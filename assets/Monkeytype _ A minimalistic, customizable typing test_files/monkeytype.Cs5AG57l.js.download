const __vite__fileDeps=["js/commandline.YdgYY-M1.js","js/vendor.RAsGzYUn.js","js/firebase.ejyHa42Z.js","js/misc.Dm4gY3rB.js","css/index.DuvNwcJp.css","js/howler.Bd76bBNG.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);import{e as Fm,s as Xn,d as yn,t as Ti,a as _r,b as ht,h as We,c as RO,f as qe,p as oo,g as qt,i as jt,j as Fh,k as P0,m as oS,n as ch,o as NO,r as Wi,q as Wy,u as Ra,v as Oe,w as ph,x as dS,y as zn,z as Sa,A as Bu,B as DO,C as tr,D as Fy,E as qu,F as jO,G as BO,H as ec,I as lS,J as uS,K as zy,L as cS,M as Wd,N as qO,O as WO,P as Iv,Q as vs,R as FO,S as zO,T as K_,U as Z0,V as R0,W as HO,X as UO,Y as V_,Z as KO,l as G_}from"./misc.Dm4gY3rB.js";import{i as VO,g as GO,$ as o,t as N0,A as QO,U as ou,e as YO,s as JO,a as Cb,b as XO,c as Q_,p as Y_,d as Sd,f as e2,h as t2,j as a2,n as s2,k as n2,l as i2,m as r2,o as Ot,q as o2,r as d2,z as Lt,u as l2,v as u2,w as c2,x as cs,y as pa,H as zh,C as Ns,B as p2,D as m2,E as f2,F as h2,L as g2,G as y2,I as v2,P as b2,S as w2,T as k2,J as _2,K as x2,M as C2,N as S2,O as J_,Q as pS,R as ya,V as mS,W as X_,X as T2,Y as $2,Z as A2,_ as M2,a0 as L2,a1 as E2,a2 as fS,a3 as hS,a4 as gS,a5 as I2,a6 as yS,a7 as O2,a8 as P2,a9 as vS,aa as Z2,ab as D0,ac as j0,ad as bS,ae as R2,af as N2,ag as D2,ah as j2,ai as B2}from"./vendor.RAsGzYUn.js";import{i as we,g as Hy,a as tc,b as g,c as q2,d as xr,s as W2,A as Qt,e as F2,f as z2,h as H2,n as Ov,j as ex}from"./firebase.ejyHa42Z.js";const U2="modulepreload",K2=function(t){return"/"+t},tx={},B0=function(e,a,s){let n=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),r=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));n=Promise.all(a.map(d=>{if(d=K2(d),d in tx)return;tx[d]=!0;const u=d.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${c}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":U2,u||(m.as="script",m.crossOrigin=""),m.href=d,r&&m.setAttribute("nonce",r),document.head.appendChild(m),u)return new Promise((f,h)=>{m.addEventListener("load",f),m.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${d}`)))})}))}return n.then(()=>e()).catch(i=>{const r=new Event("vite:preloadError",{cancelable:!0});if(r.payload=i,window.dispatchEvent(r),!r.defaultPrevented)throw i})};let wS=!0;function Io(t){wS=t}function ac(){return wS}function V2(t){const e=new AbortController;return setTimeout(()=>e.abort(new Error("request timed out")),t),e.signal}function G2(t){return async e=>{try{const a={...e.headers,"X-Client-Version":Fm.clientVersion};if(we()){const d=await GO(Hy());a.Authorization=`Bearer ${d}`}const s={method:e.method,headers:a,body:e.body},n=(AbortSignal==null?void 0:AbortSignal.timeout)===void 0,i=await fetch(e.path,{...s,signal:n?V2(t):AbortSignal.timeout(t)}),r=await i.json();return i.status>=400&&console.error(`${e.method} ${e.path} failed`,{status:i.status,...r}),{status:i.status,body:r,headers:i.headers??new Headers}}catch(a){let s="Unknown error";return a instanceof Error&&(a.message.includes("timed out")?s="request took too long to complete":s=a.message),{status:500,body:{message:s},headers:new Headers}}}}function kS(t,e,a=1e4){return VO(t,{baseUrl:e,jsonQuery:!0,api:G2(a),baseHeaders:{Accept:"application/json"}})}var yt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(yt||(yt={}));var Sb;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Sb||(Sb={}));var ee=yt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),sr=t=>{switch(typeof t){case"undefined":return ee.undefined;case"string":return ee.string;case"number":return isNaN(t)?ee.nan:ee.number;case"boolean":return ee.boolean;case"function":return ee.function;case"bigint":return ee.bigint;case"symbol":return ee.symbol;case"object":return Array.isArray(t)?ee.array:t===null?ee.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ee.promise:typeof Map<"u"&&t instanceof Map?ee.map:typeof Set<"u"&&t instanceof Set?ee.set:typeof Date<"u"&&t instanceof Date?ee.date:ee.object;default:return ee.unknown}},O=yt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Q2=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),dn=class _S extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof _S))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,yt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};dn.create=t=>new dn(t);var Fd=(t,e)=>{let a;switch(t.code){case O.invalid_type:t.received===ee.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case O.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,yt.jsonStringifyReplacer)}`;break;case O.unrecognized_keys:a=`Unrecognized key(s) in object: ${yt.joinValues(t.keys,", ")}`;break;case O.invalid_union:a="Invalid input";break;case O.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${yt.joinValues(t.options)}`;break;case O.invalid_enum_value:a=`Invalid enum value. Expected ${yt.joinValues(t.options)}, received '${t.received}'`;break;case O.invalid_arguments:a="Invalid function arguments";break;case O.invalid_return_type:a="Invalid function return type";break;case O.invalid_date:a="Invalid date";break;case O.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:yt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case O.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case O.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case O.custom:a="Invalid input";break;case O.invalid_intersection_types:a="Intersection results could not be merged";break;case O.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case O.not_finite:a="Number must be finite";break;default:a=e.defaultError,yt.assertNever(t)}return{message:a}},xS=Fd;function Y2(t){xS=t}function Hh(){return xS}var Uh=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},J2=[];function H(t,e){let a=Hh(),s=Uh({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Fd?void 0:Fd].filter(n=>!!n)});t.common.issues.push(s)}var ss=class CS{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Pe;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return CS.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return Pe;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},Pe=Object.freeze({status:"aborted"}),Kh=t=>({status:"dirty",value:t}),Da=t=>({status:"valid",value:t}),Tb=t=>t.status==="aborted",$b=t=>t.status==="dirty",sc=t=>t.status==="valid",nc=t=>typeof Promise<"u"&&t instanceof Promise;function Vh(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function SS(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var ue;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ue||(ue={}));var du,lu,ei=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ax=(t,e)=>{if(sc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new dn(t.common.issues);return this._error=a,this._error}}};function Ue(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var Xe=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return sr(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:sr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ss,ctx:{common:e.parent.common,data:e.data,parsedType:sr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(nc(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sr(e)},i=this._parseSync({data:e,path:n.path,parent:n});return ax(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:sr(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(nc(n)?n:Promise.resolve(n));return ax(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:O.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new vn({schema:this,typeName:Ce.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Hn.create(this,this._def)}nullable(){return Sr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Oo.create(this,this._def)}promise(){return Ud.create(this,this._def)}or(e){return cc.create([this,e],this._def)}and(e){return pc.create(this,e,this._def)}transform(e){return new vn({...Ue(this._def),schema:this,typeName:Ce.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new gc({...Ue(this._def),innerType:this,defaultValue:a,typeName:Ce.ZodDefault})}brand(){return new q0({typeName:Ce.ZodBranded,type:this,...Ue(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new yc({...Ue(this._def),innerType:this,catchValue:a,typeName:Ce.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return W0.create(this,e)}readonly(){return vc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},X2=/^c[^\s-]{8,}$/i,eP=/^[0-9a-z]+$/,tP=/^[0-9A-HJKMNP-TV-Z]{26}$/,aP=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,sP=/^[a-z0-9_-]{21}$/i,nP=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,iP=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,rP="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Pv,oP=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,dP=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,lP=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,TS="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",uP=new RegExp(`^${TS}$`);function $S(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function cP(t){return new RegExp(`^${$S(t)}$`)}function AS(t){let e=`${TS}T${$S(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function pP(t,e){return!!((e==="v4"||!e)&&oP.test(t)||(e==="v6"||!e)&&dP.test(t))}var zd=class uu extends Xe{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ee.string){let n=this._getOrReturnCtx(e);return H(n,{code:O.invalid_type,expected:ee.string,received:n.parsedType}),Pe}let a=new ss,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:O.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:O.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?H(s,{code:O.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&H(s,{code:O.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")iP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"email",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Pv||(Pv=new RegExp(rP,"u")),Pv.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"emoji",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")aP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"uuid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")sP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"nanoid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")X2.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"cuid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")eP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"cuid2",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")tP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"ulid",code:O.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),H(s,{validation:"url",code:O.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"regex",code:O.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?AS(n).test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?uP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?cP(n).test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{code:O.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?nP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"duration",code:O.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?pP(e.data,n.version)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"ip",code:O.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?lP.test(e.data)||(s=this._getOrReturnCtx(e,s),H(s,{validation:"base64",code:O.invalid_string,message:n.message}),a.dirty()):yt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:O.invalid_string,...ue.errToObj(s)})}_addCheck(e){return new uu({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ue.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ue.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ue.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ue.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ue.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ue.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ue.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ue.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ue.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ue.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...ue.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ue.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ue.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...ue.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...ue.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...ue.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...ue.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...ue.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...ue.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...ue.errToObj(a)})}nonempty(e){return this.min(1,ue.errToObj(e))}trim(){return new uu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new uu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new uu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};zd.create=t=>{var e;return new zd({checks:[],typeName:Ce.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};function mP(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var ic=class Ab extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ee.number){let n=this._getOrReturnCtx(e);return H(n,{code:O.invalid_type,expected:ee.number,received:n.parsedType}),Pe}let a,s=new ss;for(let n of this._def.checks)n.kind==="int"?yt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),H(a,{code:O.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?mP(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),H(a,{code:O.not_finite,message:n.message}),s.dirty()):yt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ue.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ue.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ue.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ue.toString(a))}setLimit(e,a,s,n){return new Ab({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ue.toString(n)}]})}_addCheck(e){return new Ab({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ue.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ue.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ue.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:ue.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ue.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ue.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&yt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};ic.create=t=>new ic({checks:[],typeName:Ce.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});var rc=class Mb extends Xe{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ee.bigint){let n=this._getOrReturnCtx(e);return H(n,{code:O.invalid_type,expected:ee.bigint,received:n.parsedType}),Pe}let a,s=new ss;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),H(a,{code:O.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):yt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ue.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ue.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ue.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ue.toString(a))}setLimit(e,a,s,n){return new Mb({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ue.toString(n)}]})}_addCheck(e){return new Mb({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ue.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ue.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ue.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ue.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ue.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};rc.create=t=>{var e;return new rc({checks:[],typeName:Ce.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ue(t)})};var oc=class extends Xe{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ee.boolean){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.boolean,received:a.parsedType}),Pe}return Da(e.data)}};oc.create=t=>new oc({typeName:Ce.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ue(t)});var dc=class MS extends Xe{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ee.date){let n=this._getOrReturnCtx(e);return H(n,{code:O.invalid_type,expected:ee.date,received:n.parsedType}),Pe}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return H(n,{code:O.invalid_date}),Pe}let a=new ss,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:O.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),H(s,{code:O.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):yt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new MS({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:ue.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:ue.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};dc.create=t=>new dc({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ce.ZodDate,...Ue(t)});var Gh=class extends Xe{_parse(e){if(this._getType(e)!==ee.symbol){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.symbol,received:a.parsedType}),Pe}return Da(e.data)}};Gh.create=t=>new Gh({typeName:Ce.ZodSymbol,...Ue(t)});var lc=class extends Xe{_parse(e){if(this._getType(e)!==ee.undefined){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.undefined,received:a.parsedType}),Pe}return Da(e.data)}};lc.create=t=>new lc({typeName:Ce.ZodUndefined,...Ue(t)});var uc=class extends Xe{_parse(e){if(this._getType(e)!==ee.null){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.null,received:a.parsedType}),Pe}return Da(e.data)}};uc.create=t=>new uc({typeName:Ce.ZodNull,...Ue(t)});var Hd=class extends Xe{constructor(){super(...arguments),this._any=!0}_parse(e){return Da(e.data)}};Hd.create=t=>new Hd({typeName:Ce.ZodAny,...Ue(t)});var mo=class extends Xe{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Da(e.data)}};mo.create=t=>new mo({typeName:Ce.ZodUnknown,...Ue(t)});var $i=class extends Xe{_parse(e){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.never,received:a.parsedType}),Pe}};$i.create=t=>new $i({typeName:Ce.ZodNever,...Ue(t)});var Qh=class extends Xe{_parse(e){if(this._getType(e)!==ee.undefined){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.void,received:a.parsedType}),Pe}return Da(e.data)}};Qh.create=t=>new Qh({typeName:Ce.ZodVoid,...Ue(t)});var Oo=class mh extends Xe{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==ee.array)return H(a,{code:O.invalid_type,expected:ee.array,received:a.parsedType}),Pe;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(H(a,{code:r?O.too_big:O.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(H(a,{code:O.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(H(a,{code:O.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new ei(a,r,a.path,d)))).then(r=>ss.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new ei(a,r,a.path,d)));return ss.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new mh({...this._def,minLength:{value:e,message:ue.toString(a)}})}max(e,a){return new mh({...this._def,maxLength:{value:e,message:ue.toString(a)}})}length(e,a){return new mh({...this._def,exactLength:{value:e,message:ue.toString(a)}})}nonempty(e){return this.min(1,e)}};Oo.create=(t,e)=>new Oo({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ce.ZodArray,...Ue(e)});function hd(t){if(t instanceof Ds){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Hn.create(hd(s))}return new Ds({...t._def,shape:()=>e})}else return t instanceof Oo?new Oo({...t._def,type:hd(t.element)}):t instanceof Hn?Hn.create(hd(t.unwrap())):t instanceof Sr?Sr.create(hd(t.unwrap())):t instanceof Cr?Cr.create(t.items.map(e=>hd(e))):t}var Ds=class Vs extends Xe{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=yt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==ee.object){let u=this._getOrReturnCtx(e);return H(u,{code:O.invalid_type,expected:ee.object,received:u.parsedType}),Pe}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof $i&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new ei(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof $i){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(H(s,{code:O.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new ei(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>ss.mergeObjectSync(a,u)):ss.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return ue.errToObj,new Vs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=ue.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Vs({...this._def,unknownKeys:"strip"})}passthrough(){return new Vs({...this._def,unknownKeys:"passthrough"})}extend(e){return new Vs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Vs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ce.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Vs({...this._def,catchall:e})}pick(e){let a={};return yt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Vs({...this._def,shape:()=>a})}omit(e){let a={};return yt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Vs({...this._def,shape:()=>a})}deepPartial(){return hd(this)}partial(e){let a={};return yt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Vs({...this._def,shape:()=>a})}required(e){let a={};return yt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Hn;)n=n._def.innerType;a[s]=n}}),new Vs({...this._def,shape:()=>a})}keyof(){return ZS(yt.objectKeys(this.shape))}};Ds.create=(t,e)=>new Ds({shape:()=>t,unknownKeys:"strip",catchall:$i.create(),typeName:Ce.ZodObject,...Ue(e)});Ds.strictCreate=(t,e)=>new Ds({shape:()=>t,unknownKeys:"strict",catchall:$i.create(),typeName:Ce.ZodObject,...Ue(e)});Ds.lazycreate=(t,e)=>new Ds({shape:t,unknownKeys:"strip",catchall:$i.create(),typeName:Ce.ZodObject,...Ue(e)});var cc=class extends Xe{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new dn(d.ctx.common.issues));return H(a,{code:O.invalid_union,unionErrors:r}),Pe}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new dn(u));return H(a,{code:O.invalid_union,unionErrors:d}),Pe}}get options(){return this._def.options}};cc.create=(t,e)=>new cc({options:t,typeName:Ce.ZodUnion,...Ue(e)});var Ki=t=>t instanceof mc?Ki(t.schema):t instanceof vn?Ki(t.innerType()):t instanceof fc?[t.value]:t instanceof zm?t.options:t instanceof hc?yt.objectValues(t.enum):t instanceof gc?Ki(t._def.innerType):t instanceof lc?[void 0]:t instanceof uc?[null]:t instanceof Hn?[void 0,...Ki(t.unwrap())]:t instanceof Sr?[null,...Ki(t.unwrap())]:t instanceof q0||t instanceof vc?Ki(t.unwrap()):t instanceof yc?Ki(t._def.innerType):[],LS=class ES extends Xe{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ee.object)return H(a,{code:O.invalid_type,expected:ee.object,received:a.parsedType}),Pe;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(H(a,{code:O.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Pe)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Ki(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new ES({typeName:Ce.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ue(s)})}};function Lb(t,e){let a=sr(t),s=sr(e);if(t===e)return{valid:!0,data:t};if(a===ee.object&&s===ee.object){let n=yt.objectKeys(e),i=yt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=Lb(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===ee.array&&s===ee.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=Lb(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===ee.date&&s===ee.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var pc=class extends Xe{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(Tb(i)||Tb(r))return Pe;let d=Lb(i.value,r.value);return d.valid?(($b(i)||$b(r))&&a.dirty(),{status:a.value,value:d.data}):(H(s,{code:O.invalid_intersection_types}),Pe)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};pc.create=(t,e,a)=>new pc({left:t,right:e,typeName:Ce.ZodIntersection,...Ue(a)});var Cr=class IS extends Xe{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ee.array)return H(s,{code:O.invalid_type,expected:ee.array,received:s.parsedType}),Pe;if(s.data.length<this._def.items.length)return H(s,{code:O.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Pe;!this._def.rest&&s.data.length>this._def.items.length&&(H(s,{code:O.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new ei(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>ss.mergeArray(a,i)):ss.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new IS({...this._def,rest:e})}};Cr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Cr({items:t,typeName:Ce.ZodTuple,rest:null,...Ue(e)})};var OS=class Eb extends Xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ee.object)return H(s,{code:O.invalid_type,expected:ee.object,received:s.parsedType}),Pe;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new ei(s,d,s.path,d)),value:r._parse(new ei(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?ss.mergeObjectAsync(a,n):ss.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof Xe?new Eb({keyType:e,valueType:a,typeName:Ce.ZodRecord,...Ue(s)}):new Eb({keyType:zd.create(),valueType:e,typeName:Ce.ZodRecord,...Ue(a)})}},Yh=class extends Xe{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ee.map)return H(s,{code:O.invalid_type,expected:ee.map,received:s.parsedType}),Pe;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new ei(s,d,s.path,[c,"key"])),value:i._parse(new ei(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return Pe;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return Pe;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};Yh.create=(t,e,a)=>new Yh({valueType:e,keyType:t,typeName:Ce.ZodMap,...Ue(a)});var Jh=class Ib extends Xe{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ee.set)return H(s,{code:O.invalid_type,expected:ee.set,received:s.parsedType}),Pe;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(H(s,{code:O.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(H(s,{code:O.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return Pe;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new ei(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new Ib({...this._def,minSize:{value:e,message:ue.toString(a)}})}max(e,a){return new Ib({...this._def,maxSize:{value:e,message:ue.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Jh.create=(t,e)=>new Jh({valueType:t,minSize:null,maxSize:null,typeName:Ce.ZodSet,...Ue(e)});var PS=class fh extends Xe{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ee.function)return H(a,{code:O.invalid_type,expected:ee.function,received:a.parsedType}),Pe;function s(d,u){return Uh({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Hh(),Fd].filter(c=>!!c),issueData:{code:O.invalid_arguments,argumentsError:u}})}function n(d,u){return Uh({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Hh(),Fd].filter(c=>!!c),issueData:{code:O.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof Ud){let d=this;return Da(async function(...u){let c=new dn([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return Da(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new dn([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new dn([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new fh({...this._def,args:Cr.create(e).rest(mo.create())})}returns(e){return new fh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new fh({args:e||Cr.create([]).rest(mo.create()),returns:a||mo.create(),typeName:Ce.ZodFunction,...Ue(s)})}},mc=class extends Xe{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};mc.create=(t,e)=>new mc({getter:t,typeName:Ce.ZodLazy,...Ue(e)});var fc=class extends Xe{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return H(a,{received:a.data,code:O.invalid_literal,expected:this._def.value}),Pe}return{status:"valid",value:e.data}}get value(){return this._def.value}};fc.create=(t,e)=>new fc({value:t,typeName:Ce.ZodLiteral,...Ue(e)});function ZS(t,e){return new zm({values:t,typeName:Ce.ZodEnum,...Ue(e)})}var zm=class Ob extends Xe{constructor(){super(...arguments),du.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return H(a,{expected:yt.joinValues(s),received:a.parsedType,code:O.invalid_type}),Pe}if(Vh(this,du)||SS(this,du,new Set(this._def.values)),!Vh(this,du).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return H(a,{received:a.data,code:O.invalid_enum_value,options:s}),Pe}return Da(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return Ob.create(e,{...this._def,...a})}exclude(e,a=this._def){return Ob.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};du=new WeakMap;zm.create=ZS;var hc=class extends Xe{constructor(){super(...arguments),lu.set(this,void 0)}_parse(e){let a=yt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ee.string&&s.parsedType!==ee.number){let n=yt.objectValues(a);return H(s,{expected:yt.joinValues(n),received:s.parsedType,code:O.invalid_type}),Pe}if(Vh(this,lu)||SS(this,lu,new Set(yt.getValidEnumValues(this._def.values))),!Vh(this,lu).has(e.data)){let n=yt.objectValues(a);return H(s,{received:s.data,code:O.invalid_enum_value,options:n}),Pe}return Da(e.data)}get enum(){return this._def.values}};lu=new WeakMap;hc.create=(t,e)=>new hc({values:t,typeName:Ce.ZodNativeEnum,...Ue(e)});var Ud=class extends Xe{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ee.promise&&a.common.async===!1)return H(a,{code:O.invalid_type,expected:ee.promise,received:a.parsedType}),Pe;let s=a.parsedType===ee.promise?a.data:Promise.resolve(a.data);return Da(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};Ud.create=(t,e)=>new Ud({type:t,typeName:Ce.ZodPromise,...Ue(e)});var vn=class extends Xe{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ce.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{H(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return Pe;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?Pe:u.status==="dirty"||a.value==="dirty"?Kh(u.value):u});{if(a.value==="aborted")return Pe;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?Pe:d.status==="dirty"||a.value==="dirty"?Kh(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?Pe:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?Pe:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!sc(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>sc(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);yt.assertNever(n)}};vn.create=(t,e,a)=>new vn({schema:t,typeName:Ce.ZodEffects,effect:e,...Ue(a)});vn.createWithPreprocess=(t,e,a)=>new vn({schema:e,effect:{type:"preprocess",transform:t},typeName:Ce.ZodEffects,...Ue(a)});var Hn=class extends Xe{_parse(e){return this._getType(e)===ee.undefined?Da(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Hn.create=(t,e)=>new Hn({innerType:t,typeName:Ce.ZodOptional,...Ue(e)});var Sr=class extends Xe{_parse(e){return this._getType(e)===ee.null?Da(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Sr.create=(t,e)=>new Sr({innerType:t,typeName:Ce.ZodNullable,...Ue(e)});var gc=class extends Xe{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===ee.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};gc.create=(t,e)=>new gc({innerType:t,typeName:Ce.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ue(e)});var yc=class extends Xe{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return nc(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new dn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new dn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};yc.create=(t,e)=>new yc({innerType:t,typeName:Ce.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ue(e)});var Xh=class extends Xe{_parse(e){if(this._getType(e)!==ee.nan){let a=this._getOrReturnCtx(e);return H(a,{code:O.invalid_type,expected:ee.nan,received:a.parsedType}),Pe}return{status:"valid",value:e.data}}};Xh.create=t=>new Xh({typeName:Ce.ZodNaN,...Ue(t)});var fP=Symbol("zod_brand"),q0=class extends Xe{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},W0=class RS extends Xe{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Pe:n.status==="dirty"?(a.dirty(),Kh(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Pe:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new RS({in:e,out:a,typeName:Ce.ZodPipeline})}},vc=class extends Xe{_parse(e){let a=this._def.innerType._parse(e),s=n=>(sc(n)&&(n.value=Object.freeze(n.value)),n);return nc(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};vc.create=(t,e)=>new vc({innerType:t,typeName:Ce.ZodReadonly,...Ue(e)});function NS(t,e={},a){return t?Hd.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):Hd.create()}var hP={object:Ds.lazycreate},Ce;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ce||(Ce={}));var gP=(t,e={message:`Input not instance of ${t.name}`})=>NS(a=>a instanceof t,e),DS=zd.create,jS=ic.create,yP=Xh.create,vP=rc.create,BS=oc.create,bP=dc.create,wP=Gh.create,kP=lc.create,_P=uc.create,xP=Hd.create,CP=mo.create,SP=$i.create,TP=Qh.create,$P=Oo.create,AP=Ds.create,MP=Ds.strictCreate,LP=cc.create,EP=LS.create,IP=pc.create,OP=Cr.create,PP=OS.create,ZP=Yh.create,RP=Jh.create,NP=PS.create,DP=mc.create,Pb=fc.create,jP=zm.create,BP=hc.create,qP=Ud.create,sx=vn.create,WP=Hn.create,FP=Sr.create,zP=vn.createWithPreprocess,HP=W0.create,UP=()=>DS().optional(),KP=()=>jS().optional(),VP=()=>BS().optional(),GP={string:t=>zd.create({...t,coerce:!0}),number:t=>ic.create({...t,coerce:!0}),boolean:t=>oc.create({...t,coerce:!0}),bigint:t=>rc.create({...t,coerce:!0}),date:t=>dc.create({...t,coerce:!0})},QP=Pe,p=Object.freeze({__proto__:null,defaultErrorMap:Fd,setErrorMap:Y2,getErrorMap:Hh,makeIssue:Uh,EMPTY_PATH:J2,addIssueToContext:H,ParseStatus:ss,INVALID:Pe,DIRTY:Kh,OK:Da,isAborted:Tb,isDirty:$b,isValid:sc,isAsync:nc,get util(){return yt},get objectUtil(){return Sb},ZodParsedType:ee,getParsedType:sr,ZodType:Xe,datetimeRegex:AS,ZodString:zd,ZodNumber:ic,ZodBigInt:rc,ZodBoolean:oc,ZodDate:dc,ZodSymbol:Gh,ZodUndefined:lc,ZodNull:uc,ZodAny:Hd,ZodUnknown:mo,ZodNever:$i,ZodVoid:Qh,ZodArray:Oo,ZodObject:Ds,ZodUnion:cc,ZodDiscriminatedUnion:LS,ZodIntersection:pc,ZodTuple:Cr,ZodRecord:OS,ZodMap:Yh,ZodSet:Jh,ZodFunction:PS,ZodLazy:mc,ZodLiteral:fc,ZodEnum:zm,ZodNativeEnum:hc,ZodPromise:Ud,ZodEffects:vn,ZodTransformer:vn,ZodOptional:Hn,ZodNullable:Sr,ZodDefault:gc,ZodCatch:yc,ZodNaN:Xh,BRAND:fP,ZodBranded:q0,ZodPipeline:W0,ZodReadonly:vc,custom:NS,Schema:Xe,ZodSchema:Xe,late:hP,get ZodFirstPartyTypeKind(){return Ce},coerce:GP,any:xP,array:$P,bigint:vP,boolean:BS,date:bP,discriminatedUnion:EP,effect:sx,enum:jP,function:NP,instanceof:gP,intersection:IP,lazy:DP,literal:Pb,map:ZP,nan:yP,nativeEnum:BP,never:SP,null:_P,nullable:FP,number:jS,object:AP,oboolean:VP,onumber:KP,optional:WP,ostring:UP,pipeline:HP,preprocess:zP,promise:qP,record:PP,set:RP,strictObject:MP,string:DS,symbol:wP,transformer:sx,tuple:OP,undefined:kP,union:LP,unknown:CP,void:TP,NEVER:QP,ZodIssueCode:O,quotelessJson:Q2,ZodError:dn}),Zv=t=>typeof(t==null?void 0:t.passthrough)=="function",YP=(t,e)=>Zv(t)?Zv(e)?t.merge(e):t:Zv(e)?e:Object.assign({},t,e);p.object({name:p.literal("ZodError"),issues:p.array(p.object({path:p.array(p.union([p.string(),p.number()])),message:p.string().optional(),code:p.nativeEnum(p.ZodIssueCode)}).catchall(p.any()))});var JP=Symbol("ContractNoBody"),XP=t=>"method"in t&&"path"in t,qS=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,s])=>{var n,i,r;return XP(s)?[a,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:YP(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(i=s.validateResponseOnClient)!==null&&i!==void 0?i:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(r=s.metadata)!==null&&r!==void 0?r:{}}:s.metadata}]:[a,qS(s,e)]})),Rv=Symbol("ContractPlainType"),ps=()=>({router:(t,e)=>qS(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>Rv,body:()=>Rv,type:()=>Rv,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>JP}),Ie=p.object({message:p.string()}),eZ=Ie.extend({validationErrors:p.array(p.string())}),Td=Ie,nx=Td.extend({errorId:p.string(),uid:p.string().optional()});function Yo(t){return Ie.extend({data:t.nullable()})}function mt(t){return Ie.extend({data:t})}var Ss={400:Td.describe("Generic client error"),401:Td.describe("Authentication required but not provided or invalid"),403:Td.describe("Operation not permitted"),422:eZ.describe("Request validation failed"),429:Td.describe("Rate limit exceeded"),500:nx.describe("Generic server error"),503:nx.describe("Endpoint disabled or server is under maintenance")},Un=p.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(p.number().transform(String)),Po=()=>p.string().regex(/^[a-zA-Z0-9_]+$/),St=Po(),tZ=Po().max(50),ua=p.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]"),ix=p.string().nullable().optional().transform(t=>t??void 0),Wu=p.number().nonnegative().max(100),rx=p.number().nonnegative().max(420),aZ=p.enum(["repeat","random","shuffle"]),sZ=p.enum(["word","time","section"]),nZ=p.object({uid:St}).strict(),iZ=mt(p.object({banned:p.boolean()})).strict(),rZ=p.object({reports:p.array(p.object({reportId:p.string()}).strict()).nonempty()}).strict(),oZ=p.object({reports:p.array(p.object({reportId:p.string(),reason:p.string().optional()}).strict()).nonempty()}).strict(),dZ=p.object({email:p.string().email()}).strict(),lZ=ps(),uZ=lZ.router({test:{summary:"test permission",description:"Check for admin permission for the current user",method:"GET",path:"",responses:{200:Ie}},toggleBan:{summary:"toggle user ban",description:"Ban an unbanned user or unban a banned user.",method:"POST",path:"/toggleBan",body:nZ,responses:{200:iZ}},acceptReports:{summary:"accept reports",description:"Accept one or many reports",method:"POST",path:"/report/accept",body:rZ,responses:{200:Ie}},rejectReports:{summary:"reject reports",description:"Reject one or many reports",method:"POST",path:"/report/reject",body:oZ,responses:{200:Ie}},sendForgotPasswordEmail:{summary:"send forgot password email",description:"Send a forgot password email to the given user email",method:"POST",path:"/sendForgotPasswordEmail",body:dZ,responses:{200:Ie}}},{pathPrefix:"/admin",strictStatusCodes:!0,metadata:{openApiTags:"admin",authenticationOptions:{noCache:!0},rateLimit:"adminLimit",requirePermission:"admin",requireConfiguration:{path:"admin.endpointsEnabled",invalidMessage:"Admin endpoints are currently disabled."}},commonResponses:Ss}),WS=p.object({name:p.string().regex(/^[0-9a-zA-Z_.-]+$/).max(20),enabled:p.boolean()}),FS=WS.extend({createdOn:p.number().min(0),modifiedOn:p.number().min(0),lastUsedOn:p.number().min(0).or(p.literal(-1))}),cZ=p.record(St,FS),pZ=mt(cZ),zS=WS,mZ=mt(p.object({apeKeyId:St,apeKey:p.string().base64(),apeKeyDetails:FS})),fZ=zS.partial(),ox=p.object({apeKeyId:St}),dx=ps(),hZ=dx.router({get:{summary:"get ape keys",description:"Get ape keys of the current user.",method:"GET",path:"",responses:{200:pZ},metadata:{rateLimit:"apeKeysGet"}},add:{summary:"add ape key",description:"Add an ape key for the current user.",method:"POST",path:"",body:zS.strict(),responses:{200:mZ},metadata:{rateLimit:"apeKeysGenerate"}},save:{summary:"update ape key",description:"Update an existing ape key for the current user.",method:"PATCH",path:"/:apeKeyId",pathParams:ox,body:fZ.strict(),responses:{200:Ie},metadata:{rateLimit:"apeKeysGenerate"}},delete:{summary:"delete ape key",description:"Delete ape key by id.",method:"DELETE",path:"/:apeKeyId",pathParams:ox,body:dx.noBody(),responses:{200:Ie},metadata:{rateLimit:"apeKeysGenerate"}}},{pathPrefix:"/ape-keys",strictStatusCodes:!0,metadata:{openApiTags:"ape-keys",requirePermission:"canManageApeKeys",requireConfiguration:{path:"apeKeys.endpointsEnabled",invalidMessage:"ApeKeys are currently disabled."}},commonResponses:Ss}),F0=p.enum(["normal","expert","master"]),gd=p.object({acc:p.number().nonnegative().max(100),consistency:p.number().nonnegative().max(100),difficulty:F0,lazyMode:p.boolean().optional(),language:p.string().max(100).regex(/[\w+]+/),punctuation:p.boolean().optional(),numbers:p.boolean().optional(),raw:p.number().nonnegative(),wpm:p.number().nonnegative(),timestamp:p.number().nonnegative()}),Uy=p.object({time:p.record(Un.describe("Number of seconds as string"),p.array(gd)),words:p.record(Un.describe("Number of words as string"),p.array(gd)),quote:p.record(Un,p.array(gd)),custom:p.record(p.literal("custom"),p.array(gd)),zen:p.record(p.literal("zen"),p.array(gd))}),gZ=p.union([p.literal("10"),p.literal("25"),p.literal("50"),p.literal("100")]),yZ=p.union([p.literal("15"),p.literal("30"),p.literal("60"),p.literal("120")]),vZ=p.union([p.literal("short"),p.literal("medium"),p.literal("long"),p.literal("thicc")]),Ur=Uy.keyof(),Jo=p.union([Un,Pb("zen"),Pb("custom")],{errorMap:()=>({message:'Needs to be either a number, "zen" or "custom".'})}),bZ=p.enum(["off","slow","medium","fast"]),wZ=p.enum(["off","esc","tab","enter"]),kZ=p.union([p.literal(-3),p.literal(-2),p.literal(-1),p.literal(0),p.literal(1),p.literal(2),p.literal(3)]),_Z=p.array(kZ),lx=p.enum(["off","default","block","outline","underline","carrot","banana"]),xZ=p.enum(["off","on","max"]),CZ=p.enum(["off","below","replace"]),SZ=p.enum(["off","bar","text","mini"]),Nv=p.enum(["off","text","mini"]),TZ=p.enum(["off","on","fav","light","dark","custom"]),$Z=p.enum(["black","sub","text","main"]),AZ=p.enum(["0.25","0.5","0.75","1"]),MZ=p.enum(["off","word","letter"]),LZ=p.enum(["off","static","react","next"]),EZ=p.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),IZ=p.enum(["lowercase","uppercase","blank","dynamic"]),OZ=p.enum(["always","layout","never"]),PZ=p.number().min(.5).max(3.5).step(.1),ZZ=p.enum(["manual","on"]),RZ=p.enum(["off","1","2","3","4"]),NZ=p.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),DZ=p.number().min(0).max(1),jZ=p.enum(["off","average","pb","tagPb","last","custom","daily"]),BZ=p.tuple([p.enum(["on","off"]),p.enum(["on","off"]),p.enum(["on","off"]),p.enum(["on","off"])]),qZ=p.enum(["off","custom"]),WZ=p.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),FZ=p.enum(["off","letter","word"]),zZ=p.enum(["wpm","cpm","wps","cps","wph"]),HZ=p.enum(["off","result","on","sellout"]),UZ=p.enum(["off","custom"]),KZ=p.enum(["off","typing"]),VZ=p.enum(["off","on","keymap"]),GZ=p.enum(["cover","contain","max"]),QZ=p.tuple([p.number(),p.number(),p.number(),p.number()]),YZ=p.string().regex(/^[0-9a-zA-Z_#]+$/),JZ=p.enum(["off","1","2","3","4"]),XZ=p.enum(["off","fixed","flex"]),eR=p.enum(["off","speed","acc","both"]),$n=p.string().regex(/^#([\da-f]{3}){1,2}$/i),HS=F0,z0=p.tuple([$n,$n,$n,$n,$n,$n,$n,$n,$n,$n]),tR=p.array(Po().max(50)),US=p.string().max(100).regex(/[\w#]+/),aR=p.number().nonnegative(),sR=p.number().nonnegative(),nR=p.number().nonnegative().max(100),iR=p.number().nonnegative(),rR=p.number().int().nonnegative(),oR=p.number().int().nonnegative(),dR=p.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),Dv=Po().max(50),lR=p.string().max(50).regex(/[\w\-_]+/),uR=Po().max(50),cR=p.number().positive(),pR=p.number().min(20).max(1e3).or(p.literal(0)),mR=p.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(p.literal("")),fR=p.object({theme:Dv,themeLight:Dv,themeDark:Dv,autoSwitchTheme:p.boolean(),customTheme:p.boolean(),customThemeColors:z0,favThemes:tR,showKeyTips:p.boolean(),smoothCaret:bZ,quickRestart:wZ,punctuation:p.boolean(),numbers:p.boolean(),words:oR,time:rR,mode:Ur,quoteLength:_Z,language:ua,fontSize:cR,freedomMode:p.boolean(),difficulty:HS,blindMode:p.boolean(),quickEnd:p.boolean(),caretStyle:lx,paceCaretStyle:lx,flipTestColors:p.boolean(),layout:uR,funbox:US,confidenceMode:xZ,indicateTypos:CZ,timerStyle:SZ,liveSpeedStyle:Nv,liveAccStyle:Nv,liveBurstStyle:Nv,colorfulMode:p.boolean(),randomTheme:TZ,timerColor:$Z,timerOpacity:AZ,stopOnError:MZ,showAllLines:p.boolean(),keymapMode:LZ,keymapStyle:EZ,keymapLegendStyle:IZ,keymapLayout:lR,keymapShowTopRow:OZ,keymapSize:PZ,fontFamily:dR,smoothLineScroll:p.boolean(),alwaysShowDecimalPlaces:p.boolean(),alwaysShowWordsHistory:p.boolean(),singleListCommandLine:ZZ,capsLockWarning:p.boolean(),playSoundOnError:RZ,playSoundOnClick:NZ,soundVolume:DZ,startGraphsAtZero:p.boolean(),showOutOfFocusWarning:p.boolean(),paceCaret:jZ,paceCaretCustomSpeed:aR,repeatedPace:p.boolean(),accountChart:BZ,minWpm:qZ,minWpmCustomSpeed:sR,highlightMode:WZ,tapeMode:FZ,typingSpeedUnit:zZ,ads:HZ,hideExtraLetters:p.boolean(),strictSpace:p.boolean(),minAcc:UZ,minAccCustom:nR,monkey:p.boolean(),repeatQuotes:KZ,oppositeShiftMode:VZ,customBackground:mR,customBackgroundSize:GZ,customBackgroundFilter:QZ,customLayoutfluid:YZ,monkeyPowerLevel:JZ,minBurst:XZ,minBurstCustomSpeed:iR,burstHeatmap:p.boolean(),britishEnglish:p.boolean(),lazyMode:p.boolean(),showAverage:eR,maxLineWidth:pR}).strict(),H0=fR.partial(),hR=Yo(H0),ux=ps(),gR=ux.router({get:{summary:"get config",description:"Get config of the current user.",method:"GET",path:"",responses:{200:hR},metadata:{rateLimit:"configGet"}},save:{summary:"update config",description:"Update the config of the current user. Only provided values will be updated while the missing values will be unchanged.",method:"PATCH",path:"",body:H0.strict(),responses:{200:Ie},metadata:{rateLimit:"configUpdate"}},delete:{summary:"delete config",description:"Delete/reset the config for the current user.",method:"DELETE",path:"",body:ux.noBody(),responses:{200:Ie},metadata:{rateLimit:"configDelete"}}},{pathPrefix:"/configs",strictStatusCodes:!0,metadata:{openApiTags:"configs"},commonResponses:Ss}),yR=p.string().regex(/^[0-9a-zA-Z_-]+$/).max(16);p.enum(["full","partial"]);var cx=p.enum(["test","behavior","input","sound","caret","appearance","theme","hideElements","ads","hidden"]),vR=p.array(cx).min(1).superRefine((t,e)=>{cx.options.forEach(a=>{t.filter(s=>s===a).length>1&&e.addIssue({code:p.ZodIssueCode.custom,message:"No duplicates allowed."})})}),U0=p.object({_id:St,name:yR,settingGroups:vR.nullable().optional(),config:H0.extend({tags:p.array(tZ).optional()})}),bR=U0.partial({config:!0,settingGroups:!0}),wR=mt(p.array(U0)),kR=U0.omit({_id:!0}),_R=mt(p.object({presetId:St})),xR=p.object({presetId:St}),px=ps(),CR=px.router({get:{summary:"get presets",description:"Get presets of the current user.",method:"GET",path:"",responses:{200:wR},metadata:{rateLimit:"presetsGet"}},add:{summary:"add preset",description:"Add a new preset for the current user.",method:"POST",path:"",body:kR.strict(),responses:{200:_R},metadata:{rateLimit:"presetsAdd"}},save:{summary:"update preset",description:"Update an existing preset for the current user.",method:"PATCH",path:"",body:bR.strict(),responses:{200:Ie},metadata:{rateLimit:"presetsEdit"}},delete:{summary:"delete preset",description:"Delete preset by id.",method:"DELETE",path:"/:presetId",pathParams:xR,body:px.noBody(),responses:{200:Ie},metadata:{rateLimit:"presetsRemove"}}},{pathPrefix:"/presets",strictStatusCodes:!0,metadata:{openApiTags:"presets"},commonResponses:Ss}),KS=p.object({_id:St,message:p.string(),date:p.number().int().min(0).optional(),level:p.number().int().optional(),sticky:p.boolean().optional()}),SR=mt(p.array(KS)),TR=ps(),$R=TR.router({get:{summary:"get psas",description:"Get list of public service announcements",method:"GET",path:"",responses:{200:SR}}},{pathPrefix:"/psas",strictStatusCodes:!0,metadata:{openApiTags:"psas",authenticationOptions:{isPublic:!0},rateLimit:"psaGet"},commonResponses:Ss}),AR=p.record(Un,p.number().int()),MR=p.object({timeTyping:p.number().nonnegative(),testsCompleted:p.number().int().nonnegative(),testsStarted:p.number().int().nonnegative()}),LR=p.object({language:ua,mode:Ur,mode2:Jo}).strict(),ER=mt(AR),IR=mt(MR),OR=ps(),PR=OR.router({getSpeedHistogram:{summary:"get speed histogram",description:"get number of users personal bests grouped by wpm level (multiples of ten)",method:"GET",path:"/speedHistogram",query:LR,responses:{200:ER}},getTypingStats:{summary:"get typing stats",description:"get number of tests and time users spend typing.",method:"GET",path:"/typingStats",responses:{200:IR}}},{pathPrefix:"/public",strictStatusCodes:!0,metadata:{openApiTags:"public",authenticationOptions:{isPublic:!0},rateLimit:"publicStatsGet"},commonResponses:Ss}),VS=p.object({wpm:p.number().nonnegative(),acc:p.number().nonnegative().min(0).max(100),timestamp:p.number().int().nonnegative(),raw:p.number().nonnegative(),consistency:p.number().nonnegative().optional(),uid:p.string(),name:p.string(),discordId:p.string().optional(),discordAvatar:p.string().optional(),rank:p.number().nonnegative().int(),badgeId:p.number().int().optional(),isPremium:p.boolean().optional()}),GS=p.object({count:p.number().int().nonnegative(),rank:p.number().int().nonnegative().optional(),entry:VS.optional()}),ZR=GS.extend({minWpm:p.number().nonnegative()}),QS=p.object({uid:p.string(),name:p.string(),discordId:p.string().optional(),discordAvatar:p.string().optional(),badgeId:p.number().int().optional(),lastActivityTimestamp:p.number().int().nonnegative(),timeTypedSeconds:p.number().nonnegative(),rank:p.number().nonnegative().int(),totalXp:p.number().nonnegative().int()}),RR=QS.extend({count:p.number().int().nonnegative()}),K0=p.object({language:ua,mode:Ur,mode2:Jo}),V0=p.object({skip:p.number().int().nonnegative().optional(),limit:p.number().int().nonnegative().max(50).optional()}),NR=K0.merge(V0),mx=mt(p.array(VS)),DR=mt(GS),YS=K0.extend({daysBefore:p.literal(1).optional()}),jR=YS.merge(V0),BR=mt(ZR),qR=V0.extend({weeksBefore:p.literal(1).optional()}),WR=mt(p.array(QS)),FR=Yo(RR.partial()),zR=ps(),HR=zR.router({get:{summary:"get leaderboard",description:"Get all-time leaderboard.",method:"GET",path:"",query:NR.strict(),responses:{200:mx},metadata:{authenticationOptions:{isPublic:!0}}},getRank:{summary:"get leaderboard rank",description:"Get the rank of the current user on the all-time leaderboard",method:"GET",path:"/rank",query:K0.strict(),responses:{200:DR},metadata:{authenticationOptions:{acceptApeKeys:!0}}},getDaily:{summary:"get daily leaderboard",description:"Get daily leaderboard.",method:"GET",path:"/daily",query:jR.strict(),responses:{200:mx},metadata:{authenticationOptions:{isPublic:!0},requireConfiguration:{path:"dailyLeaderboards.enabled",invalidMessage:"Daily leaderboards are not available at this time."}}},getDailyRank:{summary:"get daily leaderboard rank",description:"Get the rank of the current user on the daily leaderboard",method:"GET",path:"/daily/rank",query:YS.strict(),responses:{200:BR},metadata:{requireConfiguration:{path:"dailyLeaderboards.enabled",invalidMessage:"Daily leaderboards are not available at this time."}}},getWeeklyXp:{summary:"get weekly xp leaderboard",description:"Get weekly xp leaderboard",method:"GET",path:"/xp/weekly",query:qR.strict(),responses:{200:WR},metadata:{authenticationOptions:{isPublic:!0},requireConfiguration:{path:"leaderboards.weeklyXp.enabled",invalidMessage:"Weekly XP leaderboards are not available at this time."}}},getWeeklyXpRank:{summary:"get weekly xp leaderboard rank",description:"Get the rank of the current user on the weekly xp leaderboard",method:"GET",path:"/xp/weekly/rank",responses:{200:FR},metadata:{requireConfiguration:{path:"leaderboards.weeklyXp.enabled",invalidMessage:"Weekly XP leaderboards are not available at this time."}}}},{pathPrefix:"/leaderboards",strictStatusCodes:!0,metadata:{openApiTags:"leaderboards",rateLimit:"leaderboardsGet"},commonResponses:Ss}),UR=p.object({acc:Wu,seconds:p.number().nonnegative()}),KR=p.object({wpm:p.array(p.number().nonnegative()).max(122),raw:p.array(p.number().nonnegative()).max(122),err:p.array(p.number().nonnegative()).max(122)}),fx=p.object({average:p.number().nonnegative(),sd:p.number().nonnegative()}),VR=p.object({textLen:p.number().int().nonnegative(),mode:aZ,pipeDelimiter:p.boolean(),limit:p.object({mode:sZ,value:p.number().nonnegative()})}),GR=p.tuple([p.number().int().nonnegative(),p.number().int().nonnegative(),p.number().int().nonnegative(),p.number().int().nonnegative()]),JS=p.object({wpm:rx,rawWpm:rx,charStats:GR,acc:Wu.min(50),mode:Ur,mode2:Jo,quoteLength:p.number().int().nonnegative().max(3).optional(),timestamp:p.number().int().nonnegative(),testDuration:p.number().min(1),consistency:Wu,keyConsistency:Wu,chartData:KR.or(p.literal("toolong")),uid:St,restartCount:p.number().int().nonnegative().optional(),incompleteTestSeconds:p.number().nonnegative().optional(),afkDuration:p.number().nonnegative().optional(),tags:p.array(St).optional(),bailedOut:p.boolean().optional(),blindMode:p.boolean().optional(),lazyMode:p.boolean().optional(),funbox:US.optional(),language:ua.optional(),difficulty:HS.optional(),numbers:p.boolean().optional(),punctuation:p.boolean().optional()}),XS=JS.extend({_id:St,keySpacingStats:fx.optional(),keyDurationStats:fx.optional(),name:p.string(),isPb:p.boolean().optional()}),QR=JS.required({restartCount:!0,incompleteTestSeconds:!0,afkDuration:!0,tags:!0,bailedOut:!0,blindMode:!0,lazyMode:!0,funbox:!0,language:!0,difficulty:!0,numbers:!0,punctuation:!0}).extend({charTotal:p.number().int().nonnegative(),challenge:Po().max(100).optional(),customText:VR.optional(),hash:Po().max(100),keyDuration:p.array(p.number().nonnegative()).or(p.literal("toolong")),keySpacing:p.array(p.number().nonnegative()).or(p.literal("toolong")),keyOverlap:p.number().nonnegative(),lastKeyToEnd:p.number().nonnegative(),startToFirstKey:p.number().nonnegative(),wpmConsistency:Wu,stopOnLetter:p.boolean(),incompleteTests:p.array(UR)}).strict(),YR=p.object({base:p.number().int().optional(),fullAccuracy:p.number().int().optional(),quote:p.number().int().optional(),corrected:p.number().int().optional(),punctuation:p.number().int().optional(),numbers:p.number().int().optional(),funbox:p.number().int().optional(),streak:p.number().int().optional(),incomplete:p.number().int().optional(),daily:p.number().int().optional(),accPenalty:p.number().int().optional(),configMultiplier:p.number().int().optional()}),JR=p.object({insertedId:St,isPb:p.boolean(),tagPbs:p.array(St),dailyLeaderboardRank:p.number().int().nonnegative().optional(),weeklyXpLeaderboardRank:p.number().int().nonnegative().optional(),xp:p.number().int().nonnegative(),dailyXpBonus:p.boolean(),xpBreakdown:YR,streak:p.number().int().nonnegative()}),XR=p.object({onOrAfterTimestamp:p.number().int().min(15894288e5).optional().describe("Timestamp of the earliest result to fetch. If omitted the most recent results are fetched."),offset:p.number().int().nonnegative().optional().describe("Offset of the item at which to begin the response."),limit:p.number().int().nonnegative().max(1e3).optional().describe("Limit results to the given amount.")}),eN=mt(p.array(XS)),tN=p.object({result:QR}),aN=mt(JR),sN=p.object({tagIds:p.array(St),resultId:St}),nN=mt(p.object({tagPbs:p.array(St)})),iN=mt(XS),hx=ps(),rN=hx.router({get:{summary:"get results",description:"Gets up to 1000 results",method:"GET",path:"",query:XR.strict(),responses:{200:eN},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:{normal:"resultsGet",apeKey:"resultsGetApe"}}},add:{summary:"add result",description:"Add a test result for the current user",method:"POST",path:"",body:tN.strict(),responses:{200:aN},metadata:{rateLimit:"resultsAdd",requireConfiguration:{path:"results.savingEnabled",invalidMessage:"Results are not being saved at this time."}}},updateTags:{summary:"update result tags",description:"Labels a result with the specified tags",method:"PATCH",path:"/tags",body:sN.strict(),responses:{200:nN},metadata:{rateLimit:"resultsTagsUpdate"}},deleteAll:{summary:"delete all results",description:"Delete all results for the current user",method:"DELETE",path:"",body:hx.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"resultsDeleteAll"}},getLast:{summary:"get last result",description:"Gets a user's last saved result",path:"/last",method:"GET",responses:{200:iN},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"resultsGet"}}},{pathPrefix:"/results",strictStatusCodes:!0,metadata:{openApiTags:"results"},commonResponses:Ss}),gx=p.object({language:p.string(),mode:p.string(),mode2:p.string()}).strict(),yx=p.object({minRank:p.number().int().nonnegative(),maxRank:p.number().int().nonnegative(),minReward:p.number().int().nonnegative(),maxReward:p.number().int().nonnegative()}).strict(),eT=p.object({maintenance:p.boolean(),dev:p.object({responseSlowdownMs:p.number().int().nonnegative()}),quotes:p.object({reporting:p.object({enabled:p.boolean(),maxReports:p.number().int().nonnegative(),contentReportLimit:p.number().int().nonnegative()}),submissionsEnabled:p.boolean(),maxFavorites:p.number().int().nonnegative()}),results:p.object({savingEnabled:p.boolean(),objectHashCheckEnabled:p.boolean(),filterPresets:p.object({enabled:p.boolean(),maxPresetsPerUser:p.number().int().nonnegative()}),limits:p.object({regularUser:p.number().int().nonnegative(),premiumUser:p.number().int().nonnegative()}),maxBatchSize:p.number().int().nonnegative()}),users:p.object({signUp:p.boolean(),lastHashesCheck:p.object({enabled:p.boolean(),maxHashes:p.number().int().nonnegative()}),autoBan:p.object({enabled:p.boolean(),maxCount:p.number().int().nonnegative(),maxHours:p.number().int().nonnegative()}),profiles:p.object({enabled:p.boolean()}),discordIntegration:p.object({enabled:p.boolean()}),xp:p.object({enabled:p.boolean(),funboxBonus:p.number(),gainMultiplier:p.number(),maxDailyBonus:p.number(),minDailyBonus:p.number(),streak:p.object({enabled:p.boolean(),maxStreakDays:p.number().nonnegative(),maxStreakMultiplier:p.number()})}),inbox:p.object({enabled:p.boolean(),maxMail:p.number().int().nonnegative()}),premium:p.object({enabled:p.boolean()})}),admin:p.object({endpointsEnabled:p.boolean()}),apeKeys:p.object({endpointsEnabled:p.boolean(),acceptKeys:p.boolean(),maxKeysPerUser:p.number().int().nonnegative(),apeKeyBytes:p.number().int().nonnegative(),apeKeySaltRounds:p.number().int().nonnegative()}),rateLimiting:p.object({badAuthentication:p.object({enabled:p.boolean(),penalty:p.number(),flaggedStatusCodes:p.array(p.number().int().nonnegative())})}),dailyLeaderboards:p.object({enabled:p.boolean(),leaderboardExpirationTimeInDays:p.number().nonnegative(),maxResults:p.number().int().nonnegative(),validModeRules:p.array(gx),scheduleRewardsModeRules:p.array(gx),topResultsToAnnounce:p.number().int().positive(),xpRewardBrackets:p.array(yx)}),leaderboards:p.object({weeklyXp:p.object({enabled:p.boolean(),expirationTimeInDays:p.number().nonnegative(),xpRewardBrackets:p.array(yx)})})}),oN=mt(eT),dN=eT.deepPartial(),lN=p.object({configuration:dN.strict()}).strict(),uN=mt(p.object({})),cN=ps(),pN=cN.router({get:{summary:"get configuration",description:"Get server configuration",method:"GET",path:"",responses:{200:oN},metadata:{authenticationOptions:{isPublic:!0}}},update:{summary:"update configuration",description:"Update the server configuration. Only provided values will be updated while the missing values will be unchanged.",method:"PATCH",path:"",body:lN,responses:{200:Ie},metadata:{authenticationOptions:{noCache:!0,isPublicOnDev:!0},rateLimit:"adminLimit",requirePermission:"admin"}},getSchema:{summary:"get configuration schema",description:"Get schema definition of the server configuration.",method:"GET",path:"/schema",responses:{200:uN},metadata:{authenticationOptions:{isPublicOnDev:!0,noCache:!0},rateLimit:"adminLimit",requirePermission:"admin"}}},{pathPrefix:"/configuration",strictStatusCodes:!0,metadata:{openApiTags:"configuration"},commonResponses:Ss}),mN=p.object({username:p.string(),createUser:p.boolean().optional().describe("If `true` create user with <username>@example.com and password `password`. If false user has to exist."),firstTestTimestamp:p.number().int().nonnegative().optional(),lastTestTimestamp:p.number().int().nonnegative().optional(),minTestsPerDay:p.number().int().nonnegative().optional(),maxTestsPerDay:p.number().int().nonnegative().optional()}),fN=mt(p.object({uid:St,email:p.string().email()})),hN=ps(),gN=hN.router({generateData:{summary:"generate data",description:"Generate test results for the given user.",method:"POST",path:"/generateData",body:mN.strict(),responses:{200:fN}}},{pathPrefix:"/dev",strictStatusCodes:!0,metadata:{openApiTags:"development",authenticationOptions:{isPublicOnDev:!0}},commonResponses:Ss}),vx={a:["а","à","á","ạ","ą"],c:["с","ƈ","ċ"],d:["ԁ","ɗ"],e:["е","ẹ","ė","ė","é","è"],g:["ġ"],h:["һ"],i:["і","í","ì","ï"],j:["ј","ʝ"],k:["κ"],l:["ӏ","ḷ"],n:["ո"],o:["о","ο","օ","ȯ","ọ","ỏ","ơ","ö","ó","ò"],p:["р"],q:["զ"],s:["ʂ"],u:["υ","ս","ü","ú","ù"],v:["ν","ѵ"],x:["х","ҳ"],y:["у","ý"],z:["ʐ","ż"]};function yN(t){for(let e in vx)vx[e].forEach(a=>{t=t.replace(a,e)});return t}function vN(t,e){let a=t.toLowerCase().split(/[.,"/#!?$%^&*;:{}=\-_`~()\s\n]+/g).map(s=>yN(bN(s)??""));return wN.some(s=>a.some(n=>e==="word"?n.startsWith(s):n.includes(s)))}function bN(t){return t===void 0||t===""?t:t.replace(/[\u0300-\u036F]/g,"").trim().replace(/\n{3,}/g,`

`).replace(/\s{3,}/g,"  ")}function tT(t,e){return e.refine(a=>!vN(a,t),a=>({message:`Profanity detected. Please remove it. If you believe this is a mistake, please contact us. (${a})`}))}var wN=["miodec","bitly","niqqa","niqqer","ni99a","ni99er","niggas","niga","niger","retard","ahole","anus","ash0le","asholes","assh0le","assh0lez","asshole","assholes","assholz","asswipe","azzhole","bassterds","bastard","bastards","bastardz","basterds","basterdz","biatch","bitch","bitches","blow job","boffing","butthole","buttwipe","c0ck","c0cks","c0k","carpet muncher","cawk","cawks","clit","cnts","cntz","cock","cockhead","cock-head","cocks","cocksucker","cock-sucker","crap","cum","cunt","cunts","cuntz","dick","dild0","dild0s","dildo","dildos","dilld0","dilld0s","dominatricks","dominatrics","dominatrix","dyke","enema","f u c k","f u c k e r","fag","fag1t","faget","fagg1t","faggit","faggot","fagit","fags","fagz","faigs","flipping the bird","fudge packer","fukah","fuken","fuker","fukin","fukk","fukkah","fukken","fukker","fukkin","g00k","gayboy","gaygirl","gayz","god-damned","h00r","h0ar","h0re","jackoff","japs","jerk-off","jisim","jiss","jizm","jizz","knob","knobs","knobz","kunt","kunts","kuntz","lezzian","lipshits","lipshitz","masochist","masokist","massterbait","masstrbait","masstrbate","masterbaiter","masterbate","masterbates","n1gr","nastt","nigger;","nigur;","niiger;","niigr;","orafis","orgasim;","orgasm","orgasum","oriface","orifice","orifiss","peeenus","peeenusss","peenus","peinus","pen1s","penas","penis","penis-breath","penus","penuus","phuc","phuck","phuk","phuker","phukker","poonani","pr1c","pr1ck","pr1k","puss","pussee","pussy","puuke","puuker","qweers","qweerz","qweir","recktum","rectum","retard","sadist","scank","schlong","semen","sex","sexy","sh!t","sh1t","sh1ter","sh1ts","sh1tter","sh1tz","shit","shits","shitter","shitty","shity","shitz","shyt","shyte","shytty","shyty","skanck","skank","skankee","skankey","skanks","skanky","slut","sluts","slutty","slutz","son-of-a-bitch","turd","va1jina","vag1na","vagiina","vagina","vaj1na","vajina","vullva","vulva","wh00r","wh0re","whore","xrated","b!+ch","bitch","blowjob","clit","arschloch","shit","asshole","b!tch","b17ch","b1tch","bastard","bi+ch","boiolas","buceta","c0ck","cawk","chink","cipa","clits","cum","cunt","dildo","dirsa","ejakulate","fatass","fcuk","fux0r","hoer","hore","jism","kawk","l3itch","l3i+ch","masturbate","masterbat","masterbat3","motherfucker","s.o.b.","mofo","nazi","nigga","nigger","nutsack","phuck","pimpis","pusse","pussy","scrotum","sh!t","shemale","shi+","sh!+","slut","smut","teets","tits","boobs","b00bs","teez","testical","testicle","titt","w00se","jackoff","wank","whoar","whore","dyke","fuck","shit","amcik","andskota","arse","assrammer","ayir","bi7ch","bitch","bollock","breasts","butt-pirate","cabron","cazzo","chraa","chuj","cunt","daygo","dego","dick","dike","dupa","dziwka","ejackulate","ekrem","enculer","fag","fanculo","fanny","feces","felcher","ficken","flikker","foreskin","fotze","futkretzn","gook","guiena","h4x0r","helvete","hoer","honkey","huevon","injun","jizz","kanker","klootzak","kraut","knulle","kuksuger","kurac","kurwa","kusi","kyrpa","lesbo","mamhoon","masturbat","merd","mibun","monkleigh","mouliewop","muie","mulkku","muschi","nazis","nepesaurio","nigger","orospu","paska","perse","picka","pierdol","pillu","pimmel","piss","pizda","poontsee","porn","p0rn","pr0n","preteen","pula","pule","puta","puto","qahbeh","queef","rautenberg","schaffer","scheiss","schlampe","schmuck","sh!t","sharmuta","sharmute","skurwysyn","sphencter","spierdalaj","splooge","suka","b00b","testicle","titt","twat","vittu","wank","wetback","wichser","zabourah"],aT=p.object({_id:St,name:p.string().regex(/^[0-9a-zA-Z_.-]+$/).max(16),pb:p.object({no:p.boolean(),yes:p.boolean()}).strict(),difficulty:p.record(F0,p.boolean()),mode:p.record(Ur,p.boolean()),words:p.record(gZ.or(p.literal("custom")),p.boolean()),time:p.record(yZ.or(p.literal("custom")),p.boolean()),quoteLength:p.record(vZ,p.boolean()),punctuation:p.object({on:p.boolean(),off:p.boolean()}).strict(),numbers:p.object({on:p.boolean(),off:p.boolean()}).strict(),date:p.object({last_day:p.boolean(),last_week:p.boolean(),last_month:p.boolean(),last_3months:p.boolean(),all:p.boolean()}).strict(),tags:p.record(p.string(),p.boolean()),language:p.record(ua,p.boolean()),funbox:p.record(p.string(),p.boolean())}),sT=p.number().int().min(-11).max(12),nT=p.object({lastResultTimestamp:p.number().int().nonnegative(),length:p.number().int().nonnegative(),maxLength:p.number().int().nonnegative(),hourOffset:sT.optional()}).strict(),G0=p.object({_id:St,name:p.string(),personalBests:Uy}).strict();function Gl(t){return tT("word",t).optional().transform(e=>e===null?void 0:e)}var Ky=p.object({bio:Gl(p.string().max(250)).or(p.literal("")),keyboard:Gl(p.string().max(75)).or(p.literal("")),socialProfiles:p.object({twitter:Gl(p.string().max(20).regex(/^[0-9a-zA-Z_.-]+$/)).or(p.literal("")),github:Gl(p.string().max(39).regex(/^[0-9a-zA-Z_.-]+$/)).or(p.literal("")),website:Gl(p.string().url().max(200).startsWith("https://")).or(p.literal(""))}).strict().optional()}).strict(),iT=p.string().regex(/^[0-9a-zA-Z_-]+$/).max(16),Vy=p.object({_id:St,name:iT,colors:z0}).strict(),kN=p.object({startTimestamp:p.number().int().nonnegative(),expirationTimestamp:p.number().int().nonnegative().or(p.literal(-1).describe("lifetime premium"))}),_N=p.record(ua,p.record(Un.describe("quoteId as string"),p.number().nonnegative())),xN=p.record(Ur,p.record(Jo,p.record(ua,p.number().int().nonnegative()))),CN=p.object({rank:p.number().int().nonnegative().optional(),count:p.number().int().nonnegative()}),SN=p.object({time:p.record(Jo,p.record(ua,CN.optional()))}),rT=p.object({id:p.number().int().nonnegative(),selected:p.boolean().optional()}).strict(),TN=p.object({badges:p.array(rT)}).strict(),$N=p.boolean().describe("Admin for all languages if true").or(ua.describe("Admin for the given language")),oT=p.object({testsByDays:p.array(p.number().int().nonnegative().or(p.null())).describe("Number of tests by day. Last element of the array is on the date `lastDay`. `null` means no tests on that day."),lastDay:p.number().int().nonnegative().describe("Timestamp of the last day included in the test activity")}).strict(),AN=p.record(Un.describe("year"),p.array(p.number().int().nonnegative().nullable().describe("number of tests, position in the array is the day of the year"))),dT=p.record(ua,p.array(Un)),Gy=p.object({name:p.string(),email:p.string().email(),uid:p.string(),addedAt:p.number().int().nonnegative(),personalBests:Uy,lastReultHashes:p.array(p.string()).optional(),completedTests:p.number().int().nonnegative().optional(),startedTests:p.number().int().nonnegative().optional(),timeTyping:p.number().nonnegative().optional().describe("time typing in seconds"),streak:nT.optional(),xp:p.number().int().nonnegative().optional(),discordId:p.string().optional(),discordAvatar:p.string().optional(),tags:p.array(G0).optional(),profileDetails:Ky.optional(),customThemes:p.array(Vy).optional(),premium:kN.optional(),isPremium:p.boolean().optional(),quoteRatings:_N.optional(),favoriteQuotes:dT.optional(),lbMemory:xN.optional(),allTimeLbs:SN,inventory:TN.optional(),banned:p.boolean().optional(),lbOptOut:p.boolean().optional(),verified:p.boolean().optional(),needsToChangeName:p.boolean().optional(),quoteMod:$N.optional(),resultFilterPresets:p.array(aT).optional(),testActivity:oT.optional()}),lT=p.string().regex(/^[0-9a-zA-Z_.-]+$/).max(16),MN=p.object({completedTests:p.number().int().nonnegative().optional(),startedTests:p.number().int().nonnegative().optional(),timeTyping:p.number().int().nonnegative().optional()}),LN=Gy.pick({uid:!0,name:!0,banned:!0,addedAt:!0,discordId:!0,discordAvatar:!0,xp:!0,lbOptOut:!0,isPremium:!0,inventory:!0,allTimeLbs:!0}).extend({typingStats:MN,personalBests:Uy.pick({time:!0,words:!0}),streak:p.number().int().nonnegative(),maxStreak:p.number().int().nonnegative(),details:Ky}).partial({inventory:!0,details:!0,allTimeLbs:!0,uid:!0}),uT=p.enum(["xp","badge"]),EN=p.object({type:p.literal(uT.enum.xp),item:p.number().int()}),IN=p.object({type:p.literal(uT.enum.badge),item:rT}),ON=EN.or(IN),PN=p.object({id:St,subject:p.string(),body:p.string(),timestamp:p.number().int().nonnegative(),read:p.boolean(),rewards:p.array(ON)}),ZN=p.enum(["Inappropriate name","Inappropriate bio","Inappropriate social links","Suspected cheating"]),RN=mt(Gy.extend({inboxUnreadSize:p.number().int().nonnegative()})),Q0=tT("substring",p.string().min(1).max(16).regex(/^[\da-zA-Z_-]+$/)),NN=p.object({email:p.string().email().optional(),name:Q0,uid:p.string().optional(),captcha:p.string()}),DN=p.object({name:Q0}),jN=p.object({name:Q0}),BN=p.object({mode:Ur,mode2:Jo,language:ua,rank:p.number().int().nonnegative()}),qN=p.object({newEmail:p.string().email(),previousEmail:p.string().email()}),WN=p.object({newPassword:p.string().min(6)}),FN=p.object({mode:Ur,mode2:Jo.optional()}),zN=Yo(gd),HN=aT,UN=mt(St.describe("Id of the created result filter preset")),KN=p.object({presetId:St}),VN=mt(p.array(G0)),GN=p.object({tagName:lT}),QN=mt(G0),YN=p.object({tagId:St,newName:lT}),bx=p.object({tagId:St}),JN=mt(p.array(Vy)),XN=p.object({name:iT,colors:z0}),eD=mt(Vy.pick({_id:!0,name:!0})),tD=p.object({themeId:St}),aD=p.object({themeId:St,theme:Vy.pick({name:!0,colors:!0})}),sD=mt(p.object({url:p.string().url()})),nD=p.object({tokenType:p.string(),accessToken:p.string(),state:p.string().length(20)}),iD=mt(Gy.pick({discordId:!0,discordAvatar:!0})),rD=mt(Gy.pick({completedTests:!0,startedTests:!0,timeTyping:!0})),oD=p.object({hourOffset:sT}),dD=mt(dT),lD=p.object({language:ua,quoteId:Un}),uD=p.object({language:ua,quoteId:Un}),cD=p.object({uidOrName:p.string()}),pD=p.object({isUid:p.string().length(0).transform(t=>t==="").or(p.boolean()).default(!1)}),mD=mt(LN),fD=Ky.extend({selectedBadgeId:p.number().int().nonnegative().optional().or(p.literal(-1).describe("no badge selected"))}),hD=mt(Ky),gD=mt(p.object({inbox:p.array(PN),maxMail:p.number().int()})),yD=p.object({mailIdsToDelete:p.array(p.string().uuid()).min(1).optional(),mailIdsToMarkRead:p.array(p.string().uuid()).min(1).optional()}),vD=p.object({uid:p.string(),reason:ZN,comment:p.string().regex(/^([.]|[^/<>])+$/).max(250).optional().or(p.string().length(0)),captcha:p.string()}),bD=p.object({email:p.string().email()}),wD=Yo(AN),kD=Yo(oT),_D=Yo(nT),An=ps(),xD=An.router({get:{summary:"get user",description:"Get a user's data.",method:"GET",path:"",responses:{200:RN},metadata:{rateLimit:"userGet"}},create:{summary:"create user",description:"Creates a new user",method:"POST",path:"/signup",body:NN.strict(),responses:{200:Ie},metadata:{rateLimit:"userSignup",requireConfiguration:{path:"users.signUp",invalidMessage:"Sign up is temporarily disabled"}}},getNameAvailability:{summary:"check name",description:"Checks to see if a username is available",method:"GET",path:"/checkName/:name",pathParams:DN.strict(),responses:{200:Ie.describe("Name is available"),409:Ie.describe("Name is not available")},metadata:{authenticationOptions:{isPublic:!0},rateLimit:"userCheckName"}},delete:{summary:"delete user",description:"Deletes a user's account",method:"DELETE",path:"",body:An.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userDelete"}},reset:{summary:"reset user",description:"Completely resets a user's account to a blank state",method:"PATCH",path:"/reset",body:An.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userReset"}},updateName:{summary:"update username",description:"Updates a user's name",method:"PATCH",path:"/name",body:jN.strict(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userUpdateName"}},updateLeaderboardMemory:{summary:"update lbMemory",description:"Updates a user's cached leaderboard state",method:"PATCH",path:"/leaderboardMemory",body:BN.strict(),responses:{200:Ie},metadata:{rateLimit:"userUpdateLBMemory"}},updateEmail:{summary:"update email",description:"Updates a user's email",method:"PATCH",path:"/email",body:qN.strict(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userUpdateEmail"}},updatePassword:{summary:"update password",description:"Updates a user's email",method:"PATCH",path:"/password",body:WN.strict(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userUpdateEmail"}},getPersonalBests:{summary:"get personal bests",description:"Get user's personal bests",method:"GET",path:"/personalBests",query:FN.strict(),responses:{200:zN},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"userGet"}},deletePersonalBests:{summary:"delete personal bests",description:"Deletes a user's personal bests",method:"DELETE",path:"/personalBests",body:An.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userClearPB"}},optOutOfLeaderboards:{summary:"leaderboards opt out",description:"Opt out of the leaderboards",method:"POST",path:"/optOutOfLeaderboards",body:An.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0},rateLimit:"userOptOutOfLeaderboards"}},addResultFilterPreset:{summary:"add result filter preset",description:"Add a result filter preset",method:"POST",path:"/resultFilterPresets",body:HN.strict(),responses:{200:UN},metadata:{rateLimit:"userCustomFilterAdd",requireConfiguration:{path:"results.filterPresets.enabled",invalidMessage:"Result filter presets are not available at this time."}}},removeResultFilterPreset:{summary:"remove result filter preset",description:"Remove a result filter preset",method:"DELETE",path:"/resultFilterPresets/:presetId",pathParams:KN.strict(),body:An.noBody(),responses:{200:Ie},metadata:{rateLimit:"userCustomFilterRemove",requireConfiguration:{path:"results.filterPresets.enabled",invalidMessage:"Result filter presets are not available at this time."}}},getTags:{summary:"get tags",description:"Get the users tags",method:"GET",path:"/tags",responses:{200:VN},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"userTagsGet"}},createTag:{summary:"add tag",description:"Add a tag for the current user",method:"POST",path:"/tags",body:GN.strict(),responses:{200:QN},metadata:{rateLimit:"userTagsAdd"}},editTag:{summary:"edit tag",description:"Edit a tag",method:"PATCH",path:"/tags",body:YN.strict(),responses:{200:Ie},metadata:{rateLimit:"userTagsEdit"}},deleteTag:{summary:"delete tag",description:"Delete a tag",method:"DELETE",path:"/tags/:tagId",pathParams:bx.strict(),body:An.noBody(),responses:{200:Ie},metadata:{rateLimit:"userTagsRemove"}},deleteTagPersonalBest:{summary:"delete tag PBs",description:"Delete personal bests of a tag",method:"DELETE",path:"/tags/:tagId/personalBest",pathParams:bx.strict(),body:An.noBody(),responses:{200:Ie},metadata:{rateLimit:"userTagsClearPB"}},getCustomThemes:{summary:"get custom themes",description:"Get custom themes for the current user",method:"GET",path:"/customThemes",responses:{200:JN},metadata:{rateLimit:"userCustomThemeGet"}},addCustomTheme:{summary:"add custom themes",description:"Add a custom theme for the current user",method:"POST",path:"/customThemes",body:XN.strict(),responses:{200:eD},metadata:{rateLimit:"userCustomThemeAdd"}},deleteCustomTheme:{summary:"delete custom themes",description:"Delete a custom theme",method:"DELETE",path:"/customThemes",body:tD.strict(),responses:{200:Ie},metadata:{rateLimit:"userCustomThemeRemove"}},editCustomTheme:{summary:"edit custom themes",description:"Edit a custom theme",method:"PATCH",path:"/customThemes",body:aD.strict(),responses:{200:Ie},metadata:{rateLimit:"userCustomThemeEdit"}},getDiscordOAuth:{summary:"discord oauth",description:"Start OAuth authentication with discord",method:"GET",path:"/discord/oauth",responses:{200:sD},metadata:{rateLimit:"userDiscordLink",requireConfiguration:{path:"users.discordIntegration.enabled",invalidMessage:"Discord integration is not available at this time"}}},linkDiscord:{summary:"link with discord",description:"Links a user's account with a discord account",method:"POST",path:"/discord/link",body:nD.strict(),responses:{200:iD},metadata:{rateLimit:"userDiscordLink",requireConfiguration:{path:"users.discordIntegration.enabled",invalidMessage:"Discord integration is not available at this time"}}},unlinkDiscord:{summary:"unlink discord",description:"Unlinks a user's account with a discord account",method:"POST",path:"/discord/unlink",body:An.noBody(),responses:{200:Ie},metadata:{rateLimit:"userDiscordUnlink"}},getStats:{summary:"get stats",description:"Gets a user's typing stats data",method:"GET",path:"/stats",responses:{200:rD},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"userGet"}},setStreakHourOffset:{summary:"set streak hour offset",description:"Sets a user's streak hour offset",method:"POST",path:"/setStreakHourOffset",body:oD.strict(),responses:{200:Ie},metadata:{rateLimit:"setStreakHourOffset"}},getFavoriteQuotes:{summary:"get favorite quotes",description:"Gets a user's favorite quotes",method:"GET",path:"/favoriteQuotes",responses:{200:dD},metadata:{rateLimit:"quoteFavoriteGet"}},addQuoteToFavorites:{summary:"add favorite quotes",description:"Add a quote to the user's favorite quotes",method:"POST",path:"/favoriteQuotes",body:lD.strict(),responses:{200:Ie},metadata:{rateLimit:"quoteFavoritePost"}},removeQuoteFromFavorites:{summary:"remove favorite quotes",description:"Remove a quote to the user's favorite quotes",method:"DELETE",path:"/favoriteQuotes",body:uD.strict(),responses:{200:Ie},metadata:{rateLimit:"quoteFavoriteDelete"}},getProfile:{summary:"get profile",description:"Gets a user's profile",method:"GET",path:"/:uidOrName/profile",pathParams:cD.strict(),query:pD.strict(),responses:{200:mD,404:Td.describe("User not found")},metadata:{authenticationOptions:{isPublic:!0},rateLimit:"userProfileGet",requireConfiguration:{path:"users.profiles.enabled",invalidMessage:"Profiles are not available at this time"}}},updateProfile:{summary:"update profile",description:"Update a user's profile",method:"PATCH",path:"/profile",body:fD.strict(),responses:{200:hD},metadata:{rateLimit:"userProfileUpdate",requireConfiguration:{path:"users.profiles.enabled",invalidMessage:"Profiles are not available at this time"}}},getInbox:{summary:"get inbox",description:"Gets the user's inbox",method:"GET",path:"/inbox",responses:{200:gD},metadata:{rateLimit:"userMailGet",requireConfiguration:{path:"users.inbox.enabled",invalidMessage:"Your inbox is not available at this time."}}},updateInbox:{summary:"update inbox",description:"Updates the user's inbox",method:"PATCH",body:yD.strict(),path:"/inbox",responses:{200:Ie},metadata:{rateLimit:"userMailUpdate",requireConfiguration:{path:"users.inbox.enabled",invalidMessage:"Your inbox is not available at this time."}}},report:{summary:"report user",description:"Report a user",method:"POST",path:"/report",body:vD.strict(),responses:{200:Ie},metadata:{rateLimit:"quoteReportSubmit",requirePermission:"canReport",requireConfiguration:{path:"quotes.reporting.enabled",invalidMessage:"User reporting is unavailable."}}},verificationEmail:{summary:"send verification email",description:"Send a verification email",method:"GET",path:"/verificationEmail",responses:{200:Ie},metadata:{authenticationOptions:{noCache:!0},rateLimit:"userRequestVerificationEmail"}},forgotPasswordEmail:{summary:"send forgot password email",description:"Send a forgot password email",method:"POST",path:"/forgotPasswordEmail",body:bD.strict(),responses:{200:Ie},metadata:{authenticationOptions:{isPublic:!0},rateLimit:"userForgotPasswordEmail"}},revokeAllTokens:{summary:"revoke all tokens",description:"Revoke all tokens for the current user.",method:"POST",path:"/revokeAllTokens",body:An.noBody(),responses:{200:Ie},metadata:{authenticationOptions:{requireFreshToken:!0,noCache:!0},rateLimit:"userRevokeAllTokens"}},getTestActivity:{summary:"get test activity",description:"Get user's test activity",method:"GET",path:"/testActivity",responses:{200:wD},metadata:{rateLimit:"userTestActivity"}},getCurrentTestActivity:{summary:"get current test activity",description:"Get test activity for the last up to 372 days for the current user ",method:"GET",path:"/currentTestActivity",responses:{200:kD},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"userCurrentTestActivity"}},getStreak:{summary:"get streak",description:"Get user's streak data",method:"GET",path:"/streak",responses:{200:_D},metadata:{authenticationOptions:{acceptApeKeys:!0},rateLimit:"userStreak"}}},{pathPrefix:"/users",strictStatusCodes:!0,metadata:{openApiTags:"users"},commonResponses:Ss}),Hm=p.number().int().nonnegative().or(p.string().regex(/^\d+$/).transform(Number)),CD=p.object({id:Hm.optional(),text:p.string(),source:p.string(),length:p.number().int().positive(),approvedBy:p.string().describe("The approvers name")}),SD=p.object({_id:St,text:p.string(),source:p.string(),language:ua,submittedBy:St.describe("uid of the submitter"),timestamp:p.number().int().nonnegative(),approved:p.boolean()}),TD=p.object({_id:St,language:ua,quoteId:Hm,average:p.number().nonnegative(),ratings:p.number().int().nonnegative(),totalRating:p.number().nonnegative()}),$D=p.enum(["Grammatical error","Duplicate quote","Inappropriate content","Low quality content","Incorrect source"]),AD=mt(p.array(SD)),MD=mt(p.object({isEnabled:p.boolean()})),LD=p.object({text:p.string().min(60),source:p.string(),language:ua,captcha:p.string()}),ED=p.object({quoteId:St,editText:ix,editSource:ix}),ID=mt(CD),OD=p.object({quoteId:St}),PD=p.object({quoteId:Hm,language:ua}),ZD=Yo(TD),RD=p.object({quoteId:Hm,language:ua,rating:p.number().int().min(1).max(5)}),ND=p.object({quoteId:Hm,quoteLanguage:ua,reason:$D,comment:p.string().regex(/^([.]|[^/<>])+$/).max(250).optional().or(p.string().length(0)),captcha:p.string()}),DD=ps(),jD=DD.router({get:{summary:"get quote submissions",description:"Get list of quote submissions",method:"GET",path:"",responses:{200:AD},metadata:{rateLimit:"newQuotesGet",requirePermission:"quoteMod"}},isSubmissionEnabled:{summary:"is submission enabled",description:"Check if submissions are enabled.",method:"GET",path:"/isSubmissionEnabled",responses:{200:MD},metadata:{authenticationOptions:{isPublic:!0},rateLimit:"newQuotesIsSubmissionEnabled"}},add:{summary:"submit quote",description:"Add a quote submission",method:"POST",path:"",body:LD.strict(),responses:{200:Ie},metadata:{rateLimit:"newQuotesAdd",requireConfiguration:{path:"quotes.submissionsEnabled",invalidMessage:"Quote submission is disabled temporarily. The queue is quite long and we need some time to catch up."}}},approveSubmission:{summary:"submit quote",description:"Add a quote submission",method:"POST",path:"/approve",body:ED.strict(),responses:{200:ID},metadata:{rateLimit:"newQuotesAction",requirePermission:"quoteMod"}},rejectSubmission:{summary:"reject quote",description:"Reject a quote submission",method:"POST",path:"/reject",body:OD.strict(),responses:{200:Ie},metadata:{rateLimit:"newQuotesAction",requirePermission:"quoteMod"}},getRating:{summary:"get rating",description:"Get quote rating",method:"GET",path:"/rating",query:PD.strict(),responses:{200:ZD},metadata:{rateLimit:"quoteRatingsGet"}},addRating:{summary:"add rating",description:"Add a quote rating",method:"POST",path:"/rating",body:RD.strict(),responses:{200:Ie},metadata:{rateLimit:"quoteRatingsSubmit"}},report:{summary:"report quote",description:"Report a quote",method:"POST",path:"/report",body:ND.strict(),responses:{200:Ie},metadata:{rateLimit:"quoteReportSubmit",requirePermission:"canReport",requireConfiguration:{path:"quotes.reporting.enabled",invalidMessage:"Quote reporting is unavailable."}}}},{pathPrefix:"/quotes",strictStatusCodes:!0,metadata:{openApiTags:"quotes"},commonResponses:Ss}),BD=p.object({action:p.literal("published").or(p.string()),release:p.object({id:p.string().or(p.number().transform(String))}).optional()});mt(p.array(KS));var qD=ps(),WD=qD.router({postGithubRelease:{summary:"Github release",description:"Announce github release.",method:"POST",path:"/githubRelease",body:BD,headers:p.object({"x-hub-signature-256":p.string()}),responses:{200:Ie}}},{pathPrefix:"/webhooks",strictStatusCodes:!0,metadata:{openApiTags:"webhooks",authenticationOptions:{isGithubWebhook:!0},rateLimit:"webhookLimit"},commonResponses:Ss}),FD=ps(),zD=FD.router({admin:uZ,apeKeys:hZ,configs:gR,presets:CR,psas:$R,public:PR,leaderboards:HR,results:rN,configuration:pN,dev:gN,users:xD,quotes:jD,webhooks:WD}),vt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(vt||(vt={}));var Zb;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Zb||(Zb={}));var te=vt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nr=t=>{switch(typeof t){case"undefined":return te.undefined;case"string":return te.string;case"number":return isNaN(t)?te.nan:te.number;case"boolean":return te.boolean;case"function":return te.function;case"bigint":return te.bigint;case"symbol":return te.symbol;case"object":return Array.isArray(t)?te.array:t===null?te.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?te.promise:typeof Map<"u"&&t instanceof Map?te.map:typeof Set<"u"&&t instanceof Set?te.set:typeof Date<"u"&&t instanceof Date?te.date:te.object;default:return te.unknown}},P=vt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),HD=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ln=class cT extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof cT))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,vt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};ln.create=t=>new ln(t);var Kd=(t,e)=>{let a;switch(t.code){case P.invalid_type:t.received===te.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case P.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,vt.jsonStringifyReplacer)}`;break;case P.unrecognized_keys:a=`Unrecognized key(s) in object: ${vt.joinValues(t.keys,", ")}`;break;case P.invalid_union:a="Invalid input";break;case P.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${vt.joinValues(t.options)}`;break;case P.invalid_enum_value:a=`Invalid enum value. Expected ${vt.joinValues(t.options)}, received '${t.received}'`;break;case P.invalid_arguments:a="Invalid function arguments";break;case P.invalid_return_type:a="Invalid function return type";break;case P.invalid_date:a="Invalid date";break;case P.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:vt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case P.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case P.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case P.custom:a="Invalid input";break;case P.invalid_intersection_types:a="Intersection results could not be merged";break;case P.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case P.not_finite:a="Number must be finite";break;default:a=e.defaultError,vt.assertNever(t)}return{message:a}},pT=Kd;function UD(t){pT=t}function eg(){return pT}var tg=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},KD=[];function U(t,e){let a=eg(),s=tg({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Kd?void 0:Kd].filter(n=>!!n)});t.common.issues.push(s)}var ns=class mT{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Ze;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return mT.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return Ze;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},Ze=Object.freeze({status:"aborted"}),ag=t=>({status:"dirty",value:t}),ja=t=>({status:"valid",value:t}),Rb=t=>t.status==="aborted",Nb=t=>t.status==="dirty",bc=t=>t.status==="valid",wc=t=>typeof Promise<"u"&&t instanceof Promise;function sg(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function fT(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var ce;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ce||(ce={}));var cu,pu,ti=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},wx=(t,e)=>{if(bc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new ln(t.common.issues);return this._error=a,this._error}}};function Ke(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var et=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return nr(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ns,ctx:{common:e.parent.common,data:e.data,parsedType:nr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(wc(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},i=this._parseSync({data:e,path:n.path,parent:n});return wx(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:nr(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(wc(n)?n:Promise.resolve(n));return wx(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:P.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new bn({schema:this,typeName:Se.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Kn.create(this,this._def)}nullable(){return $r.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zo.create(this,this._def)}promise(){return Qd.create(this,this._def)}or(e){return $c.create([this,e],this._def)}and(e){return Ac.create(this,e,this._def)}transform(e){return new bn({...Ke(this._def),schema:this,typeName:Se.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new Ic({...Ke(this._def),innerType:this,defaultValue:a,typeName:Se.ZodDefault})}brand(){return new Y0({typeName:Se.ZodBranded,type:this,...Ke(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new Oc({...Ke(this._def),innerType:this,catchValue:a,typeName:Se.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return J0.create(this,e)}readonly(){return Pc.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},VD=/^c[^\s-]{8,}$/i,GD=/^[0-9a-z]+$/,QD=/^[0-9A-HJKMNP-TV-Z]{26}$/,YD=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,JD=/^[a-z0-9_-]{21}$/i,XD=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ej=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tj="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",jv,aj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,sj=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,nj=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,hT="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",ij=new RegExp(`^${hT}$`);function gT(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function rj(t){return new RegExp(`^${gT(t)}$`)}function yT(t){let e=`${hT}T${gT(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function oj(t,e){return!!((e==="v4"||!e)&&aj.test(t)||(e==="v6"||!e)&&sj.test(t))}var Vd=class mu extends et{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==te.string){let n=this._getOrReturnCtx(e);return U(n,{code:P.invalid_type,expected:te.string,received:n.parsedType}),Ze}let a=new ns,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?U(s,{code:P.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&U(s,{code:P.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")ej.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"email",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")jv||(jv=new RegExp(tj,"u")),jv.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"emoji",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")YD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"uuid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")JD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"nanoid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")VD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"cuid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")GD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"cuid2",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")QD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"ulid",code:P.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),U(s,{validation:"url",code:P.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"regex",code:P.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?yT(n).test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?ij.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?rj(n).test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{code:P.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?XD.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"duration",code:P.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?oj(e.data,n.version)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"ip",code:P.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?nj.test(e.data)||(s=this._getOrReturnCtx(e,s),U(s,{validation:"base64",code:P.invalid_string,message:n.message}),a.dirty()):vt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:P.invalid_string,...ce.errToObj(s)})}_addCheck(e){return new mu({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ce.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ce.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ce.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ce.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ce.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ce.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ce.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ce.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ce.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ce.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...ce.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ce.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ce.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...ce.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...ce.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...ce.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...ce.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...ce.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...ce.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...ce.errToObj(a)})}nonempty(e){return this.min(1,ce.errToObj(e))}trim(){return new mu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new mu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new mu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Vd.create=t=>{var e;return new Vd({checks:[],typeName:Se.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ke(t)})};function dj(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var kc=class Db extends et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==te.number){let n=this._getOrReturnCtx(e);return U(n,{code:P.invalid_type,expected:te.number,received:n.parsedType}),Ze}let a,s=new ns;for(let n of this._def.checks)n.kind==="int"?vt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),U(a,{code:P.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?dj(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),U(a,{code:P.not_finite,message:n.message}),s.dirty()):vt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ce.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ce.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ce.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ce.toString(a))}setLimit(e,a,s,n){return new Db({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ce.toString(n)}]})}_addCheck(e){return new Db({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ce.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ce.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ce.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ce.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ce.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ce.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:ce.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ce.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ce.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&vt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};kc.create=t=>new kc({checks:[],typeName:Se.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ke(t)});var _c=class jb extends et{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==te.bigint){let n=this._getOrReturnCtx(e);return U(n,{code:P.invalid_type,expected:te.bigint,received:n.parsedType}),Ze}let a,s=new ns;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),U(a,{code:P.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):vt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ce.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ce.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ce.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ce.toString(a))}setLimit(e,a,s,n){return new jb({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ce.toString(n)}]})}_addCheck(e){return new jb({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ce.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ce.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ce.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ce.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ce.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};_c.create=t=>{var e;return new _c({checks:[],typeName:Se.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ke(t)})};var xc=class extends et{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==te.boolean){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.boolean,received:a.parsedType}),Ze}return ja(e.data)}};xc.create=t=>new xc({typeName:Se.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ke(t)});var Cc=class vT extends et{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==te.date){let n=this._getOrReturnCtx(e);return U(n,{code:P.invalid_type,expected:te.date,received:n.parsedType}),Ze}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return U(n,{code:P.invalid_date}),Ze}let a=new ns,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:P.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),U(s,{code:P.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):vt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new vT({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:ce.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:ce.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Cc.create=t=>new Cc({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Se.ZodDate,...Ke(t)});var ng=class extends et{_parse(e){if(this._getType(e)!==te.symbol){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.symbol,received:a.parsedType}),Ze}return ja(e.data)}};ng.create=t=>new ng({typeName:Se.ZodSymbol,...Ke(t)});var Sc=class extends et{_parse(e){if(this._getType(e)!==te.undefined){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.undefined,received:a.parsedType}),Ze}return ja(e.data)}};Sc.create=t=>new Sc({typeName:Se.ZodUndefined,...Ke(t)});var Tc=class extends et{_parse(e){if(this._getType(e)!==te.null){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.null,received:a.parsedType}),Ze}return ja(e.data)}};Tc.create=t=>new Tc({typeName:Se.ZodNull,...Ke(t)});var Gd=class extends et{constructor(){super(...arguments),this._any=!0}_parse(e){return ja(e.data)}};Gd.create=t=>new Gd({typeName:Se.ZodAny,...Ke(t)});var fo=class extends et{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ja(e.data)}};fo.create=t=>new fo({typeName:Se.ZodUnknown,...Ke(t)});var Ai=class extends et{_parse(e){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.never,received:a.parsedType}),Ze}};Ai.create=t=>new Ai({typeName:Se.ZodNever,...Ke(t)});var ig=class extends et{_parse(e){if(this._getType(e)!==te.undefined){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.void,received:a.parsedType}),Ze}return ja(e.data)}};ig.create=t=>new ig({typeName:Se.ZodVoid,...Ke(t)});var Zo=class hh extends et{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==te.array)return U(a,{code:P.invalid_type,expected:te.array,received:a.parsedType}),Ze;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(U(a,{code:r?P.too_big:P.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(U(a,{code:P.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(U(a,{code:P.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new ti(a,r,a.path,d)))).then(r=>ns.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new ti(a,r,a.path,d)));return ns.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new hh({...this._def,minLength:{value:e,message:ce.toString(a)}})}max(e,a){return new hh({...this._def,maxLength:{value:e,message:ce.toString(a)}})}length(e,a){return new hh({...this._def,exactLength:{value:e,message:ce.toString(a)}})}nonempty(e){return this.min(1,e)}};Zo.create=(t,e)=>new Zo({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Se.ZodArray,...Ke(e)});function yd(t){if(t instanceof js){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Kn.create(yd(s))}return new js({...t._def,shape:()=>e})}else return t instanceof Zo?new Zo({...t._def,type:yd(t.element)}):t instanceof Kn?Kn.create(yd(t.unwrap())):t instanceof $r?$r.create(yd(t.unwrap())):t instanceof Tr?Tr.create(t.items.map(e=>yd(e))):t}var js=class Gs extends et{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=vt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==te.object){let u=this._getOrReturnCtx(e);return U(u,{code:P.invalid_type,expected:te.object,received:u.parsedType}),Ze}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof Ai&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new ti(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Ai){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(U(s,{code:P.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new ti(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>ns.mergeObjectSync(a,u)):ns.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return ce.errToObj,new Gs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=ce.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Gs({...this._def,unknownKeys:"strip"})}passthrough(){return new Gs({...this._def,unknownKeys:"passthrough"})}extend(e){return new Gs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Gs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Se.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Gs({...this._def,catchall:e})}pick(e){let a={};return vt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Gs({...this._def,shape:()=>a})}omit(e){let a={};return vt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Gs({...this._def,shape:()=>a})}deepPartial(){return yd(this)}partial(e){let a={};return vt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Gs({...this._def,shape:()=>a})}required(e){let a={};return vt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Kn;)n=n._def.innerType;a[s]=n}}),new Gs({...this._def,shape:()=>a})}keyof(){return CT(vt.objectKeys(this.shape))}};js.create=(t,e)=>new js({shape:()=>t,unknownKeys:"strip",catchall:Ai.create(),typeName:Se.ZodObject,...Ke(e)});js.strictCreate=(t,e)=>new js({shape:()=>t,unknownKeys:"strict",catchall:Ai.create(),typeName:Se.ZodObject,...Ke(e)});js.lazycreate=(t,e)=>new js({shape:t,unknownKeys:"strip",catchall:Ai.create(),typeName:Se.ZodObject,...Ke(e)});var $c=class extends et{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new ln(d.ctx.common.issues));return U(a,{code:P.invalid_union,unionErrors:r}),Ze}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new ln(u));return U(a,{code:P.invalid_union,unionErrors:d}),Ze}}get options(){return this._def.options}};$c.create=(t,e)=>new $c({options:t,typeName:Se.ZodUnion,...Ke(e)});var Vi=t=>t instanceof Mc?Vi(t.schema):t instanceof bn?Vi(t.innerType()):t instanceof Lc?[t.value]:t instanceof Um?t.options:t instanceof Ec?vt.objectValues(t.enum):t instanceof Ic?Vi(t._def.innerType):t instanceof Sc?[void 0]:t instanceof Tc?[null]:t instanceof Kn?[void 0,...Vi(t.unwrap())]:t instanceof $r?[null,...Vi(t.unwrap())]:t instanceof Y0||t instanceof Pc?Vi(t.unwrap()):t instanceof Oc?Vi(t._def.innerType):[],bT=class wT extends et{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==te.object)return U(a,{code:P.invalid_type,expected:te.object,received:a.parsedType}),Ze;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(U(a,{code:P.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ze)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Vi(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new wT({typeName:Se.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ke(s)})}};function Bb(t,e){let a=nr(t),s=nr(e);if(t===e)return{valid:!0,data:t};if(a===te.object&&s===te.object){let n=vt.objectKeys(e),i=vt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=Bb(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===te.array&&s===te.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=Bb(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===te.date&&s===te.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Ac=class extends et{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(Rb(i)||Rb(r))return Ze;let d=Bb(i.value,r.value);return d.valid?((Nb(i)||Nb(r))&&a.dirty(),{status:a.value,value:d.data}):(U(s,{code:P.invalid_intersection_types}),Ze)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Ac.create=(t,e,a)=>new Ac({left:t,right:e,typeName:Se.ZodIntersection,...Ke(a)});var Tr=class kT extends et{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==te.array)return U(s,{code:P.invalid_type,expected:te.array,received:s.parsedType}),Ze;if(s.data.length<this._def.items.length)return U(s,{code:P.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ze;!this._def.rest&&s.data.length>this._def.items.length&&(U(s,{code:P.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new ti(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>ns.mergeArray(a,i)):ns.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new kT({...this._def,rest:e})}};Tr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Tr({items:t,typeName:Se.ZodTuple,rest:null,...Ke(e)})};var _T=class qb extends et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==te.object)return U(s,{code:P.invalid_type,expected:te.object,received:s.parsedType}),Ze;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new ti(s,d,s.path,d)),value:r._parse(new ti(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?ns.mergeObjectAsync(a,n):ns.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof et?new qb({keyType:e,valueType:a,typeName:Se.ZodRecord,...Ke(s)}):new qb({keyType:Vd.create(),valueType:e,typeName:Se.ZodRecord,...Ke(a)})}},rg=class extends et{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==te.map)return U(s,{code:P.invalid_type,expected:te.map,received:s.parsedType}),Ze;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new ti(s,d,s.path,[c,"key"])),value:i._parse(new ti(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return Ze;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return Ze;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};rg.create=(t,e,a)=>new rg({valueType:e,keyType:t,typeName:Se.ZodMap,...Ke(a)});var og=class Wb extends et{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==te.set)return U(s,{code:P.invalid_type,expected:te.set,received:s.parsedType}),Ze;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(U(s,{code:P.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(U(s,{code:P.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return Ze;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new ti(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new Wb({...this._def,minSize:{value:e,message:ce.toString(a)}})}max(e,a){return new Wb({...this._def,maxSize:{value:e,message:ce.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};og.create=(t,e)=>new og({valueType:t,minSize:null,maxSize:null,typeName:Se.ZodSet,...Ke(e)});var xT=class gh extends et{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==te.function)return U(a,{code:P.invalid_type,expected:te.function,received:a.parsedType}),Ze;function s(d,u){return tg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,eg(),Kd].filter(c=>!!c),issueData:{code:P.invalid_arguments,argumentsError:u}})}function n(d,u){return tg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,eg(),Kd].filter(c=>!!c),issueData:{code:P.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof Qd){let d=this;return ja(async function(...u){let c=new ln([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return ja(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new ln([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new ln([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new gh({...this._def,args:Tr.create(e).rest(fo.create())})}returns(e){return new gh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new gh({args:e||Tr.create([]).rest(fo.create()),returns:a||fo.create(),typeName:Se.ZodFunction,...Ke(s)})}},Mc=class extends et{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Mc.create=(t,e)=>new Mc({getter:t,typeName:Se.ZodLazy,...Ke(e)});var Lc=class extends et{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return U(a,{received:a.data,code:P.invalid_literal,expected:this._def.value}),Ze}return{status:"valid",value:e.data}}get value(){return this._def.value}};Lc.create=(t,e)=>new Lc({value:t,typeName:Se.ZodLiteral,...Ke(e)});function CT(t,e){return new Um({values:t,typeName:Se.ZodEnum,...Ke(e)})}var Um=class Fb extends et{constructor(){super(...arguments),cu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return U(a,{expected:vt.joinValues(s),received:a.parsedType,code:P.invalid_type}),Ze}if(sg(this,cu)||fT(this,cu,new Set(this._def.values)),!sg(this,cu).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return U(a,{received:a.data,code:P.invalid_enum_value,options:s}),Ze}return ja(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return Fb.create(e,{...this._def,...a})}exclude(e,a=this._def){return Fb.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};cu=new WeakMap;Um.create=CT;var Ec=class extends et{constructor(){super(...arguments),pu.set(this,void 0)}_parse(e){let a=vt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==te.string&&s.parsedType!==te.number){let n=vt.objectValues(a);return U(s,{expected:vt.joinValues(n),received:s.parsedType,code:P.invalid_type}),Ze}if(sg(this,pu)||fT(this,pu,new Set(vt.getValidEnumValues(this._def.values))),!sg(this,pu).has(e.data)){let n=vt.objectValues(a);return U(s,{received:s.data,code:P.invalid_enum_value,options:n}),Ze}return ja(e.data)}get enum(){return this._def.values}};pu=new WeakMap;Ec.create=(t,e)=>new Ec({values:t,typeName:Se.ZodNativeEnum,...Ke(e)});var Qd=class extends et{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==te.promise&&a.common.async===!1)return U(a,{code:P.invalid_type,expected:te.promise,received:a.parsedType}),Ze;let s=a.parsedType===te.promise?a.data:Promise.resolve(a.data);return ja(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};Qd.create=(t,e)=>new Qd({type:t,typeName:Se.ZodPromise,...Ke(e)});var bn=class extends et{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Se.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{U(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return Ze;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?Ze:u.status==="dirty"||a.value==="dirty"?ag(u.value):u});{if(a.value==="aborted")return Ze;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?Ze:d.status==="dirty"||a.value==="dirty"?ag(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?Ze:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?Ze:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!bc(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>bc(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);vt.assertNever(n)}};bn.create=(t,e,a)=>new bn({schema:t,typeName:Se.ZodEffects,effect:e,...Ke(a)});bn.createWithPreprocess=(t,e,a)=>new bn({schema:e,effect:{type:"preprocess",transform:t},typeName:Se.ZodEffects,...Ke(a)});var Kn=class extends et{_parse(e){return this._getType(e)===te.undefined?ja(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Kn.create=(t,e)=>new Kn({innerType:t,typeName:Se.ZodOptional,...Ke(e)});var $r=class extends et{_parse(e){return this._getType(e)===te.null?ja(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};$r.create=(t,e)=>new $r({innerType:t,typeName:Se.ZodNullable,...Ke(e)});var Ic=class extends et{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===te.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};Ic.create=(t,e)=>new Ic({innerType:t,typeName:Se.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ke(e)});var Oc=class extends et{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return wc(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new ln(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new ln(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Oc.create=(t,e)=>new Oc({innerType:t,typeName:Se.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ke(e)});var dg=class extends et{_parse(e){if(this._getType(e)!==te.nan){let a=this._getOrReturnCtx(e);return U(a,{code:P.invalid_type,expected:te.nan,received:a.parsedType}),Ze}return{status:"valid",value:e.data}}};dg.create=t=>new dg({typeName:Se.ZodNaN,...Ke(t)});var lj=Symbol("zod_brand"),Y0=class extends et{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},J0=class ST extends et{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ze:n.status==="dirty"?(a.dirty(),ag(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ze:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new ST({in:e,out:a,typeName:Se.ZodPipeline})}},Pc=class extends et{_parse(e){let a=this._def.innerType._parse(e),s=n=>(bc(n)&&(n.value=Object.freeze(n.value)),n);return wc(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};Pc.create=(t,e)=>new Pc({innerType:t,typeName:Se.ZodReadonly,...Ke(e)});function TT(t,e={},a){return t?Gd.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):Gd.create()}var uj={object:js.lazycreate},Se;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Se||(Se={}));var cj=(t,e={message:`Input not instance of ${t.name}`})=>TT(a=>a instanceof t,e),$T=Vd.create,AT=kc.create,pj=dg.create,mj=_c.create,MT=xc.create,fj=Cc.create,hj=ng.create,gj=Sc.create,yj=Tc.create,vj=Gd.create,bj=fo.create,wj=Ai.create,kj=ig.create,_j=Zo.create,xj=js.create,Cj=js.strictCreate,Sj=$c.create,Tj=bT.create,$j=Ac.create,Aj=Tr.create,Mj=_T.create,Lj=rg.create,Ej=og.create,Ij=xT.create,Oj=Mc.create,Pj=Lc.create,Zj=Um.create,Rj=Ec.create,Nj=Qd.create,kx=bn.create,Dj=Kn.create,jj=$r.create,Bj=bn.createWithPreprocess,qj=J0.create,Wj=()=>$T().optional(),Fj=()=>AT().optional(),zj=()=>MT().optional(),Hj={string:t=>Vd.create({...t,coerce:!0}),number:t=>kc.create({...t,coerce:!0}),boolean:t=>xc.create({...t,coerce:!0}),bigint:t=>_c.create({...t,coerce:!0}),date:t=>Cc.create({...t,coerce:!0})},Uj=Ze,ct=Object.freeze({__proto__:null,defaultErrorMap:Kd,setErrorMap:UD,getErrorMap:eg,makeIssue:tg,EMPTY_PATH:KD,addIssueToContext:U,ParseStatus:ns,INVALID:Ze,DIRTY:ag,OK:ja,isAborted:Rb,isDirty:Nb,isValid:bc,isAsync:wc,get util(){return vt},get objectUtil(){return Zb},ZodParsedType:te,getParsedType:nr,ZodType:et,datetimeRegex:yT,ZodString:Vd,ZodNumber:kc,ZodBigInt:_c,ZodBoolean:xc,ZodDate:Cc,ZodSymbol:ng,ZodUndefined:Sc,ZodNull:Tc,ZodAny:Gd,ZodUnknown:fo,ZodNever:Ai,ZodVoid:ig,ZodArray:Zo,ZodObject:js,ZodUnion:$c,ZodDiscriminatedUnion:bT,ZodIntersection:Ac,ZodTuple:Tr,ZodRecord:_T,ZodMap:rg,ZodSet:og,ZodFunction:xT,ZodLazy:Mc,ZodLiteral:Lc,ZodEnum:Um,ZodNativeEnum:Ec,ZodPromise:Qd,ZodEffects:bn,ZodTransformer:bn,ZodOptional:Kn,ZodNullable:$r,ZodDefault:Ic,ZodCatch:Oc,ZodNaN:dg,BRAND:lj,ZodBranded:Y0,ZodPipeline:J0,ZodReadonly:Pc,custom:TT,Schema:et,ZodSchema:et,late:uj,get ZodFirstPartyTypeKind(){return Se},coerce:Hj,any:vj,array:_j,bigint:mj,boolean:MT,date:fj,discriminatedUnion:Tj,effect:kx,enum:Zj,function:Ij,instanceof:cj,intersection:$j,lazy:Oj,literal:Pj,map:Lj,nan:pj,nativeEnum:Rj,never:wj,null:yj,nullable:jj,number:AT,object:xj,oboolean:zj,onumber:Fj,optional:Dj,ostring:Wj,pipeline:qj,preprocess:Bj,promise:Nj,record:Mj,set:Ej,strictObject:Cj,string:$T,symbol:hj,transformer:kx,tuple:Aj,undefined:gj,union:Sj,unknown:bj,void:kj,NEVER:Uj,ZodIssueCode:P,quotelessJson:HD,ZodError:ln}),Bv=t=>typeof(t==null?void 0:t.passthrough)=="function",Kj=(t,e)=>Bv(t)?Bv(e)?t.merge(e):t:Bv(e)?e:Object.assign({},t,e);ct.object({name:ct.literal("ZodError"),issues:ct.array(ct.object({path:ct.array(ct.union([ct.string(),ct.number()])),message:ct.string().optional(),code:ct.nativeEnum(ct.ZodIssueCode)}).catchall(ct.any()))});var Vj=Symbol("ContractNoBody"),Gj=t=>"method"in t&&"path"in t,LT=(t,e)=>Object.fromEntries(Object.entries(t).map(([a,s])=>{var n,i,r;return Gj(s)?[a,{...s,path:e!=null&&e.pathPrefix?e.pathPrefix+s.path:s.path,headers:Kj(e==null?void 0:e.baseHeaders,s.headers),strictStatusCodes:(n=s.strictStatusCodes)!==null&&n!==void 0?n:e==null?void 0:e.strictStatusCodes,validateResponseOnClient:(i=s.validateResponseOnClient)!==null&&i!==void 0?i:e==null?void 0:e.validateResponseOnClient,responses:{...e==null?void 0:e.commonResponses,...s.responses},metadata:e!=null&&e.metadata?{...e==null?void 0:e.metadata,...(r=s.metadata)!==null&&r!==void 0?r:{}}:s.metadata}]:[a,LT(s,e)]})),qv=Symbol("ContractPlainType"),Qj=()=>({router:(t,e)=>LT(t,e),query:t=>t,mutation:t=>t,responses:t=>t,response:()=>qv,body:()=>qv,type:()=>qv,otherResponse:({contentType:t,body:e})=>({contentType:t,body:e}),noBody:()=>Vj}),X0=ct.object({message:ct.string()}),Yj=X0.extend({validationErrors:ct.array(ct.string())}),fu=X0,_x=fu.extend({errorId:ct.string(),uid:ct.string().optional()});function Jj(t){return X0.extend({data:t})}var Xj={400:fu.describe("Generic client error"),401:fu.describe("Authentication required but not provided or invalid"),403:fu.describe("Operation not permitted"),422:Yj.describe("Request validation failed"),429:fu.describe("Rate limit exceeded"),500:_x.describe("Generic server error"),503:_x.describe("Endpoint disabled or server is under maintenance")};ct.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(ct.number().transform(String));var ET=()=>ct.string().regex(/^[a-zA-Z0-9_]+$/),eB=ET();ET().max(50);ct.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");ct.string().nullable().optional().transform(t=>t??void 0);ct.number().nonnegative().max(100);ct.number().nonnegative().max(420);ct.enum(["repeat","random","shuffle"]);ct.enum(["word","time","section"]);var tB=ct.object({username:ct.string(),createUser:ct.boolean().optional().describe("If `true` create user with <username>@example.com and password `password`. If false user has to exist."),firstTestTimestamp:ct.number().int().nonnegative().optional(),lastTestTimestamp:ct.number().int().nonnegative().optional(),minTestsPerDay:ct.number().int().nonnegative().optional(),maxTestsPerDay:ct.number().int().nonnegative().optional()}),aB=Jj(ct.object({uid:eB,email:ct.string().email()})),sB=Qj(),nB=sB.router({generateData:{summary:"generate data",description:"Generate test results for the given user.",method:"POST",path:"/generateData",body:tB.strict(),responses:{200:aB}}},{pathPrefix:"/dev",strictStatusCodes:!0,metadata:{openApiTags:"development",authenticationOptions:{isPublicOnDev:!0}},commonResponses:Xj});const IT=Fm.backendUrl,iB=kS(zD,IT,1e4),rB=kS(nB,IT,24e4),F={...iB,dev:rB};async function Rf(){}class di{constructor(e){this.name=e.name,this.element=e.element,this.pathname=e.path,this.beforeHide=e.beforeHide??Rf,this.afterHide=e.afterHide??Rf,this.beforeShow=e.beforeShow??Rf,this.afterShow=e.afterShow??Rf}}const Qy=new Map;function ms(t,e=!0){const a=document.getElementById(t)??void 0;if(a===void 0)throw new Error(`Element with id ${t} not found`);Qy.set(t,a),e&&Na(t)}function Na(t){const e=Qy.get(t);e?e.remove():ms(t,!0)}const oB={popups:document.getElementById("popups"),main:document.querySelector("main")};function Cs(t,e){const a=Qy.get(t);oB[e].append(a)}function dB(t){return Qy.has(t)}function Zn(t,e=!1){const a=e?100:1e3;o(".pageLoading .fill, .pageAccount .preloader .fill").stop(!0,e).animate({width:t+"%"},a)}function lg(t){o(".pageLoading .text, .pageAccount .preloader .text").text(t)}async function OT(){return new Promise(t=>{Xn(o(".pageLoading .preloader .icon"),o(".pageLoading .preloader .barWrapper"),125,async()=>{t()}),Xn(o(".pageAccount .preloader .icon"),o(".pageAccount .preloader .barWrapper"),125,async()=>{t()})})}const lB=new di({name:"loading",element:o(".page.pageLoading"),path:"/",afterHide:async()=>{Na("pageLoading")},beforeShow:async()=>{Cs("pageLoading","main")}}),uB={theme:"serika_dark",themeLight:"serika",themeDark:"serika_dark",autoSwitchTheme:!1,customTheme:!1,customThemeColors:["#323437","#e2b714","#e2b714","#646669","#2c2e31","#d1d0c5","#ca4754","#7e2a33","#ca4754","#7e2a33"],favThemes:[],showKeyTips:!0,smoothCaret:"medium",quickRestart:"off",punctuation:!1,numbers:!1,words:50,time:30,mode:"time",quoteLength:[1],language:"english",fontSize:2,freedomMode:!1,difficulty:"normal",blindMode:!1,quickEnd:!1,caretStyle:"default",paceCaretStyle:"default",flipTestColors:!1,layout:"default",funbox:"none",confidenceMode:"off",indicateTypos:"off",timerStyle:"mini",liveSpeedStyle:"off",liveAccStyle:"off",liveBurstStyle:"off",colorfulMode:!1,randomTheme:"off",timerColor:"main",timerOpacity:"1",stopOnError:"off",showAllLines:!1,keymapMode:"off",keymapStyle:"staggered",keymapLegendStyle:"lowercase",keymapLayout:"overrideSync",keymapShowTopRow:"layout",keymapSize:1,fontFamily:"Roboto_Mono",smoothLineScroll:!1,alwaysShowDecimalPlaces:!1,alwaysShowWordsHistory:!1,singleListCommandLine:"on",capsLockWarning:!0,playSoundOnError:"off",playSoundOnClick:"off",soundVolume:.5,startGraphsAtZero:!0,showOutOfFocusWarning:!0,paceCaret:"off",paceCaretCustomSpeed:100,repeatedPace:!0,accountChart:["on","on","on","on"],minWpm:"off",minWpmCustomSpeed:100,highlightMode:"letter",typingSpeedUnit:"wpm",ads:"result",hideExtraLetters:!1,strictSpace:!1,minAcc:"off",minAccCustom:90,monkey:!1,repeatQuotes:"off",oppositeShiftMode:"off",customBackground:"",customBackgroundSize:"cover",customBackgroundFilter:[0,1,1,1],customLayoutfluid:"qwerty#dvorak#colemak",monkeyPowerLevel:"off",minBurst:"off",minBurstCustomSpeed:100,burstHeatmap:!1,britishEnglish:!1,lazyMode:!1,showAverage:"off",tapeMode:"off",maxLineWidth:0},$a=yn(uB),PT=[];function cB(t){PT.push(t)}window.addEventListener("load",()=>{window.addEventListener("online",()=>{xx(!0)}),window.addEventListener("offline",()=>{xx(!1)})});function xx(t){PT.forEach(e=>{try{e(t)}catch(a){console.error("Connection event subscriber threw an error"),console.error(a)}})}let nn=!1,Ro=!1,ea=!1,Va=null,Km=!0,so=!1,zb=1;function ZT(t){nn=t}function pB(t){Ro=t}function ek(t){ea=t}function RT(t){Va=t}function ZJ(t){Km=t}function NT(t){so=t}function tk(t){zb=t}let Zc=navigator.onLine;function ta(){return Zc}let Fu,Hb=!1;function Yy(){Hb||Fu===void 0&&(Fu=tc("No internet connection",0,"exclamation-triangle",!1,()=>{Hb=!0,Fu=void 0}))}const mB=N0(1e4,()=>{Zc?(g("You're back online",1,{customTitle:"Connection"}),Fu!==void 0&&o(`#bannerCenter .banner[id="${Fu}"] .closeButton`).trigger("click"),Hb=!1):ea||Yy()});cB(t=>{Zc=t,mB()});window.addEventListener("load",()=>{Zc=navigator.onLine,Zc||Yy()});function an(t,e,a){const s=Cx(t),n=Cx(e);if(s&&n){const i={r:s.r,g:s.g,b:s.b,a:1},r={r:n.r,g:n.g,b:n.b,a},d=QO(i,r);return fB(d.r,d.g,d.b)}else return"#000000"}function Cx(t){if(t.length!==4&&t.length!==7||!t.startsWith("#"))return;let e,a,s;if(t.length===4)e=+("0x"+t[1]+t[1]),a=+("0x"+t[2]+t[2]),s=+("0x"+t[3]+t[3]);else if(t.length===7)e=+("0x"+t[1]+t[2]),a=+("0x"+t[3]+t[4]),s=+("0x"+t[5]+t[6]);else return;return{r:e,g:a,b:s}}function fB(t,e,a){return"#"+((1<<24)+(t<<16)+(e<<8)+a).toString(16).slice(1)}function ug(t){let e,a,s;t.length===4?(e="0x"+t[1]+t[1],a="0x"+t[2]+t[2],s="0x"+t[3]+t[3]):t.length===7?(e="0x"+t[1]+t[2],a="0x"+t[3]+t[4],s="0x"+t[5]+t[6]):(e=0,a=0,s=0),e/=255,a/=255,s/=255;const n=Math.min(e,a,s),i=Math.max(e,a,s),r=i-n;let d=0,u=0,c=0;return r===0?d=0:i===e?d=(a-s)/r%6:i===a?d=(s-e)/r+2:d=(e-a)/r+4,d=Math.round(d*60),d<0&&(d+=360),c=(i+n)/2,u=r===0?0:r/(1-Math.abs(2*c-1)),u=+(u*100).toFixed(1),c=+(c*100).toFixed(1),{hue:d,sat:u,lgt:c,string:"hsl("+d+","+u+"%,"+c+"%)"}}function hB(t){return ug(t).lgt>=50}function DT(t){return ug(t).lgt<50}function gB(t){const e=t.match(/^rgb\((\d+), \s*(\d+), \s*(\d+)\)$/);if(e===null||e.length<3)return;function a(s){return("0"+parseInt(s).toString(16)).slice(-2)}return"#"+a(e[1])+a(e[2])+a(e[3])}async function yB(t){try{if(!t)throw new Error("No URL");const e=await fetch(t);if(e.ok)return await e.json();throw new Error(`${e.status} ${e.statusText}`)}catch(e){throw console.error("Error fetching JSON: "+t,e),e}}function vB(t,e){const a=new Map;return async(...s)=>{const n=s[0];if(a.has(n)){const r=await a.get(n);if(r!==void 0)return r}const i=t.apply(null,s);return a.set(n,i),i}}const fs=vB(yB);async function Vm(){try{return await fs("/layouts/_list.json")}catch{throw new Error("Layouts JSON fetch failed")}}async function Gm(t){const a=(await Vm())[t];if(a===void 0)throw new Error(`Layout ${t} is undefined`);return a}let lo;async function ak(){if(lo)return lo;{let t=await fs("/themes/_list.json");return t=t.sort((e,a)=>{const s=e.name.toLowerCase(),n=a.name.toLowerCase();return s<n?-1:s>n?1:0}),lo=t,lo}}let Nf;async function bB(){if(Nf)return Nf;{if(lo||await ak(),!lo)throw new Error("Themes list is undefined");let t=[...lo];return t=t.sort((e,a)=>{const s=ug(e.bgColor);return ug(a.bgColor).lgt-s.lgt}),Nf=t,Nf}}async function sk(){try{return await fs("/languages/_list.json")}catch{throw new Error("Language list JSON fetch failed")}}async function nk(){try{return await fs("/languages/_groups.json")}catch{throw new Error("Language groups JSON fetch failed")}}let Df;async function Qm(t){return(Df===void 0||Df.name!==t)&&(Df=await fs(`/languages/${t}.json`)),Df}async function wB(t){const e=await Qm(t);return e.orderedByFrequency===!0?"yes":e.orderedByFrequency===!1?"no":"unknown"}async function Kr(t){return await Qm(t)}async function kB(t){let e;return(await nk()).forEach(s=>{e===void 0&&s.languages.includes(t)&&(e=s)}),e}let jf;async function Ol(){if(jf)return jf;{let t=await fs("/funbox/_list.json");return t=t.sort((e,a)=>{const s=e.name.toLowerCase(),n=a.name.toLowerCase();return s<n?-1:s>n?1:0}),jf=t,jf}}class jT{constructor(e,a,s){this.title=e,this.author=a,this.words=s}}async function _B(t){return(await Ol()).find(function(a){return a.name===t})}let Bf;async function xB(){if(Bf)return Bf;{let t=await fs("/fonts/_list.json");return t=t.sort((e,a)=>{const s=e.name.toLowerCase(),n=a.name.toLowerCase();return s<n?-1:s>n?1:0}),Bf=t,Bf}}async function CB(){try{return await fs("/challenges/_list.json")}catch{throw new Error("Challenge list JSON fetch failed")}}async function SB(){try{return await fs("/about/supporters.json")}catch{throw new Error("Supporters list JSON fetch failed")}}async function TB(){try{return await fs("/about/contributors.json")}catch{throw new Error("Contributors list JSON fetch failed")}}async function $B(){const t=await fs("https://api.github.com/repos/monkeytypegame/monkeytype/releases?per_page=1");if(t[0]===void 0||t[0].name===void 0)throw new Error("No release found");return t[0].name}async function AB(){return fs("https://api.github.com/repos/monkeytypegame/monkeytype/releases?per_page=5")}function Rc(t){return MB(BT(t))}function MB(t){const e={};for(const a of Ti($a)){const s=t[a]??$a[a];e[a]=s}return e}function BT(t){if(t.quickTab===!0&&t.quickRestart===void 0&&(t.quickRestart="tab"),typeof t.smoothCaret=="boolean"&&(t.smoothCaret=t.smoothCaret?"medium":"off"),t.swapEscAndTab===!0&&t.quickRestart===void 0&&(t.quickRestart="esc"),t.alwaysShowCPM===!0&&t.typingSpeedUnit===void 0&&(t.typingSpeedUnit="cpm"),t.showAverage==="wpm"&&(t.showAverage="speed"),typeof t.playSoundOnError=="boolean"&&(t.playSoundOnError=t.playSoundOnError?"1":"off"),t.showTimerProgress===!1&&t.timerStyle===void 0&&(t.timerStyle="off"),t.showLiveWpm===!0&&t.liveSpeedStyle===void 0){let e="mini";t.timerStyle!=="bar"&&t.timerStyle!=="off"&&(e=t.timerStyle),t.liveSpeedStyle=e}if(t.showLiveBurst===!0&&t.liveBurstStyle===void 0){let e="mini";t.timerStyle!=="bar"&&t.timerStyle!=="off"&&(e=t.timerStyle),t.liveBurstStyle=e}if(t.showLiveAcc===!0&&t.liveAccStyle===void 0){let e="mini";t.timerStyle!=="bar"&&t.timerStyle!=="off"&&(e=t.timerStyle),t.liveAccStyle=e}return typeof t.soundVolume=="string"&&(t.soundVolume=parseFloat(t.soundVolume)),t}class yh{constructor(e,a,s=!1){const n=new ou(a),i=this.getInterval(n,s);this.startDay=i.start,this.endDay=i.end,this.data=this.buildData(e,n),this.isFullYear=s}getInterval(e,a=!1){const s=a?YO(e):new Date;let n=JO(e);return a||(n=Cb(XO(s,52),1),Q_(n)||(n=Y_(n))),{start:n,end:s}}buildData(e,a){const s=new Array(Math.max(0,386-e.length)).fill(void 0);s.push(...e);const n=Sd(this.endDay,this.startDay)+1,i=s.length-n+Sd(this.endDay,a);return s.slice(i)}getMonths(){const e=e2({start:this.startDay,end:this.endDay}),a=[];for(let s=0;s<e.length;s++){const n=e[s];let i=s===0?this.startDay:t2(n),r=s===e.length-1?this.endDay:a2(i);Q_(i)||(i=(s===0?Y_:s2)(i)),n2(r)||(r=i2(r));const d=r2(r,i,{roundingMethod:"ceil"});d>2?a.push({text:Ot(n,"MMM").toLowerCase(),weeks:d}):s==0&&a.push({text:"",weeks:d})}return a}getDays(){const e=[],a=this.getBuckets(),s=r=>{if(r===void 0||r===null||r===0)return"0";for(let d=0;d<4;d++)if(r<=(a[d]??0))return(1+d).toString();return"4"};for(let r=0;r<this.startDay.getDay();r++)e.push({level:"filler"});const n=Sd(this.endDay,this.startDay);let i=this.startDay;for(let r=0;r<=n;r++){const d=this.data[r],u=Ot(i,"EEEE dd MMM yyyy");e.push({level:s(d),label:d!=null?`${d} ${d==1?"test":"tests"} on ${u}`:`no activity on ${u}`}),i=Cb(i,1)}for(let r=this.endDay.getDay();r<6;r++)e.push({level:"filler"});return e}getTotalTests(){const e=Sd(this.endDay,this.startDay);return this.data.slice(0,e+1).reduce((a,s)=>(a??0)+(s??0),0)??0}getBuckets(){const a=this.data.filter(r=>r!=null).sort((r,d)=>r-d),s=a.slice(Math.round(a.length*.1),a.length-Math.round(a.length*.1)),i=s.reduce((r,d)=>r+d,0)/s.length;return[Math.floor(i/2),Math.round(i),Math.round(i*1.5)]}}class LB extends yh{constructor(e,a){super(e,a),this.lastDay=new ou(a)}increment(e){const a=new ou(e),s=new ou(this.lastDay);if(o2(a,s)){const n=this.data.length-1;this.data[n]=(this.data[n]||0)+1}else{if(d2(a,s))throw new Error("cannot alter data in the past.");{const n=Sd(a,s)-1;for(let r=0;r<n;r++)this.data.push(void 0);this.data.push(1);const i=this.getInterval(a);this.startDay=i.start,this.endDay=i.end,this.lastDay=a}}this.data=this.buildData(this.data,this.lastDay)}getFullYearCalendar(){const e=new Date;return this.lastDay.getFullYear()!==new ou(e).getFullYear()?new yh([],e,!0):new yh(this.data,this.lastDay,!0)}}const EB={results:void 0,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}},name:"",email:"",uid:"",isPremium:!1,config:$a,customThemes:[],presets:[],tags:[],banned:void 0,verified:void 0,lbMemory:{time:{15:{english:0},60:{english:0}}},typingStats:{timeTyping:0,startedTests:0,completedTests:0},quoteRatings:void 0,quoteMod:!1,favoriteQuotes:{},addedAt:0,filterPresets:[],xp:0,inboxUnreadSize:0,streak:0,maxStreak:0,streakHourOffset:void 0,allTimeLbs:{time:{15:{english:{count:0,rank:0}},60:{english:{count:0,rank:0}}}}},Sx=yn(EB);let oe;class hu extends Error{constructor(e,a){super(e),this.responseCode=a,this.name="SnapshotInitError",this.responseCode=a}}function T(){return oe}function Aa(t){const e=oe==null?void 0:oe.banned,a=oe==null?void 0:oe.verified,s=oe==null?void 0:oe.lbOptOut;try{t==null||delete t.banned}catch{}try{t==null||delete t.verified}catch{}try{t==null||delete t.lbOptOut}catch{}oe=t,oe&&(oe.banned=e,oe.verified=a,oe.lbOptOut=s)}async function IB(){var e,a,s,n,i,r,d;const t=Sx;try{if(!we())return!1;const[u,c,m]=await Promise.all([F.users.get(),F.configs.get(),F.presets.get()]);if(u.status!==200)throw new hu(`${u.body.message} (user)`,u.status);if(c.status!==200)throw new hu(`${c.body.message} (config)`,c.status);if(m.status!==200)throw new hu(`${m.body.message} (presets)`,m.status);const f=u.body.data,h=c.body.data,y=m.body.data;if(f===null)throw new hu("Request was successful but user data is null",200);if(h!==null&&"config"in h)throw new Error("Config data is not in the correct format. Please refresh the page or contact support.");t.name=f.name,t.personalBests=f.personalBests,t.personalBests??(t.personalBests={time:{},words:{},quote:{},zen:{},custom:{}});for(const w of["time","words","quote","zen","custom"])(e=t.personalBests)[w]??(e[w]={});t.banned=f.banned,t.lbOptOut=f.lbOptOut,t.verified=f.verified,t.discordId=f.discordId,t.discordAvatar=f.discordAvatar,t.needsToChangeName=f.needsToChangeName,t.typingStats={timeTyping:f.timeTyping??0,startedTests:f.startedTests??0,completedTests:f.completedTests??0},t.quoteMod=f.quoteMod,t.favoriteQuotes=f.favoriteQuotes??{},t.quoteRatings=f.quoteRatings,t.details=f.profileDetails,t.addedAt=f.addedAt,t.inventory=f.inventory,t.xp=f.xp??0,t.inboxUnreadSize=f.inboxUnreadSize??0,t.streak=((a=f==null?void 0:f.streak)==null?void 0:a.length)??0,t.maxStreak=((s=f==null?void 0:f.streak)==null?void 0:s.maxLength)??0,t.filterPresets=f.resultFilterPresets??[],t.isPremium=(f==null?void 0:f.isPremium)??!1,t.allTimeLbs=f.allTimeLbs,f.testActivity!==void 0&&(t.testActivity=new LB(f.testActivity.testsByDays,new Date(f.testActivity.lastDay)));const b=(n=f==null?void 0:f.streak)==null?void 0:n.hourOffset;if(t.streakHourOffset=b??void 0,f.lbMemory!==void 0&&(t.lbMemory=f.lbMemory),h==null?t.config={...$a}:t.config=Rc(h),t.customThemes=f.customThemes??[],t.tags=((i=f.tags)==null?void 0:i.map(w=>({...w,display:w.name.replaceAll("_"," ")})))??[],t.tags=(r=t.tags)==null?void 0:r.sort((w,$)=>w.name>$.name?1:w.name<$.name?-1:0),y!=null){const w=y.map($=>({...$,display:$.name.replace(/_/gi," ")}));t.presets=w,t.presets=(d=t.presets)==null?void 0:d.sort(($,E)=>$.name>E.name?1:$.name<E.name?-1:0)}return oe=t,oe}catch(u){throw oe=Sx,u}}async function ik(t){var s;if(!we()||!oe||oe.results!==void 0&&(t===void 0||oe.results.length>t)||!ta())return!1;oe.results===void 0&&(lg("Downloading results..."),Zn(90));const e=await F.results.get({query:{offset:t}});if(e.status!==200)return g("Error getting results: "+e.body.message,-1),!1;const a=e.body.data.map(n=>(n.bailedOut===void 0&&(n.bailedOut=!1),n.blindMode===void 0&&(n.blindMode=!1),n.lazyMode===void 0&&(n.lazyMode=!1),n.difficulty===void 0&&(n.difficulty="normal"),n.funbox===void 0&&(n.funbox="none"),(n.language===void 0||n.language===null)&&(n.language="english"),n.numbers===void 0&&(n.numbers=!1),n.punctuation===void 0&&(n.punctuation=!1),n.numbers===void 0&&(n.numbers=!1),n.quoteLength===void 0&&(n.quoteLength=-1),n.restartCount===void 0&&(n.restartCount=0),n.incompleteTestSeconds===void 0&&(n.incompleteTestSeconds=0),n.afkDuration===void 0&&(n.afkDuration=0),n.tags===void 0&&(n.tags=[]),n));if(a==null||a.sort((n,i)=>i.timestamp-n.timestamp),oe.results!==void 0&&oe.results.length>0){const n=(s=_r(oe.results))==null?void 0:s.timestamp,i=a.filter(r=>r.timestamp<n);oe.results.push(...i)}else oe.results=a;return!0}async function OB(t){if(!oe)return!1;if(oe.customThemes===void 0&&(oe.customThemes=[]),oe.customThemes.length>=10)return g("Too many custom themes!",0),!1;const e=await F.users.addCustomTheme({body:{...t}});if(e.status!==200)return g("Error adding custom theme: "+e.body.message,-1),!1;if(e.body.data===null)return g("Error adding custom theme: No data returned",-1),!1;const a={...t,_id:e.body.data._id};return oe.customThemes.push(a),!0}async function PB(t,e){var i;if(!we()||!oe)return!1;oe.customThemes===void 0&&(oe.customThemes=[]);const a=(i=oe.customThemes)==null?void 0:i.find(r=>r._id===t);if(!a)return g("Editing failed: Custom theme with id: "+t+" does not exist",-1),!1;const s=await F.users.editCustomTheme({body:{themeId:t,theme:e}});if(s.status!==200)return g("Error editing custom theme: "+s.body.message,-1),!1;const n={...e,_id:t};return oe.customThemes[oe.customThemes.indexOf(a)]=n,!0}async function ZB(t){var s,n;if(!we()||!oe||!((s=oe.customThemes)==null?void 0:s.find(i=>i._id===t)))return!1;const a=await F.users.deleteCustomTheme({body:{themeId:t}});return a.status!==200?(g("Error deleting custom theme: "+a.body.message,-1),!1):(oe.customThemes=(n=oe.customThemes)==null?void 0:n.filter(i=>i._id!==t),!0)}async function qT(t,e,a,s,n,i,r){const d=T();if(!d)return[0,0];function u(){var E;const m=[];(E=d==null?void 0:d.tags)==null||E.forEach(L=>{L.active===!0&&m.push(L._id)});let f=0,h=0,y=0,b=0,w=0,$=0;if((d==null?void 0:d.results)!==void 0){for(const L of d.results)if(L.mode===t&&(L.punctuation??!1)===a&&(L.numbers??!1)===s&&L.language===n&&L.difficulty===i&&(L.lazyMode===r||L.lazyMode===void 0&&!r)&&(m.length===0||m.some(be=>{var J;return(J=L.tags)==null?void 0:J.includes(be)}))){if(`${L.mode2}`!=`${e}`&&t!=="quote")continue;if($<10&&(y+=L.wpm,b+=L.acc,$++),`${L.mode2}`==`${e}`&&(f+=L.wpm,h+=L.acc,w++,w>=10))break}}return w===0&&t==="quote"?[y/$,b/$]:[f/w,h/w]}return d===null||await ik()===null?[0,0]:u()}async function RB(t,e,a,s,n,i,r){const d=T();if(!d)return 0;function u(){var h;const m=[];(h=d==null?void 0:d.tags)==null||h.forEach(y=>{y.active===!0&&m.push(y._id)});let f=0;if((d==null?void 0:d.results)!==void 0){for(const y of d.results)if(y.mode===t&&(y.punctuation??!1)===a&&(y.numbers??!1)===s&&y.language===n&&y.difficulty===i&&(y.lazyMode===r||y.lazyMode===void 0&&!r)&&(m.length===0||m.some(b=>{var w;return(w=y.tags)==null?void 0:w.includes(b)}))){if(y.timestamp<Date.now()-864e5||`${y.mode2}`!=`${e}`&&t!=="quote")continue;y.wpm>f&&(f=y.wpm)}}return f}return d===null||await ik()===null?0:u()}async function NB(t,e,a,s,n,i,r){const d=T();if(!d)return 0;let u=0;for(const c of d.tags){if(!c.active)continue;const m=await WT(c._id,t,e,a,s,n,i,r);m>u&&(u=m)}return u}async function Nc(t,e,a,s,n,i,r,d){var m,f;if(!(await Ol()).filter(h=>d==null?void 0:d.split("#").includes(h.name)).every(h=>h.canGetPb))return;const c=(f=(m=oe==null?void 0:oe.personalBests)==null?void 0:m[t])==null?void 0:f[e];return c==null?void 0:c.find(h=>(h.punctuation??!1)===a&&(h.numbers??!1)===s&&h.difficulty===i&&h.language===n&&(h.lazyMode??!1)===r)}async function DB(t,e,a,s,n,i,r,d,u,c,m){if(t==="quote"||!oe)return;function f(){var y,b;if(!oe)return;let h=!1;oe.personalBests??(oe.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(y=oe.personalBests)[t]??(y[t]={[e]:[]}),(b=oe.personalBests[t])[e]??(b[e]=[]),oe.personalBests[t][e].forEach(w=>{(w.punctuation??!1)===a&&(w.numbers??!1)===s&&w.difficulty===i&&w.language===n&&(w.lazyMode??!1)===r&&(h=!0,w.wpm=d,w.acc=u,w.raw=c,w.timestamp=Date.now(),w.consistency=m,w.lazyMode=r)}),h||oe.personalBests[t][e].push({language:n,difficulty:i,lazyMode:r,punctuation:a,numbers:s,wpm:d,acc:u,raw:c,timestamp:Date.now(),consistency:m})}oe!==null&&f()}async function WT(t,e,a,s,n,i,r,d){var f,h,y,b;if(oe===null)return 0;let u=0;const c=(((f=T())==null?void 0:f.tags)??[]).filter(w=>w._id===t)[0];return c===void 0||(c.personalBests??(c.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(h=c.personalBests)[e]??(h[e]={[a]:[]}),(y=c.personalBests[e])[a]??(y[a]=[]),u=((b=(c.personalBests[e][a]??[]).find(w=>(w.punctuation??!1)===s&&(w.numbers??!1)===n&&w.difficulty===r&&w.language===i&&(w.lazyMode===d||w.lazyMode===void 0&&!d)))==null?void 0:b.wpm)??0),u}async function jB(t,e,a,s,n,i,r,d,u,c,m,f){if(!oe||e==="quote")return;function h(){var b,w,$;const y=(b=oe==null?void 0:oe.tags)==null?void 0:b.filter(E=>E._id===t)[0];y.personalBests??(y.personalBests={time:{},words:{},quote:{},zen:{},custom:{}}),(w=y.personalBests)[e]??(w[e]={[a]:[]}),($=y.personalBests[e])[a]??($[a]=[]);try{let E=!1;y.personalBests[e][a].forEach(L=>{(L.punctuation??!1)===s&&(L.numbers??!1)===n&&L.difficulty===r&&L.language===i&&(L.lazyMode===d||L.lazyMode===void 0&&!d)&&(E=!0,L.wpm=u,L.acc=c,L.raw=m,L.timestamp=Date.now(),L.consistency=f,L.lazyMode=d)}),E||y.personalBests[e][a].push({language:i,difficulty:r,lazyMode:d,punctuation:s,numbers:n,wpm:u,acc:c,raw:m,timestamp:Date.now(),consistency:f})}catch{y.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},y.personalBests[e][a]=[{language:i,difficulty:r,lazyMode:d,punctuation:s,numbers:n,wpm:u,acc:c,raw:m,timestamp:Date.now(),consistency:f}]}}oe!==null&&h()}async function Tx(t,e,a,s,n=!1){var i,r,d;{const u=t,c=e,m=T();if(!m)return;m.lbMemory===void 0&&(m.lbMemory={time:{15:{english:0},60:{english:0}}}),m.lbMemory[u]===void 0&&(m.lbMemory[u]={15:{english:0},60:{english:0}}),m.lbMemory[u][c]===void 0&&(m.lbMemory[u][c]={});const f=(d=(r=(i=m.lbMemory)==null?void 0:i[u])==null?void 0:r[c])==null?void 0:d[a],h=m.lbMemory[u][c];h[a]=s,n&&f!==s&&await F.users.updateLeaderboardMemory({body:{mode:t,mode2:e,language:a,rank:s}}),Aa(m)}}async function FT(t){if(we()){const e=await F.configs.save({body:t});e.status!==200&&g("Failed to save config: "+e.body.message,-1)}}async function BB(){if(we()){const t=await F.configs.delete();t.status!==200&&g("Failed to reset config: "+t.body.message,-1)}}function zT(t){const e=T();e&&((e==null?void 0:e.results)!==void 0&&(e.results.unshift(t),Aa(e)),e.testActivity!==void 0&&(e.testActivity.increment(new Date(t.timestamp)),Aa(e)))}function HT(t,e){const a=T();a&&(a.typingStats===void 0&&(a.typingStats={timeTyping:0,startedTests:0,completedTests:0}),a.typingStats.timeTyping+=e,a.typingStats.startedTests+=t,a.typingStats.completedTests+=1,Aa(a))}function UT(t){const e=T();e&&(e.xp===void 0&&(e.xp=0),e.xp+=t,Aa(e))}function qB(t){const e=T();e&&(e.inventory===void 0&&(e.inventory={badges:[]}),e.inventory.badges.push(t),Aa(e))}function WB(t){const e=T();e&&(e.streak=t,e.streak>e.maxStreak&&(e.maxStreak=e.streak),Aa(e))}async function FB(t){var a;if(!we()||oe===void 0)return;if(t==="current")return oe.testActivity;const e=new Date().getFullYear().toString();if(t===e)return(a=oe.testActivity)==null?void 0:a.getFullYearCalendar();if(oe.testActivityByYear===void 0){if(!ta())return;ht();const s=await F.users.getTestActivity();if(s.status!==200){g("Error getting test activities: "+s.body.message,-1),We();return}oe.testActivityByYear={};for(const n in s.body.data){if(n===e)continue;const i=s.body.data[n]??[],r=Cb(new Date(parseInt(n),0,1),i.length);oe.testActivityByYear[n]=new yh(i,r,!0)}We()}return oe.testActivityByYear[t]}const KT=[];function Ym(){o("#words, #koInputVisualContainer").css("transition","none").removeClass("blurred"),o(".outOfFocusWarning").addClass("hidden"),RO(KT)}function zB(){KT.push(setTimeout(()=>{o("#words, #koInputVisualContainer").css("transition","0.25s").addClass("blurred"),o(".outOfFocusWarning").removeClass("hidden")},1e3))}function VT(t,e,a){a===void 0?g(`Invalid value for ${t} (${e}). Please try to change this setting again.`,-1):g(`Invalid value for ${t} (${e}). ${a}`,-1),console.error(`Invalid value key ${t} value ${e} type ${typeof e}`)}function de(t,e,a){const s=a.safeParse(e).success;return s||VT(t,e,void 0),s}function Ht(t,e){return de(t,e,Lt.boolean())}async function HB(t,e,a){let s=!1,n;for(const i of a)switch(i){case"layoutfluid":{if(typeof e!="string")break;const r=e.split(/[# ]+/);if(r.length<2||r.length>5)break;try{await Vm()}catch(u){n=qe(u,"Failed to validate layoutfluid value");break}const d=await Promise.all(r.map(async u=>Gm(u)));if(!d.every(u=>u!==void 0)){n=`The following inputted layouts do not exist: ${r.map((m,f)=>[m,d[f]]).filter(([m,f])=>f===void 0).map(([m])=>m).join(", ")}`;break}s=!0;break}}return s||VT(t,e,n),s}const GT=[];function Dt(t){GT.push(t)}function B(t,e,a,s,n){GT.forEach(i=>{try{i(t,e,a,s,n)}catch(r){console.error("Config event subscriber threw an error"),console.error(r)}})}let Ub;async function Mi(t,e){try{c2(Ub,t,e)}catch{console.log("Analytics unavailable")}}const qf=localStorage.getItem("acceptedCookies");let cg;qf!=null&&qf!==""?cg=JSON.parse(qf):cg=null;cg!==null&&cg.analytics&&Kb();function Kb(){try{Ub=l2(q2),u2(Ub,!0),o("body").append(`
    <script
    async
    src="https://www.googletagmanager.com/gtag/js?id=UA-165993088-1"
  ><\/script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "UA-165993088-1");
  <\/script>`)}catch(t){console.error(qe(t,"Failed to activate analytics"))}}const UB=[{name:"Prime Ape",description:"Paying for a monthly subscription",icon:"fa-dollar-sign",test:t=>t.isPremium===!0},{name:"Banned",description:"This account is banned",icon:"fa-gavel",color:"var(--error-color)",test:t=>t.banned===!0},{name:"LbOptOut",description:"This account has opted out of leaderboards",icon:"fa-crown",color:"var(--error-color)",test:t=>t.lbOptOut===!0}],KB={iconsOnly:!1};function VB(t){return UB.filter(a=>a.test(t))}function GB(t,e){const a=`<i class="fas ${t.icon}"></i>`;if(e.iconsOnly)return a;const s=[];return t.background!==void 0&&s.push(`background: ${t.background};`),(t==null?void 0:t.color)!==void 0&&s.push(`color: ${t.color};`),(t==null?void 0:t.customStyle)!==void 0&&s.push(t.customStyle),`<div class="flag" ${`aria-label="${t.description}" data-balloon-pos="right"`} style="${s.join("")}">${a}</div>`}function Jy(t,e){const a={...KB,...e};return VB(t).map(s=>GB(s,a)).join("")}function pg(t){return Math.floor((Math.sqrt(392*t+22801)-53)/98)}function QB(t){return 49*(t-1)+100}function YB(t){return(49*Math.pow(t,2)+53*t-102)/2}function Dc(t){const e=pg(t);return{level:e,levelCurrentXp:t-YB(e),levelMaxXp:QB(e)}}let Ia={bg:"#323437",main:"#e2b714",caret:"#e2b714",sub:"#646669",subAlt:"#2c2e31",text:"#d1d0c5",error:"#ca4754",errorExtra:"#7e2a33",colorfulError:"#ca4754",colorfulErrorExtra:"#7e2a33"};async function bs(t){return Ia[t]||Jm(),Ia[t]}async function Vr(){return Ia.bg||Jm(),Ia}function JB(){Ia={bg:"",main:"",caret:"",sub:"",subAlt:"",text:"",error:"",errorExtra:"",colorfulError:"",colorfulErrorExtra:""}}function Jm(){const t=getComputedStyle(document.body);Ia.bg=t.getPropertyValue("--bg-color").replace(" ",""),Ia.main=t.getPropertyValue("--main-color").replace(" ",""),Ia.caret=t.getPropertyValue("--caret-color").replace(" ",""),Ia.sub=t.getPropertyValue("--sub-color").replace(" ",""),Ia.subAlt=t.getPropertyValue("--sub-alt-color").replace(" ",""),Ia.text=t.getPropertyValue("--text-color").replace(" ",""),Ia.error=t.getPropertyValue("--error-color").replace(" ",""),Ia.errorExtra=t.getPropertyValue("--error-extra-color").replace(" ",""),Ia.colorfulError=t.getPropertyValue("--colorful-error-color").replace(" ",""),Ia.colorfulErrorExtra=t.getPropertyValue("--colorful-error-extra-color").replace(" ","")}let mg=!1;function XB(){mg||(mg=!0,console.error("Slow timer, disabling animations"))}function jc(){mg=!1}function ia(){return mg}let fg=!1,na=!1,QT=!1,to={currentXp:0,addedXp:0,breakdown:void 0};const gi=o("nav .xpBar .xpBreakdown .total"),rn=o("nav .xpBar .xpBreakdown .list"),fi=o("nav .level"),On=o("nav .xpBar .bar"),vh=o("nav .xpBar");async function eq(){if(na=!0,!fg)return;QT?gi.text(`+${to.addedXp}`):Ms(to.addedXp,!0),rn.stop(!0,!0).empty().addClass("hidden"),fi.text(pg(to.currentXp+to.addedXp));const t=Dc(to.currentXp+to.addedXp),e=t.level+t.levelCurrentXp/t.levelMaxXp;On.css("width",`${e%1*100}%`),await jt(2e3),fg=!1,vh.stop(!0,!0).css("opacity",1).animate({opacity:0},ia()?0:qt(250))}function $x(t){const e=Dc(t),a=e.levelCurrentXp/e.levelMaxXp;fi.text(e.level),On.css({width:a*100+"%"})}async function YT(t,e,a){na=!1,fg=!0,to={currentXp:t,addedXp:e,breakdown:a},fi.text(pg(t));const s=Dc(t),n=Dc(t+e),i=s.level+s.levelCurrentXp/s.levelMaxXp,r=n.level+n.levelCurrentXp/n.levelMaxXp,d=rn;rn.stop(!0,!0).css("opacity",0).empty(),vh.stop(!0,!0).css("opacity",0),gi.text("");const u=oo(vh,{opacity:"1"},ia()?0:qt(125),"linear"),c=oo(rn,{opacity:"1"},ia()?0:qt(125),"linear");if(a!==void 0?(d.removeClass("hidden"),Promise.all([u,c])):d.addClass("hidden"),na)return;const m=aq(i,r),f=tq(e,a);await Promise.all([m,f]),!na&&(await jt(5e3),!na&&(fg=!1,fi.text(pg(t+e)),vh.stop(!0,!0).css("opacity",1).animate({opacity:0},ia()?0:qt(250))))}async function Ms(t,e=!1){if(!e&&na)return;gi.text(`+${t}`);const a=(Math.random()*2-1)/4,s=(Math.random()+1)/2;gi.stop(!0,!0).css({transition:"initial",borderSpacing:100}).animate({borderSpacing:0},{step(n){gi.css("transform",`scale(${1+n/200*s}) rotate(${n/10*a}deg)`)},duration:qt(2e3),easing:"easeOutCubic",complete:()=>{gi.css({backgroundColor:"",transition:""})}})}async function As(t,e,a){if(na)return;if(e===void 0)rn.append(`<div class="line" data-string='${t}'><div>${t}</div><div></div></div>`);else if(typeof e=="string")rn.append(`
      <div class="line" data-string='${t}'>
      <div class="${a==null?void 0:a.extraClass}">${t}</div>
      <div class="${a==null?void 0:a.extraClass}">${e}</div>
      </div>`);else{const n=e==null?void 0:e>=0;rn.append(`
      <div class="line" data-string='${t}'>

        <div class="${a==null?void 0:a.extraClass}">${t}</div>
        <div class="${n?"positive":"negative"} ${a==null?void 0:a.extraClass}">${n?"+":"-"}${Math.abs(e)}</div>
      </div>`)}if(a!=null&&a.noAnimation)return;const s=rn.find(`.line[data-string='${t}']`);s.css("opacity",0),await oo(s,{opacity:"1"},qt(250),"swing")}async function tq(t,e){if(na)return;if(rn.css("opacity",1),!e){gi.text(`+${t}`);return}const a=qt(250);let s=0;rn.empty(),rn.removeClass("hidden"),gi.text("+0"),s+=e.base??0,gi.text(`+${s}`),await As("time typing",e.base,{noAnimation:!0}),await jt(a),e.fullAccuracy?(await jt(a),s+=e.fullAccuracy,Ms(s),await As("perfect",e.fullAccuracy)):e.corrected&&(await jt(a),s+=e.corrected,Ms(s),await As("clean",e.corrected)),!na&&(e.quote?(await jt(a),s+=e.quote,Ms(s),await As("quote",e.quote)):(e.punctuation&&(await jt(a),s+=e.punctuation,Ms(s),await As("punctuation",e.punctuation)),e.numbers&&(await jt(a),s+=e.numbers,Ms(s),await As("numbers",e.numbers))),!na&&(e.funbox&&(await jt(a),s+=e.funbox,Ms(s),await As("funbox",e.funbox)),!na&&(e.streak&&(await jt(a),s+=e.streak,Ms(s),await As("streak",e.streak)),!na&&(e.accPenalty&&(await jt(a),s-=e.accPenalty,Ms(s),await As("accuracy penalty",e.accPenalty*-1)),!na&&(e.incomplete&&(await jt(a),s+=e.incomplete,Ms(s),await As("incomplete tests",e.incomplete)),!na&&(e.configMultiplier&&(await jt(a),s*=e.configMultiplier,Ms(s),await As("global multiplier",`x${e.configMultiplier}`)),!na&&(e.daily&&(await jt(a),s+=e.daily,Ms(s),await As("daily bonus",e.daily)),QT=!0,!na&&await jt(a))))))))}async function aq(t,e){if(na)return;const a=e-t;if(On.css("width",`${t%1*100}%`),e%1===0){if(await oo(On,{width:"100%"},ia()?0:qt(1e3),"easeOutExpo"),na)return;Wv(),On.css("width","0%")}else if(Math.floor(t)===Math.floor(e))await oo(On,{width:`${e%1*100}%`},ia()?0:qt(1e3),"easeOutExpo");else{const s=Math.min(1e3/a,200);let n=a,i=!1,r=s,d="linear",u=1-t%1;do{if(na)return;n-1<1&&(r=Fh(n-1,0,.5,1e3,200),d="easeOutQuad"),i&&(Wv(),On.css("width","0%"),u=1),await oo(On,{width:"100%"},ia()?0:qt(r),d),n-=u,i=!0}while(n>1);if(na||(Wv(),On.css("width","0%"),na))return;await oo(On,{width:`${n%1*100}%`},ia()?0:qt(1e3),"easeOutExpo")}}async function Wv(){const t=await Vr();fi.text(parseInt(fi.text())+1);const e=Math.random()*2-1,a=Math.random()+1;fi.stop(!0,!0).css({backgroundColor:t.main,borderSpacing:100,transition:"initial"}).animate({backgroundColor:t.sub,borderSpacing:0},{step(s){fi.css("transform",`scale(${1+s/200*a}) rotate(${s/10*e}deg)`)},duration:qt(2e3),easing:"easeOutCubic",complete:()=>{fi.css({backgroundColor:"",transition:""})}})}let Vb=!1;function sq(){o("nav .accountButtonAndMenu").addClass("hidden"),o("nav .textButton.view-login").addClass("hidden")}function Zs(t){t?(o("header nav .account").css("opacity",1).css("pointer-events","none"),Vb?(o("header nav .view-account .loading").css("opacity",1).removeClass("hidden"),o("header nav .view-account .avatar").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{o("header nav .view-account .avatar").addClass("hidden")})):(o("header nav .view-account .loading").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100),o("header nav .view-account .user").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{o("header nav .view-account .user").addClass("hidden")}))):(o("header nav .account").css("opacity",1).css("pointer-events","auto"),Vb?(o("header nav .view-account .loading").css("opacity",1).addClass("hidden"),o("header nav .view-account .avatar").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100)):(o("header nav .view-account .loading").stop(!0,!0).css({opacity:1}).animate({opacity:0},100,()=>{o("header nav .view-account .loading").addClass("hidden")}),o("header nav .view-account .user").stop(!0,!0).removeClass("hidden").css({opacity:0}).animate({opacity:1},100)))}function Gb(t){o("header nav .view-account > .text").text(t)}function Ax(t){o("nav .textButton.view-account > .text").append(Jy(t,{iconsOnly:!0}))}function hg(t,e){(e??"")&&(t??"")?P0(t,e).then(a=>{a!==null&&(o("header nav .view-account .avatar").css("background-image",`url(${a})`),Vb=!0,o("header nav .view-account .user").addClass("hidden"),o("header nav .view-account .avatar").removeClass("hidden"))}):(o("header nav .view-account .avatar").addClass("hidden"),o("header nav .view-account .user").removeClass("hidden"))}function JT(t){if(we()){const{xp:e,discordId:a,discordAvatar:s,name:n}=t;Gb(n),Ax(t??{}),$x(e),hg(a??"",s??""),o("nav .accountButtonAndMenu .menu .items .goToProfile").attr("href",`/profile/${n}`),Xn(o("nav .textButton.view-login"),o("nav .accountButtonAndMenu"),250)}else Xn(o("nav .accountButtonAndMenu"),o("nav .textButton.view-login"),250,async()=>{Gb(""),Ax({}),$x(0),hg(void 0,void 0)})}var zC;const nq=(zC=window.matchMedia("(pointer:coarse)"))==null?void 0:zC.matches;nq&&o("nav .accountButtonAndMenu .textButton.view-account").attr("href","");const rk=[{name:"nausea",info:"I think I'm gonna be sick.",hasCSS:!0},{name:"round_round_baby",info:"...right round, like a record baby. Right, round round round.",hasCSS:!0},{name:"simon_says",info:"Type what simon says.",properties:["changesWordsVisibility","usesLayout"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"mirror",info:"Everything is mirrored!",hasCSS:!0},{name:"upside_down",info:"Everything is upside down!",hasCSS:!0},{name:"tts",info:"Listen closely.",properties:["changesWordsVisibility","speaks"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"choo_choo",info:"All the letters are spinning!",properties:["noLigatures","conflictsWithSymmetricChars"],hasCSS:!0},{name:"arrows",info:"Play it on a pad!",properties:["ignoresLanguage","ignoresLayout","nospace","noLetters","symmetricChars"],forcedConfig:{punctuation:[!1],numbers:[!1],highlightMode:["letter","off"]}},{name:"rAnDoMcAsE",info:"I kInDa LiKe HoW iNeFfIcIeNt QwErTy Is.",properties:["changesCapitalisation"]},{name:"capitals",info:"Capitalize Every Word.",properties:["changesCapitalisation"]},{name:"layoutfluid",info:"Switch between layouts specified below proportionately to the length of the test.",properties:["changesLayout","noInfiniteDuration"]},{name:"earthquake",info:"Everybody get down! The words are shaking!",properties:["noLigatures"],hasCSS:!0},{name:"space_balls",info:"In a galaxy far far away.",hasCSS:!0},{name:"gibberish",info:"Anvbuefl dizzs eoos alsb?",properties:["ignoresLanguage","unspeakable"]},{name:"58008",alias:"numbers",info:"A special mode for accountants.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"ascii",info:"Where was the ampersand again?. Only ASCII characters.",properties:["ignoresLanguage","noLetters","unspeakable"],forcedConfig:{numbers:[!1]}},{name:"specials",info:"!@#$%^&*. Only special characters.",properties:["ignoresLanguage","noLetters","unspeakable"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"plus_zero",info:"React quickly! Only the current word is visible.",properties:["changesWordsVisibility","toPush:1","noInfiniteDuration"]},{name:"plus_one",info:"Only one future word is visible.",properties:["changesWordsVisibility","toPush:2","noInfiniteDuration"]},{name:"plus_two",info:"Only two future words are visible.",properties:["changesWordsVisibility","toPush:3","noInfiniteDuration"]},{name:"plus_three",info:"Only three future words are visible.",properties:["changesWordsVisibility","toPush:4","noInfiniteDuration"]},{name:"read_ahead_easy",info:"Only the current word is invisible.",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"read_ahead",info:"Current and the next word are invisible!",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"read_ahead_hard",info:"Current and the next two words are invisible!",properties:["changesWordsVisibility"],forcedConfig:{highlightMode:["letter","off"]},hasCSS:!0},{name:"memory",info:"Test your memory. Remember the words and type them blind.",properties:["changesWordsVisibility","noInfiniteDuration"],forcedConfig:{mode:["words","quote","custom"]}},{name:"nospace",info:"Whoneedsspacesanyway?",properties:["nospace"],forcedConfig:{highlightMode:["letter","off"]}},{name:"poetry",info:"Practice typing some beautiful prose.",properties:["noInfiniteDuration","ignoresLanguage"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"wikipedia",info:"Practice typing wikipedia sections.",properties:["noInfiniteDuration","ignoresLanguage"],forcedConfig:{punctuation:[!1],numbers:[!1]}},{name:"weakspot",info:"Focus on slow and mistyped letters.",properties:["changesWordsFrequency"]},{name:"pseudolang",info:"Nonsense words that look like the current language.",properties:["unspeakable","ignoresLanguage"]},{name:"IPv4",alias:"network",info:"For sysadmins.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"IPv6",alias:"network",info:"For sysadmins with a long beard.",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"binary",alias:"numbers",info:"01000010 01100101 01100101 01110000 00100000 01100010 01101111 01101111 01110000 00101110",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1],punctuation:[!1]}},{name:"hexadecimal",info:"0x38 0x20 0x74 0x69 0x6D 0x65 0x73 0x20 0x6D 0x6F 0x72 0x65 0x20 0x62 0x6F 0x6F 0x70 0x21",properties:["ignoresLanguage","ignoresLayout","noLetters"],forcedConfig:{numbers:[!1]}},{name:"zipf",alias:"frequency",info:"Words are generated according to Zipf's law. (not all languages will produce Zipfy results, use with caution)",properties:["changesWordsFrequency"]},{name:"morse",info:"-.../././.--./ -.../---/---/.--./-.-.--/ ",properties:["ignoresLanguage","ignoresLayout","noLetters","nospace"]},{name:"crt",info:"Go back to the 1980s",properties:["noLigatures"]},{name:"backwards",info:"...sdrawkcab epyt ot yrt woN",properties:["noLigatures","conflictsWithSymmetricChars","wordOrder:reverse"]},{name:"ddoouubblleedd",info:"TTyyppee eevveerryytthhiinngg ttwwiiccee..",properties:["noLigatures"]},{name:"instant_messaging",info:"Who needs shift anyway?",properties:["changesCapitalisation"]}];function iq(){return rk}function ze(t){const e=[];for(const a of t.split("#")){const s=rk.find(n=>n.name===a);s&&e.push(s)}return e}function Et(t,e){const a=rk.find(s=>s.name===t);if(!a)throw new Error(`Funbox ${t} not found.`);a.functions=e}function rq(t){return t.normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function XT(t){return t.replace(/([A-Z])/g," $1").trim().toLowerCase()}function e1(t){try{return t.charAt(t.length-1)}catch{return""}}function Mx(t,e,a){return e>t.length-1?t:t.substring(0,e)+a+t.substring(e+1)}function Xm(t){return t.split(/ +/).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}function Yd(t){return t.charAt(0).toUpperCase()+t.slice(1)}function oq(t,e){const a=[];let s=[];const n=new Set(e);for(const i of t)n.has(i)?(s.length>0&&a.push(s.join("")),a.push(i),s=[]):s.push(i);return s.length>0&&a.push(s.join("")),a}function Ar(t,e=!1){let a="";return e?a=Rn(t):a=t,a.replace(/_/g," ")}function Rn(t){return t.replace(/_\d*k$/g,"")}function t1(t){const e={"“":'"',"”":'"',"„":'"',"’":"'","‘":"'",",":",","—":"-","…":"...","«":"<<","»":">>","–":"-"," ":" "," ":" "," ":" "};return t.replace(/[“”’‘—,…«»–\u2007\u202F\u00A0]/g,a=>e[a]||"")}function a1(t,e,a=!1){let s;e.length>t.length&&(s=e,e=t,t=s);let n=t.filter(function(i){return e.includes(i)});return a?[...new Set(n)]:n}function Qb(t,e,a){var s;if(ze(a).length===0)return{result:!0};if(t==="words"||t==="time")return e===0?(a==="nospace"&&console.log("break"),ze(a).filter(i=>{var r;return(r=i.properties)==null?void 0:r.includes("noInfiniteDuration")}).length>0?{result:!1,forcedConfigs:[t==="words"?10:15]}:{result:!0}):{result:!0};{const n={};for(const i of ze(a))if(i.forcedConfig)for(const r in i.forcedConfig)n[r]===void 0?n[r]=i.forcedConfig[r]:n[r]=a1(n[r],i.forcedConfig[r],!0);if(n[t]===void 0)return{result:!0};if(((s=n[t])==null?void 0:s.length)===0)throw new Error("No intersection of forced configs");return{result:(n[t]??[]).includes(e),forcedConfigs:n[t]}}}function Xo(t,e,a,s=!1){let n=0;if(t==="mode"){let i=[];i=i.concat(ze(a).filter(r=>{var d,u;return((d=r.forcedConfig)==null?void 0:d.mode)!==void 0&&!((u=r.forcedConfig)!=null&&u.mode.includes(e))})),e==="zen"&&(i=i.concat(ze(a).filter(r=>{var d,u,c,m,f,h,y,b,w,$,E;return((d=r.functions)==null?void 0:d.getWord)??((u=r.functions)==null?void 0:u.pullSection)??((c=r.functions)==null?void 0:c.alterText)??((m=r.functions)==null?void 0:m.withWords)??((f=r.properties)==null?void 0:f.includes("changesCapitalisation"))??((h=r.properties)==null?void 0:h.includes("nospace"))??((y=r.properties)==null?void 0:y.find(L=>L.startsWith("toPush:")))??((b=r.properties)==null?void 0:b.includes("changesWordsVisibility"))??((w=r.properties)==null?void 0:w.includes("speaks"))??(($=r.properties)==null?void 0:$.includes("changesLayout"))??((E=r.properties)==null?void 0:E.includes("changesWordsFrequency"))}))),(e==="quote"||e==="custom")&&(i=i.concat(ze(a).filter(r=>{var d,u,c,m;return((d=r.functions)==null?void 0:d.getWord)??((u=r.functions)==null?void 0:u.pullSection)??((c=r.functions)==null?void 0:c.withWords)??((m=r.properties)==null?void 0:m.includes("changesWordsFrequency"))}))),i.length>0&&(n+=1)}if(t==="words"||t==="time"){if(!Qb(t,e,a).result)if(s)n+=1;else return g("Active funboxes do not support infinite tests",0),!1}else Qb(t,e,a).result||(n+=1);return n>0?(s||g(`You can't set ${XT(t)} to ${e.toString()} with currently active funboxes.`,0,{duration:5}),!1):!0}function s1(t,e){console.log("cansetfunboxwithconfig",t,e.mode);let a=e.funbox;a==="none"?a=t:a+="#"+t;const s=[];for(const[n,i]of Object.entries(e))Xo(n,i,a,!0)||s.push({key:n,value:i});if(s.length>0){const n=[];for(const i of s)n.push(`${Yd(XT(i.key))} cannot be set to ${i.value.toString()}.`);return g(`You can't enable ${t.replace(/_/g," ")}:<br>${n.join("<br>")}`,0,{duration:5,allowHTML:!0}),!1}else return!0}function ok(t,e){if(e==="none"||t==="none")return!0;let a=ze(t);e!==void 0&&(a=a.concat(iq().filter(k=>k.name===e)));const s=ze(t).filter(k=>t.split("#").find(S=>S===k.name)!==void 0).length===t.split("#").length,n=a.filter(k=>{var S,z,Ee;return((S=k.functions)==null?void 0:S.getWord)??((z=k.functions)==null?void 0:z.pullSection)??((Ee=k.functions)==null?void 0:Ee.withWords)}).length<=1,i=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="changesLayout")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="ignoresLayout"||z==="usesLayout")}).length===0,r=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="nospace"||z.startsWith("toPush"))}).length<=1,d=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="changesWordsVisibility")}).length<=1,u=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="changesWordsFrequency")}).length<=1,c=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="changesWordsFrequency")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="ignoresLanguage")}).length===0,m=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="noLetters")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="changesCapitalisation")}).length===0,f=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="conflictsWithSymmetricChars")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="symmetricChars")}).length===0,h=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="speaks")}).length<=1,y=a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="speaks")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="speaks")}).length===1&&a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="unspeakable")}).length===0||a.filter(k=>{var S;return(S=k.properties)==null?void 0:S.find(z=>z==="ignoresLanguage")}).length===0,b=a.filter(k=>{var S,z;return(((S=k.properties)==null?void 0:S.find(Ee=>Ee.startsWith("toPush:")))??"")||((z=k.functions)==null?void 0:z.pullSection)}).length<=1,w=a.filter(k=>k.hasCSS==!0).length<=1,$=a.filter(k=>{var S;return(S=k.functions)==null?void 0:S.punctuateWord}).length<=1,E=a.filter(k=>{var S;return(S=k.functions)==null?void 0:S.isCharCorrect}).length<=1,L=a.filter(k=>{var S;return(S=k.functions)==null?void 0:S.getWordHtml}).length<=1,be={};let J=!0;for(const k of a)if(k.forcedConfig)for(const S in k.forcedConfig)if(be[S]){if(a1(be[S],k.forcedConfig[S],!0).length===0){J=!1;break}}else be[S]=k.forcedConfig[S];return s&&n&&i&&r&&d&&u&&c&&m&&f&&h&&y&&b&&w&&$&&E&&L&&J}var bt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(bt||(bt={}));var Yb;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Yb||(Yb={}));var ae=bt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ir=t=>{switch(typeof t){case"undefined":return ae.undefined;case"string":return ae.string;case"number":return isNaN(t)?ae.nan:ae.number;case"boolean":return ae.boolean;case"function":return ae.function;case"bigint":return ae.bigint;case"symbol":return ae.symbol;case"object":return Array.isArray(t)?ae.array:t===null?ae.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ae.promise:typeof Map<"u"&&t instanceof Map?ae.map:typeof Set<"u"&&t instanceof Set?ae.set:typeof Date<"u"&&t instanceof Date?ae.date:ae.object;default:return ae.unknown}},Z=bt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),dq=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),un=class n1 extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof n1))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,bt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};un.create=t=>new un(t);var Jd=(t,e)=>{let a;switch(t.code){case Z.invalid_type:t.received===ae.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case Z.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,bt.jsonStringifyReplacer)}`;break;case Z.unrecognized_keys:a=`Unrecognized key(s) in object: ${bt.joinValues(t.keys,", ")}`;break;case Z.invalid_union:a="Invalid input";break;case Z.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${bt.joinValues(t.options)}`;break;case Z.invalid_enum_value:a=`Invalid enum value. Expected ${bt.joinValues(t.options)}, received '${t.received}'`;break;case Z.invalid_arguments:a="Invalid function arguments";break;case Z.invalid_return_type:a="Invalid function return type";break;case Z.invalid_date:a="Invalid date";break;case Z.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:bt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case Z.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case Z.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case Z.custom:a="Invalid input";break;case Z.invalid_intersection_types:a="Intersection results could not be merged";break;case Z.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case Z.not_finite:a="Number must be finite";break;default:a=e.defaultError,bt.assertNever(t)}return{message:a}},i1=Jd;function lq(t){i1=t}function gg(){return i1}var yg=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},uq=[];function K(t,e){let a=gg(),s=yg({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Jd?void 0:Jd].filter(n=>!!n)});t.common.issues.push(s)}var is=class r1{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Re;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return r1.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return Re;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},Re=Object.freeze({status:"aborted"}),vg=t=>({status:"dirty",value:t}),Ba=t=>({status:"valid",value:t}),Jb=t=>t.status==="aborted",Xb=t=>t.status==="dirty",Bc=t=>t.status==="valid",qc=t=>typeof Promise<"u"&&t instanceof Promise;function bg(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function o1(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var pe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(pe||(pe={}));var gu,yu,ai=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Lx=(t,e)=>{if(Bc(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new un(t.common.issues);return this._error=a,this._error}}};function Ve(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var tt=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return ir(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:ir(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new is,ctx:{common:e.parent.common,data:e.data,parsedType:ir(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(qc(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ir(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Lx(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:ir(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(qc(n)?n:Promise.resolve(n));return Lx(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:Z.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new wn({schema:this,typeName:Te.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Vn.create(this,this._def)}nullable(){return Lr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return No.create(this,this._def)}promise(){return tl.create(this,this._def)}or(e){return Vc.create([this,e],this._def)}and(e){return Gc.create(this,e,this._def)}transform(e){return new wn({...Ve(this._def),schema:this,typeName:Te.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new Xc({...Ve(this._def),innerType:this,defaultValue:a,typeName:Te.ZodDefault})}brand(){return new dk({typeName:Te.ZodBranded,type:this,...Ve(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new ep({...Ve(this._def),innerType:this,catchValue:a,typeName:Te.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return lk.create(this,e)}readonly(){return tp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},cq=/^c[^\s-]{8,}$/i,pq=/^[0-9a-z]+$/,mq=/^[0-9A-HJKMNP-TV-Z]{26}$/,fq=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,hq=/^[a-z0-9_-]{21}$/i,gq=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,yq=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,vq="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Fv,bq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,wq=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,kq=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,d1="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_q=new RegExp(`^${d1}$`);function l1(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function xq(t){return new RegExp(`^${l1(t)}$`)}function u1(t){let e=`${d1}T${l1(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function Cq(t,e){return!!((e==="v4"||!e)&&bq.test(t)||(e==="v6"||!e)&&wq.test(t))}var Xd=class vu extends tt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ae.string){let n=this._getOrReturnCtx(e);return K(n,{code:Z.invalid_type,expected:ae.string,received:n.parsedType}),Re}let a=new is,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:Z.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:Z.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?K(s,{code:Z.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&K(s,{code:Z.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")yq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"email",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Fv||(Fv=new RegExp(vq,"u")),Fv.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"emoji",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")fq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"uuid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")hq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"nanoid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")cq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"cuid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")pq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"cuid2",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")mq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"ulid",code:Z.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),K(s,{validation:"url",code:Z.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"regex",code:Z.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?u1(n).test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?_q.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?xq(n).test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{code:Z.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?gq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"duration",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?Cq(e.data,n.version)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"ip",code:Z.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?kq.test(e.data)||(s=this._getOrReturnCtx(e,s),K(s,{validation:"base64",code:Z.invalid_string,message:n.message}),a.dirty()):bt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:Z.invalid_string,...pe.errToObj(s)})}_addCheck(e){return new vu({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...pe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...pe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...pe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...pe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...pe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...pe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...pe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...pe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...pe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...pe.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...pe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...pe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...pe.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...pe.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...pe.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...pe.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...pe.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...pe.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...pe.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...pe.errToObj(a)})}nonempty(e){return this.min(1,pe.errToObj(e))}trim(){return new vu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new vu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new vu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Xd.create=t=>{var e;return new Xd({checks:[],typeName:Te.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ve(t)})};function Sq(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var Wc=class ew extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ae.number){let n=this._getOrReturnCtx(e);return K(n,{code:Z.invalid_type,expected:ae.number,received:n.parsedType}),Re}let a,s=new is;for(let n of this._def.checks)n.kind==="int"?bt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),K(a,{code:Z.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?Sq(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),K(a,{code:Z.not_finite,message:n.message}),s.dirty()):bt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,pe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,pe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,pe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,pe.toString(a))}setLimit(e,a,s,n){return new ew({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:pe.toString(n)}]})}_addCheck(e){return new ew({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:pe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:pe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:pe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:pe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:pe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:pe.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:pe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:pe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:pe.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&bt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Wc.create=t=>new Wc({checks:[],typeName:Te.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ve(t)});var Fc=class tw extends tt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ae.bigint){let n=this._getOrReturnCtx(e);return K(n,{code:Z.invalid_type,expected:ae.bigint,received:n.parsedType}),Re}let a,s=new is;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),K(a,{code:Z.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):bt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,pe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,pe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,pe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,pe.toString(a))}setLimit(e,a,s,n){return new tw({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:pe.toString(n)}]})}_addCheck(e){return new tw({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:pe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:pe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:pe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:pe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:pe.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Fc.create=t=>{var e;return new Fc({checks:[],typeName:Te.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ve(t)})};var zc=class extends tt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ae.boolean){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.boolean,received:a.parsedType}),Re}return Ba(e.data)}};zc.create=t=>new zc({typeName:Te.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ve(t)});var Hc=class c1 extends tt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ae.date){let n=this._getOrReturnCtx(e);return K(n,{code:Z.invalid_type,expected:ae.date,received:n.parsedType}),Re}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return K(n,{code:Z.invalid_date}),Re}let a=new is,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:Z.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),K(s,{code:Z.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):bt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new c1({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:pe.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:pe.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Hc.create=t=>new Hc({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Te.ZodDate,...Ve(t)});var wg=class extends tt{_parse(e){if(this._getType(e)!==ae.symbol){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.symbol,received:a.parsedType}),Re}return Ba(e.data)}};wg.create=t=>new wg({typeName:Te.ZodSymbol,...Ve(t)});var Uc=class extends tt{_parse(e){if(this._getType(e)!==ae.undefined){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.undefined,received:a.parsedType}),Re}return Ba(e.data)}};Uc.create=t=>new Uc({typeName:Te.ZodUndefined,...Ve(t)});var Kc=class extends tt{_parse(e){if(this._getType(e)!==ae.null){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.null,received:a.parsedType}),Re}return Ba(e.data)}};Kc.create=t=>new Kc({typeName:Te.ZodNull,...Ve(t)});var el=class extends tt{constructor(){super(...arguments),this._any=!0}_parse(e){return Ba(e.data)}};el.create=t=>new el({typeName:Te.ZodAny,...Ve(t)});var ho=class extends tt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ba(e.data)}};ho.create=t=>new ho({typeName:Te.ZodUnknown,...Ve(t)});var Li=class extends tt{_parse(e){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.never,received:a.parsedType}),Re}};Li.create=t=>new Li({typeName:Te.ZodNever,...Ve(t)});var kg=class extends tt{_parse(e){if(this._getType(e)!==ae.undefined){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.void,received:a.parsedType}),Re}return Ba(e.data)}};kg.create=t=>new kg({typeName:Te.ZodVoid,...Ve(t)});var No=class bh extends tt{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==ae.array)return K(a,{code:Z.invalid_type,expected:ae.array,received:a.parsedType}),Re;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(K(a,{code:r?Z.too_big:Z.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(K(a,{code:Z.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(K(a,{code:Z.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new ai(a,r,a.path,d)))).then(r=>is.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new ai(a,r,a.path,d)));return is.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new bh({...this._def,minLength:{value:e,message:pe.toString(a)}})}max(e,a){return new bh({...this._def,maxLength:{value:e,message:pe.toString(a)}})}length(e,a){return new bh({...this._def,exactLength:{value:e,message:pe.toString(a)}})}nonempty(e){return this.min(1,e)}};No.create=(t,e)=>new No({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Te.ZodArray,...Ve(e)});function vd(t){if(t instanceof Bs){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Vn.create(vd(s))}return new Bs({...t._def,shape:()=>e})}else return t instanceof No?new No({...t._def,type:vd(t.element)}):t instanceof Vn?Vn.create(vd(t.unwrap())):t instanceof Lr?Lr.create(vd(t.unwrap())):t instanceof Mr?Mr.create(t.items.map(e=>vd(e))):t}var Bs=class Qs extends tt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=bt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==ae.object){let u=this._getOrReturnCtx(e);return K(u,{code:Z.invalid_type,expected:ae.object,received:u.parsedType}),Re}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof Li&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new ai(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Li){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(K(s,{code:Z.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new ai(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>is.mergeObjectSync(a,u)):is.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return pe.errToObj,new Qs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=pe.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Qs({...this._def,unknownKeys:"strip"})}passthrough(){return new Qs({...this._def,unknownKeys:"passthrough"})}extend(e){return new Qs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Qs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Te.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Qs({...this._def,catchall:e})}pick(e){let a={};return bt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Qs({...this._def,shape:()=>a})}omit(e){let a={};return bt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Qs({...this._def,shape:()=>a})}deepPartial(){return vd(this)}partial(e){let a={};return bt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Qs({...this._def,shape:()=>a})}required(e){let a={};return bt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Vn;)n=n._def.innerType;a[s]=n}}),new Qs({...this._def,shape:()=>a})}keyof(){return y1(bt.objectKeys(this.shape))}};Bs.create=(t,e)=>new Bs({shape:()=>t,unknownKeys:"strip",catchall:Li.create(),typeName:Te.ZodObject,...Ve(e)});Bs.strictCreate=(t,e)=>new Bs({shape:()=>t,unknownKeys:"strict",catchall:Li.create(),typeName:Te.ZodObject,...Ve(e)});Bs.lazycreate=(t,e)=>new Bs({shape:t,unknownKeys:"strip",catchall:Li.create(),typeName:Te.ZodObject,...Ve(e)});var Vc=class extends tt{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new un(d.ctx.common.issues));return K(a,{code:Z.invalid_union,unionErrors:r}),Re}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new un(u));return K(a,{code:Z.invalid_union,unionErrors:d}),Re}}get options(){return this._def.options}};Vc.create=(t,e)=>new Vc({options:t,typeName:Te.ZodUnion,...Ve(e)});var Gi=t=>t instanceof Qc?Gi(t.schema):t instanceof wn?Gi(t.innerType()):t instanceof Yc?[t.value]:t instanceof ef?t.options:t instanceof Jc?bt.objectValues(t.enum):t instanceof Xc?Gi(t._def.innerType):t instanceof Uc?[void 0]:t instanceof Kc?[null]:t instanceof Vn?[void 0,...Gi(t.unwrap())]:t instanceof Lr?[null,...Gi(t.unwrap())]:t instanceof dk||t instanceof tp?Gi(t.unwrap()):t instanceof ep?Gi(t._def.innerType):[],p1=class m1 extends tt{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ae.object)return K(a,{code:Z.invalid_type,expected:ae.object,received:a.parsedType}),Re;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(K(a,{code:Z.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Re)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Gi(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new m1({typeName:Te.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ve(s)})}};function aw(t,e){let a=ir(t),s=ir(e);if(t===e)return{valid:!0,data:t};if(a===ae.object&&s===ae.object){let n=bt.objectKeys(e),i=bt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=aw(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===ae.array&&s===ae.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=aw(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===ae.date&&s===ae.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Gc=class extends tt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(Jb(i)||Jb(r))return Re;let d=aw(i.value,r.value);return d.valid?((Xb(i)||Xb(r))&&a.dirty(),{status:a.value,value:d.data}):(K(s,{code:Z.invalid_intersection_types}),Re)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};Gc.create=(t,e,a)=>new Gc({left:t,right:e,typeName:Te.ZodIntersection,...Ve(a)});var Mr=class f1 extends tt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ae.array)return K(s,{code:Z.invalid_type,expected:ae.array,received:s.parsedType}),Re;if(s.data.length<this._def.items.length)return K(s,{code:Z.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Re;!this._def.rest&&s.data.length>this._def.items.length&&(K(s,{code:Z.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new ai(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>is.mergeArray(a,i)):is.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new f1({...this._def,rest:e})}};Mr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Mr({items:t,typeName:Te.ZodTuple,rest:null,...Ve(e)})};var h1=class sw extends tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ae.object)return K(s,{code:Z.invalid_type,expected:ae.object,received:s.parsedType}),Re;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new ai(s,d,s.path,d)),value:r._parse(new ai(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?is.mergeObjectAsync(a,n):is.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof tt?new sw({keyType:e,valueType:a,typeName:Te.ZodRecord,...Ve(s)}):new sw({keyType:Xd.create(),valueType:e,typeName:Te.ZodRecord,...Ve(a)})}},_g=class extends tt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ae.map)return K(s,{code:Z.invalid_type,expected:ae.map,received:s.parsedType}),Re;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new ai(s,d,s.path,[c,"key"])),value:i._parse(new ai(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return Re;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return Re;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};_g.create=(t,e,a)=>new _g({valueType:e,keyType:t,typeName:Te.ZodMap,...Ve(a)});var xg=class nw extends tt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ae.set)return K(s,{code:Z.invalid_type,expected:ae.set,received:s.parsedType}),Re;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(K(s,{code:Z.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(K(s,{code:Z.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return Re;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new ai(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new nw({...this._def,minSize:{value:e,message:pe.toString(a)}})}max(e,a){return new nw({...this._def,maxSize:{value:e,message:pe.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};xg.create=(t,e)=>new xg({valueType:t,minSize:null,maxSize:null,typeName:Te.ZodSet,...Ve(e)});var g1=class wh extends tt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ae.function)return K(a,{code:Z.invalid_type,expected:ae.function,received:a.parsedType}),Re;function s(d,u){return yg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,gg(),Jd].filter(c=>!!c),issueData:{code:Z.invalid_arguments,argumentsError:u}})}function n(d,u){return yg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,gg(),Jd].filter(c=>!!c),issueData:{code:Z.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof tl){let d=this;return Ba(async function(...u){let c=new un([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return Ba(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new un([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new un([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new wh({...this._def,args:Mr.create(e).rest(ho.create())})}returns(e){return new wh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new wh({args:e||Mr.create([]).rest(ho.create()),returns:a||ho.create(),typeName:Te.ZodFunction,...Ve(s)})}},Qc=class extends tt{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Qc.create=(t,e)=>new Qc({getter:t,typeName:Te.ZodLazy,...Ve(e)});var Yc=class extends tt{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return K(a,{received:a.data,code:Z.invalid_literal,expected:this._def.value}),Re}return{status:"valid",value:e.data}}get value(){return this._def.value}};Yc.create=(t,e)=>new Yc({value:t,typeName:Te.ZodLiteral,...Ve(e)});function y1(t,e){return new ef({values:t,typeName:Te.ZodEnum,...Ve(e)})}var ef=class iw extends tt{constructor(){super(...arguments),gu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return K(a,{expected:bt.joinValues(s),received:a.parsedType,code:Z.invalid_type}),Re}if(bg(this,gu)||o1(this,gu,new Set(this._def.values)),!bg(this,gu).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return K(a,{received:a.data,code:Z.invalid_enum_value,options:s}),Re}return Ba(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return iw.create(e,{...this._def,...a})}exclude(e,a=this._def){return iw.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};gu=new WeakMap;ef.create=y1;var Jc=class extends tt{constructor(){super(...arguments),yu.set(this,void 0)}_parse(e){let a=bt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ae.string&&s.parsedType!==ae.number){let n=bt.objectValues(a);return K(s,{expected:bt.joinValues(n),received:s.parsedType,code:Z.invalid_type}),Re}if(bg(this,yu)||o1(this,yu,new Set(bt.getValidEnumValues(this._def.values))),!bg(this,yu).has(e.data)){let n=bt.objectValues(a);return K(s,{received:s.data,code:Z.invalid_enum_value,options:n}),Re}return Ba(e.data)}get enum(){return this._def.values}};yu=new WeakMap;Jc.create=(t,e)=>new Jc({values:t,typeName:Te.ZodNativeEnum,...Ve(e)});var tl=class extends tt{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ae.promise&&a.common.async===!1)return K(a,{code:Z.invalid_type,expected:ae.promise,received:a.parsedType}),Re;let s=a.parsedType===ae.promise?a.data:Promise.resolve(a.data);return Ba(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};tl.create=(t,e)=>new tl({type:t,typeName:Te.ZodPromise,...Ve(e)});var wn=class extends tt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{K(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return Re;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?Re:u.status==="dirty"||a.value==="dirty"?vg(u.value):u});{if(a.value==="aborted")return Re;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?Re:d.status==="dirty"||a.value==="dirty"?vg(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?Re:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?Re:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Bc(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>Bc(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);bt.assertNever(n)}};wn.create=(t,e,a)=>new wn({schema:t,typeName:Te.ZodEffects,effect:e,...Ve(a)});wn.createWithPreprocess=(t,e,a)=>new wn({schema:e,effect:{type:"preprocess",transform:t},typeName:Te.ZodEffects,...Ve(a)});var Vn=class extends tt{_parse(e){return this._getType(e)===ae.undefined?Ba(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Vn.create=(t,e)=>new Vn({innerType:t,typeName:Te.ZodOptional,...Ve(e)});var Lr=class extends tt{_parse(e){return this._getType(e)===ae.null?Ba(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Lr.create=(t,e)=>new Lr({innerType:t,typeName:Te.ZodNullable,...Ve(e)});var Xc=class extends tt{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===ae.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};Xc.create=(t,e)=>new Xc({innerType:t,typeName:Te.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ve(e)});var ep=class extends tt{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return qc(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new un(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new un(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};ep.create=(t,e)=>new ep({innerType:t,typeName:Te.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ve(e)});var Cg=class extends tt{_parse(e){if(this._getType(e)!==ae.nan){let a=this._getOrReturnCtx(e);return K(a,{code:Z.invalid_type,expected:ae.nan,received:a.parsedType}),Re}return{status:"valid",value:e.data}}};Cg.create=t=>new Cg({typeName:Te.ZodNaN,...Ve(t)});var Tq=Symbol("zod_brand"),dk=class extends tt{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},lk=class v1 extends tt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Re:n.status==="dirty"?(a.dirty(),vg(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Re:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new v1({in:e,out:a,typeName:Te.ZodPipeline})}},tp=class extends tt{_parse(e){let a=this._def.innerType._parse(e),s=n=>(Bc(n)&&(n.value=Object.freeze(n.value)),n);return qc(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};tp.create=(t,e)=>new tp({innerType:t,typeName:Te.ZodReadonly,...Ve(e)});function b1(t,e={},a){return t?el.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):el.create()}var $q={object:Bs.lazycreate},Te;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Te||(Te={}));var Aq=(t,e={message:`Input not instance of ${t.name}`})=>b1(a=>a instanceof t,e),w1=Xd.create,k1=Wc.create,Mq=Cg.create,Lq=Fc.create,_1=zc.create,Eq=Hc.create,Iq=wg.create,Oq=Uc.create,Pq=Kc.create,Zq=el.create,Rq=ho.create,Nq=Li.create,Dq=kg.create,jq=No.create,Bq=Bs.create,qq=Bs.strictCreate,Wq=Vc.create,Fq=p1.create,zq=Gc.create,Hq=Mr.create,Uq=h1.create,Kq=_g.create,Vq=xg.create,Gq=g1.create,Qq=Qc.create,rw=Yc.create,Yq=ef.create,Jq=Jc.create,Xq=tl.create,Ex=wn.create,eW=Vn.create,tW=Lr.create,aW=wn.createWithPreprocess,sW=lk.create,nW=()=>w1().optional(),iW=()=>k1().optional(),rW=()=>_1().optional(),oW={string:t=>Xd.create({...t,coerce:!0}),number:t=>Wc.create({...t,coerce:!0}),boolean:t=>zc.create({...t,coerce:!0}),bigint:t=>Fc.create({...t,coerce:!0}),date:t=>Hc.create({...t,coerce:!0})},dW=Re,C=Object.freeze({__proto__:null,defaultErrorMap:Jd,setErrorMap:lq,getErrorMap:gg,makeIssue:yg,EMPTY_PATH:uq,addIssueToContext:K,ParseStatus:is,INVALID:Re,DIRTY:vg,OK:Ba,isAborted:Jb,isDirty:Xb,isValid:Bc,isAsync:qc,get util(){return bt},get objectUtil(){return Yb},ZodParsedType:ae,getParsedType:ir,ZodType:tt,datetimeRegex:u1,ZodString:Xd,ZodNumber:Wc,ZodBigInt:Fc,ZodBoolean:zc,ZodDate:Hc,ZodSymbol:wg,ZodUndefined:Uc,ZodNull:Kc,ZodAny:el,ZodUnknown:ho,ZodNever:Li,ZodVoid:kg,ZodArray:No,ZodObject:Bs,ZodUnion:Vc,ZodDiscriminatedUnion:p1,ZodIntersection:Gc,ZodTuple:Mr,ZodRecord:h1,ZodMap:_g,ZodSet:xg,ZodFunction:g1,ZodLazy:Qc,ZodLiteral:Yc,ZodEnum:ef,ZodNativeEnum:Jc,ZodPromise:tl,ZodEffects:wn,ZodTransformer:wn,ZodOptional:Vn,ZodNullable:Lr,ZodDefault:Xc,ZodCatch:ep,ZodNaN:Cg,BRAND:Tq,ZodBranded:dk,ZodPipeline:lk,ZodReadonly:tp,custom:b1,Schema:tt,ZodSchema:tt,late:$q,get ZodFirstPartyTypeKind(){return Te},coerce:oW,any:Zq,array:jq,bigint:Lq,boolean:_1,date:Eq,discriminatedUnion:Fq,effect:Ex,enum:Yq,function:Gq,instanceof:Aq,intersection:zq,lazy:Qq,literal:rw,map:Kq,nan:Mq,nativeEnum:Jq,never:Nq,null:Pq,nullable:tW,number:k1,object:Bq,oboolean:rW,onumber:iW,optional:eW,ostring:nW,pipeline:sW,preprocess:aW,promise:Xq,record:Uq,set:Vq,strictObject:qq,string:w1,symbol:Iq,transformer:Ex,tuple:Hq,undefined:Oq,union:Wq,unknown:Rq,void:Dq,NEVER:dW,ZodIssueCode:Z,quotelessJson:dq,ZodError:un}),kh=C.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(C.number().transform(String)),tf=()=>C.string().regex(/^[a-zA-Z0-9_]+$/);tf();tf().max(50);var lW=C.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");C.string().nullable().optional().transform(t=>t??void 0);C.number().nonnegative().max(100);C.number().nonnegative().max(420);C.enum(["repeat","random","shuffle"]);C.enum(["word","time","section"]);var x1=C.enum(["normal","expert","master"]),Ql=C.object({acc:C.number().nonnegative().max(100),consistency:C.number().nonnegative().max(100),difficulty:x1,lazyMode:C.boolean().optional(),language:C.string().max(100).regex(/[\w+]+/),punctuation:C.boolean().optional(),numbers:C.boolean().optional(),raw:C.number().nonnegative(),wpm:C.number().nonnegative(),timestamp:C.number().nonnegative()}),uW=C.object({time:C.record(kh.describe("Number of seconds as string"),C.array(Ql)),words:C.record(kh.describe("Number of words as string"),C.array(Ql)),quote:C.record(kh,C.array(Ql)),custom:C.record(C.literal("custom"),C.array(Ql)),zen:C.record(C.literal("zen"),C.array(Ql))});C.union([C.literal("10"),C.literal("25"),C.literal("50"),C.literal("100")]);C.union([C.literal("15"),C.literal("30"),C.literal("60"),C.literal("120")]);C.union([C.literal("short"),C.literal("medium"),C.literal("long"),C.literal("thicc")]);var cW=uW.keyof();C.union([kh,rw("zen"),rw("custom")],{errorMap:()=>({message:'Needs to be either a number, "zen" or "custom".'})});var C1=C.enum(["off","slow","medium","fast"]),S1=C.enum(["off","esc","tab","enter"]),T1=C.union([C.literal(-3),C.literal(-2),C.literal(-1),C.literal(0),C.literal(1),C.literal(2),C.literal(3)]),$1=C.array(T1),Sg=C.enum(["off","default","block","outline","underline","carrot","banana"]),A1=C.enum(["off","on","max"]),M1=C.enum(["off","below","replace"]),L1=C.enum(["off","bar","text","mini"]),Od=C.enum(["off","text","mini"]),E1=C.enum(["off","on","fav","light","dark","custom"]),I1=C.enum(["black","sub","text","main"]),O1=C.enum(["0.25","0.5","0.75","1"]),P1=C.enum(["off","word","letter"]),Z1=C.enum(["off","static","react","next"]),R1=C.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),N1=C.enum(["lowercase","uppercase","blank","dynamic"]),D1=C.enum(["always","layout","never"]),j1=C.number().min(.5).max(3.5).step(.1),B1=C.enum(["manual","on"]),q1=C.enum(["off","1","2","3","4"]),W1=C.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),F1=C.number().min(0).max(1),z1=C.enum(["off","average","pb","tagPb","last","custom","daily"]),H1=C.tuple([C.enum(["on","off"]),C.enum(["on","off"]),C.enum(["on","off"]),C.enum(["on","off"])]),U1=C.enum(["off","custom"]),K1=C.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),V1=C.enum(["off","letter","word"]),G1=C.enum(["wpm","cpm","wps","cps","wph"]),Q1=C.enum(["off","result","on","sellout"]),Y1=C.enum(["off","custom"]),J1=C.enum(["off","typing"]),X1=C.enum(["off","on","keymap"]),uk=C.enum(["cover","contain","max"]),ck=C.tuple([C.number(),C.number(),C.number(),C.number()]),pW=C.string().regex(/^[0-9a-zA-Z_#]+$/),e$=C.enum(["off","1","2","3","4"]),t$=C.enum(["off","fixed","flex"]),a$=C.enum(["off","speed","acc","both"]),Mn=C.string().regex(/^#([\da-f]{3}){1,2}$/i),s$=x1,pk=C.tuple([Mn,Mn,Mn,Mn,Mn,Mn,Mn,Mn,Mn,Mn]),n$=C.array(tf().max(50)),mk=C.string().max(100).regex(/[\w#]+/),i$=C.number().nonnegative(),r$=C.number().nonnegative(),o$=C.number().nonnegative().max(100),d$=C.number().nonnegative(),l$=C.number().int().nonnegative(),u$=C.number().int().nonnegative(),c$=C.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),go=tf().max(50),p$=C.string().max(50).regex(/[\w\-_]+/),m$=tf().max(50),f$=C.number().positive(),h$=C.number().min(20).max(1e3).or(C.literal(0)),g$=C.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(C.literal("")),y$=C.object({theme:go,themeLight:go,themeDark:go,autoSwitchTheme:C.boolean(),customTheme:C.boolean(),customThemeColors:pk,favThemes:n$,showKeyTips:C.boolean(),smoothCaret:C1,quickRestart:S1,punctuation:C.boolean(),numbers:C.boolean(),words:u$,time:l$,mode:cW,quoteLength:$1,language:lW,fontSize:f$,freedomMode:C.boolean(),difficulty:s$,blindMode:C.boolean(),quickEnd:C.boolean(),caretStyle:Sg,paceCaretStyle:Sg,flipTestColors:C.boolean(),layout:m$,funbox:mk,confidenceMode:A1,indicateTypos:M1,timerStyle:L1,liveSpeedStyle:Od,liveAccStyle:Od,liveBurstStyle:Od,colorfulMode:C.boolean(),randomTheme:E1,timerColor:I1,timerOpacity:O1,stopOnError:P1,showAllLines:C.boolean(),keymapMode:Z1,keymapStyle:R1,keymapLegendStyle:N1,keymapLayout:p$,keymapShowTopRow:D1,keymapSize:j1,fontFamily:c$,smoothLineScroll:C.boolean(),alwaysShowDecimalPlaces:C.boolean(),alwaysShowWordsHistory:C.boolean(),singleListCommandLine:B1,capsLockWarning:C.boolean(),playSoundOnError:q1,playSoundOnClick:W1,soundVolume:F1,startGraphsAtZero:C.boolean(),showOutOfFocusWarning:C.boolean(),paceCaret:z1,paceCaretCustomSpeed:i$,repeatedPace:C.boolean(),accountChart:H1,minWpm:U1,minWpmCustomSpeed:r$,highlightMode:K1,tapeMode:V1,typingSpeedUnit:G1,ads:Q1,hideExtraLetters:C.boolean(),strictSpace:C.boolean(),minAcc:Y1,minAccCustom:o$,monkey:C.boolean(),repeatQuotes:J1,oppositeShiftMode:X1,customBackground:g$,customBackgroundSize:uk,customBackgroundFilter:ck,customLayoutfluid:pW,monkeyPowerLevel:e$,minBurst:t$,minBurstCustomSpeed:d$,burstHeatmap:C.boolean(),britishEnglish:C.boolean(),lazyMode:C.boolean(),showAverage:a$,maxLineWidth:h$}).strict(),mW=y$.partial(),wt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(wt||(wt={}));var ow;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(ow||(ow={}));var se=wt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),rr=t=>{switch(typeof t){case"undefined":return se.undefined;case"string":return se.string;case"number":return isNaN(t)?se.nan:se.number;case"boolean":return se.boolean;case"function":return se.function;case"bigint":return se.bigint;case"symbol":return se.symbol;case"object":return Array.isArray(t)?se.array:t===null?se.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?se.promise:typeof Map<"u"&&t instanceof Map?se.map:typeof Set<"u"&&t instanceof Set?se.set:typeof Date<"u"&&t instanceof Date?se.date:se.object;default:return se.unknown}},R=wt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),fW=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),cn=class v$ extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof v$))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,wt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};cn.create=t=>new cn(t);var al=(t,e)=>{let a;switch(t.code){case R.invalid_type:t.received===se.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case R.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,wt.jsonStringifyReplacer)}`;break;case R.unrecognized_keys:a=`Unrecognized key(s) in object: ${wt.joinValues(t.keys,", ")}`;break;case R.invalid_union:a="Invalid input";break;case R.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${wt.joinValues(t.options)}`;break;case R.invalid_enum_value:a=`Invalid enum value. Expected ${wt.joinValues(t.options)}, received '${t.received}'`;break;case R.invalid_arguments:a="Invalid function arguments";break;case R.invalid_return_type:a="Invalid function return type";break;case R.invalid_date:a="Invalid date";break;case R.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:wt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case R.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case R.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case R.custom:a="Invalid input";break;case R.invalid_intersection_types:a="Intersection results could not be merged";break;case R.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case R.not_finite:a="Number must be finite";break;default:a=e.defaultError,wt.assertNever(t)}return{message:a}},b$=al;function hW(t){b$=t}function Tg(){return b$}var $g=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},gW=[];function V(t,e){let a=Tg(),s=$g({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===al?void 0:al].filter(n=>!!n)});t.common.issues.push(s)}var rs=class w${constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Ne;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return w$.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return Ne;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},Ne=Object.freeze({status:"aborted"}),Ag=t=>({status:"dirty",value:t}),qa=t=>({status:"valid",value:t}),dw=t=>t.status==="aborted",lw=t=>t.status==="dirty",ap=t=>t.status==="valid",sp=t=>typeof Promise<"u"&&t instanceof Promise;function Mg(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function k$(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var me;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(me||(me={}));var bu,wu,si=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Ix=(t,e)=>{if(ap(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new cn(t.common.issues);return this._error=a,this._error}}};function Ge(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var at=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return rr(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new rs,ctx:{common:e.parent.common,data:e.data,parsedType:rr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(sp(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rr(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Ix(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:rr(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(sp(n)?n:Promise.resolve(n));return Ix(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:R.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new kn({schema:this,typeName:$e.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Gn.create(this,this._def)}nullable(){return Ir.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Do.create(this,this._def)}promise(){return il.create(this,this._def)}or(e){return up.create([this,e],this._def)}and(e){return cp.create(this,e,this._def)}transform(e){return new kn({...Ge(this._def),schema:this,typeName:$e.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new hp({...Ge(this._def),innerType:this,defaultValue:a,typeName:$e.ZodDefault})}brand(){return new fk({typeName:$e.ZodBranded,type:this,...Ge(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new gp({...Ge(this._def),innerType:this,catchValue:a,typeName:$e.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return hk.create(this,e)}readonly(){return yp.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},yW=/^c[^\s-]{8,}$/i,vW=/^[0-9a-z]+$/,bW=/^[0-9A-HJKMNP-TV-Z]{26}$/,wW=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,kW=/^[a-z0-9_-]{21}$/i,_W=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,xW=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,CW="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",zv,SW=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,TW=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,$W=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,_$="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",AW=new RegExp(`^${_$}$`);function x$(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function MW(t){return new RegExp(`^${x$(t)}$`)}function C$(t){let e=`${_$}T${x$(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function LW(t,e){return!!((e==="v4"||!e)&&SW.test(t)||(e==="v6"||!e)&&TW.test(t))}var sl=class ku extends at{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==se.string){let n=this._getOrReturnCtx(e);return V(n,{code:R.invalid_type,expected:se.string,received:n.parsedType}),Ne}let a=new rs,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:R.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:R.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?V(s,{code:R.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&V(s,{code:R.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")xW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"email",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")zv||(zv=new RegExp(CW,"u")),zv.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"emoji",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")wW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"uuid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")kW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"nanoid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")yW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")vW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid2",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")bW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ulid",code:R.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),V(s,{validation:"url",code:R.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"regex",code:R.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?C$(n).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?AW.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?MW(n).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:R.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?_W.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"duration",code:R.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?LW(e.data,n.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ip",code:R.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?$W.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64",code:R.invalid_string,message:n.message}),a.dirty()):wt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:R.invalid_string,...me.errToObj(s)})}_addCheck(e){return new ku({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...me.errToObj(e)})}url(e){return this._addCheck({kind:"url",...me.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...me.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...me.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...me.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...me.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...me.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...me.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...me.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...me.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...me.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...me.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...me.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...me.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...me.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...me.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...me.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...me.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...me.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...me.errToObj(a)})}nonempty(e){return this.min(1,me.errToObj(e))}trim(){return new ku({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ku({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ku({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};sl.create=t=>{var e;return new sl({checks:[],typeName:$e.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ge(t)})};function EW(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var np=class uw extends at{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==se.number){let n=this._getOrReturnCtx(e);return V(n,{code:R.invalid_type,expected:se.number,received:n.parsedType}),Ne}let a,s=new rs;for(let n of this._def.checks)n.kind==="int"?wt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{code:R.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?EW(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{code:R.not_finite,message:n.message}),s.dirty()):wt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,me.toString(a))}gt(e,a){return this.setLimit("min",e,!1,me.toString(a))}lte(e,a){return this.setLimit("max",e,!0,me.toString(a))}lt(e,a){return this.setLimit("max",e,!1,me.toString(a))}setLimit(e,a,s,n){return new uw({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:me.toString(n)}]})}_addCheck(e){return new uw({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:me.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:me.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:me.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:me.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:me.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&wt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};np.create=t=>new np({checks:[],typeName:$e.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ge(t)});var ip=class cw extends at{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==se.bigint){let n=this._getOrReturnCtx(e);return V(n,{code:R.invalid_type,expected:se.bigint,received:n.parsedType}),Ne}let a,s=new rs;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),V(a,{code:R.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):wt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,me.toString(a))}gt(e,a){return this.setLimit("min",e,!1,me.toString(a))}lte(e,a){return this.setLimit("max",e,!0,me.toString(a))}lt(e,a){return this.setLimit("max",e,!1,me.toString(a))}setLimit(e,a,s,n){return new cw({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:me.toString(n)}]})}_addCheck(e){return new cw({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:me.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:me.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:me.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:me.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:me.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};ip.create=t=>{var e;return new ip({checks:[],typeName:$e.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ge(t)})};var rp=class extends at{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==se.boolean){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.boolean,received:a.parsedType}),Ne}return qa(e.data)}};rp.create=t=>new rp({typeName:$e.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ge(t)});var op=class S$ extends at{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==se.date){let n=this._getOrReturnCtx(e);return V(n,{code:R.invalid_type,expected:se.date,received:n.parsedType}),Ne}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return V(n,{code:R.invalid_date}),Ne}let a=new rs,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:R.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:R.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):wt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new S$({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:me.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:me.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};op.create=t=>new op({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:$e.ZodDate,...Ge(t)});var Lg=class extends at{_parse(e){if(this._getType(e)!==se.symbol){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.symbol,received:a.parsedType}),Ne}return qa(e.data)}};Lg.create=t=>new Lg({typeName:$e.ZodSymbol,...Ge(t)});var dp=class extends at{_parse(e){if(this._getType(e)!==se.undefined){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.undefined,received:a.parsedType}),Ne}return qa(e.data)}};dp.create=t=>new dp({typeName:$e.ZodUndefined,...Ge(t)});var lp=class extends at{_parse(e){if(this._getType(e)!==se.null){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.null,received:a.parsedType}),Ne}return qa(e.data)}};lp.create=t=>new lp({typeName:$e.ZodNull,...Ge(t)});var nl=class extends at{constructor(){super(...arguments),this._any=!0}_parse(e){return qa(e.data)}};nl.create=t=>new nl({typeName:$e.ZodAny,...Ge(t)});var yo=class extends at{constructor(){super(...arguments),this._unknown=!0}_parse(e){return qa(e.data)}};yo.create=t=>new yo({typeName:$e.ZodUnknown,...Ge(t)});var Ei=class extends at{_parse(e){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.never,received:a.parsedType}),Ne}};Ei.create=t=>new Ei({typeName:$e.ZodNever,...Ge(t)});var Eg=class extends at{_parse(e){if(this._getType(e)!==se.undefined){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.void,received:a.parsedType}),Ne}return qa(e.data)}};Eg.create=t=>new Eg({typeName:$e.ZodVoid,...Ge(t)});var Do=class _h extends at{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==se.array)return V(a,{code:R.invalid_type,expected:se.array,received:a.parsedType}),Ne;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(V(a,{code:r?R.too_big:R.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(V(a,{code:R.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(V(a,{code:R.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new si(a,r,a.path,d)))).then(r=>rs.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new si(a,r,a.path,d)));return rs.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new _h({...this._def,minLength:{value:e,message:me.toString(a)}})}max(e,a){return new _h({...this._def,maxLength:{value:e,message:me.toString(a)}})}length(e,a){return new _h({...this._def,exactLength:{value:e,message:me.toString(a)}})}nonempty(e){return this.min(1,e)}};Do.create=(t,e)=>new Do({type:t,minLength:null,maxLength:null,exactLength:null,typeName:$e.ZodArray,...Ge(e)});function bd(t){if(t instanceof qs){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Gn.create(bd(s))}return new qs({...t._def,shape:()=>e})}else return t instanceof Do?new Do({...t._def,type:bd(t.element)}):t instanceof Gn?Gn.create(bd(t.unwrap())):t instanceof Ir?Ir.create(bd(t.unwrap())):t instanceof Er?Er.create(t.items.map(e=>bd(e))):t}var qs=class Ys extends at{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=wt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==se.object){let u=this._getOrReturnCtx(e);return V(u,{code:R.invalid_type,expected:se.object,received:u.parsedType}),Ne}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof Ei&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new si(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Ei){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(V(s,{code:R.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new si(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>rs.mergeObjectSync(a,u)):rs.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return me.errToObj,new Ys({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=me.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Ys({...this._def,unknownKeys:"strip"})}passthrough(){return new Ys({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ys({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ys({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:$e.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Ys({...this._def,catchall:e})}pick(e){let a={};return wt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Ys({...this._def,shape:()=>a})}omit(e){let a={};return wt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Ys({...this._def,shape:()=>a})}deepPartial(){return bd(this)}partial(e){let a={};return wt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Ys({...this._def,shape:()=>a})}required(e){let a={};return wt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Gn;)n=n._def.innerType;a[s]=n}}),new Ys({...this._def,shape:()=>a})}keyof(){return E$(wt.objectKeys(this.shape))}};qs.create=(t,e)=>new qs({shape:()=>t,unknownKeys:"strip",catchall:Ei.create(),typeName:$e.ZodObject,...Ge(e)});qs.strictCreate=(t,e)=>new qs({shape:()=>t,unknownKeys:"strict",catchall:Ei.create(),typeName:$e.ZodObject,...Ge(e)});qs.lazycreate=(t,e)=>new qs({shape:t,unknownKeys:"strip",catchall:Ei.create(),typeName:$e.ZodObject,...Ge(e)});var up=class extends at{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new cn(d.ctx.common.issues));return V(a,{code:R.invalid_union,unionErrors:r}),Ne}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new cn(u));return V(a,{code:R.invalid_union,unionErrors:d}),Ne}}get options(){return this._def.options}};up.create=(t,e)=>new up({options:t,typeName:$e.ZodUnion,...Ge(e)});var Qi=t=>t instanceof pp?Qi(t.schema):t instanceof kn?Qi(t.innerType()):t instanceof mp?[t.value]:t instanceof af?t.options:t instanceof fp?wt.objectValues(t.enum):t instanceof hp?Qi(t._def.innerType):t instanceof dp?[void 0]:t instanceof lp?[null]:t instanceof Gn?[void 0,...Qi(t.unwrap())]:t instanceof Ir?[null,...Qi(t.unwrap())]:t instanceof fk||t instanceof yp?Qi(t.unwrap()):t instanceof gp?Qi(t._def.innerType):[],T$=class $$ extends at{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==se.object)return V(a,{code:R.invalid_type,expected:se.object,received:a.parsedType}),Ne;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(V(a,{code:R.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ne)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Qi(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new $$({typeName:$e.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ge(s)})}};function pw(t,e){let a=rr(t),s=rr(e);if(t===e)return{valid:!0,data:t};if(a===se.object&&s===se.object){let n=wt.objectKeys(e),i=wt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=pw(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===se.array&&s===se.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=pw(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===se.date&&s===se.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var cp=class extends at{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(dw(i)||dw(r))return Ne;let d=pw(i.value,r.value);return d.valid?((lw(i)||lw(r))&&a.dirty(),{status:a.value,value:d.data}):(V(s,{code:R.invalid_intersection_types}),Ne)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};cp.create=(t,e,a)=>new cp({left:t,right:e,typeName:$e.ZodIntersection,...Ge(a)});var Er=class A$ extends at{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.array)return V(s,{code:R.invalid_type,expected:se.array,received:s.parsedType}),Ne;if(s.data.length<this._def.items.length)return V(s,{code:R.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ne;!this._def.rest&&s.data.length>this._def.items.length&&(V(s,{code:R.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new si(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>rs.mergeArray(a,i)):rs.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new A$({...this._def,rest:e})}};Er.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Er({items:t,typeName:$e.ZodTuple,rest:null,...Ge(e)})};var M$=class mw extends at{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.object)return V(s,{code:R.invalid_type,expected:se.object,received:s.parsedType}),Ne;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new si(s,d,s.path,d)),value:r._parse(new si(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?rs.mergeObjectAsync(a,n):rs.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof at?new mw({keyType:e,valueType:a,typeName:$e.ZodRecord,...Ge(s)}):new mw({keyType:sl.create(),valueType:e,typeName:$e.ZodRecord,...Ge(a)})}},Ig=class extends at{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.map)return V(s,{code:R.invalid_type,expected:se.map,received:s.parsedType}),Ne;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new si(s,d,s.path,[c,"key"])),value:i._parse(new si(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return Ne;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return Ne;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};Ig.create=(t,e,a)=>new Ig({valueType:e,keyType:t,typeName:$e.ZodMap,...Ge(a)});var Og=class fw extends at{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==se.set)return V(s,{code:R.invalid_type,expected:se.set,received:s.parsedType}),Ne;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(V(s,{code:R.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(V(s,{code:R.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return Ne;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new si(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new fw({...this._def,minSize:{value:e,message:me.toString(a)}})}max(e,a){return new fw({...this._def,maxSize:{value:e,message:me.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Og.create=(t,e)=>new Og({valueType:t,minSize:null,maxSize:null,typeName:$e.ZodSet,...Ge(e)});var L$=class xh extends at{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==se.function)return V(a,{code:R.invalid_type,expected:se.function,received:a.parsedType}),Ne;function s(d,u){return $g({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Tg(),al].filter(c=>!!c),issueData:{code:R.invalid_arguments,argumentsError:u}})}function n(d,u){return $g({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Tg(),al].filter(c=>!!c),issueData:{code:R.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof il){let d=this;return qa(async function(...u){let c=new cn([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return qa(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new cn([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new cn([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new xh({...this._def,args:Er.create(e).rest(yo.create())})}returns(e){return new xh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new xh({args:e||Er.create([]).rest(yo.create()),returns:a||yo.create(),typeName:$e.ZodFunction,...Ge(s)})}},pp=class extends at{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};pp.create=(t,e)=>new pp({getter:t,typeName:$e.ZodLazy,...Ge(e)});var mp=class extends at{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return V(a,{received:a.data,code:R.invalid_literal,expected:this._def.value}),Ne}return{status:"valid",value:e.data}}get value(){return this._def.value}};mp.create=(t,e)=>new mp({value:t,typeName:$e.ZodLiteral,...Ge(e)});function E$(t,e){return new af({values:t,typeName:$e.ZodEnum,...Ge(e)})}var af=class hw extends at{constructor(){super(...arguments),bu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return V(a,{expected:wt.joinValues(s),received:a.parsedType,code:R.invalid_type}),Ne}if(Mg(this,bu)||k$(this,bu,new Set(this._def.values)),!Mg(this,bu).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return V(a,{received:a.data,code:R.invalid_enum_value,options:s}),Ne}return qa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return hw.create(e,{...this._def,...a})}exclude(e,a=this._def){return hw.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};bu=new WeakMap;af.create=E$;var fp=class extends at{constructor(){super(...arguments),wu.set(this,void 0)}_parse(e){let a=wt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==se.string&&s.parsedType!==se.number){let n=wt.objectValues(a);return V(s,{expected:wt.joinValues(n),received:s.parsedType,code:R.invalid_type}),Ne}if(Mg(this,wu)||k$(this,wu,new Set(wt.getValidEnumValues(this._def.values))),!Mg(this,wu).has(e.data)){let n=wt.objectValues(a);return V(s,{received:s.data,code:R.invalid_enum_value,options:n}),Ne}return qa(e.data)}get enum(){return this._def.values}};wu=new WeakMap;fp.create=(t,e)=>new fp({values:t,typeName:$e.ZodNativeEnum,...Ge(e)});var il=class extends at{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==se.promise&&a.common.async===!1)return V(a,{code:R.invalid_type,expected:se.promise,received:a.parsedType}),Ne;let s=a.parsedType===se.promise?a.data:Promise.resolve(a.data);return qa(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};il.create=(t,e)=>new il({type:t,typeName:$e.ZodPromise,...Ge(e)});var kn=class extends at{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===$e.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{V(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return Ne;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?Ne:u.status==="dirty"||a.value==="dirty"?Ag(u.value):u});{if(a.value==="aborted")return Ne;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?Ne:d.status==="dirty"||a.value==="dirty"?Ag(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?Ne:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?Ne:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!ap(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>ap(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);wt.assertNever(n)}};kn.create=(t,e,a)=>new kn({schema:t,typeName:$e.ZodEffects,effect:e,...Ge(a)});kn.createWithPreprocess=(t,e,a)=>new kn({schema:e,effect:{type:"preprocess",transform:t},typeName:$e.ZodEffects,...Ge(a)});var Gn=class extends at{_parse(e){return this._getType(e)===se.undefined?qa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Gn.create=(t,e)=>new Gn({innerType:t,typeName:$e.ZodOptional,...Ge(e)});var Ir=class extends at{_parse(e){return this._getType(e)===se.null?qa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Ir.create=(t,e)=>new Ir({innerType:t,typeName:$e.ZodNullable,...Ge(e)});var hp=class extends at{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===se.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};hp.create=(t,e)=>new hp({innerType:t,typeName:$e.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ge(e)});var gp=class extends at{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return sp(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new cn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new cn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};gp.create=(t,e)=>new gp({innerType:t,typeName:$e.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ge(e)});var Pg=class extends at{_parse(e){if(this._getType(e)!==se.nan){let a=this._getOrReturnCtx(e);return V(a,{code:R.invalid_type,expected:se.nan,received:a.parsedType}),Ne}return{status:"valid",value:e.data}}};Pg.create=t=>new Pg({typeName:$e.ZodNaN,...Ge(t)});var IW=Symbol("zod_brand"),fk=class extends at{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},hk=class I$ extends at{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ne:n.status==="dirty"?(a.dirty(),Ag(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Ne:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new I$({in:e,out:a,typeName:$e.ZodPipeline})}},yp=class extends at{_parse(e){let a=this._def.innerType._parse(e),s=n=>(ap(n)&&(n.value=Object.freeze(n.value)),n);return sp(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};yp.create=(t,e)=>new yp({innerType:t,typeName:$e.ZodReadonly,...Ge(e)});function O$(t,e={},a){return t?nl.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):nl.create()}var OW={object:qs.lazycreate},$e;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})($e||($e={}));var PW=(t,e={message:`Input not instance of ${t.name}`})=>O$(a=>a instanceof t,e),P$=sl.create,Z$=np.create,ZW=Pg.create,RW=ip.create,R$=rp.create,NW=op.create,DW=Lg.create,jW=dp.create,BW=lp.create,qW=nl.create,WW=yo.create,FW=Ei.create,zW=Eg.create,HW=Do.create,UW=qs.create,KW=qs.strictCreate,VW=up.create,GW=T$.create,QW=cp.create,YW=Er.create,JW=M$.create,XW=Ig.create,eF=Og.create,tF=L$.create,aF=pp.create,gw=mp.create,sF=af.create,nF=fp.create,iF=il.create,Ox=kn.create,rF=Gn.create,oF=Ir.create,dF=kn.createWithPreprocess,lF=hk.create,uF=()=>P$().optional(),cF=()=>Z$().optional(),pF=()=>R$().optional(),mF={string:t=>sl.create({...t,coerce:!0}),number:t=>np.create({...t,coerce:!0}),boolean:t=>rp.create({...t,coerce:!0}),bigint:t=>ip.create({...t,coerce:!0}),date:t=>op.create({...t,coerce:!0})},fF=Ne,xe=Object.freeze({__proto__:null,defaultErrorMap:al,setErrorMap:hW,getErrorMap:Tg,makeIssue:$g,EMPTY_PATH:gW,addIssueToContext:V,ParseStatus:rs,INVALID:Ne,DIRTY:Ag,OK:qa,isAborted:dw,isDirty:lw,isValid:ap,isAsync:sp,get util(){return wt},get objectUtil(){return ow},ZodParsedType:se,getParsedType:rr,ZodType:at,datetimeRegex:C$,ZodString:sl,ZodNumber:np,ZodBigInt:ip,ZodBoolean:rp,ZodDate:op,ZodSymbol:Lg,ZodUndefined:dp,ZodNull:lp,ZodAny:nl,ZodUnknown:yo,ZodNever:Ei,ZodVoid:Eg,ZodArray:Do,ZodObject:qs,ZodUnion:up,ZodDiscriminatedUnion:T$,ZodIntersection:cp,ZodTuple:Er,ZodRecord:M$,ZodMap:Ig,ZodSet:Og,ZodFunction:L$,ZodLazy:pp,ZodLiteral:mp,ZodEnum:af,ZodNativeEnum:fp,ZodPromise:il,ZodEffects:kn,ZodTransformer:kn,ZodOptional:Gn,ZodNullable:Ir,ZodDefault:hp,ZodCatch:gp,ZodNaN:Pg,BRAND:IW,ZodBranded:fk,ZodPipeline:hk,ZodReadonly:yp,custom:O$,Schema:at,ZodSchema:at,late:OW,get ZodFirstPartyTypeKind(){return $e},coerce:mF,any:qW,array:HW,bigint:RW,boolean:R$,date:NW,discriminatedUnion:GW,effect:Ox,enum:sF,function:tF,instanceof:PW,intersection:QW,lazy:aF,literal:gw,map:XW,nan:ZW,nativeEnum:nF,never:FW,null:BW,nullable:oF,number:Z$,object:UW,oboolean:pF,onumber:cF,optional:rF,ostring:uF,pipeline:lF,preprocess:dF,promise:iF,record:JW,set:eF,strictObject:KW,string:P$,symbol:DW,transformer:Ox,tuple:YW,undefined:jW,union:VW,unknown:WW,void:zW,NEVER:fF,ZodIssueCode:R,quotelessJson:fW,ZodError:cn}),Ch=xe.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(xe.number().transform(String)),N$=()=>xe.string().regex(/^[a-zA-Z0-9_]+$/);N$();N$().max(50);xe.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");xe.string().nullable().optional().transform(t=>t??void 0);xe.number().nonnegative().max(100);xe.number().nonnegative().max(420);xe.enum(["repeat","random","shuffle"]);xe.enum(["word","time","section"]);var hF=xe.enum(["normal","expert","master"]),Yl=xe.object({acc:xe.number().nonnegative().max(100),consistency:xe.number().nonnegative().max(100),difficulty:hF,lazyMode:xe.boolean().optional(),language:xe.string().max(100).regex(/[\w+]+/),punctuation:xe.boolean().optional(),numbers:xe.boolean().optional(),raw:xe.number().nonnegative(),wpm:xe.number().nonnegative(),timestamp:xe.number().nonnegative()}),gF=xe.object({time:xe.record(Ch.describe("Number of seconds as string"),xe.array(Yl)),words:xe.record(Ch.describe("Number of words as string"),xe.array(Yl)),quote:xe.record(Ch,xe.array(Yl)),custom:xe.record(xe.literal("custom"),xe.array(Yl)),zen:xe.record(xe.literal("zen"),xe.array(Yl))});xe.union([xe.literal("10"),xe.literal("25"),xe.literal("50"),xe.literal("100")]);xe.union([xe.literal("15"),xe.literal("30"),xe.literal("60"),xe.literal("120")]);xe.union([xe.literal("short"),xe.literal("medium"),xe.literal("long"),xe.literal("thicc")]);var yF=gF.keyof();xe.union([Ch,gw("zen"),gw("custom")],{errorMap:()=>({message:'Needs to be either a number, "zen" or "custom".'})});var kt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(kt||(kt={}));var yw;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(yw||(yw={}));var ne=kt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),or=t=>{switch(typeof t){case"undefined":return ne.undefined;case"string":return ne.string;case"number":return isNaN(t)?ne.nan:ne.number;case"boolean":return ne.boolean;case"function":return ne.function;case"bigint":return ne.bigint;case"symbol":return ne.symbol;case"object":return Array.isArray(t)?ne.array:t===null?ne.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ne.promise:typeof Map<"u"&&t instanceof Map?ne.map:typeof Set<"u"&&t instanceof Set?ne.set:typeof Date<"u"&&t instanceof Date?ne.date:ne.object;default:return ne.unknown}},N=kt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),vF=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),pn=class D$ extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof D$))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,kt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};pn.create=t=>new pn(t);var rl=(t,e)=>{let a;switch(t.code){case N.invalid_type:t.received===ne.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case N.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,kt.jsonStringifyReplacer)}`;break;case N.unrecognized_keys:a=`Unrecognized key(s) in object: ${kt.joinValues(t.keys,", ")}`;break;case N.invalid_union:a="Invalid input";break;case N.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${kt.joinValues(t.options)}`;break;case N.invalid_enum_value:a=`Invalid enum value. Expected ${kt.joinValues(t.options)}, received '${t.received}'`;break;case N.invalid_arguments:a="Invalid function arguments";break;case N.invalid_return_type:a="Invalid function return type";break;case N.invalid_date:a="Invalid date";break;case N.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:kt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case N.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case N.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case N.custom:a="Invalid input";break;case N.invalid_intersection_types:a="Intersection results could not be merged";break;case N.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case N.not_finite:a="Number must be finite";break;default:a=e.defaultError,kt.assertNever(t)}return{message:a}},j$=rl;function bF(t){j$=t}function Zg(){return j$}var Rg=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},wF=[];function G(t,e){let a=Zg(),s=Rg({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===rl?void 0:rl].filter(n=>!!n)});t.common.issues.push(s)}var os=class B${constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return De;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return B$.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return De;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},De=Object.freeze({status:"aborted"}),Ng=t=>({status:"dirty",value:t}),Wa=t=>({status:"valid",value:t}),vw=t=>t.status==="aborted",bw=t=>t.status==="dirty",vp=t=>t.status==="valid",bp=t=>typeof Promise<"u"&&t instanceof Promise;function Dg(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function q$(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var fe;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(fe||(fe={}));var _u,xu,ni=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},Px=(t,e)=>{if(vp(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new pn(t.common.issues);return this._error=a,this._error}}};function Qe(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var st=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return or(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:or(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new os,ctx:{common:e.parent.common,data:e.data,parsedType:or(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(bp(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:or(e)},i=this._parseSync({data:e,path:n.path,parent:n});return Px(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:or(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(bp(n)?n:Promise.resolve(n));return Px(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:N.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new _n({schema:this,typeName:Ae.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Qn.create(this,this._def)}nullable(){return Pr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return jo.create(this,this._def)}promise(){return ll.create(this,this._def)}or(e){return Tp.create([this,e],this._def)}and(e){return $p.create(this,e,this._def)}transform(e){return new _n({...Qe(this._def),schema:this,typeName:Ae.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new Ep({...Qe(this._def),innerType:this,defaultValue:a,typeName:Ae.ZodDefault})}brand(){return new gk({typeName:Ae.ZodBranded,type:this,...Qe(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new Ip({...Qe(this._def),innerType:this,catchValue:a,typeName:Ae.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return yk.create(this,e)}readonly(){return Op.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},kF=/^c[^\s-]{8,}$/i,_F=/^[0-9a-z]+$/,xF=/^[0-9A-HJKMNP-TV-Z]{26}$/,CF=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,SF=/^[a-z0-9_-]{21}$/i,TF=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,$F=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,AF="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Hv,MF=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,LF=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,EF=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,W$="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",IF=new RegExp(`^${W$}$`);function F$(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function OF(t){return new RegExp(`^${F$(t)}$`)}function z$(t){let e=`${W$}T${F$(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function PF(t,e){return!!((e==="v4"||!e)&&MF.test(t)||(e==="v6"||!e)&&LF.test(t))}var ol=class Cu extends st{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ne.string){let n=this._getOrReturnCtx(e);return G(n,{code:N.invalid_type,expected:ne.string,received:n.parsedType}),De}let a=new os,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),G(s,{code:N.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),G(s,{code:N.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?G(s,{code:N.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&G(s,{code:N.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")$F.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"email",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")Hv||(Hv=new RegExp(AF,"u")),Hv.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"emoji",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")CF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"uuid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")SF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"nanoid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")kF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"cuid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")_F.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"cuid2",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")xF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"ulid",code:N.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),G(s,{validation:"url",code:N.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"regex",code:N.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?z$(n).test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?IF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?OF(n).test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{code:N.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?TF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"duration",code:N.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?PF(e.data,n.version)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"ip",code:N.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?EF.test(e.data)||(s=this._getOrReturnCtx(e,s),G(s,{validation:"base64",code:N.invalid_string,message:n.message}),a.dirty()):kt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:N.invalid_string,...fe.errToObj(s)})}_addCheck(e){return new Cu({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...fe.errToObj(e)})}url(e){return this._addCheck({kind:"url",...fe.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...fe.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...fe.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...fe.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...fe.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...fe.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...fe.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...fe.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...fe.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...fe.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...fe.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...fe.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...fe.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...fe.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...fe.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...fe.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...fe.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...fe.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...fe.errToObj(a)})}nonempty(e){return this.min(1,fe.errToObj(e))}trim(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Cu({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};ol.create=t=>{var e;return new ol({checks:[],typeName:Ae.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Qe(t)})};function ZF(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var wp=class ww extends st{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ne.number){let n=this._getOrReturnCtx(e);return G(n,{code:N.invalid_type,expected:ne.number,received:n.parsedType}),De}let a,s=new os;for(let n of this._def.checks)n.kind==="int"?kt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:N.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?ZF(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),G(a,{code:N.not_finite,message:n.message}),s.dirty()):kt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,fe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,fe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,fe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,fe.toString(a))}setLimit(e,a,s,n){return new ww({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:fe.toString(n)}]})}_addCheck(e){return new ww({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:fe.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:fe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:fe.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:fe.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:fe.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&kt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};wp.create=t=>new wp({checks:[],typeName:Ae.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Qe(t)});var kp=class kw extends st{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ne.bigint){let n=this._getOrReturnCtx(e);return G(n,{code:N.invalid_type,expected:ne.bigint,received:n.parsedType}),De}let a,s=new os;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),G(a,{code:N.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):kt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,fe.toString(a))}gt(e,a){return this.setLimit("min",e,!1,fe.toString(a))}lte(e,a){return this.setLimit("max",e,!0,fe.toString(a))}lt(e,a){return this.setLimit("max",e,!1,fe.toString(a))}setLimit(e,a,s,n){return new kw({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:fe.toString(n)}]})}_addCheck(e){return new kw({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:fe.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:fe.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:fe.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};kp.create=t=>{var e;return new kp({checks:[],typeName:Ae.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Qe(t)})};var _p=class extends st{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ne.boolean){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.boolean,received:a.parsedType}),De}return Wa(e.data)}};_p.create=t=>new _p({typeName:Ae.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Qe(t)});var xp=class H$ extends st{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ne.date){let n=this._getOrReturnCtx(e);return G(n,{code:N.invalid_type,expected:ne.date,received:n.parsedType}),De}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return G(n,{code:N.invalid_date}),De}let a=new os,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),G(s,{code:N.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),G(s,{code:N.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):kt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new H$({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:fe.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:fe.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};xp.create=t=>new xp({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Ae.ZodDate,...Qe(t)});var jg=class extends st{_parse(e){if(this._getType(e)!==ne.symbol){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.symbol,received:a.parsedType}),De}return Wa(e.data)}};jg.create=t=>new jg({typeName:Ae.ZodSymbol,...Qe(t)});var Cp=class extends st{_parse(e){if(this._getType(e)!==ne.undefined){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.undefined,received:a.parsedType}),De}return Wa(e.data)}};Cp.create=t=>new Cp({typeName:Ae.ZodUndefined,...Qe(t)});var Sp=class extends st{_parse(e){if(this._getType(e)!==ne.null){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.null,received:a.parsedType}),De}return Wa(e.data)}};Sp.create=t=>new Sp({typeName:Ae.ZodNull,...Qe(t)});var dl=class extends st{constructor(){super(...arguments),this._any=!0}_parse(e){return Wa(e.data)}};dl.create=t=>new dl({typeName:Ae.ZodAny,...Qe(t)});var vo=class extends st{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Wa(e.data)}};vo.create=t=>new vo({typeName:Ae.ZodUnknown,...Qe(t)});var Ii=class extends st{_parse(e){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.never,received:a.parsedType}),De}};Ii.create=t=>new Ii({typeName:Ae.ZodNever,...Qe(t)});var Bg=class extends st{_parse(e){if(this._getType(e)!==ne.undefined){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.void,received:a.parsedType}),De}return Wa(e.data)}};Bg.create=t=>new Bg({typeName:Ae.ZodVoid,...Qe(t)});var jo=class Sh extends st{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==ne.array)return G(a,{code:N.invalid_type,expected:ne.array,received:a.parsedType}),De;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(G(a,{code:r?N.too_big:N.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(G(a,{code:N.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(G(a,{code:N.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new ni(a,r,a.path,d)))).then(r=>os.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new ni(a,r,a.path,d)));return os.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new Sh({...this._def,minLength:{value:e,message:fe.toString(a)}})}max(e,a){return new Sh({...this._def,maxLength:{value:e,message:fe.toString(a)}})}length(e,a){return new Sh({...this._def,exactLength:{value:e,message:fe.toString(a)}})}nonempty(e){return this.min(1,e)}};jo.create=(t,e)=>new jo({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Ae.ZodArray,...Qe(e)});function wd(t){if(t instanceof Ws){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Qn.create(wd(s))}return new Ws({...t._def,shape:()=>e})}else return t instanceof jo?new jo({...t._def,type:wd(t.element)}):t instanceof Qn?Qn.create(wd(t.unwrap())):t instanceof Pr?Pr.create(wd(t.unwrap())):t instanceof Or?Or.create(t.items.map(e=>wd(e))):t}var Ws=class Js extends st{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=kt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==ne.object){let u=this._getOrReturnCtx(e);return G(u,{code:N.invalid_type,expected:ne.object,received:u.parsedType}),De}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof Ii&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new ni(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof Ii){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(G(s,{code:N.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new ni(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>os.mergeObjectSync(a,u)):os.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return fe.errToObj,new Js({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=fe.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Js({...this._def,unknownKeys:"strip"})}passthrough(){return new Js({...this._def,unknownKeys:"passthrough"})}extend(e){return new Js({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Js({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ae.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Js({...this._def,catchall:e})}pick(e){let a={};return kt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Js({...this._def,shape:()=>a})}omit(e){let a={};return kt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Js({...this._def,shape:()=>a})}deepPartial(){return wd(this)}partial(e){let a={};return kt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Js({...this._def,shape:()=>a})}required(e){let a={};return kt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Qn;)n=n._def.innerType;a[s]=n}}),new Js({...this._def,shape:()=>a})}keyof(){return Y$(kt.objectKeys(this.shape))}};Ws.create=(t,e)=>new Ws({shape:()=>t,unknownKeys:"strip",catchall:Ii.create(),typeName:Ae.ZodObject,...Qe(e)});Ws.strictCreate=(t,e)=>new Ws({shape:()=>t,unknownKeys:"strict",catchall:Ii.create(),typeName:Ae.ZodObject,...Qe(e)});Ws.lazycreate=(t,e)=>new Ws({shape:t,unknownKeys:"strip",catchall:Ii.create(),typeName:Ae.ZodObject,...Qe(e)});var Tp=class extends st{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new pn(d.ctx.common.issues));return G(a,{code:N.invalid_union,unionErrors:r}),De}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new pn(u));return G(a,{code:N.invalid_union,unionErrors:d}),De}}get options(){return this._def.options}};Tp.create=(t,e)=>new Tp({options:t,typeName:Ae.ZodUnion,...Qe(e)});var Yi=t=>t instanceof Ap?Yi(t.schema):t instanceof _n?Yi(t.innerType()):t instanceof Mp?[t.value]:t instanceof sf?t.options:t instanceof Lp?kt.objectValues(t.enum):t instanceof Ep?Yi(t._def.innerType):t instanceof Cp?[void 0]:t instanceof Sp?[null]:t instanceof Qn?[void 0,...Yi(t.unwrap())]:t instanceof Pr?[null,...Yi(t.unwrap())]:t instanceof gk||t instanceof Op?Yi(t.unwrap()):t instanceof Ip?Yi(t._def.innerType):[],U$=class K$ extends st{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ne.object)return G(a,{code:N.invalid_type,expected:ne.object,received:a.parsedType}),De;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(G(a,{code:N.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),De)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Yi(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new K$({typeName:Ae.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Qe(s)})}};function _w(t,e){let a=or(t),s=or(e);if(t===e)return{valid:!0,data:t};if(a===ne.object&&s===ne.object){let n=kt.objectKeys(e),i=kt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=_w(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===ne.array&&s===ne.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=_w(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===ne.date&&s===ne.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var $p=class extends st{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(vw(i)||vw(r))return De;let d=_w(i.value,r.value);return d.valid?((bw(i)||bw(r))&&a.dirty(),{status:a.value,value:d.data}):(G(s,{code:N.invalid_intersection_types}),De)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};$p.create=(t,e,a)=>new $p({left:t,right:e,typeName:Ae.ZodIntersection,...Qe(a)});var Or=class V$ extends st{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ne.array)return G(s,{code:N.invalid_type,expected:ne.array,received:s.parsedType}),De;if(s.data.length<this._def.items.length)return G(s,{code:N.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),De;!this._def.rest&&s.data.length>this._def.items.length&&(G(s,{code:N.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new ni(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>os.mergeArray(a,i)):os.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new V$({...this._def,rest:e})}};Or.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Or({items:t,typeName:Ae.ZodTuple,rest:null,...Qe(e)})};var G$=class xw extends st{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ne.object)return G(s,{code:N.invalid_type,expected:ne.object,received:s.parsedType}),De;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new ni(s,d,s.path,d)),value:r._parse(new ni(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?os.mergeObjectAsync(a,n):os.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof st?new xw({keyType:e,valueType:a,typeName:Ae.ZodRecord,...Qe(s)}):new xw({keyType:ol.create(),valueType:e,typeName:Ae.ZodRecord,...Qe(a)})}},qg=class extends st{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ne.map)return G(s,{code:N.invalid_type,expected:ne.map,received:s.parsedType}),De;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new ni(s,d,s.path,[c,"key"])),value:i._parse(new ni(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return De;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return De;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};qg.create=(t,e,a)=>new qg({valueType:e,keyType:t,typeName:Ae.ZodMap,...Qe(a)});var Wg=class Cw extends st{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ne.set)return G(s,{code:N.invalid_type,expected:ne.set,received:s.parsedType}),De;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(G(s,{code:N.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(G(s,{code:N.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return De;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new ni(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new Cw({...this._def,minSize:{value:e,message:fe.toString(a)}})}max(e,a){return new Cw({...this._def,maxSize:{value:e,message:fe.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Wg.create=(t,e)=>new Wg({valueType:t,minSize:null,maxSize:null,typeName:Ae.ZodSet,...Qe(e)});var Q$=class Th extends st{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ne.function)return G(a,{code:N.invalid_type,expected:ne.function,received:a.parsedType}),De;function s(d,u){return Rg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Zg(),rl].filter(c=>!!c),issueData:{code:N.invalid_arguments,argumentsError:u}})}function n(d,u){return Rg({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Zg(),rl].filter(c=>!!c),issueData:{code:N.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof ll){let d=this;return Wa(async function(...u){let c=new pn([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return Wa(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new pn([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new pn([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Th({...this._def,args:Or.create(e).rest(vo.create())})}returns(e){return new Th({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Th({args:e||Or.create([]).rest(vo.create()),returns:a||vo.create(),typeName:Ae.ZodFunction,...Qe(s)})}},Ap=class extends st{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};Ap.create=(t,e)=>new Ap({getter:t,typeName:Ae.ZodLazy,...Qe(e)});var Mp=class extends st{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return G(a,{received:a.data,code:N.invalid_literal,expected:this._def.value}),De}return{status:"valid",value:e.data}}get value(){return this._def.value}};Mp.create=(t,e)=>new Mp({value:t,typeName:Ae.ZodLiteral,...Qe(e)});function Y$(t,e){return new sf({values:t,typeName:Ae.ZodEnum,...Qe(e)})}var sf=class Sw extends st{constructor(){super(...arguments),_u.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return G(a,{expected:kt.joinValues(s),received:a.parsedType,code:N.invalid_type}),De}if(Dg(this,_u)||q$(this,_u,new Set(this._def.values)),!Dg(this,_u).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return G(a,{received:a.data,code:N.invalid_enum_value,options:s}),De}return Wa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return Sw.create(e,{...this._def,...a})}exclude(e,a=this._def){return Sw.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};_u=new WeakMap;sf.create=Y$;var Lp=class extends st{constructor(){super(...arguments),xu.set(this,void 0)}_parse(e){let a=kt.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ne.string&&s.parsedType!==ne.number){let n=kt.objectValues(a);return G(s,{expected:kt.joinValues(n),received:s.parsedType,code:N.invalid_type}),De}if(Dg(this,xu)||q$(this,xu,new Set(kt.getValidEnumValues(this._def.values))),!Dg(this,xu).has(e.data)){let n=kt.objectValues(a);return G(s,{received:s.data,code:N.invalid_enum_value,options:n}),De}return Wa(e.data)}get enum(){return this._def.values}};xu=new WeakMap;Lp.create=(t,e)=>new Lp({values:t,typeName:Ae.ZodNativeEnum,...Qe(e)});var ll=class extends st{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ne.promise&&a.common.async===!1)return G(a,{code:N.invalid_type,expected:ne.promise,received:a.parsedType}),De;let s=a.parsedType===ne.promise?a.data:Promise.resolve(a.data);return Wa(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};ll.create=(t,e)=>new ll({type:t,typeName:Ae.ZodPromise,...Qe(e)});var _n=class extends st{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ae.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{G(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return De;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?De:u.status==="dirty"||a.value==="dirty"?Ng(u.value):u});{if(a.value==="aborted")return De;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?De:d.status==="dirty"||a.value==="dirty"?Ng(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?De:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?De:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!vp(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>vp(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);kt.assertNever(n)}};_n.create=(t,e,a)=>new _n({schema:t,typeName:Ae.ZodEffects,effect:e,...Qe(a)});_n.createWithPreprocess=(t,e,a)=>new _n({schema:e,effect:{type:"preprocess",transform:t},typeName:Ae.ZodEffects,...Qe(a)});var Qn=class extends st{_parse(t){return this._getType(t)===ne.undefined?Wa(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Qn.create=(t,e)=>new Qn({innerType:t,typeName:Ae.ZodOptional,...Qe(e)});var Pr=class extends st{_parse(e){return this._getType(e)===ne.null?Wa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Pr.create=(t,e)=>new Pr({innerType:t,typeName:Ae.ZodNullable,...Qe(e)});var Ep=class extends st{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===ne.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};Ep.create=(t,e)=>new Ep({innerType:t,typeName:Ae.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Qe(e)});var Ip=class extends st{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return bp(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new pn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new pn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};Ip.create=(t,e)=>new Ip({innerType:t,typeName:Ae.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Qe(e)});var Fg=class extends st{_parse(e){if(this._getType(e)!==ne.nan){let a=this._getOrReturnCtx(e);return G(a,{code:N.invalid_type,expected:ne.nan,received:a.parsedType}),De}return{status:"valid",value:e.data}}};Fg.create=t=>new Fg({typeName:Ae.ZodNaN,...Qe(t)});var RF=Symbol("zod_brand"),gk=class extends st{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},yk=class J$ extends st{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?De:n.status==="dirty"?(a.dirty(),Ng(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?De:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new J$({in:e,out:a,typeName:Ae.ZodPipeline})}},Op=class extends st{_parse(e){let a=this._def.innerType._parse(e),s=n=>(vp(n)&&(n.value=Object.freeze(n.value)),n);return bp(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};Op.create=(t,e)=>new Op({innerType:t,typeName:Ae.ZodReadonly,...Qe(e)});function X$(t,e={},a){return t?dl.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):dl.create()}var NF={object:Ws.lazycreate},Ae;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Ae||(Ae={}));var DF=(t,e={message:`Input not instance of ${t.name}`})=>X$(a=>a instanceof t,e),eA=ol.create,tA=wp.create,jF=Fg.create,BF=kp.create,aA=_p.create,qF=xp.create,WF=jg.create,FF=Cp.create,zF=Sp.create,HF=dl.create,UF=vo.create,KF=Ii.create,VF=Bg.create,GF=jo.create,QF=Ws.create,YF=Ws.strictCreate,JF=Tp.create,XF=U$.create,e5=$p.create,t5=Or.create,a5=G$.create,s5=qg.create,n5=Wg.create,i5=Q$.create,r5=Ap.create,o5=Mp.create,d5=sf.create,l5=Lp.create,u5=ll.create,Zx=_n.create,c5=Qn.create,p5=Pr.create,m5=_n.createWithPreprocess,f5=yk.create,h5=()=>eA().optional(),g5=()=>tA().optional(),y5=()=>aA().optional(),v5={string:t=>ol.create({...t,coerce:!0}),number:t=>wp.create({...t,coerce:!0}),boolean:t=>_p.create({...t,coerce:!0}),bigint:t=>kp.create({...t,coerce:!0}),date:t=>xp.create({...t,coerce:!0})},b5=De,Oi=Object.freeze({__proto__:null,defaultErrorMap:rl,setErrorMap:bF,getErrorMap:Zg,makeIssue:Rg,EMPTY_PATH:wF,addIssueToContext:G,ParseStatus:os,INVALID:De,DIRTY:Ng,OK:Wa,isAborted:vw,isDirty:bw,isValid:vp,isAsync:bp,get util(){return kt},get objectUtil(){return yw},ZodParsedType:ne,getParsedType:or,ZodType:st,datetimeRegex:z$,ZodString:ol,ZodNumber:wp,ZodBigInt:kp,ZodBoolean:_p,ZodDate:xp,ZodSymbol:jg,ZodUndefined:Cp,ZodNull:Sp,ZodAny:dl,ZodUnknown:vo,ZodNever:Ii,ZodVoid:Bg,ZodArray:jo,ZodObject:Ws,ZodUnion:Tp,ZodDiscriminatedUnion:U$,ZodIntersection:$p,ZodTuple:Or,ZodRecord:G$,ZodMap:qg,ZodSet:Wg,ZodFunction:Q$,ZodLazy:Ap,ZodLiteral:Mp,ZodEnum:sf,ZodNativeEnum:Lp,ZodPromise:ll,ZodEffects:_n,ZodTransformer:_n,ZodOptional:Qn,ZodNullable:Pr,ZodDefault:Ep,ZodCatch:Ip,ZodNaN:Fg,BRAND:RF,ZodBranded:gk,ZodPipeline:yk,ZodReadonly:Op,custom:X$,Schema:st,ZodSchema:st,late:NF,get ZodFirstPartyTypeKind(){return Ae},coerce:v5,any:HF,array:GF,bigint:BF,boolean:aA,date:qF,discriminatedUnion:XF,effect:Zx,enum:d5,function:i5,instanceof:DF,intersection:e5,lazy:r5,literal:o5,map:s5,nan:jF,nativeEnum:l5,never:KF,null:zF,nullable:p5,number:tA,object:QF,oboolean:y5,onumber:g5,optional:c5,ostring:h5,pipeline:f5,preprocess:m5,promise:u5,record:a5,set:n5,strictObject:YF,string:eA,symbol:WF,transformer:Zx,tuple:t5,undefined:FF,union:JF,unknown:UF,void:VF,NEVER:b5,ZodIssueCode:N,quotelessJson:vF,ZodError:pn});Oi.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(Oi.number().transform(String));var sA=()=>Oi.string().regex(/^[a-zA-Z0-9_]+$/),nA=sA();sA().max(50);var w5=Oi.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");Oi.string().nullable().optional().transform(t=>t??void 0);Oi.number().nonnegative().max(100);Oi.number().nonnegative().max(420);var k5=Oi.enum(["repeat","random","shuffle"]),_5=Oi.enum(["word","time","section"]);class Ts{constructor(e){this.key=e.key,this.schema=e.schema,this.fallback=e.fallback,this.migrate=e.migrate}get(){const e=window.localStorage.getItem(this.key);if(e===null)return this.fallback;let a;try{a=JSON.parse(e)}catch(i){return console.log(`Value from localStorage ${this.key} was not a valid JSON, using fallback`,i),window.localStorage.removeItem(this.key),this.fallback}const s=this.schema.safeParse(a);if(s.success)return s.data;console.log(`Value from localStorage ${this.key} failed schema validation, migrating`,s.error.issues);let n=this.fallback;if(this.migrate){const i=this.migrate(a,s.error.issues,yn(this.fallback)),r=this.schema.safeParse(i);r.success?n=i:console.error(`Value from localStorage ${this.key} failed schema validation after migration! This is very bad!`,r.error.issues)}return window.localStorage.setItem(this.key,JSON.stringify(n)),n}set(e){try{const a=this.schema.parse(e);return window.localStorage.setItem(this.key,JSON.stringify(a)),!0}catch(a){return console.error(`Failed to set ${this.key} in localStorage`,e,a.issues),!1}}}const vk=new Ts({key:"config",schema:y$,fallback:$a,migrate:(t,e)=>oS(t)?Rc(t):$a});let iA;const l={...$a};let $h={};const x5=cs(1e3,()=>{Object.keys($h).length>0&&(Zs(!0),FT($h).then(()=>{Zs(!1)})),$h={}});function q(t,e=!1,a=!1){if(e)return;vk.set(l),a||($h[t]=l[t],x5());const s=JSON.stringify(l);B("saveToLocalStorage",s)}function Pl(t=!1){console.log("saving full config to localStorage"),vk.set(l),t||(Zs(!0),FT(l),Zs(!1));const e=JSON.stringify(l);B("saveToLocalStorage",e)}function Fs(t,e){return!Ht("numbers",t)||!Xo("numbers",t,l.funbox)?!1:(l.mode==="quote"&&(t=!1),l.numbers=t,q("numbers",e),B("numbers",l.numbers),!0)}function xn(t,e){return!Ht("punctuation",t)||!Xo("punctuation",t,l.funbox)?!1:(l.mode==="quote"&&(t=!1),l.punctuation=t,q("punctuation",e),B("punctuation",l.punctuation),!0)}function ha(t,e){if(!de("mode",t,yF)||!Xo("mode",t,l.funbox))return!1;const a=l.mode;return l.mode=t,l.mode==="custom"||l.mode==="quote"?(xn(!1,!0),Fs(!1,!0)):l.mode==="zen"&&l.paceCaret!=="off"&&g("Pace caret will not work with zen mode.",0),q("mode",e),B("mode",l.mode,e,a),!0}function rA(t,e){return de("play sound on error",t,q1)?(l.playSoundOnError=t,q("playSoundOnError",e),B("playSoundOnError",l.playSoundOnError),!0):!1}function oA(t,e){return de("play sound on click",t,W1)?(l.playSoundOnClick=t,q("playSoundOnClick",e),B("playSoundOnClick",l.playSoundOnClick),!0):!1}function dA(t,e){return(t<0||t>1)&&(g("Sound volume must be between 0 and 1",0),t=.5),de("sound volume",t,F1)?(l.soundVolume=t,q("soundVolume",e),B("soundVolume",l.soundVolume),!0):!1}function Pn(t,e){return de("difficulty",t,s$)?(l.difficulty=t,q("difficulty",e),B("difficulty",l.difficulty,e),!0):!1}function Tw(t,e){return de("favorite themes",t,n$)?(l.favThemes=t,q("favThemes",e),B("favThemes",l.favThemes),!0):!1}function yi(t,e){if(!de("funbox",t,mk))return!1;for(const s of l.funbox.split("#"))if(!s1(s,l))return!1;const a=t||"none";return l.funbox=a,q("funbox",e),B("funbox",l.funbox),!0}function bk(t,e){if(!de("funbox",t,mk))return!1;let a;const s=l.funbox.split("#");if(s[0]==="none"&&s.splice(0,1),s.includes(t))a=s.indexOf(t),s.splice(a,1),s.length===0?l.funbox="none":l.funbox=s.join("#"),a=-a-1;else{if(!s1(t,l))return!1;s.push(t),l.funbox=s.sort().join("#"),a=s.indexOf(t)}return q("funbox",e),B("funbox",l.funbox),a}function lA(t,e){return Ht("blind mode",t)?(l.blindMode=t,q("blindMode",e),B("blindMode",l.blindMode,e),!0):!1}function nf(t,e){return t.length!==4&&(t=["on","on","on","on"]),de("account chart",t,H1)?(t[0]==="off"&&t[1]==="off"&&(t[0]="on"),l.accountChart=t,q("accountChart",e),B("accountChart",l.accountChart),!0):!1}function wk(t,e){return de("stop on error",t,P1)?(l.stopOnError=t,l.stopOnError!=="off"&&(l.confidenceMode="off",q("confidenceMode",e)),q("stopOnError",e),B("stopOnError",l.stopOnError,e),!0):!1}function uA(t,e){return Ht("always show decimal places",t)?(l.alwaysShowDecimalPlaces=t,q("alwaysShowDecimalPlaces",e),B("alwaysShowDecimalPlaces",l.alwaysShowDecimalPlaces),!0):!1}function cA(t,e){return de("typing speed unit",t,G1)?(l.typingSpeedUnit=t,q("typingSpeedUnit",e),B("typingSpeedUnit",l.typingSpeedUnit,e),!0):!1}function pA(t,e){return Ht("show out of focus warning",t)?(l.showOutOfFocusWarning=t,l.showOutOfFocusWarning||Ym(),q("showOutOfFocusWarning",e),B("showOutOfFocusWarning",l.showOutOfFocusWarning),!0):!1}function mA(t,e){return de("pace caret",t,z1)?document.readyState==="complete"&&(t==="pb"||t==="tagPb")&&!we()?(g('Pace caret "pb" and "tag pb" are unavailable without an account',0),!1):(l.paceCaret=t,q("paceCaret",e),B("paceCaret",l.paceCaret,e),!0):!1}function kk(t,e){return de("pace caret custom speed",t,i$)?(l.paceCaretCustomSpeed=t,q("paceCaretCustomSpeed",e),B("paceCaretCustomSpeed",l.paceCaretCustomSpeed),!0):!1}function fA(t,e){return Ht("repeated pace",t)?(l.repeatedPace=t,q("repeatedPace",e),B("repeatedPace",l.repeatedPace),!0):!1}function hA(t,e){return de("min speed",t,U1)?(l.minWpm=t,q("minWpm",e),B("minWpm",l.minWpm,e),!0):!1}function _k(t,e){return de("min speed custom",t,r$)?(l.minWpmCustomSpeed=t,q("minWpmCustomSpeed",e),B("minWpmCustomSpeed",l.minWpmCustomSpeed),!0):!1}function gA(t,e){return de("min acc",t,Y1)?(l.minAcc=t,q("minAcc",e),B("minAcc",l.minAcc,e),!0):!1}function xk(t,e){return t>100&&(t=100),de("min acc custom",t,o$)?(l.minAccCustom=t,q("minAccCustom",e),B("minAccCustom",l.minAccCustom),!0):!1}function yA(t,e){return de("min burst",t,t$)?(l.minBurst=t,q("minBurst",e),B("minBurst",l.minBurst,e),!0):!1}function Ck(t,e){return de("min burst custom speed",t,d$)?(l.minBurstCustomSpeed=t,q("minBurstCustomSpeed",e),B("minBurstCustomSpeed",l.minBurstCustomSpeed),!0):!1}function vA(t,e){return Ht("always show words history",t)?(l.alwaysShowWordsHistory=t,q("alwaysShowWordsHistory",e),B("alwaysShowWordsHistory",l.alwaysShowWordsHistory),!0):!1}function bA(t,e){return de("single list command line",t,B1)?(l.singleListCommandLine=t,q("singleListCommandLine",e),B("singleListCommandLine",l.singleListCommandLine),!0):!1}function wA(t,e){return Ht("caps lock warning",t)?(l.capsLockWarning=t,q("capsLockWarning",e),B("capsLockWarning",l.capsLockWarning),!0):!1}function Pp(t,e){return Ht("show all lines",t)?t&&l.tapeMode!=="off"?(g("Show all lines doesn't support tape mode",0),!1):(l.showAllLines=t,q("showAllLines",e),B("showAllLines",l.showAllLines,e),!0):!1}function kA(t,e){return Ht("quick end",t)?(l.quickEnd=t,q("quickEnd",e),B("quickEnd",l.quickEnd),!0):!1}function _A(t,e){return de("ads",t,Q1)?(l.ads=t,q("ads",e),!e&&!NO()&&(Wi(3),g("Ad settings changed. Refreshing...",0)),B("ads",l.ads),!0):!1}function xA(t,e){return de("repeat quotes",t,J1)?(l.repeatQuotes=t,q("repeatQuotes",e),B("repeatQuotes",l.repeatQuotes),!0):!1}function CA(t,e){return Ht("flip test colors",t)?(l.flipTestColors=t,q("flipTestColors",e),B("flipTestColors",l.flipTestColors),!0):!1}function SA(t,e){return Ht("colorful mode",t)?(l.colorfulMode=t,q("colorfulMode",e),B("colorfulMode",l.colorfulMode),!0):!1}function TA(t,e){return Ht("strict space",t)?(l.strictSpace=t,q("strictSpace",e),B("strictSpace",l.strictSpace),!0):!1}function $A(t,e){return de("opposite shift mode",t,X1)?(l.oppositeShiftMode=t,q("oppositeShiftMode",e),B("oppositeShiftMode",l.oppositeShiftMode),!0):!1}function AA(t,e){return de("caret style",t,Sg)?(l.caretStyle=t,o("#caret").removeClass("off"),o("#caret").removeClass("default"),o("#caret").removeClass("underline"),o("#caret").removeClass("outline"),o("#caret").removeClass("block"),o("#caret").removeClass("carrot"),o("#caret").removeClass("banana"),t==="off"?o("#caret").addClass("off"):t==="default"?o("#caret").addClass("default"):t==="block"?o("#caret").addClass("block"):t==="outline"?o("#caret").addClass("outline"):t==="underline"?o("#caret").addClass("underline"):t==="carrot"?o("#caret").addClass("carrot"):t==="banana"&&o("#caret").addClass("banana"),q("caretStyle",e),B("caretStyle",l.caretStyle),!0):!1}function MA(t,e){return de("pace caret style",t,Sg)?(l.paceCaretStyle=t,o("#paceCaret").removeClass("off"),o("#paceCaret").removeClass("default"),o("#paceCaret").removeClass("underline"),o("#paceCaret").removeClass("outline"),o("#paceCaret").removeClass("block"),o("#paceCaret").removeClass("carrot"),o("#paceCaret").removeClass("banana"),t==="default"?o("#paceCaret").addClass("default"):t==="block"?o("#paceCaret").addClass("block"):t==="outline"?o("#paceCaret").addClass("outline"):t==="underline"?o("#paceCaret").addClass("underline"):t==="carrot"?o("#paceCaret").addClass("carrot"):t==="banana"&&o("#paceCaret").addClass("banana"),q("paceCaretStyle",e),B("paceCaretStyle",l.paceCaretStyle),!0):!1}function LA(t,e){return de("show average",t,a$)?(l.showAverage=t,q("showAverage",e),B("showAverage",l.showAverage,e),!0):!1}function Gr(t,e){return!de("highlight mode",t,K1)||!Xo("highlightMode",t,l.funbox)?!1:(l.highlightMode=t,q("highlightMode",e),B("highlightMode",l.highlightMode),!0)}function Sk(t,e){return de("tape mode",t,V1)?(t!=="off"&&l.showAllLines&&Pp(!1,!0),l.tapeMode=t,q("tapeMode",e),B("tapeMode",l.tapeMode),!0):!1}function EA(t,e){return Ht("hide extra letters",t)?(l.hideExtraLetters=t,q("hideExtraLetters",e),B("hideExtraLetters",l.hideExtraLetters),!0):!1}function IA(t,e){return de("timer style",t,L1)?(l.timerStyle=t,q("timerStyle",e),B("timerStyle",l.timerStyle),!0):!1}function OA(t,e){return de("live speed style",t,Od)?(l.liveSpeedStyle=t,q("liveSpeedStyle",e),B("liveSpeedStyle",l.timerStyle),!0):!1}function PA(t,e){return de("live acc style",t,Od)?(l.liveAccStyle=t,q("liveAccStyle",e),B("liveAccStyle",l.timerStyle),!0):!1}function ZA(t,e){return de("live burst style",t,Od)?(l.liveBurstStyle=t,q("liveBurstStyle",e),B("liveBurstStyle",l.timerStyle),!0):!1}function RA(t,e){return de("timer color",t,I1)?(l.timerColor=t,q("timerColor",e),B("timerColor",l.timerColor),!0):!1}function NA(t,e){return de("timer opacity",t,O1)?(l.timerOpacity=t,q("timerOpacity",e),B("timerOpacity",l.timerOpacity),!0):!1}function DA(t,e){return Ht("key tips",t)?(l.showKeyTips=t,l.showKeyTips?o("footer .keyTips").removeClass("hidden"):o("footer .keyTips").addClass("hidden"),q("showKeyTips",e),B("showKeyTips",l.showKeyTips),!0):!1}function Dn(t,e){return t=isNaN(t)||t<0?$a.time:t,!de("time",t,l$)||!Xo("words",t,l.funbox)?!1:(l.time=t,q("time",e),B("time",l.time),!0)}function bi(t,e,a){if(Array.isArray(t)){if(!de("quote length",t,$1))return!1;t.length===1&&t[0]===-1&&(t=[1]),l.quoteLength=t}else{if(!de("quote length",t,T1))return!1;Array.isArray(l.quoteLength)||(l.quoteLength=[]),(t===null||isNaN(t)||t<-3||t>3)&&(t=1),t=parseInt(t.toString()),t===-1?l.quoteLength=[0,1,2,3]:a&&t>=0?l.quoteLength.includes(t)?l.quoteLength.length>1&&(l.quoteLength=l.quoteLength.filter(s=>s!==t)):l.quoteLength.push(t):l.quoteLength=[t]}return q("quoteLength",e),B("quoteLength",l.quoteLength),!0}function Zr(t,e){return t=t<0||t>1e5?$a.words:t,!de("words",t,u$)||!Xo("words",t,l.funbox)?!1:(l.words=t,q("words",e),B("words",l.words),!0)}function jA(t,e){return de("smooth caret",t,C1)?(l.smoothCaret=t,t==="off"?o("#caret").css("animation-name","caretFlashHard"):o("#caret").css("animation-name","caretFlashSmooth"),q("smoothCaret",e),B("smoothCaret",l.smoothCaret),!0):!1}function BA(t,e){return Ht("start graphs at zero",t)?(l.startGraphsAtZero=t,q("startGraphsAtZero",e),B("startGraphsAtZero",l.startGraphsAtZero),!0):!1}function qA(t,e){return Ht("smooth line scroll",t)?(l.smoothLineScroll=t,q("smoothLineScroll",e),B("smoothLineScroll",l.smoothLineScroll),!0):!1}function WA(t,e){return de("quick restart mode",t,S1)?(l.quickRestart=t,q("quickRestart",e),B("quickRestart",l.quickRestart),!0):!1}function FA(t,e){return de("font family",t,c$)?(t===""&&(t="roboto_mono",g("Empty input received, reverted to the default font.",0,{customTitle:"Custom font"})),!t||!/^[0-9a-zA-Z_.\-#+()]+$/.test(t)?(g(`Invalid font name value: "${t}".`,-1,{customTitle:"Custom font",duration:3}),!1):(l.fontFamily=t,document.documentElement.style.setProperty("--font",`"${t.replace(/_/g," ")}", "Roboto Mono", "Vazirmatn", monospace`),q("fontFamily",e),B("fontFamily",l.fontFamily),!0)):!1}function zA(t,e){return Ht("freedom mode",t)?(t==null&&(t=!1),l.freedomMode=t,l.freedomMode&&l.confidenceMode!=="off"&&(l.confidenceMode="off"),q("freedomMode",e),B("freedomMode",l.freedomMode),!0):!1}function HA(t,e){return de("confidence mode",t,A1)?(l.confidenceMode=t,l.confidenceMode!=="off"&&(l.freedomMode=!1,l.stopOnError="off",q("freedomMode",e),q("stopOnError",e)),q("confidenceMode",e),B("confidenceMode",l.confidenceMode,e),!0):!1}function UA(t,e){return de("indicate typos",t,M1)?(l.indicateTypos=t,q("indicateTypos",e),B("indicateTypos",l.indicateTypos),!0):!1}function KA(t,e){return Ht("auto switch theme",t)?(t=t??$a.autoSwitchTheme,l.autoSwitchTheme=t,q("autoSwitchTheme",e),B("autoSwitchTheme",l.autoSwitchTheme),!0):!1}function wi(t,e){return Ht("custom theme",t)?(l.customTheme=t,q("customTheme",e),B("customTheme",l.customTheme),!0):!1}function VA(t,e){return de("theme",t,go)?(l.theme=t,l.customTheme&&wi(!1),q("theme",e),B("theme",l.theme),!0):!1}function GA(t,e){return de("theme light",t,go)?(l.themeLight=t,q("themeLight",e),B("themeLight",l.themeLight,e),!0):!1}function QA(t,e){return de("theme dark",t,go)?(l.themeDark=t,q("themeDark",e),B("themeDark",l.themeDark,e),!0):!1}function C5(t,e,a,s,n){return de("themes",t,go)?(a.length===9&&(e&&g("Missing sub alt color. Please edit it in the custom theme settings and save your changes.",0,{duration:7}),a.splice(4,0,"#000000")),l.customThemeColors=a,l.theme=t,l.customTheme=e,l.autoSwitchTheme=s,q("theme",n),B("setThemes",e),!0):!1}function YA(t,e){var a,s;if(!de("random theme",t,E1))return!1;if(t==="custom"){if(!we())return l.randomTheme=t,!1;if(!T())return!0;if(((s=(a=T())==null?void 0:a.customThemes)==null?void 0:s.length)===0)return g("You need to create a custom theme first",0),l.randomTheme="off",!1}return l.randomTheme=t,q("randomTheme",e),B("randomTheme",l.randomTheme),!0}function JA(t,e){return Ht("british english",t)?(t||(t=!1),l.britishEnglish=t,q("britishEnglish",e),B("britishEnglish",l.britishEnglish),!0):!1}function Zp(t,e){return Ht("lazy mode",t)?(t||(t=!1),l.lazyMode=t,q("lazyMode",e),B("lazyMode",l.lazyMode,e),!0):!1}function Rp(t,e){return t.length===9&&(g("Missing sub alt color. Please edit it in the custom theme settings and save your changes.",0,{duration:7}),t.splice(4,0,"#000000")),de("custom theme colors",t,pk)?(t!==void 0&&(l.customThemeColors=t),q("customThemeColors",e),B("customThemeColors",l.customThemeColors,e),!0):!1}function ul(t,e){return de("language",t,w5)?(l.language=t,Mi("changedLanguage",{language:t}),q("language",e),B("language",l.language),!0):!1}function S5(t,e){return Ht("monkey",t)?(l.monkey=t,q("monkey",e),B("monkey",l.monkey),!0):!1}function mn(t,e){return de("keymap mode",t,Z1)?(o(".activeKey").removeClass("activeKey"),o(".keymapKey").attr("style",""),l.keymapMode=t,q("keymapMode",e),B("keymapMode",l.keymapMode,e),!0):!1}function XA(t,e){return de("keymap legend style",t,N1)?(["lowercase","uppercase","blank","dynamic"].forEach(s=>{o(".keymapLegendStyle").removeClass(s)}),t=t||"lowercase",o(".keymapKey > .letter").css("display",""),o(".keymapKey > .letter").css("text-transform",""),t==="uppercase"&&o(".keymapKey > .letter").css("text-transform","capitalize"),t==="blank"&&o(".keymapKey > .letter").css("display","none"),o(".keymapLegendStyle").addClass(t),l.keymapLegendStyle=t,q("keymapLegendStyle",e),B("keymapLegendStyle",l.keymapLegendStyle),!0):!1}function eM(t,e){return de("keymap style",t,R1)?(t=t||"staggered",l.keymapStyle=t,q("keymapStyle",e),B("keymapStyle",l.keymapStyle),!0):!1}function bo(t,e){return de("keymap layout",t,p$)?(l.keymapLayout=t,q("keymapLayout",e),B("keymapLayout",l.keymapLayout),!0):!1}function tM(t,e){return de("keymapShowTopRow",t,D1)?(l.keymapShowTopRow=t,q("keymapShowTopRow",e),B("keymapShowTopRow",l.keymapShowTopRow),!0):!1}function rf(t,e){return t<.5&&(t=.5),t>3.5&&(t=3.5),t=ch(t),de("keymap size",t,j1)?(l.keymapSize=t,o("#keymap").css("zoom",t),q("keymapSize",e),B("keymapSize",l.keymapSize,e),o(window).trigger("resize"),!0):!1}function wo(t,e){return de("layout",t,m$)?(l.layout=t,q("layout",e),B("layout",l.layout,e),!0):!1}function Xy(t,e){return t<0&&(t=1),typeof t=="string"&&["1","125","15","2","3","4"].includes(t)&&(t==="125"?t=1.25:t==="15"?t=1.5:t=parseInt(t)),de("font size",t,f$)?(t===15&&(t=1.5),l.fontSize=t,o("#caret, #paceCaret, #liveStatsMini, #typingTest, #wordsInput").css("fontSize",t+"rem"),q("fontSize",e),B("fontSize",l.fontSize,e),e||o(window).trigger("resize"),!0):!1}function of(t,e){return t<20&&t!==0&&(t=20),t>1e3&&(t=1e3),de("max line width",t,h$)?(l.maxLineWidth=t,q("maxLineWidth",e),B("maxLineWidth",l.maxLineWidth,e),o(window).trigger("resize"),!0):!1}function df(t,e){return t=t.trim(),de("custom background",t,g$)?(l.customBackground=t,q("customBackground",e),B("customBackground",l.customBackground),!0):!1}async function Tk(t,e){const a=t.trim();if(!await HB("layoutfluid",a,["layoutfluid"]))return!1;const s=a.replace(/ /g,"#");return l.customLayoutfluid=s,q("customLayoutfluid",e),B("customLayoutFluid",l.customLayoutfluid),!0}function $k(t,e){return de("custom background size",t,uk)?(l.customBackgroundSize=t,q("customBackgroundSize",e),B("customBackgroundSize",l.customBackgroundSize),!0):!1}function Ak(t,e){return t.length===5&&(t=[t[0],t[1],t[2],t[3]]),de("custom background filter",t,ck)?(l.customBackgroundFilter=t,q("customBackgroundFilter",e),B("customBackgroundFilter",l.customBackgroundFilter),!0):!1}function T5(t,e){return de("monkey power level",t,e$)?(l.monkeyPowerLevel=t,q("monkeyPowerLevel",e),B("monkeyPowerLevel",l.monkeyPowerLevel),!0):!1}function aM(t,e){return Ht("burst heatmap",t)?(t||(t=!1),l.burstHeatmap=t,q("burstHeatmap",e),B("burstHeatmap",l.burstHeatmap),!0):!1}async function cl(t){if(t===void 0)return;B("fullConfigChange");const e=t;Object.keys($a).forEach(a=>{if(e[a]===void 0){const s=$a[a];e[a]=s}}),e!=null&&(_A(e.ads,!0),GA(e.themeLight,!0),QA(e.themeDark,!0),C5(e.theme,e.customTheme,e.customThemeColors,e.autoSwitchTheme,!0),await Tk(e.customLayoutfluid,!0),df(e.customBackground,!0),$k(e.customBackgroundSize,!0),Ak(e.customBackgroundFilter,!0),WA(e.quickRestart,!0),DA(e.showKeyTips,!0),Dn(e.time,!0),bi(e.quoteLength,!0),Zr(e.words,!0),ul(e.language,!0),wo(e.layout,!0),Xy(e.fontSize,!0),of(e.maxLineWidth,!0),zA(e.freedomMode,!0),AA(e.caretStyle,!0),MA(e.paceCaretStyle,!0),Pn(e.difficulty,!0),lA(e.blindMode,!0),kA(e.quickEnd,!0),CA(e.flipTestColors,!0),SA(e.colorfulMode,!0),HA(e.confidenceMode,!0),UA(e.indicateTypos,!0),IA(e.timerStyle,!0),OA(e.liveSpeedStyle,!0),PA(e.liveAccStyle,!0),ZA(e.liveBurstStyle,!0),RA(e.timerColor,!0),NA(e.timerOpacity,!0),mn(e.keymapMode,!0),eM(e.keymapStyle,!0),XA(e.keymapLegendStyle,!0),bo(e.keymapLayout,!0),tM(e.keymapShowTopRow,!0),rf(e.keymapSize,!0),FA(e.fontFamily,!0),jA(e.smoothCaret,!0),qA(e.smoothLineScroll,!0),uA(e.alwaysShowDecimalPlaces,!0),vA(e.alwaysShowWordsHistory,!0),bA(e.singleListCommandLine,!0),wA(e.capsLockWarning,!0),rA(e.playSoundOnError,!0),oA(e.playSoundOnClick,!0),dA(e.soundVolume,!0),wk(e.stopOnError,!0),Tw(e.favThemes,!0),yi(e.funbox,!0),YA(e.randomTheme,!0),Pp(e.showAllLines,!0),pA(e.showOutOfFocusWarning,!0),mA(e.paceCaret,!0),kk(e.paceCaretCustomSpeed,!0),fA(e.repeatedPace,!0),nf(e.accountChart,!0),yA(e.minBurst,!0),Ck(e.minBurstCustomSpeed,!0),hA(e.minWpm,!0),_k(e.minWpmCustomSpeed,!0),gA(e.minAcc,!0),xk(e.minAccCustom,!0),Gr(e.highlightMode,!0),cA(e.typingSpeedUnit,!0),EA(e.hideExtraLetters,!0),BA(e.startGraphsAtZero,!0),TA(e.strictSpace,!0),$A(e.oppositeShiftMode,!0),ha(e.mode,!0),Fs(e.numbers,!0),xn(e.punctuation,!0),S5(e.monkey,!0),xA(e.repeatQuotes,!0),T5(e.monkeyPowerLevel,!0),aM(e.burstHeatmap,!0),JA(e.britishEnglish,!0),Zp(e.lazyMode,!0),LA(e.showAverage,!0),Sk(e.tapeMode,!0),B("configApplied",void 0,void 0,void 0,l)),B("fullConfigChangeFinished")}async function Mk(){await cl($a),await BB(),Pl(!0)}async function $5(){console.log("loading localStorage config");const t=vk.get();t===void 0?await Mk():(await cl(t),Pl(!0)),iA()}function $w(){const t={};return Ti(l).filter(e=>l[e]!==$a[e]).forEach(e=>{t[e]=l[e]}),t}const sM=new Promise(t=>{iA=t});class A5{constructor(){this.list=[],this.sectionIndexList=[],this.length=0,this.currentIndex=0}get(e,a=!1){var s,n;return e===void 0?this.list:a?(n=(s=this.list[e])==null?void 0:s.replace(/[.?!":\-,]/g,""))==null?void 0:n.toLowerCase():this.list[e]}getCurrent(){return this.list[this.currentIndex]??""}getLast(){return this.list[this.list.length-1]}push(e,a){this.list.push(e),this.sectionIndexList.push(a),this.length=this.list.length}reset(){this.list=[],this.sectionIndexList=[],this.currentIndex=0,this.length=this.list.length}resetCurrentIndex(){this.currentIndex=0}decreaseCurrentIndex(){this.currentIndex--}increaseCurrentIndex(){this.currentIndex++}clean(){for(const e of this.list)if(/ +/.test(e)){const a=this.list.indexOf(e),s=e.split(" ");this.list.splice(a,1);for(let n=0;n<s.length;n++)this.list.splice(a+n,0,s[n])}}}const I=new A5;let Np=!1,zg=!1,Lk=!1,pt=null;function Aw(t){pt=t}function M5(t){Np=t}function L5(t){zg=t}function E5(t){Lk=t}ms("commandLine");async function Zl(){try{ht();const t=await B0(()=>import("./commandline.YdgYY-M1.js"),__vite__mapDeps([0,1,2,3,4]));return We(),t}catch(t){if(We(),t instanceof Error&&t.message.includes("Failed to fetch dynamically imported module"))g("Failed to load commandline module: could not fetch",-1);else{const e=qe(t,"Failed to load commandline module");g(e,-1)}throw t}}ms("devOptionsModal");document.addEventListener("keydown",async t=>{ac()||t.key!==void 0&&(t.key==="Escape"&&l.quickRestart!=="esc"||t.key==="Tab"&&l.quickRestart==="esc"&&!Np&&!t.shiftKey||t.key==="Tab"&&l.quickRestart==="esc"&&Np&&t.shiftKey||t.key.toLowerCase()==="p"&&(t.metaKey||t.ctrlKey)&&t.shiftKey)&&(t.preventDefault(),Wy()||(await Zl()).show())});window.onerror=function(t,e,a,s,n){Mi("error",{error:(n==null?void 0:n.stack)??""})};window.onunhandledrejection=function(t){Mi("error",{error:t.reason.stack??""})};const Wf=125,Ff=.75;class Ct{constructor(e){var n,i;this.open=!1,this.setupRan=!1,e.dialogId.startsWith("#")&&(e.dialogId=e.dialogId.slice(1)),this.skeletonAppendParent=e.appendTo??"popups",dB(e.dialogId)&&Cs(e.dialogId,this.skeletonAppendParent);const a=document.getElementById(e.dialogId),s=document.querySelector(`#${e.dialogId} > .modal`);if(a===null)throw new Error(`Dialog element with id ${e.dialogId} not found`);if(!(a instanceof HTMLDialogElement))throw new Error("Animated dialog must be an HTMLDialogElement");if(a===null)throw new Error(`Dialog element with id ${e.dialogId} not found`);if(s===null)throw new Error(`Div element inside #${e.dialogId} with class 'modal' not found`);this.dialogId=e.dialogId,this.wrapperEl=a,this.modalEl=s,this.customShowAnimations=(n=e.customAnimations)==null?void 0:n.show,this.customHideAnimations=(i=e.customAnimations)==null?void 0:i.hide,this.previousModalInChain=void 0,this.showOptionsWhenInChain=e.showOptionsWhenInChain,this.customEscapeHandler=e==null?void 0:e.customEscapeHandler,this.customWrapperClickHandler=e==null?void 0:e.customWrapperClickHandler,this.setup=e==null?void 0:e.setup,ms(this.dialogId)}getPreviousModalInChain(){return this.previousModalInChain}async runSetup(){this.wrapperEl.addEventListener("keydown",e=>{e.key==="Escape"&&Ra(this.dialogId)&&(e.preventDefault(),e.stopPropagation(),this.customEscapeHandler!==void 0?this.customEscapeHandler(e):this.hide())}),this.wrapperEl.addEventListener("mousedown",e=>{e.target===this.wrapperEl&&(this.customWrapperClickHandler!==void 0?this.customWrapperClickHandler(e):this.hide())}),this.setup!==void 0&&await this.setup(this.modalEl)}getDialogId(){return this.dialogId}getWrapper(){return this.wrapperEl}getModal(){return this.modalEl}isOpen(){return this.open}focusFirstInput(e){const s=[...this.modalEl.querySelectorAll("input")].filter(n=>!n.classList.contains("hidden"))[0];s!=null?e===!0?s.focus():e==="focusAndSelect"?(s.focus(),s.select()):this.wrapperEl.focus():this.wrapperEl.focus()}async show(e){return new Promise(async a=>{var u,c,m,f,h,y,b,w,$,E,L,be,J;if(this.open){a();return}if(Cs(this.dialogId,this.skeletonAppendParent),this.setupRan||(await this.runSetup(),this.setupRan=!0),Ra(this.dialogId)){a();return}const s=qt((((c=(u=e==null?void 0:e.customAnimation)==null?void 0:u.modal)==null?void 0:c.durationMs)??(e==null?void 0:e.animationDurationMs)??((f=(m=this.customShowAnimations)==null?void 0:m.modal)==null?void 0:f.durationMs)??Wf)*((e==null?void 0:e.modalChain)!==void 0?Ff:1));(e==null?void 0:e.modalChain)!==void 0&&(this.previousModalInChain=e.modalChain,await this.previousModalInChain.hide({animationMode:"modalOnly",animationDurationMs:s,dontShowPreviousModalInchain:e.modalChain.previousModalInChain!==void 0})),this.open=!0,(e==null?void 0:e.mode)==="dialog"?this.wrapperEl.show():((e==null?void 0:e.mode)==="modal"||(e==null?void 0:e.mode)===void 0)&&this.wrapperEl.showModal(),await((h=e==null?void 0:e.beforeAnimation)==null?void 0:h.call(e,this.modalEl,e==null?void 0:e.modalChainData)),setTimeout(async()=>{this.focusFirstInput(e==null?void 0:e.focusFirstInput)},1);const n=((y=e==null?void 0:e.customAnimation)==null?void 0:y.modal)??((b=this.customShowAnimations)==null?void 0:b.modal),i=((w=e==null?void 0:e.customAnimation)==null?void 0:w.wrapper)??(($=this.customShowAnimations)==null?void 0:$.wrapper)??{from:{opacity:"0"},to:{opacity:"1"},easing:"swing"},r=qt(((L=(E=e==null?void 0:e.customAnimation)==null?void 0:E.wrapper)==null?void 0:L.durationMs)??((J=(be=this.customShowAnimations)==null?void 0:be.wrapper)==null?void 0:J.durationMs)??Wf),d=this.previousModalInChain!==void 0?"modalOnly":(e==null?void 0:e.animationMode)??"both";o(this.modalEl).stop(!0,!1),o(this.wrapperEl).stop(!0,!1),d==="both"||d==="none"?(n!=null&&n.from?(o(this.modalEl).css(n.from),o(this.modalEl).animate(n.to,d==="none"?0:s,n.easing??"swing")):o(this.modalEl).css("opacity","1"),o(this.wrapperEl).css(i.from),o(this.wrapperEl).removeClass("hidden").css("opacity","0").animate(i.to??{opacity:1},d==="none"?0:r,i.easing??"swing",async()=>{var k;this.focusFirstInput(e==null?void 0:e.focusFirstInput),await((k=e==null?void 0:e.afterAnimation)==null?void 0:k.call(e,this.modalEl,e==null?void 0:e.modalChainData)),a()})):d==="modalOnly"&&(o(this.wrapperEl).removeClass("hidden").css("opacity","1"),n!=null&&n.from?o(this.modalEl).css(n.from):o(this.modalEl).css("opacity","0"),o(this.modalEl).animate((n==null?void 0:n.to)??{opacity:1},s,(n==null?void 0:n.easing)??"swing",async()=>{var k;this.focusFirstInput(e==null?void 0:e.focusFirstInput),await((k=e==null?void 0:e.afterAnimation)==null?void 0:k.call(e,this.modalEl,e==null?void 0:e.modalChainData)),a()}))})}async hide(e){return new Promise(async a=>{var u,c,m,f,h,y,b,w,$,E,L,be,J;if(!Ra(this.dialogId)){a();return}e!=null&&e.clearModalChain&&(this.previousModalInChain=void 0),await((u=e==null?void 0:e.beforeAnimation)==null?void 0:u.call(e,this.modalEl));const s=((c=e==null?void 0:e.customAnimation)==null?void 0:c.modal)??((m=this.customHideAnimations)==null?void 0:m.modal),n=qt((((h=(f=e==null?void 0:e.customAnimation)==null?void 0:f.modal)==null?void 0:h.durationMs)??(e==null?void 0:e.animationDurationMs)??((b=(y=this.customHideAnimations)==null?void 0:y.modal)==null?void 0:b.durationMs)??Wf)*(this.previousModalInChain!==void 0?Ff:1)),i=((w=e==null?void 0:e.customAnimation)==null?void 0:w.wrapper)??(($=this.customHideAnimations)==null?void 0:$.wrapper)??{from:{opacity:"1"},to:{opacity:"0"},easing:"swing"},r=qt(((L=(E=e==null?void 0:e.customAnimation)==null?void 0:E.wrapper)==null?void 0:L.durationMs)??((J=(be=this.customHideAnimations)==null?void 0:be.wrapper)==null?void 0:J.durationMs)??Wf),d=this.previousModalInChain!==void 0?"modalOnly":(e==null?void 0:e.animationMode)??"both";o(this.modalEl).stop(!0,!1),o(this.wrapperEl).stop(!0,!1),d==="both"||d==="none"?(s!=null&&s.from?(o(this.modalEl).css(s.from),o(this.modalEl).animate(s.to,d==="none"?0:n,s.easing??"swing")):o(this.modalEl).css("opacity","1"),o(this.wrapperEl).css(i.from),o(this.wrapperEl).css("opacity","1").animate((i==null?void 0:i.to)??{opacity:0},d==="none"?0:r,(i==null?void 0:i.easing)??"swing",async()=>{var k;this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),Na(this.dialogId),this.open=!1,await((k=e==null?void 0:e.afterAnimation)==null?void 0:k.call(e,this.modalEl)),this.previousModalInChain!==void 0&&!(e!=null&&e.dontShowPreviousModalInchain)&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:e==null?void 0:e.modalChainData,animationDurationMs:n*Ff,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()})):d==="modalOnly"&&(o(this.wrapperEl).removeClass("hidden").css("opacity","1"),s!=null&&s.from?o(this.modalEl).css(s.from):o(this.modalEl).css("opacity","1"),o(this.modalEl).animate((s==null?void 0:s.to)??{opacity:0},n,(s==null?void 0:s.easing)??"swing",async()=>{var k;this.wrapperEl.close(),o(this.wrapperEl).addClass("hidden").css("opacity","0"),Na(this.dialogId),this.open=!1,await((k=e==null?void 0:e.afterAnimation)==null?void 0:k.call(e,this.modalEl)),this.previousModalInChain!==void 0&&!(e!=null&&e.dontShowPreviousModalInchain)&&(await this.previousModalInChain.show({animationMode:"modalOnly",modalChainData:e==null?void 0:e.modalChainData,animationDurationMs:n*Ff,...this.previousModalInChain.showOptionsWhenInChain}),this.previousModalInChain=void 0),a()}))})}destroy(){this.wrapperEl.close(),this.wrapperEl.classList.add("hidden"),Na(this.dialogId),this.open=!1}}function nM(){iM.show()}const iM=new Ct({dialogId:"supportModal",setup:async t=>{var e;(e=t.querySelector("button.ads"))==null||e.addEventListener("click",async()=>{(await Zl()).show({subgroupOverride:"enableAds"},{modalChain:iM})})}});function rM(){I5.show()}const I5=new Ct({dialogId:"contactModal"});function O5(){P5.show({beforeAnimation:async()=>{o("#versionHistoryModal .modal").html(`
    <div class="preloader">
      <i class="fas fa-fw fa-spin fa-circle-notch"></i>
    </div
  `),AB().then(t=>{o("#versionHistoryModal .modal").html('<div class="releases"></div'),t.forEach(e=>{if(!e.draft&&!e.prerelease){let a=e.body;a=a.replace(/\r\n/g,"<br>"),a=a.replace(/### (.*?)<br>/g,"<h3>$1</h3>"),a=a.replace(/<\/h3><br>/gi,"</h3>"),a=a.replace(/^- /gm,""),a=a.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>"),a=a.replace(/\[(.*?)\]\((.*?)\)/g,'<a href="$2" target="_blank">$1</a>'),o("#versionHistoryModal .modal .releases").append(`
        <div class="release">
          <div class="title">${e.name}</div>
          <div class="date">${Ot(new Date(e.published_at),"dd MMM yyyy")}</div>
          <div class="body">${a}</div>
        </div>
      `)}})}).catch(t=>{const e=qe(t,"Failed to fetch version history");o("#versionHistoryModal .modal").html(`<div class="releases">Failed to fetch version history:<br>${e}</div`)}),o("#newVersionIndicator").addClass("hidden")}})}const P5=new Ct({dialogId:"versionHistoryModal"});var HC;(HC=document.querySelector("footer #commandLineMobileButton"))==null||HC.addEventListener("click",async()=>{(await Zl()).show({singleListOverride:!1})});var UC;(UC=document.querySelector("footer #newVersionIndicator"))==null||UC.addEventListener("click",t=>{var e;t.stopPropagation(),(e=document.querySelector("#newVersionIndicator"))==null||e.classList.add("hidden")});var KC;(KC=document.querySelector("footer .currentVersion"))==null||KC.addEventListener("click",t=>{t.shiftKey?alert(Fm.clientVersion):O5()});var VC;(VC=document.querySelector("footer .right .current-theme"))==null||VC.addEventListener("click",async t=>{var a,s;if(t.shiftKey){if(l.customTheme){wi(!1);return}if(we()&&(((s=(a=T())==null?void 0:a.customThemes)==null?void 0:s.length)??0)<1){g("No custom themes!",0),wi(!1);return}wi(!0)}else{const n=l.customTheme?"customThemesList":"themes";(await Zl()).show({subgroupOverride:n})}});var GC;(GC=document.querySelector("footer #supportMeButton"))==null||GC.addEventListener("click",()=>{nM()});var QC;(QC=document.querySelector("footer #contactPopupButton"))==null||QC.addEventListener("click",()=>{rM()});o("#keymap").on("click",".r5 .keySpace",async()=>{(await Zl()).show({subgroupOverride:"keymapLayouts"})});let Ek=!1;function $t(){Ek=!0}function Dp(){Ek=!1}function Z5(){return Ek}const oM=["NumpadMultiply","NumpadSubtract","NumpadAdd","NumpadDecimal","NumpadEqual","NumpadDivide","Numpad0","Numpad1","Numpad2","Numpad3","Numpad4","Numpad5","Numpad6","Numpad7","Numpad8","Numpad9","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space","Enter","Tab","NoCode"];class R5{constructor(){this.current="",this.history=[],this.historyLength=0,this.length=0,this.koreanStatus=!1}reset(){this.current="",this.history=[],this.length=0}resetHistory(){this.history=[],this.length=0}setCurrent(e){this.current=e,this.length=this.current.length}setKoreanStatus(e){this.koreanStatus=e}appendCurrent(e){this.current+=e,this.length=this.current.length}resetCurrent(){this.current=""}getCurrent(){return this.current}getKoreanStatus(){return this.koreanStatus}pushHistory(){this.history.push(this.current),this.historyLength=this.history.length,this.resetCurrent()}popHistory(){const e=this.history.pop()??"";return this.historyLength=this.history.length,e}getHistory(e){return e===void 0?this.history:this.history[e]}getHistoryLast(){return _r(this.history)}}class N5{constructor(){this.current="",this.history=[]}setCurrent(e){this.current=e}appendCurrent(e){this.current+=e}resetCurrent(){this.current=""}resetHistory(){this.history=[]}reset(){this.resetCurrent(),this.resetHistory()}getHistory(e){return this.history[e]}popHistory(){return this.history.pop()??""}pushHistory(){this.history.push(this.current),this.current=""}}let ki={};const A=new R5,da=new N5;let Bo=[],Hg=0,ev=0,_i={},Ps={correct:0,incorrect:0},It={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},mi={total:0,lastStartTime:-1},xi=[],tv=[],ks=[],lf=[],jp={count:0,words:[]},uf=[],Ug=!0;function Mw(){Hg++}function dM(){Ug=!1}function lM(){jp.count++}function Lw(t){jp.words.push(t)}function D5(t){ev=t}function av(){Bo.push(Hg),Hg=0}function sv(){uf.push(Ug),Ug=!0}function nv(){lf.push(jp),jp={count:0,words:[]}}function uM(t){t?Ps.correct++:Ps.incorrect++}function j5(t){var i,r;const e=Oe(ph(It.duration.array)),a=Object.entries(ki);a.sort((d,u)=>d[1].timestamp-u[1].timestamp);for(const d of a)cM(t,d[0]);const s=(i=_r(a))==null?void 0:i[0],n=(r=ki[s])==null?void 0:r.index;s!==void 0&&n!==void 0&&(It.duration.array[n]=e)}let Bp=0;function cM(t,e){if(!oM.includes(e))return;e==="NoCode"&&(Bp--,e="NoCode"+Bp);const a=ki[e];if(a===void 0)return;const s=Math.abs(a.timestamp-t);It.duration.array[a.index]=s,console.debug("Keyup recorded",e,s),delete ki[e],pM(t)}function B5(t,e){var a;if(!oM.includes(e)){console.debug("Key not tracked",e);return}if(e==="NoCode"&&(e="NoCode"+Bp,Bp++),ki[e]!==void 0){console.debug("Key already down",e);return}if(ki[e]={timestamp:t,index:It.duration.array.length},It.duration.array.push(0),pM((a=ki[e])==null?void 0:a.timestamp),It.spacing.last!==-1){const s=Math.abs(t-It.spacing.last);It.spacing.array.push(Oe(s)),console.debug("Keydown recorded",e,s)}It.spacing.last=t,It.spacing.first===-1&&(It.spacing.first=t,console.debug("First keydown recorded",e,t))}function pM(t){Object.keys(ki).length>1?mi.lastStartTime===-1&&(mi.lastStartTime=t):mi.lastStartTime!==-1&&(mi.total+=t-mi.lastStartTime,mi.lastStartTime=-1)}function q5(){It={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}},mi={total:0,lastStartTime:-1},ki={},Bp=0,console.debug("Keypress timings reset")}function mM(t){Object.keys(_i).includes(t)?_i[t]++:_i[t]=1}function fM(t){xi.push(t)}function hM(t){tv.push(t)}function gM(t){ks[I.currentIndex]===void 0?ks.push(t):ks[I.currentIndex]=t}function W5(){xi=[],tv=[],ks=[],Bo=[],Hg=0,uf=[],Ug=!0,lf=[],jp={count:0,words:[]},ev=0,_i={},Ps={correct:0,incorrect:0},It={spacing:{first:-1,last:-1,array:[]},duration:{array:[]}}}const F5=Lt.record(Lt.string(),Lt.string()),z5=Lt.record(Lt.string(),Lt.object({text:Lt.string(),progress:Lt.number()})),yM=new Ts({key:"customText",schema:F5,fallback:{}}),vM=new Ts({key:"customTextLong",schema:z5,fallback:{}}),H5=Lt.object({text:Lt.array(Lt.string()),mode:k5,limit:Lt.object({value:Lt.number(),mode:_5}),pipeDelimiter:Lt.boolean()}),U5={text:["The","quick","brown","fox","jumps","over","the","lazy","dog"],mode:"repeat",limit:{value:9,mode:"word"},pipeDelimiter:!1},Ma=new Ts({key:"customTextSettings",schema:H5,fallback:U5,migrate:(t,e,a)=>{if(typeof t!="object"||t===null)return a;const s=a;return"text"in t&&Lt.array(Lt.string()).safeParse(s.text).success&&(s.text=t.text),s}});function cf(){return Ma.get().text}function Pi(t){const e=Ma.get();Ma.set({...e,text:t,limit:{value:t.length,mode:e.limit.mode}})}function zu(){return Ma.get().mode}function qp(t){const e=Ma.get();Ma.set({...e,mode:t,limit:{value:e.text.length,mode:e.limit.mode}})}function K5(){return Ma.get().limit}function Bt(){return Ma.get().limit.value}function Jt(){return Ma.get().limit.mode}function ko(t){const e=Ma.get();Ma.set({...e,limit:{value:t,mode:e.limit.mode}})}function br(t){const e=Ma.get();Ma.set({...e,limit:{value:e.limit.value,mode:t}})}function Rl(){return Ma.get().pipeDelimiter}function pl(t){const e=Ma.get();Ma.set({...e,pipeDelimiter:t})}function ed(){return{text:cf(),mode:zu(),limit:K5(),pipeDelimiter:Rl()}}function Kg(t,e=!1){if(e){const s=Nl()[t];if(s===void 0)throw new Error(`Custom text ${t} not found`);return s.text.split(/ +/)}else{const a=iv()[t];if(a===void 0)throw new Error(`Custom text ${t} not found`);return a.split(/ +/)}}function V5(t,e,a=!1){if(a){const s=Nl();s[t]={text:"",progress:0};const n=s[t];if(n===void 0)throw new Error("Custom text not found");typeof e=="string"?n.text=e:n.text=e.join(" "),Ok(s)}else{const s=iv();typeof e=="string"?s[t]=e:s[t]=e.join(" "),wM(s)}}function bM(t,e){const a=e?Nl():iv();delete a[t],e?Ok(a):wM(a)}function Ik(t){const e=Nl()[t];if(e===void 0)throw new Error("Custom text not found");return e.progress??0}function Ew(t,e){const a=Nl(),s=a[t];if(s===void 0)throw new Error("Custom text not found");s.progress=e,Ok(a)}function iv(){return yM.get()}function Nl(){return vM.get()}function wM(t){yM.set(t)}function Ok(t){vM.set(t)}function Iw(t=!1){return Object.keys(t?Nl():iv())}let Vg=!0;const Ci=document.querySelector("#caret");function kM(){Vg&&(Ci.style.animationName="none",Ci.style.opacity="1",Vg=!1)}function _M(){Vg||(l.smoothCaret!=="off"&&!ia()?Ci.style.animationName="caretFlashSmooth":Ci.style.animationName="caretFlashHard",Vg=!0)}function pf(){Ci.classList.add("hidden")}function G5(t){var a,s;if(t||(t=(s=(a=document.getElementById("words"))==null?void 0:a.querySelectorAll(".word"))==null?void 0:s[0]),!t)return 0;const e=window.getComputedStyle(t);return parseInt(e.marginRight)+parseInt(e.marginLeft)}function Q5(t,e,a,s,n,i,r,d){const u=l.blindMode||l.hideExtraLetters;let c=0;if(l.tapeMode==="off"){let m=0;const f=n[d],h=n[r-1],y=n[d-1];e?d<r&&f?m=(f==null?void 0:f.offsetLeft)+(t?0:i):u?m=((h==null?void 0:h.offsetLeft)??0)-(t?i:0):m=((y==null?void 0:y.offsetLeft)??0)-(t?i:0):d<r&&f?m=f==null?void 0:f.offsetLeft:u?m=((h==null?void 0:h.offsetLeft)??0)+((h==null?void 0:h.offsetWidth)??0):m=((y==null?void 0:y.offsetLeft)??0)+((y==null?void 0:y.offsetWidth)??0),c=a.offsetLeft+m,s&&e&&(c+=a.offsetWidth)}else if(c=(o(document.querySelector("#wordsWrapper")).width()??0)/2-(t&&e?i:0),l.tapeMode==="word"&&d>0){let f=0;for(let h=0;h<d&&!(u&&h>=r);h++)f+=o(n[h]).outerWidth(!0)??0;e&&(f*=-1),c+=f}return c}async function Zi(t=!1){var Ee,ca;const e=Math.round(((Ee=document.querySelector("#caret"))==null?void 0:Ee.getBoundingClientRect().width)??0),a=["block","outline","underline"].includes(l.caretStyle);let s=I.getCurrent().length;const n=A.current.length;l.mode==="zen"&&(s=n);const i=document==null?void 0:document.querySelector("#words .active"),r=(i==null?void 0:i.children.length)===0;r&&i.insertAdjacentHTML("beforeend",'<letter style="opacity: 0;">_</letter>');const d=i==null?void 0:i.querySelectorAll("letter");if(!(d!=null&&d.length))return;const u=d[n],c=d[s-1],f=(await Kr(l.language)).rightToLeft,h=(u==null?void 0:u.offsetHeight)||(c==null?void 0:c.offsetHeight)||l.fontSize*xr(1),y=(u==null?void 0:u.offsetTop)??(c==null?void 0:c.offsetTop)??0,b=h-Ci.offsetHeight;let w=i.offsetTop+y+b/2;l.caretStyle==="underline"&&(w=i.offsetTop+y-Ci.offsetHeight/2);let $=u==null?void 0:u.offsetWidth;if($===void 0||r)$=G5(i);else if($===0){$=0;for(let aa=n;aa>=0&&($=(ca=d[aa])==null?void 0:ca.offsetWidth,!$);aa--);}const E=a?($??0)+"px":"",be=Q5(a,f,i,r,d,$,s,n)-(a?0:e/2);let J=o("#words .smoothScroller").height();J===void 0&&(J=0);const k=o(Ci);k.css("display","block");const S={top:w-J,left:be};E!==""?S.width=E:k.css("width","");const z=l.smoothCaret=="off"?0:l.smoothCaret=="slow"?150:l.smoothCaret=="medium"?100:l.smoothCaret=="fast"?85:0;if(k.stop(!0,!1).animate(S,ia()||t?0:z),l.showAllLines){const aa=window.innerHeight,ma=aa/2-k.outerHeight()/2,La=document.body.scrollHeight;if(w>=ma&&La>aa&&ea){const Tn=w-ma/2;window.scrollTo({left:0,top:Tn,behavior:dS()?"instant":"smooth"})}}r&&(i==null||i.replaceChildren())}function xM(t=!1){Ci.classList.remove("hidden"),Zi(t),_M()}const Pd=document.querySelector("#capsWarning"),Y5=navigator.platform.startsWith("Mac");let _o=!1,Gg=!1;function J5(){Gg||(Pd==null||Pd.classList.remove("hidden"),Gg=!0)}function X5(){Gg&&(Pd==null||Pd.classList.add("hidden"),Gg=!1)}function CM(t){var e,a;_o=((a=(e=t==null?void 0:t.originalEvent)==null?void 0:e.getModifierState)==null?void 0:a.call(e,"CapsLock"))??!_o;try{l.capsLockWarning&&_o?J5():X5()}catch{}}o(document).on("keyup",CM);o(document).on("keydown",t=>{Y5&&CM(t)});let Rr=!1,Nr=!1;const Rx=[["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal"],["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash"],["KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote"],["KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash"],["Space"]],e4=/^[^\p{L}\p{N}]{1}$/u,t4=/Mac|iPod|iPhone|iPad/.test(navigator.platform);let Nx=[!1,!1];function a4(){const t=Rr||Nr,e=t4?t||_o:t!==_o,[a,s]=Nx;if(!(a===e&&s===t))return Nx=[e,t]}async function SM(){const t=a4();if(t===void 0)return;const e=[...document.getElementsByClassName("keymapKey")].filter(u=>{const c=u.classList.contains("keymapKey"),m=!u.classList.contains("keySpace")&&!u.classList.contains("keySplitSpace");return c&&m}),a=e.map(u=>u.dataset.key);if(a.includes(void 0))return;const s=e.map(u=>u.childNodes[1]),[n,i]=t,r=l.keymapLayout==="overrideSync"?l.layout==="default"?"qwerty":l.layout:l.keymapLayout,d=await Gm(r).catch(()=>{});if(d===void 0){g("Failed to load keymap layout",-1);return}for(let u=0;u<a.length;u++){const c=a[u],m=s[u],f=c[0],h=c[1];if(m===void 0||c===void 0||f===void 0||h===void 0)continue;const y=[f,h].some(J=>e4.test(J??"")),b=TM(f,d);if(b===void 0)return;const E=Ow(b)&&(y?i:n),L=Number(E),be=c[L];m.textContent=be??""}}o(document).on("keydown",t=>{t.code==="ShiftLeft"?(Rr=!0,Nr=!1):t.code==="ShiftRight"&&(Rr=!1,Nr=!0),l.keymapLegendStyle==="dynamic"&&SM()});o(document).on("keyup",t=>{(t.code==="ShiftLeft"||t.code==="ShiftRight")&&(Rr=!1,Nr=!1),l.keymapLegendStyle==="dynamic"&&SM()});function s4(){Rr=!1,Nr=!1}const n4=["KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyA","KeyS","KeyD","KeyF","KeyG","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6"],i4=["KeyY","KeyU","KeyI","KeyO","KeyP","KeyH","KeyJ","KeyK","KeyL","KeyB","KeyN","KeyM","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","Backslash","BracketLeft","BracketRight","Semicolon","Quote","Comma","Period","Slash"];function Ow(t){if(!Rr&&!Nr||l.oppositeShiftMode==="off")return!0;const e=i4.includes(t),a=n4.includes(t);return!!(!e&&!a||Rr&&e||Nr&&a)}function TM(t,e){var d,u;const a=Object.values(e.keys),s=a.findIndex(c=>c.find(m=>m.includes(t))),n=a[s];if(n===void 0)return;const i=n.findIndex(c=>c.includes(t));if(i===-1)return;let r=(d=Rx[s])==null?void 0:d[i];return e.type==="iso"&&(s===2&&i===11?r="Backslash":s===3&&i===0?r="IntlBackslash":s===3&&(r=(u=Rx[3])==null?void 0:u[i-1])),r}async function $M(){return await B0(()=>import("./howler.Bd76bBNG.js").then(t=>t.h),__vite__mapDeps([5,1]))}let Is=null,qo=null;async function AM(){const t=(await $M()).Howl;Is===null&&(Is={1:[{sounds:[new t({src:"../sound/error1/error1_1.wav"}),new t({src:"../sound/error1/error1_1.wav"})],counter:0}],2:[{sounds:[new t({src:"../sound/error2/error2_1.wav"}),new t({src:"../sound/error2/error2_1.wav"})],counter:0}],3:[{sounds:[new t({src:"../sound/error3/error3_1.wav"}),new t({src:"../sound/error3/error3_1.wav"})],counter:0}],4:[{sounds:[new t({src:"../sound/error4/error4_1.wav"}),new t({src:"../sound/error4/error4_1.wav"})],counter:0},{sounds:[new t({src:"../sound/error4/error4_2.wav"}),new t({src:"../sound/error4/error4_2.wav"})],counter:0}]},Howler.volume(l.soundVolume))}async function rv(){const t=(await $M()).Howl;qo===null&&(qo={1:[{sounds:[new t({src:"../sound/click1/click1_1.wav"}),new t({src:"../sound/click1/click1_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click1/click1_2.wav"}),new t({src:"../sound/click1/click1_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click1/click1_3.wav"}),new t({src:"../sound/click1/click1_3.wav"})],counter:0}],2:[{sounds:[new t({src:"../sound/click2/click2_1.wav"}),new t({src:"../sound/click2/click2_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click2/click2_2.wav"}),new t({src:"../sound/click2/click2_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click2/click2_3.wav"}),new t({src:"../sound/click2/click2_3.wav"})],counter:0}],3:[{sounds:[new t({src:"../sound/click3/click3_1.wav"}),new t({src:"../sound/click3/click3_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click3/click3_2.wav"}),new t({src:"../sound/click3/click3_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click3/click3_3.wav"}),new t({src:"../sound/click3/click3_3.wav"})],counter:0}],4:[{sounds:[new t({src:"../sound/click4/click4_1.wav"}),new t({src:"../sound/click4/click4_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_2.wav"}),new t({src:"../sound/click4/click4_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_3.wav"}),new t({src:"../sound/click4/click4_33.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_4.wav"}),new t({src:"../sound/click4/click4_44.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_5.wav"}),new t({src:"../sound/click4/click4_55.wav"})],counter:0},{sounds:[new t({src:"../sound/click4/click4_6.wav"}),new t({src:"../sound/click4/click4_66.wav"})],counter:0}],5:[{sounds:[new t({src:"../sound/click5/click5_1.wav"}),new t({src:"../sound/click5/click5_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_2.wav"}),new t({src:"../sound/click5/click5_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_3.wav"}),new t({src:"../sound/click5/click5_33.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_4.wav"}),new t({src:"../sound/click5/click5_44.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_5.wav"}),new t({src:"../sound/click5/click5_55.wav"})],counter:0},{sounds:[new t({src:"../sound/click5/click5_6.wav"}),new t({src:"../sound/click5/click5_66.wav"})],counter:0}],6:[{sounds:[new t({src:"../sound/click6/click6_1.wav"}),new t({src:"../sound/click6/click6_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click6/click6_2.wav"}),new t({src:"../sound/click6/click6_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click6/click6_3.wav"}),new t({src:"../sound/click6/click6_33.wav"})],counter:0}],7:[{sounds:[new t({src:"../sound/click7/click7_1.wav"}),new t({src:"../sound/click7/click7_11.wav"})],counter:0},{sounds:[new t({src:"../sound/click7/click7_2.wav"}),new t({src:"../sound/click7/click7_22.wav"})],counter:0},{sounds:[new t({src:"../sound/click7/click7_3.wav"}),new t({src:"../sound/click7/click7_33.wav"})],counter:0}],14:[{sounds:[new t({src:"../sound/click14/click14_1.wav"}),new t({src:"../sound/click14/click14_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_2.wav"}),new t({src:"../sound/click14/click14_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_3.wav"}),new t({src:"../sound/click14/click14_3.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_4.wav"}),new t({src:"../sound/click14/click14_4.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_5.wav"}),new t({src:"../sound/click14/click14_5.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_6.wav"}),new t({src:"../sound/click14/click14_6.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_7.wav"}),new t({src:"../sound/click14/click14_7.wav"})],counter:0},{sounds:[new t({src:"../sound/click14/click14_8.wav"}),new t({src:"../sound/click14/click14_8.wav"})],counter:0}],15:[{sounds:[new t({src:"../sound/click15/click15_1.wav"}),new t({src:"../sound/click15/click15_1.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_2.wav"}),new t({src:"../sound/click15/click15_2.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_3.wav"}),new t({src:"../sound/click15/click15_3.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_4.wav"}),new t({src:"../sound/click15/click15_4.wav"})],counter:0},{sounds:[new t({src:"../sound/click15/click15_5.wav"}),new t({src:"../sound/click15/click15_5.wav"})],counter:0}]},Howler.volume(l.soundVolume))}async function aee(t){qo===null&&await rv();const e=qo;Object.keys(e).includes(t)&&(e[t][0].sounds[0].seek(0),e[t][0].sounds[0].play())}async function see(t){var s,n,i,r,d,u;Is===null&&await AM(),Object.keys(Is).includes(t)&&((i=(n=(s=Is==null?void 0:Is[t])==null?void 0:s[0])==null?void 0:n.sounds[0])==null||i.seek(0),(u=(d=(r=Is==null?void 0:Is[t])==null?void 0:r[0])==null?void 0:d.sounds[0])==null||u.play())}let Su="KeyA";o(document).on("keydown",t=>{Su=t.code||"KeyA"});const rt={C:[16.35,32.7,65.41,130.81,261.63,523.25,1046.5,2093,4186.01],Db:[17.32,34.65,69.3,138.59,277.18,554.37,1108.73,2217.46,4434.92],D:[18.35,36.71,73.42,146.83,293.66,587.33,1174.66,2349.32,4698.64],Eb:[19.45,38.89,77.78,155.56,311.13,622.25,1244.51,2489.02,4978.03],E:[20.6,41.2,82.41,164.81,329.63,659.26,1318.51,2637.02],F:[21.83,43.65,87.31,174.61,349.23,698.46,1396.91,2793.83],Gb:[23.12,46.25,92.5,185,369.99,739.99,1479.98,2959.96],G:[24.5,49,98,196,392,783.99,1567.98,3135.96],Ab:[25.96,51.91,103.83,207.65,415.3,830.61,1661.22,3322.44],A:[27.5,55,110,220,440,880,1760,3520],Bb:[29.14,58.27,116.54,233.08,466.16,932.33,1864.66,3729.31],B:[30.87,61.74,123.47,246.94,493.88,987.77,1975.53,3951.07]};function dt(t,e=0){return a=>t[a+e]??0}const zf={KeyZ:dt(rt.C),KeyS:dt(rt.Db),KeyX:dt(rt.D),KeyD:dt(rt.Eb),KeyC:dt(rt.E),KeyV:dt(rt.F),KeyG:dt(rt.Gb),KeyB:dt(rt.G),KeyH:dt(rt.Ab),KeyN:dt(rt.A),KeyJ:dt(rt.Bb),KeyM:dt(rt.B),Comma:dt(rt.C,1),KeyL:dt(rt.Db,1),Period:dt(rt.D,1),Semicolon:dt(rt.Eb,1),Slash:dt(rt.E,1),KeyQ:dt(rt.C,1),Digit2:dt(rt.Db,1),KeyW:dt(rt.D,1),Digit3:dt(rt.Eb,1),KeyE:dt(rt.E,1),KeyR:dt(rt.F,1),Digit5:dt(rt.Gb,1),KeyT:dt(rt.G,1),Digit6:dt(rt.Ab,1),KeyY:dt(rt.A,1),Digit7:dt(rt.Bb,1),KeyU:dt(rt.B,1),KeyI:dt(rt.C,2),Digit9:dt(rt.Db,2),KeyO:dt(rt.D,2),Digit0:dt(rt.Eb,2),KeyP:dt(rt.E,2),BracketLeft:dt(rt.F,2),Equal:dt(rt.Gb,2),BracketRight:dt(rt.G,2)},MM={8:"sine",9:"sawtooth",10:"square",11:"triangle"};let la;function LM(){if(la!==null)try{la=new AudioContext}catch(t){la=null,console.error(t),g(qe(t,"Error initializing audio context")+". Notes will not play.",-1)}}const Dx={pentatonic:["C","D","E","G","A"],wholetone:["C","D","E","Gb","Ab","Bb"]};function jx(t){const e={position:0,octave:4,direction:1};return async()=>{qo===null&&await rv(),EM(t,e)}}const Bx={position:0,octave:4,direction:1},qx={12:{name:"pentatonic",preview:jx("pentatonic"),meta:Bx},13:{name:"wholetone",preview:jx("wholetone"),meta:Bx}};function EM(t,e){if(la===void 0&&LM(),!la)return;const a=Sa(0,Dx[t].length-1);Math.random()<.5&&(e.octave+=e.direction),e.octave>=6&&(e.direction=-1),e.octave<=4&&(e.direction=1);const s=Dx[t][a],n=rt[s][e.octave],i=la.createOscillator(),r=la.createGain();i.type="sine",r.gain.value=l.soundVolume/10,i.connect(r),r.connect(la.destination),i.frequency.value=n,i.start(la.currentTime),r.gain.setTargetAtTime(0,la.currentTime,.3),i.stop(la.currentTime+2)}function r4(t,e){var d;if(la===void 0&&LM(),!la||(Su=t??Su,!(Su in zf)))return;const s=3+(Rr||Nr||_o?1:0),n=(d=zf[Su])==null?void 0:d.call(zf,s),i=la.createOscillator(),r=la.createGain();i.type=e??MM[l.playSoundOnClick],r.gain.value=l.soundVolume/10,i.connect(r),r.connect(la.destination),i.frequency.value=n,i.start(la.currentTime),r.gain.setTargetAtTime(0,la.currentTime,.15),i.stop(la.currentTime+.5)}async function Ri(t){if(l.playSoundOnClick==="off")return;if(l.playSoundOnClick in qx){const{name:n,meta:i}=qx[l.playSoundOnClick];EM(n,i);return}if(l.playSoundOnClick in MM){r4(t??void 0);return}qo===null&&await rv();const e=qo[l.playSoundOnClick];if(e===void 0)throw new Error("Invalid click sound ID");const a=zn(e),s=a.sounds[a.counter];a.counter++,a.counter===2&&(a.counter=0),s.seek(0),s.play()}async function ov(){if(l.playSoundOnError==="off")return;Is===null&&await AM();const t=Is[l.playSoundOnError];if(t===void 0)throw new Error("Invalid error sound ID");const e=zn(t),a=e.sounds[e.counter];e.counter++,e.counter===2&&(e.counter=0),a.seek(0),a.play()}function o4(t){try{Howler.volume(t)}catch{}}Dt((t,e)=>{t==="playSoundOnClick"&&e!=="off"&&rv(),t==="soundVolume"&&o4(parseFloat(e))});let Pk=[],jn=[],IM=0,Zk=!0,Nn=0,wa=0,Wo=0,mf=0,Qg=[],Pw=[];var YC;const ga=(YC=document.getElementById("playpauseReplayButton"))==null?void 0:YC.children[0];function OM(t){Pk=t}function Rk(){const t=document.getElementById("replayWords");if(t===null)return;t.innerHTML="";let e=0;jn.forEach(a=>{a.action==="backWord"?e--:(a.action==="submitCorrectWord"||a.action==="submitErrorWord")&&e++}),Pk.forEach((a,s)=>{if(s>e)return;const n=document.createElement("div");n.className="word";for(const i of a){const r=document.createElement("letter");r.innerHTML=i,n.appendChild(r)}t.appendChild(n)})}function ff(){var t;Qg.forEach(e=>{clearTimeout(e)}),Qg=[],Pw.forEach(e=>{clearTimeout(e)}),Pw=[],mf=wa,Wo=Nn,ga!==void 0&&(ga.className="fas fa-play",(t=ga.parentNode)==null||t.setAttribute("aria-label","Resume replay"))}function rd(t=!1){t&&l.playSoundOnError!=="off"?ov():Ri()}function PM(t,e=!1){var s,n,i,r;let a=(s=document.getElementById("replayWords"))==null?void 0:s.children[Nn];if(a!==void 0){if(t.action==="correctLetter")e||rd(),(n=a.children[wa])==null||n.classList.add("correct"),wa++;else if(t.action==="incorrectLetter"){e||rd(!0);let d;wa>=a.children.length&&(d=document.createElement("letter"),d==null||d.classList.add("extra"),d.innerHTML=((i=t.value)==null?void 0:i.toString())??"",a.appendChild(d)),d=a.children[wa],d==null||d.classList.add("incorrect"),wa++}else if(t.action==="setLetterIndex"&&typeof t.value=="number"){e||rd(),wa=t.value;for(const d of[...a.children].slice(wa))d!=null&&d.classList.contains("extra")?d.remove():d.className=""}else if(t.action==="submitCorrectWord")e||rd(),Nn++,wa=0;else if(t.action==="submitErrorWord")e||rd(!0),a==null||a.classList.add("error"),Nn++,wa=0;else if(t.action==="backWord"){e||rd(),Nn--;const d=document.getElementById("replayWords");for(d!==null&&(a=d.children[Nn]),wa=a.children.length;((r=a.children[wa-1])==null?void 0:r.className)==="";)wa--;a==null||a.classList.remove("error")}}}function Nk(){var s;let t=0;wa=0,Nn=0,jn.forEach((n,i)=>{(Nn<Wo||Nn===Wo&&wa<mf)&&(PM(n,!0),t=i+1)});const e=(s=jn[t])==null?void 0:s.time;if(e===void 0)throw new Error("Failed to load old replay: datatime is undefined");const a=Math.floor(e/1e3);return RM(a),t}function ZM(){var t;o("#resultReplay").stop(!0,!0).hasClass("hidden")?(Rk(),Nk(),o("#watchReplayButton").hasClass("loaded")?o("#resultReplay").removeClass("hidden").css("display","none").slideDown(250):(o("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),o("#resultReplay").removeClass("hidden").css("display","none").slideDown(250))):(((t=ga==null?void 0:ga.parentNode)==null?void 0:t.getAttribute("aria-label"))!="Start replay"&&ff(),o("#resultReplay").slideUp(250,()=>{o("#resultReplay").addClass("hidden")}))}function d4(){o("#resultReplay").stop(!0,!0).hasClass("hidden")||ZM(),o("#replayStats").text(""),jn=[],IM=performance.now(),Zk=!0,mf=0,Wo=0}function Dk(){Zk=!1}function xo(t,e){if(!Zk)return;const a=performance.now()-IM;jn.push({action:t,value:e,time:a})}function RM(t){const a=`${xi[t-1]??0}wpm	${t}s`;o("#replayStats").text(a)}function l4(){var n,i;if(wa=0,Nn=0,ga===void 0)return;ga.className="fas fa-pause",(n=ga.parentNode)==null||n.setAttribute("aria-label","Pause replay"),Rk();const t=Nk(),e=(i=jn[t])==null?void 0:i.time;if(e===void 0)throw new Error("Failed to play replay: lastTime is undefined");let a=Math.round(e/1e3);const s=Math.round(_r(jn).time/1e3);for(;a<=s;){const r=a;Pw.push(setTimeout(()=>{RM(r)},r*1e3-e)),a++}jn.forEach((r,d)=>{d<t||Qg.push(setTimeout(()=>{PM(r)},r.time-e))}),Qg.push(setTimeout(()=>{mf=0,Wo=0,ga.className="fas fa-play",ga.parentNode.setAttribute("aria-label","Start replay")},_r(jn).time-e))}function u4(){return JSON.stringify({replayData:jn,wordsList:Pk})}o(".pageTest #playpauseReplayButton").on("click",()=>{(ga==null?void 0:ga.className)==="fas fa-play"?l4():(ga==null?void 0:ga.className)==="fas fa-pause"&&ff()});o("#replayWords").on("click","letter",t=>{ff();const e=document.querySelector("#replayWords"),a=[...(e==null?void 0:e.children)??[]];Wo=a.indexOf(t.target.parentNode),mf=[...a[Wo].children].indexOf(t.target),Rk(),Nk()});o(".pageTest").on("click","#watchReplayButton",()=>{ZM()});class Jl{constructor(e,a,s,n,i){this.unit=e,this.convertFactor=a,this.fullUnitString=s,this.histogramDataBucketSize=n,this.historyStepSize=i}fromWpm(e){return e*this.convertFactor}toWpm(e){return e/this.convertFactor}}const c4={wpm:new Jl("wpm",1,"Words per Minute",10,10),cpm:new Jl("cpm",5,"Characters per Minute",50,100),wps:new Jl("wps",1/60,"Words per Second",.5,2),cps:new Jl("cps",5/60,"Characters per Second",5,5),wph:new Jl("wph",60,"Words per Hour",250,1e3)};function Ta(t){return c4[t]}const dv={composing:!1,startPos:-1};function Co(){return dv.composing}function p4(){return dv.startPos}function NM(t){dv.composing=t}function m4(t){dv.startPos=t}const Oa=16,DM=12,Zw=Oa/2,f4=DM/2,Wx=250;let Ya=[],fa,ml={},Yg=[],lv=[],Hu=[],jk=[],$d=[],Hf,od,jM=new Date,Wp=!1,BM=!1,Rw=!0,Jg=!0,Nw=!1,Uf=!1;async function h4(t,e){if(!BM||$d!==void 0&&t===$d[0]&&e===$d[1]||!Wp&&!await y4()||t===void 0||e===void 0||t<0||e<0||e<t)return!1;e=Math.min(e,fa.length-1);const a=v4(t,e,Nw);for(let s=0;s<Ya.length;s++){const n=lv[s],i=n.children[0];n.classList.remove("highlight-hidden"),!Rw&&!Jg?(n.classList.add("withAnimation"),i.classList.add("withAnimation")):(n.classList.remove("withAnimation"),i.classList.remove("withAnimation"));const r=a[s];r&&(n.style.right=r.highlightRight+"px",i.style.left=r.inputContainerLeft+"px",n.style.left=r.highlightLeft+"px")}return Rw=!1,Jg=!1,$d=[t,e],!0}function g4(){for(const t of lv)t.classList.add("highlight-hidden");Jg=!0,$d=[]}function Bk(){if(Wp){for(const t of Yg)t.remove();lv=[],Yg=[],ml={},Ya=[],Hu=[],jk=[],Wp=!1,Rw=!0,Jg=!0,$d=[]}}function qM(t){BM=t}async function y4(){if(Wp||Uf)return!1;Uf=!0;const t=new Date().getTime()-jM.getTime();if(t<Wx&&await new Promise(c=>setTimeout(c,Wx-t)),Nw=(await Kr(l.language)).rightToLeft,Hf=o("#resultWordsHistory")[0],od=Hf.getBoundingClientRect(),fa=o(Hf).find(".words .word[input]"),fa.length===0)return Uf=!1,!1;let a=-1,s,n=0;ml[0]=0;for(let c=1;c<fa.length;c++){const m=fa[c],f=fa[c-1];m.offsetTop!=f.offsetTop&&(n++,s=Bu([fa[a+1],f]),Ya.push({firstWordIndex:a+1,lastWordIndex:c-1,rect:s}),a=c-1),ml[c]=n}s=Bu([fa[a+1],fa[fa.length-1]]),Ya.push({firstWordIndex:a+1,lastWordIndex:fa.length-1,rect:s});const i=od.width,r=od.height,d=od.top,u=od.left;return Ya.forEach(c=>{const m=document.createElement("div");m.classList.add("highlightContainer"),Yg.push(m);const f=c.rect.top-f4,h=c.rect.left-Zw,y=f-d,b=h-u,w=c.rect.width+Oa,$=c.rect.height+DM,E=c.rect.width,L=c.rect.height,be=y/r*100+"%",J=b/i*100+"%",k=w/i*100+"%",S=$/r*100+"%";m.style.width=k,m.style.top=be,m.style.left=J,m.style.height=S;const z=document.createElement("div"),Ee=document.createElement("div");Ee.style.top=c.rect.top-f+"px",Ee.style.left=c.rect.left-h+"px",Ee.style.width=E+"px",Ee.style.height=L+"px",z.className="highlight highlight-hidden",Ee.className="inputWordsContainer";for(let ca=c.firstWordIndex;ca<=c.lastWordIndex;ca+=1){const aa=fa[ca],ma=aa.getAttribute("input")??"";if(!ma)continue;const La=document.createElement("div");let Tn;Nw?Tn=c.rect.left-od.left+Oa:Tn=0,La.style.left=aa.offsetLeft+Zw-Tn+"px",La.innerHTML=ma.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt").slice(0,aa.childElementCount),La.className="inputWord",Ee.append(La),jk.push(La)}Hu.push(Ee),lv.push(z),z.append(Ee),m.append(z),Hf.append(m)}),Wp=!0,Uf=!1,!0}function v4(t,e,a=!1){const s=ml[t],n=new Array(Ya.length).fill(null).map(()=>({highlightLeft:0,highlightRight:0,inputContainerLeft:0,inputContainerRight:0})),i=b4(t,e),r=fa[t],d=Ya[s],u=n[s],c=Yg[s],m=Hu[s];if(r===void 0||d===void 0||u===void 0||c===void 0||m===void 0)return n;if(!a)u.highlightLeft=r.offsetLeft,u.highlightRight=d.rect.width-(u.highlightLeft+i)+Oa;else{const f=c.offsetLeft;u.highlightRight=d.rect.width-(r.offsetLeft+r.offsetWidth)+f+Zw,u.highlightLeft=d.rect.width-(u.highlightRight+i)+Oa}a?u.inputContainerLeft=-1*(m.getBoundingClientRect().width-i-u.highlightRight):u.inputContainerLeft=-1*u.highlightLeft;for(let f=s-1;f>=0;f--){const h=n[f],y=n[f+1],b=Ya[f],w=Hu[f];h===void 0||b===void 0||y===void 0||w===void 0||(a?(h.highlightRight=y.highlightRight+b.rect.width+Oa,h.highlightLeft=b.rect.width-(h.highlightRight+i)+Oa,h.inputContainerLeft=-1*(w.getBoundingClientRect().width-i-h.highlightRight)):(h.highlightLeft=y.highlightLeft+b.rect.width+Oa,h.highlightRight=b.rect.width-(h.highlightLeft+i)+Oa,h.inputContainerLeft=-1*h.highlightLeft))}for(let f=s+1;f<Ya.length;f++){const h=n[f],y=Ya[f-1],b=Ya[f],w=n[f-1],$=Hu[f];h===void 0||y===void 0||b===void 0||w===void 0||$===void 0||(a?(h.highlightRight=-1*(y.rect.width-w.highlightRight+Oa),h.highlightLeft=b.rect.width-(h.highlightRight+i)+Oa,h.inputContainerLeft=-1*($.getBoundingClientRect().width-i-h.highlightRight)):(h.highlightLeft=-1*(y.rect.width-w.highlightLeft+Oa),h.highlightRight=b.rect.width-(h.highlightLeft+i)+Oa,h.inputContainerLeft=-1*h.highlightLeft))}return n}function b4(t,e){var b,w;const a=ml[t],s=ml[e];if(a===void 0||s===void 0)return 0;const n=fa[t],i=fa[e],r=jk[e],d=fa[((b=Ya[a])==null?void 0:b.lastWordIndex)??-1],u=fa[((w=Ya[s])==null?void 0:w.firstWordIndex)??-1];if(n===void 0||i===void 0||r===void 0||d===void 0||u===void 0)return 0;if(a==s){const $=Bu([n,i]),E=i.getBoundingClientRect(),L=r.getBoundingClientRect();let be=$.width+Oa;return be-=E.width-L.width,be}const c=Bu([n,d]),m=Bu([u,i]);let f=c.width+m.width;for(let $=a+1;$<s;$++)f+=Ya[$].rect.width;f+=2*Oa*(s-a);const h=i.getBoundingClientRect(),y=r.getBoundingClientRect();return f-=h.width-y.width,f}function w4(){jM=new Date}let WM="loading";function ft(){return WM}function k4(t){WM=t}const Uv={suffix:"",fallback:"-",showDecimalPlaces:void 0,rounding:Math.round};class _4{constructor(e){this.config=e}typingSpeed(e,a={}){const s={...Uv,...a};if(e==null)return s.fallback??"";const n=Ta(this.config.typingSpeedUnit).fromWpm(e);return this.number(n,s)}percentage(e,a={}){const s={...Uv,...a};return s.suffix="%"+(s.suffix??""),this.number(e,s)}accuracy(e,a={}){return this.percentage(e,{rounding:Math.floor,...a})}decimals(e,a={}){const s={...Uv,...a};return this.number(e,s)}number(e,a){if(e==null)return a.fallback??"";const s=a.suffix??"";return(a.showDecimalPlaces!==void 0?a.showDecimalPlaces:this.config.alwaysShowDecimalPlaces)?Oe(e).toFixed(2)+s:(a.rounding??Math.round)(e).toString()+s}rank(e,a={}){const s={fallback:"-",...a};if(e==null)return s.fallback??"";let n="th";const i=e%10,r=e%100;return i===1&&r!==11&&(n="st"),i===2&&r!==12&&(n="nd"),i===3&&r!==13&&(n="rd"),e+n}}const ve=new _4(l);async function x4(){return(await B0(()=>import("./html2canvas.esm.CBrSDip1.js"),[])).default}function C4(t,e,a){let s="";for(const n of t)for(const i of n){const r=e[i].offsetLeft,d=e[i].offsetWidth,u=`[${i}]`,c=a[i];s+=`<hint data-length=1 data-chars-index=${u} style="left: ${r+d/2}px;">${c}</hint>`}return s=`<div class="hints">${s}</div>`,s}async function S4(t,e,a){const n=(await Kr(l.language)).rightToLeft;let i=0;for(const r of t){for(let d=0;d<r.length-1;d++){const u=a[i],c=a[i+1],m=n?c:u,f=n?u:c;if(m.offsetLeft+m.offsetWidth/2>f.offsetLeft-f.offsetWidth/2){u.dataset.length=(parseInt(u.dataset.length??"1")+parseInt(c.dataset.length??"1")).toString();const h=u.dataset.charsIndex??"[]",y=c.dataset.charsIndex??"[]";u.dataset.charsIndex=h.slice(0,-1)+","+y.slice(1);const b=r[d]??0,w=e[b].offsetLeft+(n?e[b].offsetWidth:0)+(c.offsetLeft-u.offsetLeft);u.style.left=w.toString()+"px",u.insertAdjacentHTML("beforeend",c.innerHTML),c.remove(),r.splice(d+1,1),i-=d===0?1:2,d-=d===0?1:2}i++}i++}}const T4=cs(250,async()=>{const t=await wB(l.language);t==="no"&&g(`${Yd(Ar(l.language))} does not support Zipf funbox, because the list is not ordered by frequency. Please try another word list.`,0,{duration:7}),t==="unknown"&&g(`${Yd(Ar(l.language))} may not support Zipf funbox, because we don't know if it's ordered by frequency or not. If you would like to add this label, please contact us.`,0,{duration:7})});Dt((t,e,a)=>{(t==="language"||t==="funbox")&&l.funbox.split("#").includes("zipf")&&T4(),t==="fontSize"&&!a&&(Ym(),Fk(!0),Wk(!0)),["fontSize","fontFamily","blindMode","hideExtraLetters"].includes(t)&&HM().catch(s=>{console.error(s)}),t==="theme"&&Zd(),e!==void 0&&(t==="highlightMode"&&ft()==="test"&&cv(),["highlightMode","blindMode","indicateTypos","tapeMode","hideExtraLetters"].includes(t)&&KM(),t==="tapeMode"&&!a&&(e==="off"?o("#words").css("margin-left","unset"):hf()),typeof e=="boolean"&&(t==="flipTestColors"&&E4(e),t==="colorfulMode"&&I4(e),t==="burstHeatmap"&&Zd()))});let zt=0,Yt=!1,ds=!1,Dw=!1,Ah=0,Fo=!1;function FM(t){Yt=t}function qk(t){zt=t}let Kf;function jw(t){ds=t,t?new Promise(e=>{Kf=e}):(Kf&&Kf(),Kf=null)}function zM(t){Fo=t}function $4(){Ah=0,zt=0}function uv(){o("#wordsInput").trigger("focus")}function cv(t,e=!1){const a=document.querySelector("#words .active");t||a==null||a.classList.add("typed"),l.mode==="zen"&&t?a==null||a.remove():a!==null&&!e&&a.classList.remove("active");const s=document.querySelectorAll("#words .word")[zt];if(s==null)throw new Error("activeWord is undefined - can't update active element");s.classList.add("active"),s.classList.remove("error"),s.classList.remove("typed"),s.offsetTop,!e&&L4()&&Wk(),l.tapeMode!=="off"&&hf()}async function HM(){var i,r,d,u;if(ft()!=="test"||Yt||l.indicateTypos!=="below")return;const e=(await Kr(l.language)).rightToLeft;let a,s;const n=(i=document.getElementById("words"))==null?void 0:i.querySelectorAll("div.word > div.hints > hint");for(let c=0;c<((n==null?void 0:n.length)??0);c++){const m=n==null?void 0:n[c];(!a||((r=m.parentElement)==null?void 0:r.parentElement)!==a)&&(a=(d=m.parentElement)==null?void 0:d.parentElement,s=a==null?void 0:a.querySelectorAll("letter"));const f=(u=m.dataset.charsIndex)==null?void 0:u.slice(1,-1).split(",").map(w=>parseInt(w)),h=e?parseInt(m.dataset.length??"1")-1:0;let y=(s==null?void 0:s[(f==null?void 0:f[h])??0]).offsetLeft;const b=(f==null?void 0:f.reduce((w,$)=>w+(s==null?void 0:s[$]).offsetWidth,0))??0;y+=b/2,m.style.left=y.toString()+"px"}}function UM(t){var n;let e=!1,a="<div class='word'>";const s=ze(l.funbox).find(i=>{var r;return(r=i.functions)==null?void 0:r.getWordHtml});for(let i=0;i<t.length;i++)(n=s==null?void 0:s.functions)!=null&&n.getWordHtml?a+=s.functions.getWordHtml(t.charAt(i),!0):t.charAt(i)==="	"?a+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:t.charAt(i)===`
`?(e=!0,a+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):a+="<letter>"+t.charAt(i)+"</letter>";return a+="</div>",e&&(a+="<div class='newline'></div>"),a}function KM(){var e,a,s;l.tapeMode!=="off"?(o("#words").addClass("tape"),o("#wordsWrapper").addClass("tape")):(o("#words").removeClass("tape"),o("#wordsWrapper").removeClass("tape")),l.blindMode?(o("#words").addClass("blind"),o("#wordsWrapper").addClass("blind")):(o("#words").removeClass("blind"),o("#wordsWrapper").removeClass("blind")),l.indicateTypos==="below"?(o("#words").addClass("indicateTyposBelow"),o("#wordsWrapper").addClass("indicateTyposBelow")):(o("#words").removeClass("indicateTyposBelow"),o("#wordsWrapper").removeClass("indicateTyposBelow")),l.hideExtraLetters?(o("#words").addClass("hideExtraLetters"),o("#wordsWrapper").addClass("hideExtraLetters")):(o("#words").removeClass("hideExtraLetters"),o("#wordsWrapper").removeClass("hideExtraLetters"));const t=((s=(a=(e=o("#words"))==null?void 0:e.attr("class"))==null?void 0:a.split(/\s+/))==null?void 0:s.filter(n=>!n.startsWith("highlight-")))??[];l.highlightMode!=null&&t.push("highlight-"+l.highlightMode.replaceAll("_","-")),o("#words").attr("class",t.join(" ")),GM(),Fk(!0),setTimeout(()=>{Wk(!0)},250)}function A4(){o("#words").empty();let t="";if(l.mode!=="zen")for(let e=0;e<I.length;e++)t+=UM(I.get(e));else t='<div class="word">word height</div><div class="word active"></div>';o("#words").html(t),cv(void 0,!0),setTimeout(()=>{Zi()},125),KM(),l.mode==="zen"&&o(document.querySelector(".word")).remove()}const M4=["japanese","chinese","korean"];function L4(){return M4.some(e=>l.language.startsWith(e))||l.mode!=="time"&&l.showAllLines}async function Wk(t=!1){if(ft()!=="test"||l.tapeMode!=="off"&&!t)return;const a=(await Kr(l.language)).rightToLeft,s=document.querySelector("#wordsInput"),n=document.querySelectorAll("#words .word")[zt];if(!n){s.style.top="0px",s.style.left="0px";return}const i=window.getComputedStyle(n),r=parseInt(i.marginTop)+parseInt(i.marginBottom),d=xr(l.fontSize),u=n.offsetTop+d/2-s.offsetHeight/2+1;if(n.offsetWidth<d?s.style.width=d+"px":s.style.width=n.offsetWidth+"px",l.tapeMode!=="off"){s.style.top=u+"px",s.style.left=n.offsetLeft+"px";return}t?s.style.top=u+d+r+4+"px":s.style.top=u+"px",n.offsetWidth<d&&a?s.style.left=n.offsetLeft-d+"px":s.style.left=n.offsetLeft+"px"}function Fk(t=!1){if(ft()!=="test"||Yt||!t&&l.mode!=="custom")return;o("#wordsWrapper").removeClass("hidden");const e=o(document.querySelector(".word")).outerHeight(!0);if(o(document.querySelector("#words")).outerHeight(!0),l.showAllLines&&l.mode!=="time"&&Jt()!=="time"&&Bt()!==0)o("#words").css("height","auto").css("overflow","visible clip").css("width","100%").css("margin-left","unset"),o("#wordsWrapper").css("height","auto").css("overflow","visible clip"),o(".outOfFocusWarning").css("margin-top",e+xr(1)/2+"px");else{let a,s;if(l.tapeMode!=="off")a=e*2,s=e;else{let n=0,i=0,r=0;const d=document.querySelectorAll("#words .word");let u=0;const c=window.getComputedStyle(d[0]),m=parseInt(c.marginTop),f=parseInt(c.marginBottom);for(;n<3;){const y=d[r];if(!y)break;const b=y.offsetTop;b>i&&(n++,u+=y.offsetHeight+m+f,i=b),r++}n<3&&(u=u*(3/n)),a=u/3*4,s=u}l.tapeMode!=="off"?(o("#words").css({overflow:"hidden",width:"200vw"}),o("#wordsWrapper").css({overflow:"hidden"}),hf()):(o("#words").css({overflow:"visible clip",marginLeft:"unset",width:""}),o("#wordsWrapper").css({overflow:"visible clip"})),setTimeout(()=>{o("#words").css("height",a+"px"),o("#wordsWrapper").css("height",s+"px"),o(".outOfFocusWarning").css("margin-top",s/2-xr(1)/2+"px")},0)}}function Fx(t){o("#words").append(UM(t))}function E4(t){t?o("#words").addClass("flipped"):o("#words").removeClass("flipped")}function I4(t){t?o("#words").addClass("colorfulMode"):o("#words").removeClass("colorfulMode")}let zx=!1;async function O4(){var f,h;ht();let t=!1,e=!1;(DO("#cookiesModal")||document.contains(document.querySelector("#cookiesModal")))&&(e=!0);function a(){We(),o("#ad-result-wrapper").removeClass("hidden"),o("#ad-result-small-wrapper").removeClass("hidden"),o("#testConfig").removeClass("hidden"),o(".pageTest .screenshotSpacer").remove(),o("#notificationCenter").removeClass("hidden"),o("#commandLineMobileButton").removeClass("hidden"),o(".pageTest .ssWatermark").addClass("hidden"),o(".pageTest .ssWatermark").text("monkeytype.com"),o(".pageTest .buttons").removeClass("hidden"),o("noscript").removeClass("hidden"),o("#nocss").removeClass("hidden"),o("header, footer").removeClass("invisible"),o("#result").removeClass("noBalloons"),o(".wordInputHighlight").removeClass("hidden"),o(".highlightContainer").removeClass("hidden"),e&&o("#cookiesModal").removeClass("hidden"),t&&o("#resultReplay").removeClass("hidden"),we()||o(".pageTest .loginTip").removeClass("hidden"),document.querySelector("html").style.scrollBehavior="smooth",ze(l.funbox).forEach(y=>{var b,w;return(w=(b=y.functions)==null?void 0:b.applyGlobalCSS)==null?void 0:w.call(b)})}o("#resultReplay").hasClass("hidden")||(t=!0,ff());const s=new Date(Date.now());o("#resultReplay").addClass("hidden"),o(".pageTest .ssWatermark").removeClass("hidden");const n=T(),i=[Ot(s,"dd MMM yyyy HH:mm"),"monkeytype.com"];if((n==null?void 0:n.name)!==void 0){const y=`${n==null?void 0:n.name}${Jy(n,{iconsOnly:!0})}`;i.unshift(y)}o(".pageTest .ssWatermark").html(i.map(y=>`<span>${y}</span>`).join("<span class='pipe'>|</span>")),o(".pageTest .buttons").addClass("hidden"),o("#notificationCenter").addClass("hidden"),o("#commandLineMobileButton").addClass("hidden"),o(".pageTest .loginTip").addClass("hidden"),o("noscript").addClass("hidden"),o("#nocss").addClass("hidden"),o("#ad-result-wrapper").addClass("hidden"),o("#ad-result-small-wrapper").addClass("hidden"),o("#testConfig").addClass("hidden"),o(".page.pageTest").prepend("<div class='screenshotSpacer'></div>"),o("header, footer").addClass("invisible"),o("#result").addClass("noBalloons"),o(".wordInputHighlight").addClass("hidden"),o(".highlightContainer").addClass("hidden"),e&&o("#cookiesModal").addClass("hidden"),ze(l.funbox).forEach(y=>{var b,w;return(w=(b=y.functions)==null?void 0:b.clearGlobal)==null?void 0:w.call(b)}),document.querySelector("html").style.scrollBehavior="auto",window.scrollTo({top:0});const r=o("#result .wrapper"),d=((f=r.offset())==null?void 0:f.left)??0,u=((h=r.offset())==null?void 0:h.top)??0,c=r.outerWidth(!0),m=r.outerHeight(!0);try{const y=xr(2),b=xr(2);(await(await x4())(document.body,{backgroundColor:await bs("bg"),width:c+y*2,height:m+b*2,x:d-y,y:u-b})).toBlob(async $=>{try{if($===null)throw new Error("Could not create image, blob is null");const E=new ClipboardItem(Object.defineProperty({},$.type,{value:$,enumerable:!0}));await navigator.clipboard.write([E]),g("Copied to clipboard",1,{duration:2})}catch(E){console.error("Error while saving image to clipboard",E),$?(navigator.userAgent.toLowerCase().includes("firefox")&&!zx&&(zx=!0,g("On Firefox you can enable the asyncClipboard.clipboardItem permission in about:config to enable copying straight to the clipboard",0,{duration:10})),g("Could not save image to clipboard. Opening in new tab instead (make sure popups are allowed)",0,{duration:5}),open(URL.createObjectURL($))):g(qe(E,"Error saving image to clipboard"),-1)}a()})}catch(y){g(qe(y,"Error creating image"),-1),a()}setTimeout(()=>{a()},3e3)}async function Bn(t){var d,u,c;const e=t??A.current,a=I.getCurrent();if(!a&&l.mode!=="zen")return;let s="";const n=[];let i=!1;if(l.mode==="zen")for(const m of A.current)m==="	"?s+=`<letter class='tabChar correct' style="opacity: 0"><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:m===`
`?(i=!0,s+=`<letter class='nlChar correct' style="opacity: 0"><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`):s+=`<letter class="correct">${m}</letter>`;else{let m=!1;const f=A.getKoreanStatus();if(f){const y=pa.disassemble(a).join(""),b=pa.disassemble(e).join(""),w=tr.test(e)?e.search(tr):b.length;e.search(tr)<pa.d(y).length&&y.slice(0,w)===b.slice(0,w)&&(m=!0)}else{const y=tr.test(e)?e.search(tr):e.length;e.search(tr)<a.length&&a.slice(0,y)===e.slice(0,y)&&(m=!0)}const h=ze(l.funbox).find(y=>{var b;return(b=y.functions)==null?void 0:b.getWordHtml});for(let y=0;y<e.length;y++){const b=a[y]===e[y];let w=a[y],$="",E="";if((d=h==null?void 0:h.functions)!=null&&d.getWordHtml){const L=h.functions.getWordHtml(w);L!==""&&(w=L)}else w==="	"?($="tabChar",w='<i class="fas fa-long-arrow-alt-right fa-fw"></i>'):w===`
`&&(E="nlChar",w='<i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i>');if(b)s+=`<letter class="correct ${$}${E}">${w}</letter>`;else if(w!==void 0&&Co()&&y>=p4()&&!(f&&!m))s+=`<letter class="dead">${l.indicateTypos==="replace"?e[y]===" "?"_":e[y]:w}</letter>`;else if(w===void 0){let L=e[y];(L===" "||L==="	"||L===`
`)&&(L="_"),s+=`<letter class="incorrect extra ${$}${E}">${L}</letter>`}else if(s+=`<letter class="incorrect ${$}${E}">`+(l.indicateTypos==="replace"?e[y]===" "?"_":e[y]:w)+"</letter>",l.indicateTypos==="below")if(!(n!=null&&n.length))n.push([y]);else{const L=n[n.length-1];(L==null?void 0:L[L.length-1])===y-1?L.push(y):n.push([y])}}for(let y=e.length;y<a.length;y++)(u=h==null?void 0:h.functions)!=null&&u.getWordHtml?s+=h.functions.getWordHtml(a[y],!0):a[y]==="	"?s+=`<letter class='tabChar'><i class="fas fa-long-arrow-alt-right fa-fw"></i></letter>`:a[y]===`
`?s+=`<letter class='nlChar'><i class="fas fa-level-down-alt fa-rotate-90 fa-fw"></i></letter>`:s+="<letter>"+a[y]+"</letter>"}const r=(c=document.querySelectorAll("#words .word"))==null?void 0:c[zt];if(r.innerHTML=s,n!=null&&n.length){const m=r.querySelectorAll("letter"),f=C4(n,m,e);r.insertAdjacentHTML("beforeend",f);const h=r.getElementsByTagName("hint");await S4(n,m,h)}i&&o("#words").append("<div class='newline'></div>"),l.tapeMode!=="off"&&hf()}function hf(){var r;if(ft()!=="test"||Yt)return;const t=document.querySelector("#wordsWrapper").offsetWidth;let e=0;const a=[];let s=0;if(zt>0){for(let d=0;d<zt;d++){const u=document.querySelectorAll("#words .word")[d];e+=o(u).outerWidth(!0)??0;const c=Math.floor(u.offsetLeft),m=Math.floor(u.offsetWidth);if(c<0-m){const f=o(o("#words .word")[d]);a.push(f),s+=f.outerWidth(!0)??0}}if(a.length>0){zt-=a.length,a.forEach(u=>u.remove()),e-=s;const d=parseInt(o("#words").css("margin-left"),10);o("#words").css("margin-left",`${d+s}px`)}}let n=0;if(l.tapeMode==="letter"&&A.current.length>0){const u=(r=document.querySelectorAll("#words .word")[zt])==null?void 0:r.querySelectorAll("letter");if(!u)return;for(let c=0;c<A.current.length;c++){const m=u[c];(l.blindMode||l.hideExtraLetters)&&m.classList.contains("extra")||(n+=o(m).outerWidth(!0)??0)}}const i=t/2-(e+n);l.smoothLineScroll?o("#words").stop(!0,!1).animate({marginLeft:i},ia()?0:125):o("#words").css("margin-left",`${i}px`)}function P4(){const t=Fy(l,pt);let e="";l.funbox!=="none"&&(e=" "+l.funbox.split("#").join(" ")),o(".pageTest #premidTestMode").text(`${l.mode} ${t} ${Ar(l.language)}${e}`),o(".pageTest #premidSecondsLeft").text(l.time)}let Kv=0;function zk(t){var e;if(l.tapeMode==="off"&&Ah>0||l.tapeMode!=="off"&&Ah>=0){const a=t,s=[],n=o("#words .word");for(let r=0;r<zt;r++){const d=o(n[r]);if(d.hasClass("hidden"))continue;Math.floor(d[0].offsetTop)<(l.tapeMode==="off"?a-10:a+10)&&s.push(o(o("#words .word")[r]))}const i=o(document.querySelector(".word")).outerHeight(!0);if(l.smoothLineScroll&&s.length>0){Dw=!0;const r=o("#words .smoothScroller");r.length===0?o("#words").prepend(`<div class="smoothScroller" style="position: fixed;height:${i}px;width:100%"></div>`):r.css("height",`${(r.outerHeight(!0)??0)+i}px`),o("#words .smoothScroller").stop(!0,!1).animate({height:0},ia()?0:125,()=>{o("#words .smoothScroller").remove()}),o("#paceCaret").stop(!0,!1).animate({top:((e=document.querySelector("#paceCaret"))==null?void 0:e.offsetTop)-i},ia()?0:125);const d={marginTop:`-${i*(Kv+1)}px`};if(l.tapeMode!=="off"){const c=document.querySelector("#wordsWrapper").offsetWidth/2;d.marginLeft=`${c}px`}Kv++,o("#words").stop(!0,!1).animate(d,ia()?0:125,()=>{var u,c;Kv=0,(c=(u=document.querySelectorAll("#words .word"))==null?void 0:u[zt])==null||c.offsetTop,zt-=s.length,Dw=!1,s.forEach(m=>m.remove()),o("#words").css("marginTop","0")})}else s.forEach(r=>r.remove()),zt-=s.length,o("#paceCaret").css({top:document.querySelector("#paceCaret").offsetTop-i})}Ah++,Fk()}function Z4(t){t?(o("#words").addClass("rightToLeftTest"),o("#resultWordsHistory .words").addClass("rightToLeftTest"),o("#resultReplay .words").addClass("rightToLeftTest")):(o("#words").removeClass("rightToLeftTest"),o("#resultWordsHistory .words").removeClass("rightToLeftTest"),o("#resultReplay .words").removeClass("rightToLeftTest"))}function R4(t){t?(o("#words").addClass("withLigatures"),o("#resultWordsHistory .words").addClass("withLigatures"),o("#resultReplay .words").addClass("withLigatures")):(o("#words").removeClass("withLigatures"),o("#resultWordsHistory .words").removeClass("withLigatures"),o("#resultReplay .words").removeClass("withLigatures"))}async function N4(){o("#resultWordsHistory .words").empty();let t="";for(let e=0;e<A.history.length+2;e++){const a=A.getHistory(e),s=da.getHistory(e),n=I.get(e),i=(a==null?void 0:a.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g))!==null||(n==null?void 0:n.match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g))!==null;let r="";try{if(a===void 0||a==="")throw new Error("empty input word");if(s!==void 0&&s!==""){const u=i?pa.assemble(s.split("")):s;r=`<div class='word nocursor' burst="${ks[e]}" input="${u.replace(/"/g,"&quot;").replace(/ /g,"_")}">`}else r=`<div class='word nocursor' burst="${ks[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`;if(e===A.history.length-1){const u={correct:0,incorrect:0,missed:0},c=l.mode==="zen"?a.length:n.length;for(let m=0;m<c;m++)m<a.length?l.mode==="zen"||a[m]===n[m]?u.correct++:u.incorrect++:u.missed++;(u.incorrect!==0||l.mode!=="time")&&l.mode!=="zen"&&a!==n&&(r=`<div class='word nocursor error' burst="${ks[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`)}else l.mode!=="zen"&&a!==n&&(r=`<div class='word nocursor error' burst="${ks[e]}" input="${a.replace(/"/g,"&quot;").replace(/ /g,"_")}">`);let d;if(l.mode==="zen"||a.length>n.length?d=a.length:d=n.length,s===void 0)throw new Error("empty corrected word");for(let u=0;u<d;u++){let c;try{c=i?pa.assemble(s.split(""))[u]:s[u]}catch{c=void 0}let m="";const f=i?pa.assemble(s.split("")):s;u+1===d&&f!==void 0&&f.length>a.length&&(m="extraCorrected"),l.mode==="zen"||n[u]!==void 0?l.mode==="zen"||a[u]===n[u]?c===a[u]||c===void 0?r+=`<letter class="correct ${m}">${a[u]}</letter>`:r+=`<letter class="corrected ${m}">`+a[u]+"</letter>":a[u]===A.current?r+=`<letter class='correct ${m}'>`+n[u]+"</letter>":a[u]===void 0?r+="<letter>"+n[u]+"</letter>":r+=`<letter class="incorrect ${m}">`+n[u]+"</letter>":r+='<letter class="incorrect extra">'+a[u]+"</letter>"}r+="</div>"}catch{try{r="<div class='word'>";for(const u of n)r+="<letter>"+u+"</letter>";r+="</div>"}catch{}}t+=r}return o("#resultWordsHistory .words").html(t),o("#showWordHistoryButton").addClass("loaded"),!0}function VM(t=!1){Yt&&(w4(),o("#resultWordsHistory").stop(!0,!0).hasClass("hidden")?o("#resultWordsHistory .words .word").length===0?(o("#words").html('<div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>'),N4().then(()=>{l.burstHeatmap&&Zd(),o("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(t?0:250,()=>{l.burstHeatmap&&Zd()})})):(l.burstHeatmap&&Zd(),o("#resultWordsHistory").removeClass("hidden").css("display","none").slideDown(t?0:250)):o("#resultWordsHistory").slideUp(250,()=>{o("#resultWordsHistory").addClass("hidden")}))}async function Zd(){if(l.burstHeatmap){o("#resultWordsHistory .heatmapLegend").removeClass("hidden");let t=[...ks];t=t.filter(u=>u!==1/0),t=t.filter(u=>u<350);const e=Ta(l.typingSpeedUnit);t.forEach((u,c)=>{t[c]=Math.round(e.fromWpm(u))});const a=await Vr();let s=[a.colorfulError,an(a.colorfulError,a.text,.5),a.text,an(a.main,a.text,.5),a.main],n=a.sub;a.main===a.text&&(s=[a.colorfulError,an(a.colorfulError,a.text,.5),a.sub,an(a.sub,a.text,.5),a.main],n=a.subAlt);const i=t.sort((u,c)=>u-c),r=t.length,d=[{val:0,colorId:0},{val:i[r*.15|0],colorId:1},{val:i[r*.35|0],colorId:2},{val:i[r*.65|0],colorId:3},{val:i[r*.85|0],colorId:4}];d.forEach((u,c)=>{const m=d[c+1];let f="";c===0&&m?f=`<${Math.round(m.val)}`:c===4?f=`${Math.round(u.val)}+`:m&&(u.val!=m.val?f=`${Math.round(u.val)}-${Math.round(m.val)-1}`:f=`${Math.round(u.val)}-${Math.round(u.val)}`),o("#resultWordsHistory .heatmapLegend .box"+c).html(`<div>${f}</div>`)}),o("#resultWordsHistory .words .word").each((u,c)=>{const m=o(c).attr("burst");if(m===void 0)o(c).css("color",n);else{let f=parseInt(m);f=Math.round(Ta(l.typingSpeedUnit).fromWpm(f)),d.forEach(h=>{f>=h.val&&(o(c).addClass("heatmapInherit"),o(c).css("color",s[h.colorId]))})}}),o("#resultWordsHistory .heatmapLegend .boxes .box").each((u,c)=>{o(c).css("background",s[u])})}else o("#resultWordsHistory .heatmapLegend").addClass("hidden"),o("#resultWordsHistory .words .word").removeClass("heatmapInherit"),o("#resultWordsHistory .words .word").css("color",""),o("#resultWordsHistory .heatmapLegend .boxes .box").css("color","")}function D4(t){o(o("#words .word")[t]).addClass("error")}function j4(t){o(o("#words .word")[t]).find("letter").addClass("correct")}function GM(){let t={};l.tapeMode==="off"?l.maxLineWidth===0?t={"max-width":"100%"}:t={"max-width":l.maxLineWidth+"ch"}:l.maxLineWidth===0?t={"max-width":"100%"}:t={"max-width":"100%"};const e=o("#typingTest");e.css(t),l.maxLineWidth===0?e.removeClass("full-width-padding").addClass("content"):e.removeClass("content").addClass("full-width-padding")}function B4(t){o("#barTimerProgress").css("opacity",parseFloat(t)),o("#liveStatsTextTop").css("opacity",parseFloat(t)),o("#liveStatsTextBottom").css("opacity",parseFloat(t)),o("#liveStatsMini").css("opacity",parseFloat(t))}function q4(t){o("#barTimerProgress").removeClass("timerSub"),o("#barTimerProgress").removeClass("timerText"),o("#barTimerProgress").removeClass("timerMain"),o("#liveStatsTextTop").removeClass("timerSub"),o("#liveStatsTextTop").removeClass("timerText"),o("#liveStatsTextTop").removeClass("timerMain"),o("#liveStatsTextBottom").removeClass("timerSub"),o("#liveStatsTextBottom").removeClass("timerText"),o("#liveStatsTextBottom").removeClass("timerMain"),o("#liveStatsMini").removeClass("timerSub"),o("#liveStatsMini").removeClass("timerText"),o("#liveStatsMini").removeClass("timerMain"),t==="main"?(o("#barTimerProgress").addClass("timerMain"),o("#liveStatsTextTop").addClass("timerMain"),o("#liveStatsTextBottom").addClass("timerMain"),o("#liveStatsMini").addClass("timerMain")):t==="sub"?(o("#barTimerProgress").addClass("timerSub"),o("#liveStatsTextTop").addClass("timerSub"),o("#liveStatsTextBottom").addClass("timerSub"),o("#liveStatsMini").addClass("timerSub")):t==="text"&&(o("#barTimerProgress").addClass("timerText"),o("#liveStatsTextTop").addClass("timerText"),o("#liveStatsTextBottom").addClass("timerText"),o("#liveStatsMini").addClass("timerText"))}o(".pageTest").on("click","#saveScreenshotButton",()=>{O4()});o(".pageTest #copyWordsListButton").on("click",async()=>{let t;l.mode==="zen"?t=A.history.join(" "):t=I.get().slice(0,A.history.length).join(" "),await QM(t)});o(".pageTest #copyMissedWordsListButton").on("click",async()=>{let t;l.mode==="zen"?t=A.history.join(" "):t=Object.keys(_i??{}).join(" "),await QM(t)});async function QM(t){try{await navigator.clipboard.writeText(t),g("Copied to clipboard",0,{duration:2})}catch(e){g("Could not copy to clipboard: "+e,-1)}}o(".pageTest #toggleBurstHeatmap").on("click",async()=>{aM(!l.burstHeatmap),Bk()});o(".pageTest #resultWordsHistory").on("mouseleave",".words .word",()=>{o(".wordInputHighlight").remove()});o(".pageTest #result #wpmChart").on("mouseleave",()=>{qM(!1),g4()});o(".pageTest #result #wpmChart").on("mouseenter",()=>{qM(!0)});o(".pageTest #resultWordsHistory").on("mouseenter",".words .word",t=>{if(Yt){const e=o(t.currentTarget).attr("input"),a=parseInt(o(t.currentTarget).attr("burst"));e!==void 0&&o(t.currentTarget).append(`<div class="wordInputHighlight withSpeed">
          <div class="text">
          ${e.replace(/\t/g,"_").replace(/\n/g,"_").replace(/</g,"&lt").replace(/>/g,"&gt")}
          </div>
          <div class="speed">
          ${ve.typingSpeed(a,{showDecimalPlaces:!1})}
          ${l.typingSpeedUnit}
          </div>
          </div>`)}});addEventListener("resize",()=>{Bk()});o("#wordsInput").on("focus",t=>{t.target===document.activeElement&&(!Yt&&l.showOutOfFocusWarning&&Ym(),xM(!0))});o("#wordsInput").on("focusout",()=>{!Yt&&l.showOutOfFocusWarning&&zB(),pf()});o(".pageTest").on("click","#showWordHistoryButton",()=>{VM()});o("#wordsWrapper").on("click",()=>{uv()});Dt((t,e)=>{t==="quickRestart"&&(e==="off"?o(".pageTest #restartTestButton").removeClass("hidden"):o(".pageTest #restartTestButton").addClass("hidden")),t==="maxLineWidth"&&GM(),t==="timerOpacity"&&B4(e),t==="timerColor"&&q4(e)});let YM="",JM=!1;function Hk(){return YM}function Ni(){return JM}function Dr(t,e){YM=t,JM=e}let Uk=!1,zo,Dl,Bw,qw,Xg,ey,Ho=!1,XM;function W4(t){XM=t}function F4(){const t={lastResult:XM,start:zo,end:Dl,afkHistory:uf,errorHistory:lf,wpmHistory:xi,rawHistory:tv,burstHistory:ks,keypressCountHistory:Bo,currentBurstStart:ev,lastSecondNotRound:Ho,missedWords:_i,accuracy:Ps,keypressTimings:It,keyOverlap:mi,wordsHistory:I.list.slice(0,A.history.length),inputHistory:A.history};try{t.keypressTimings.spacing.average=It.spacing.array.reduce((e,a)=>a+=e)/It.spacing.array.length,t.keypressTimings.spacing.sd=qu(It.spacing.array)}catch{}try{t.keypressTimings.duration.average=It.duration.array.reduce((e,a)=>a+=e)/It.duration.array.length,t.keypressTimings.duration.sd=qu(It.duration.array)}catch{}return t}function z4(){zo=0,Dl=0,Uk=!1,Ho=!1}let Kk=0,ty=0,Vk=[];function eL(){Kk++}function Gk(t){ty+=t}function Qk(t,e){Vk.push({acc:t,seconds:e})}function tL(){Kk=0,ty=0,Vk=[]}function Vf(){Uk=!0}function gf(t){return t===void 0?(Dl-zo)/1e3:(t-zo)/1e3}function Yk(t){const e=gf(ea?performance.now():Dl),a=sL(),s=Oe((a.correctWordChars+a.correctSpaces)*(60/e)/5),n=Oe((a.allCorrectChars+a.spaces+a.incorrectChars+a.extraChars)*(60/e)/5);return{wpm:t?s:Math.round(s),raw:t?n:Math.round(n)}}function Hx(t){Dl=t,qw=Date.now(),ey=new Date().getTime()}function H4(t){zo=t,Bw=Date.now(),Xg=new Date().getTime()}function Jk(t){let e=0;return t!==void 0&&(l.mode==="time"?e=Math.round(t)-Bo.length:e=Math.ceil(t)-Bo.length,e<0&&(e=0)),uf.filter(s=>s).length+e}function U4(){Ho=!0}function aL(){var n,i;const t=A.getKoreanStatus(),e=(performance.now()-ev)/1e3;let a;if(a=t?zh.disassemble(A.current).length:A.current.length,a===0&&(a=t?((i=zh.disassemble(A.getHistoryLast()))==null?void 0:i.length)??0:((n=A.getHistoryLast())==null?void 0:n.length)??0),a===0)return 0;const s=Oe(a*(60/e)/5);return Math.round(s)}function yf(){const t=Ps.correct/(Ps.correct+Ps.incorrect)*100;return isNaN(t)?100:t}function K4(){const t=gf();Bo.splice(t),xi.splice(t),ks.splice(t),tv.splice(t)}function V4(){const t=A.getKoreanStatus();let e=[...A.history];return ea&&e.push(A.current),t&&(e=e.map(a=>zh.disassemble(a).join(""))),e}function G4(){const t=A.getKoreanStatus();let e=[...l.mode==="zen"?A.history:I.list];return ea&&e.push(l.mode==="zen"?A.current:I.getCurrent()),t&&(e=e.map(a=>zh.disassemble(a).join(""))),e}function sL(){let t=0,e=0,a=0,s=0,n=0,i=0,r=0;const d=V4(),u=G4();for(let c=0;c<d.length;c++){const m=d[c],f=u[c];if(m===f)t+=f.length,e+=f.length,c<d.length-1&&e1(m)!==`
`&&r++;else if(m.length>=f.length)for(let h=0;h<m.length;h++)h<f.length?m[h]===f[h]?e++:a++:s++;else{const h={correct:0,incorrect:0,missed:0};for(let y=0;y<f.length;y++)y<m.length?m[y]===f[y]?h.correct++:h.incorrect++:h.missed++;e+=h.correct,a+=h.incorrect,c===d.length-1&&l.mode==="time"?h.incorrect===0&&(t+=h.correct):n+=h.missed}c<d.length-1&&i++}return ze(l.funbox).find(c=>{var m;return(m=c.properties)==null?void 0:m.includes("nospace")})&&(i=0,r=0),{spaces:i,correctWordChars:t,allCorrectChars:e,incorrectChars:l.mode==="zen"?Ps.incorrect:a,extraChars:s,missedChars:n,correctSpaces:r}}function Q4(){console.debug("Calculating result stats");let t=gf();console.debug("Test seconds",t," (date based) ",(qw-Bw)/1e3," (performance.now based)",(ey-Xg)/1e3," (new Date based)"),console.debug("Test seconds",ch(t)," (date based) ",ch((qw-Bw)/1e3)," (performance.now based)",ch((ey-Xg)/1e3)," (new Date based)"),l.mode!=="custom"&&(t=Oe(t),console.debug("Mode is not custom - rounding to 2. New time: ",t));const e=sL(),{wpm:a,raw:s}=Yk(!0),n=Oe(yf()),i={wpm:isNaN(a)?0:a,wpmRaw:isNaN(s)?0:s,acc:n,correctChars:e.correctWordChars,incorrectChars:e.incorrectChars,missedChars:e.missedChars,extraChars:e.extraChars,allChars:e.allCorrectChars+e.spaces+e.incorrectChars+e.extraChars,time:Oe(t),spaces:e.spaces,correctSpaces:e.correctSpaces};return console.debug("Result stats",i),i}const Rt={mode:null,punctuation:null,numbers:null,customText:null};function Y4(t,e){if(l.mode==="zen")return!1;let a;t==="words"&&!e||t==="off"&&e?a=20:a=10;let s=[];t==="words"&&(Object.keys(_i).forEach(f=>{const h=_i[f];h!==void 0&&s.push([f,h])}),s.sort((f,h)=>h[1]-f[1]),s=s.slice(0,a));let n=[];if(t==="biwords"){for(let f=0;f<I.length;f++){const h=I.get(f),y=_i[h];y!==void 0&&(f===0?n.push([h,"",y]):n.push([h,I.get(f-1),y]))}n.sort((f,h)=>h[2]-f[2]),n=n.slice(0,a)}if((t==="words"&&s.length===0||t==="biwords"&&n.length===0)&&!e)return g("You haven't missed any words",0),!1;let i=[];if(e&&(i=I.get().map((f,h)=>[f,ks[h]??0]),i.sort((f,h)=>f[1]-h[1]),i=i.slice(0,Math.min(a,Math.round(I.length*.2))),i.length===0&&g("Test too short to classify slow words.",0)),s.length===0&&n.length===0&&i.length===0)return g("Could not start a new custom test",0),!1;const r=[];s.forEach(f=>{for(let h=0;h<f[1];h++)r.push(f[0])}),n.forEach(f=>{for(let h=0;h<f[2];h++)f[1]!==""?r.push(f[1]+" "+f[0]):r.push(f[0])}),i.forEach((f,h)=>{for(let y=0;y<i.length-h;y++)r.push(f[0])});const d=Rt.mode===null?l.mode:Rt.mode,u=Rt.punctuation===null?l.punctuation:Rt.punctuation,c=Rt.numbers===null?l.numbers:Rt.numbers;let m=null;return l.mode==="custom"&&(m=ed()),ha("custom",!0),pl(!0),Pi(r),br("section"),qp("shuffle"),ko((i.length+s.length+n.length)*5),Dr("practise",void 0),Rt.mode=d,Rt.punctuation=u,Rt.numbers=c,Rt.customText=m,!0}function nL(){Rt.mode=null,Rt.punctuation=null,Rt.numbers=null,Rt.customText=null}Dt(t=>{t==="mode"&&nL()});const Fp=document.querySelector("#liveStatsTextBottom .liveSpeed"),zp=document.querySelector("#liveStatsMini .speed");function J4(){Fp.innerHTML="0",zp.innerHTML="0"}function X4(t,e){let a=t;l.blindMode&&(a=e);const s=ve.typingSpeed(a,{showDecimalPlaces:!1});Fp.innerHTML=s,zp.innerHTML=s}let ay=!1;function Xk(){l.liveSpeedStyle!=="off"&&ea&&(ay||(l.liveSpeedStyle==="mini"?o(zp).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):o(Fp).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),ay=!0))}function pv(){ay&&(o(Fp).stop(!0,!1).animate({opacity:0},125,()=>{Fp.classList.add("hidden")}),o(zp).stop(!0,!1).animate({opacity:0},125,()=>{zp.classList.add("hidden")}),ay=!1)}Dt((t,e)=>{t==="liveSpeedStyle"&&(e==="off"?pv():Xk())});const Hp=document.querySelector("#liveStatsTextBottom .liveBurst"),Up=document.querySelector("#liveStatsMini .burst");function e3(){Hp.innerHTML="0",Up.innerHTML="0"}async function t3(t){const e=ve.typingSpeed(t,{showDecimalPlaces:!1});Up.innerHTML=e,Hp.innerHTML=e}let sy=!1;function e_(){l.liveBurstStyle!=="off"&&ea&&(sy||(l.liveBurstStyle==="mini"?o(Up).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):o(Hp).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),sy=!0))}function mv(){sy&&(o(Hp).stop(!0,!1).animate({opacity:0},125,()=>{o(Hp).addClass("hidden")}),o(Up).stop(!0,!1).animate({opacity:0},125,()=>{o(Up).addClass("hidden")}),sy=!1)}Dt((t,e)=>{t==="liveBurstStyle"&&(e==="off"?mv():e_())});const Kp=document.querySelector("#liveStatsTextBottom .liveAcc"),Vp=document.querySelector("#liveStatsMini .acc");function a3(t){let e=Math.floor(t);l.blindMode&&(e=100),Vp.innerHTML=e+"%",Kp.innerHTML=e+"%"}function s3(){Vp.innerHTML="100%",Kp.innerHTML="100%"}let ny=!1;function t_(){l.liveAccStyle!=="off"&&ea&&(ny||(l.liveAccStyle==="mini"?o(Vp).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125):o(Kp).stop(!0,!1).removeClass("hidden").css("opacity",0).animate({opacity:1},125),ny=!0))}function fv(){ny&&(o(Kp).stop(!0,!1).animate({opacity:0},125,()=>{o(Kp).addClass("hidden")}),o(Vp).stop(!0,!1).animate({opacity:0},125,()=>{o(Vp).addClass("hidden")}),ny=!1)}Dt((t,e)=>{t==="liveAccStyle"&&(e==="off"?fv():t_())});function ts(t,e=!1,a=!1,s=":",n=!0,i=!1){t=Math.abs(t);let r=0,d;i?(r=Math.floor(t/86400),d=Math.floor(t%86400/3600)):d=Math.floor(t/3600);const u=Math.floor(t%3600/60),c=Oe(t%3600%60);let m,f,h,y;i&&(r<10&&s!=="text"?m="0"+r:m=r),d<10&&s!=="text"?f="0"+d:f=d,u<10&&s!=="text"?h="0"+u:h=u,c<10&&(u>0||d>0||e)&&s!=="text"?y="0"+c:y=c;let b="";return r>0&&i&&(b+=m,s==="text"?r===1?b+=" day ":b+=" days ":b+=s),(d>0||a)&&(b+=f,s==="text"?d===1?b+=" hour ":b+=" hours ":b+=s),(u>0||d>0||e)&&(b+=h,s==="text"?u===1?b+=" minute ":b+=" minutes ":n&&(b+=s)),n&&(b+=y,s==="text"&&(c===1?b+=" second":b+=" seconds")),d===0&&u===0&&!n&&s==="text"&&(b="less than 1 minute"),b.trim()}let a_=0;function Gp(){return a_}function n3(t){a_=t}function i3(){a_++}const Ww=o("#barTimerProgress .bar"),iL=o("#barTimerProgress .opacityWrapper"),hv=o("#liveStatsTextTop .timerProgress"),Qp=o("#liveStatsMini .time");function s_(){l.mode!=="zen"&&l.timerStyle==="bar"?iL.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125):l.timerStyle==="text"?hv.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125):(l.mode==="zen"||l.timerStyle==="mini")&&Qp.stop(!0,!0).removeClass("hidden").css("opacity",0).animate({opacity:1},125)}function r3(){let t="0vw";(l.mode==="time"||l.mode==="custom"&&Jt()==="time")&&(t="100vw"),Ww.stop(!0,!0).animate({width:t},0),Qp.text("0"),hv.text("0")}function gv(){iL.stop(!0,!0).animate({opacity:0},125),Qp.stop(!0,!0).animate({opacity:0},125,()=>{Qp.addClass("hidden")}),hv.stop(!0,!0).animate({opacity:0},125)}const Hi=hv[0],Ui=Qp[0];function Ux(){return l.mode==="custom"&&Jt()==="section"?I.sectionIndexList[I.currentIndex]-1:A.history.length}function vf(){const t=Gp();if(l.mode==="time"||l.mode==="custom"&&Jt()==="time"){let e=l.time;if(l.mode==="custom"&&Jt()==="time"&&(e=Bt()),l.timerStyle==="bar"){const a=100-(t+1)/e*100;Ww.stop(!0,!0).animate({width:a+"vw"},ia()?0:1e3,"linear")}else if(l.timerStyle==="text"){let a=ts(e-t);e===0&&(a=ts(t)),Hi!==null&&(Hi.innerHTML="<div>"+a+"</div>")}else if(l.timerStyle==="mini"){let a=ts(e-t);e===0&&(a=ts(t)),Ui!==null&&(Ui.innerHTML=a)}}else if(l.mode==="words"||l.mode==="custom"||l.mode==="quote"){let e=I.length;if(l.mode==="words"&&(e=l.words),l.mode==="custom"&&(e=Bt()),l.mode==="quote"&&(e=(pt==null?void 0:pt.textSplit.length)??1),l.timerStyle==="bar"){const a=Math.floor((I.currentIndex+1)/e*100);Ww.stop(!0,!0).animate({width:a+"vw"},ia()?0:250)}else l.timerStyle==="text"?e===0?Hi!==null&&(Hi.innerHTML=`<div>${A.history.length}</div>`):Hi!==null&&(Hi.innerHTML=`<div>${Ux()}/${e}</div>`):l.timerStyle==="mini"&&(e===0?Ui!==null&&(Ui.innerHTML=`${A.history.length}`):Ui!==null&&(Ui.innerHTML=`${Ux()}/${e}`))}else l.mode==="zen"&&(l.timerStyle==="text"?Hi!==null&&(Hi.innerHTML=`<div>${A.history.length}</div>`):Ui!==null&&(Ui.innerHTML=`${A.history.length}`))}function o3(){ea&&(gv(),vf(),l.timerStyle!=="off"&&setTimeout(()=>{s_()},125))}Dt((t,e)=>{t==="timerStyle"&&o3()});const Kx=3;let Ad=!1;function Qr(t,e=!1){t&&!Ad?(Ad=!0,kM(),o("header").addClass("focus"),o("footer").addClass("focus"),e||o("body").css("cursor","none"),o("main").addClass("focus"),o("#bannerCenter").addClass("focus"),o("#notificationCenter").addClass("focus"),o("#capsWarning").addClass("focus"),o("#ad-vertical-right-wrapper").addClass("focus"),o("#ad-vertical-left-wrapper").addClass("focus"),o("#ad-footer-wrapper").addClass("focus"),o("#ad-footer-small-wrapper").addClass("focus"),Xk(),e_(),t_(),s_()):!t&&Ad&&(Ad=!1,_M(),o("header").removeClass("focus"),o("footer").removeClass("focus"),o("body").css("cursor","default"),o("main").removeClass("focus"),o("#bannerCenter").removeClass("focus"),o("#notificationCenter").removeClass("focus"),o("#capsWarning").removeClass("focus"),o("#app").removeClass("focus"),o("#ad-vertical-right-wrapper").removeClass("focus"),o("#ad-vertical-left-wrapper").removeClass("focus"),o("#ad-footer-wrapper").removeClass("focus"),o("#ad-footer-small-wrapper").removeClass("focus"),pv(),mv(),fv(),gv())}o(document).on("mousemove",function(t){Ad&&ft()!=="loading"&&(ft()==="account"&&Ad||t.originalEvent&&(t.originalEvent.movementX>Kx||t.originalEvent.movementY>Kx)&&Qr(!1))});function d3(){return Math.floor(Math.random()*256).toString(2).padStart(8,"0")}function l3(){const t=Sa(1,4);return Array.from({length:t},()=>Math.floor(Math.random()*256).toString(16).padStart(2,"0")).join("")}function u3(t){const e={a:".-",b:"-...",c:"-.-.",d:"-..",e:".",f:"..-.",g:"--.",h:"....",i:"..",j:".---",k:"-.-",l:".-..",m:"--",n:"-.",o:"---",p:".--.",q:"--.-",r:".-.",s:"...",t:"-",u:"..-",v:"...-",w:".--",x:"-..-",y:"-.--",z:"--..",0:"-----",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----.",".":".-.-.-",",":"--..--","?":"..--..","'":".----.","/":"-..-.","(":"-.--.",")":"-.--.-","&":".-...",":":"---...",";":"-.-.-.","=":"-...-","+":".-.-.","-":"-....-",_:"..--.-",'"':".-..-.",$:"...-..-","!":"-.-.--","@":".--.-."};let a="";const s=rq(t);for(let n=0;n<s.length;n++){const i=e[s.toLowerCase()[n]];a+=i!==void 0?i+"/":""}return a}function c3(){const t=Sa(1,7);let e="";for(let a=0;a<t;a++)e+=String.fromCharCode(97+Sa(0,25));return e}function p3(){const t=Sa(1,10);let e="";for(let a=0;a<t;a++){const s=33+Sa(0,93);e+=String.fromCharCode(s)}return e}function m3(){const t=Sa(1,7);let e="";const a=["`","~","!","@","#","$","%","^","&","*","(",")","-","_","=","+","{","}","[","]","'",'"',"/","\\","|","?",";",":",">","<"];for(let s=0;s<t;s++)e+=zn(a);return e}function rL(t){const e=Sa(1,t);let a="";for(let s=0;s<e;s++){let n;s===0?n=Sa(1,9):n=Sa(0,9),a+=n.toString()}return a}let Ji=null,Mh=null;function f3(){o("#typingTest #memoryTimer").stop(!0,!0).animate({opacity:1},125)}function oL(){o("#typingTest #memoryTimer").stop(!0,!0).animate({opacity:0},125)}function fl(){Mh!==null&&(clearInterval(Mh),Mh=null),Ji=null,oL()}function h3(){fl(),Ji=Math.round(Math.pow(I.length,1.2)),Vx(Ji),f3(),Mh=setInterval(()=>{Ji!==null&&(Ji-=1,Ji===0?oL():Vx(Ji),Ji<=0&&(fl(),o("#wordsWrapper").addClass("hidden")))},1e3)}function Vx(t){o("#typingTest #memoryTimer").text(`Timer left to memorise all words: ${t}s`)}let Rd={};function va(t,e,a){Rd[t]??(Rd[t]={value:e,setFunction:a})}function dL(){Object.keys(Rd).forEach(t=>{const e=Rd[t];e.setFunction(e.value,!0)}),Rd={}}const lL=[];function g3(t){lL.push(t)}async function y3(t){lL.forEach(e=>{try{e(t)}catch(a){console.error("TTS event subscriber threw an error"),console.error(a)}})}const n_=[];function v3(t){n_.push(t)}async function uL(t,e){n_.forEach(a=>{try{a("flash",t,e)}catch(s){console.error("Keymap flash event subscriber threw an error"),console.error(s)}})}async function cr(t){n_.forEach(e=>{try{e("highlight",t)}catch(a){console.error("Keymap highlight event subscriber threw an error"),console.error(a)}})}const b3=50,w3=20,k3=5e3,Uu={};class _3{constructor(){this.average=0,this.count=0}update(e){this.count<b3&&this.count++;const a=1/this.count;this.average=e*a+this.average*(1-a)}}function x3(t,e){var n;const a=It.spacing.array;if(a.length===0||typeof a=="string")return;let s=a[a.length-1];e||(s+=k3),t in Uu||(Uu[t]=new _3),(n=Uu[t])==null||n.update(s)}function C3(t){let e=0,a=0;for(const s of t)s in Uu&&(e+=Uu[s].average,a++);return a===0?0:e/a}function S3(t){let e,a="";for(let s=0;s<w3;s++){const n=t.randomWord("normal"),i=C3(n);(s===0||e===void 0||i>e)&&(a=n,e=i)}return a}const T3=["—","_"," "],$3=100,A3="https://poetrydb.org/random";class M3 extends jT{constructor(e,a,s){super(e,a,s),this.title=e,this.author=a,this.words=s,this.cleanUpText()}cleanUpText(){let e=0;const a=[];for(const s of this.words){let n="";for(const i of s)T3.includes(i)||(n+=i);if(n!==""&&(a.push(n),e++,e===$3))break}this.words=a}}async function L3(){console.log("Getting poem");try{const a=(await(await fetch(A3)).json())[0];if(!a)return!1;const s=[];return a.lines.forEach(n=>{n.split(/ +/).forEach(i=>{s.push(i)})}),new M3(a.title,a.author,s)}catch(t){return console.log(t),!1}}async function E3(t){switch(t.name){case"english":return"en";case"spanish":return"es";case"french":return"fr";case"german":return"de";case"portuguese":return"pt";case"arabic":return"ar";case"italian":return"it";case"latin":return"la";case"afrikaans":return"af";case"korean":return"ko";case"russian":return"ru";case"polish":return"pl";case"czech":return"cs";case"slovak":return"sk";case"ukrainian":return"uk";case"lithuanian":return"lt";case"indonesian":return"id";case"greek":return"el";case"turkish":return"tr";case"thai":return"th";case"tamil":return"ta";case"slovenian":return"sl";case"croatian":return"hr";case"dutch":return"nl";case"danish":return"da";case"hungarian":return"hu";case"norwegian_bokmal":return"no";case"norwegian_nynorsk":return"nn";case"hebrew":return"he";case"malay":return"ms";case"romanian":return"ro";case"finnish":return"fi";case"estonian":return"et";case"welsh":return"cy";case"persian":return"fa";case"kazakh":return"kk";case"vietnamese":return"vi";case"swedish":return"sv";case"serbian":return"sr";case"georgian":return"ka";case"catalan":return"ca";case"bulgarian":return"bg";case"esperanto":return"eo";case"bangla":return"bn";case"urdu":return"ur";case"armenian":return"hy";case"myanmar":return"my";case"hindi":return"hi";case"macedonian":return"mk";case"uzbek":return"uz";case"belarusian":return"be";case"azerbaijani":return"az";case"latvian":return"lv";case"euskera":return"eu";default:return"en"}}async function I3(t){ht();let e="en",a;try{a=await kB(t)}catch(d){console.error(qe(d,"Failed to find current language group"))}a!==void 0&&(e=await E3(a));const s=`https://${e}.wikipedia.org/api/rest_v1/page/random/summary`,n={title:"",author:""},i=await fetch(s);let r=0;if(i.status===200){const d=await i.json();n.title=d.title,n.author=d.author,r=d.pageid}return new Promise((d,u)=>{i.status!==200&&(We(),u(i.status));const c=`https://${e}.wikipedia.org/w/api.php?action=query&format=json&pageids=${r}&prop=extracts&exintro=true&origin=*`,m=new XMLHttpRequest;m.onload=()=>{if(m.readyState===4)if(m.status===200){let f=JSON.parse(m.responseText).query.pages[r.toString()].extract;f=f.replace(/<\/p><p>+/g," "),f=jO(f),f=f.replace(/\[\d+\]/gi,""),f=f.replace(/[\u200B-\u200D\uFEFF]/g,""),f=t1(f),e==="en"&&(f=f.replace(/[^\x20-\x7E]+/g,"")),f=f.replace(/\s+/g," "),f=f.trim();const h=f.split(" "),y=new jT(n.title,n.author,h);We(),d(y)}else We(),u(m.status)},m.open("GET",c),m.send()})}function cL(t,e,a,s,n){const i=[],r=Math.round(t/e);for(let d=0;d<e;d++){let c=Sa(0,2**r-1).toString(a);if(s){const m=Math.ceil(r/Math.ceil(Math.log2(a)));c="0".repeat(Math.max(0,m-c.length))+c}i.push(c)}return i.join(n)}function Gx(t,e,a,s,n,i){const r=n.split(s).map(c=>parseInt(c,a)),d=Math.round(t/e);let u=i;for(let c=0;c<e;c++)u-=d,u<0&&(-u<=d?r[c]&=2**d-1^2**-u-1:r[c]=0);return r.map(c=>c.toString(a)).join(s)+"/"+i.toString()}function O3(){return cL(32,4,10,!1,".")}function P3(){return cL(128,8,16,!0,":")}function pL(t){return t.includes(":")?Gx(128,8,16,":",t,Sa(16,32)*4):Gx(32,4,10,".",t,Sa(8,32))}function Z3(t){const e=t.split("/");let a=e[0].split(":"),s="";a=a.map(m=>m.replace(/^0+/gm,""));let n=0,i=-1,r=-1,d=0,u=-1,c=-1;for(let m=0;m<a.length;m++)a[m]===""?(u===-1&&(u=m),d++):(c=m-1,n<d&&(n=d,i=u,r=c),d=0,u=-1,c=-1);return n<d&&(n=d,i=u,r=a.length-1),a=a.map((m,f)=>m===""?f>=i&&f<=r&&i!==r?":":"0":m),s=a.join(":"),s=s.replace(/:{3,}/gm,"::"),e.length>1&&(s+="/"+e[1]),s}let Xl=null;class i_{constructor(e){this.words=e,this.length=this.words.length,this.shuffledIndexes=[],this.orderedIndex=0}resetIndexes(){this.orderedIndex=0,this.shuffledIndexes=[]}randomWord(e){return e==="zipf"?this.words[BO(this.words.length)]:zn(this.words)}shuffledWord(){return this.shuffledIndexes.length===0&&this.generateShuffledIndexes(),this.words[this.shuffledIndexes.pop()]}generateShuffledIndexes(){this.shuffledIndexes=[];for(let e=0;e<this.length;e++)this.shuffledIndexes.push(e);ec(this.shuffledIndexes)}nextWord(){return this.orderedIndex>=this.length&&(this.orderedIndex=0),this.words[this.orderedIndex++]}}async function R3(t){return(Xl===null||t!==Xl.words)&&(Xl=new i_(t)),Xl.resetIndexes(),Xl}function mL(){o("#typingTest #layoutfluidTimer").stop(!0,!0).animate({opacity:1},125)}function Ku(){o("#typingTest #layoutfluidTimer").stop(!0,!0).animate({opacity:0},125)}function Vv(t,e){o("#typingTest #layoutfluidTimer").text(`${Yd(e)} in: ${t}s`)}function N3(t,e){const a=Yd(e.replace(/_/g," "));let s=`${a} in: ${t} words`;t===1&&(s=`${a} starting next word`),o("#typingTest #layoutfluidTimer").text(s)}let eu=!1,Gf=0,Gv=0,Qx=0,Yx=3,dd=0,ld=0;function D3(t){Gv--;let e=Math.round(Math.random()),a=Math.round(Math.random()*5-.5);return t?(eu=!!Math.round(Math.random()),eu?a=3:a=0):(eu?(Qx===e?dd++:dd=0,(dd>1||ld>0&&dd>0)&&(e=1-e,dd=0),Qx=e,a=e*(Gf+1)):(Yx===e?ld++:ld=0,(ld>1||ld>0&&dd>0)&&(e=1-e,ld=0),Yx=e,a=3-e*(Gf+1)),eu=!eu,Gv<0&&e===0&&(Gf=1-Gf,Gv=Math.floor(Math.random()*3)+3)),a}function j3(t){const e=["←","↓","↑","→"];let a="";for(let s=0;s<4;s++)a+=e[D3(s===0&&t)];return a}const Jx=2;class B3{constructor(){this.chars={},this.count=0}addChar(e){this.count++,e in this.chars?this.chars[e]++:this.chars[e]=1}randomChar(){const e=Sa(0,this.count-1);let a=0;for(const[s,n]of Object.entries(this.chars))if(a+=n,a>e)return s;return Object.keys(this.chars)[0]}}class q3 extends i_{constructor(e){super(e),this.ngrams={},this.length=1/0;for(let a of e){a+=" ";let s="";for(const n of a)s in this.ngrams||(this.ngrams[s]=new B3),this.ngrams[s].addChar(n),s=(s+n).slice(-Jx)}}randomWord(){let e="";for(;;){const a=e.slice(-Jx),s=this.ngrams[a];if(!s){e="";continue}const n=s.randomChar();if(n===" ")break;e+=n}return e}}Et("simon_says",{applyConfig(){mn("next",!0)},rememberSettings(){va("keymapMode",l.keymapMode,mn)}});Et("tts",{applyConfig(){mn("off",!0)},rememberSettings(){va("keymapMode",l.keymapMode,mn)},toggleScript(t){if(window.speechSynthesis===void 0){g("Failed to load text-to-speech script",-1);return}t[0]!==void 0&&y3(t[0])}});Et("arrows",{getWord(t,e){return j3(e===0)},rememberSettings(){va("highlightMode",l.highlightMode,Gr)},handleChar(t){return t==="a"||t==="ArrowLeft"||t==="j"?"←":t==="s"||t==="ArrowDown"||t==="k"?"↓":t==="w"||t==="ArrowUp"||t==="i"?"↑":t==="d"||t==="ArrowRight"||t==="l"?"→":t},isCharCorrect(t,e){return(t==="a"||t==="ArrowLeft"||t==="j")&&e==="←"||(t==="s"||t==="ArrowDown"||t==="k")&&e==="↓"||(t==="w"||t==="ArrowUp"||t==="i")&&e==="↑"||(t==="d"||t==="ArrowRight"||t==="l")&&e==="→"},async preventDefaultEvent(t){return["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(t.key)},getWordHtml(t,e){let a="";return t==="↑"&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-up"></i>',e&&(a+="</letter>")),t==="↓"&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-down"></i>',e&&(a+="</letter>")),t==="←"&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-left"></i>',e&&(a+="</letter>")),t==="→"&&(e&&(a+="<letter>"),a+='<i class="fas fa-arrow-right"></i>',e&&(a+="</letter>")),a}});Et("rAnDoMcAsE",{alterText(t){let e=t[0];for(let a=1;a<t.length;a++)e[a-1]===e[a-1].toUpperCase()?e+=t[a].toLowerCase():e+=t[a].toUpperCase();return e}});Et("backwards",{alterText(t){return t.split("").reverse().join("")}});Et("capitals",{alterText(t){return Xm(t)}});Et("layoutfluid",{applyConfig(){const t=l.customLayoutfluid.split("#")[0]??"qwerty";wo(t,!0),bo(t,!0)},rememberSettings(){va("keymapMode",l.keymapMode,mn),va("layout",l.layout,wo),va("keymapLayout",l.keymapLayout,bo)},handleSpace(){if(l.mode!=="time"){const t=l.customLayoutfluid?l.customLayoutfluid.split("#"):["qwerty","dvorak","colemak"],e=I.length,a=Math.floor(e/t.length),s=Math.floor((A.history.length+1)/a),n=a-(I.currentIndex+1)%a;t[s]?(n<=3&&t[s+1]?(mL(),N3(n,t[s+1])):Ku(),n===a&&(wo(t[s]),bo(t[s]),n>3&&Ku())):Ku(),setTimeout(()=>{cr(I.getCurrent().charAt(A.current.length).toString())},1)}},getResultContent(){return l.customLayoutfluid.replace(/#/g," ")},restart(){this.applyConfig&&this.applyConfig(),setTimeout(()=>{cr(I.getCurrent().substring(A.current.length,A.current.length+1).toString())},1)}});Et("gibberish",{getWord(){return c3()}});Et("58008",{getWord(){let t=rL(7);return l.language.startsWith("kurdish")?t=lS(t):l.language.startsWith("nepali")&&(t=uS(t)),t},punctuateWord(t){if(t.length>3&&(Math.random()<.5&&(t=Mx(t,Sa(1,t.length-2),".")),Math.random()<.75)){const e=Sa(1,t.length-2);if(t[e-1]!=="."&&t[e+1]!=="."&&t[e+1]!=="0"){const a=zn(["/","*","-","+"]);t=Mx(t,e,a)}}return t},rememberSettings(){va("numbers",l.numbers,Fs)},handleChar(t){return t===`
`?" ":t}});Et("ascii",{getWord(){return p3()},punctuateWord(t){return t}});Et("specials",{getWord(){return m3()}});Et("read_ahead_easy",{rememberSettings(){va("highlightMode",l.highlightMode,Gr)}});Et("read_ahead",{rememberSettings(){va("highlightMode",l.highlightMode,Gr)}});Et("read_ahead_hard",{rememberSettings(){va("highlightMode",l.highlightMode,Gr)}});Et("memory",{applyConfig(){o("#wordsWrapper").addClass("hidden"),Pp(!0,!0),l.keymapMode==="next"&&mn("react",!0)},rememberSettings(){va("mode",l.mode,ha),va("showAllLines",l.showAllLines,Pp),l.keymapMode==="next"&&va("keymapMode",l.keymapMode,mn)},start(){fl(),o("#words").addClass("hidden")},restart(){h3(),o("#words").removeClass("hidden"),l.keymapMode==="next"&&mn("react")}});Et("nospace",{rememberSettings(){va("highlightMode",l.highlightMode,Gr)}});Et("poetry",{async pullSection(){return L3()}});Et("wikipedia",{async pullSection(t){return I3((t??"")||"english")}});Et("weakspot",{getWord(t){return t!==void 0?S3(t):""}});Et("pseudolang",{async withWords(t){return t!==void 0?new q3(t):new i_([])}});Et("IPv4",{getWord(){return O3()},punctuateWord(t){let e=t;return Math.random()<.25&&(e=pL(t)),e},rememberSettings(){va("numbers",l.numbers,Fs)}});Et("IPv6",{getWord(){return P3()},punctuateWord(t){let e=t;return Math.random()<.25&&(e=pL(t)),e.includes(":")&&(e=Z3(e)),e},rememberSettings(){va("numbers",l.numbers,Fs)}});Et("binary",{getWord(){return d3()}});Et("hexadecimal",{getWord(){return l3()},punctuateWord(t){return`0x${t}`},rememberSettings(){va("punctuation",l.punctuation,xn)}});Et("zipf",{getWordsFrequencyMode(){return"zipf"}});Et("ddoouubblleedd",{alterText(t){return t.replace(/./gu,"$&$&")}});Et("instant_messaging",{alterText(t){return t.toLowerCase().replace(/[.!?]$/g,`
`).replace(/[().'"]/g,"").replace(/\n+/g,`
`)}});function iy(...t){ze(l.funbox).forEach(e=>{var a;(a=e.functions)!=null&&a.toggleScript&&e.functions.toggleScript(t)})}function W3(t){return ze(l.funbox).forEach(e=>{var a,s;return(s=(a=e.functions)==null?void 0:a.clearGlobal)==null?void 0:s.call(a)}),dL(),yi(t,!1),!0}function fL(t){if(t==="none"&&W3("none"),!ok(l.funbox,t)&&!l.funbox.split("#").includes(t))return g(`${Yd(t.replace(/_/g," "))} funbox is not compatible with the current funbox selection`,0),!0;dL();const e=bk(t,!1);return l.funbox.includes(t)?ze(t).forEach(a=>{var s,n;return(n=(s=a.functions)==null?void 0:s.applyGlobalCSS)==null?void 0:n.call(s)}):ze(t).forEach(a=>{var s,n;return(n=(s=a.functions)==null?void 0:s.clearGlobal)==null?void 0:n.call(s)}),!(e===!1||e===!0)}async function Md(){var t,e,a,s;return o("body").attr("class",((s=(a=(e=(t=o("body"))==null?void 0:t.attr("class"))==null?void 0:e.split(/\s+/))==null?void 0:a.filter(n=>!n.startsWith("fb-")))==null?void 0:s.join(" "))??""),o("#funBoxTheme").removeAttr("href"),o("#wordsWrapper").removeClass("hidden"),fl(),$t(),!0}async function r_(t){if(t==null?t=l.funbox:l.funbox!==t&&(l.funbox=t),!ok(l.funbox))return g(qe(void 0,`Failed to activate funbox: funboxes ${l.funbox.replace(/_/g," ")} are not compatible`),-1),yi("none",!0),await Md(),!1;fl(),await z3(),await H3(),o("#wordsWrapper").removeClass("hidden");let e;try{e=await Kr(l.language)}catch(s){return g(qe(s,"Failed to activate funbox"),-1),yi("none",!0),await Md(),!1}if(e.ligatures&&ze(l.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.includes("noLigatures")})){g("Current language does not support this funbox mode",0),yi("none",!0),await Md();return}let a=!0;for(const[s,n]of Object.entries(l)){const i=Qb(s,n,l.funbox);if(!i.result&&!i.result)if(i.forcedConfigs&&i.forcedConfigs.length>0)s==="mode"&&ha(i.forcedConfigs[0]),s==="words"&&Zr(i.forcedConfigs[0]),s==="time"&&Dn(i.forcedConfigs[0]),s==="punctuation"&&xn(i.forcedConfigs[0]),s==="numbers"&&Fs(i.forcedConfigs[0]),s==="highlightMode"&&Gr(i.forcedConfigs[0]);else{a=!1;break}}if(!a){l.funbox.includes("#")?g(`Failed to activate funboxes ${l.funbox}: no intersecting forced configs. Disabling funbox`,-1):g(`Failed to activate funbox ${l.funbox}: no forced configs. Disabling funbox`,-1),yi("none",!0),await Md();return}return $t(),ze(l.funbox).forEach(async s=>{var n,i;(i=(n=s.functions)==null?void 0:n.applyConfig)==null||i.call(n)}),!0}async function F3(){ze(l.funbox).forEach(async t=>{var e;(e=t.functions)!=null&&e.rememberSettings&&t.functions.rememberSettings()})}Et("morse",{alterText(t){return u3(t)}});Et("crt",{applyGlobalCSS(){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent)){const e=navigator.userAgent.match(/.*Version\/([0-9]*)\.([0-9]*).*/),a=e!==null?parseInt(e[1]??"0"):0,s=e!==null?parseInt(e[2]??"0"):0;if(a<=16&&s<=5){g("CRT is not available on Safari 16.5 or earlier.",0,{duration:5}),fL("crt");return}}o("body").append('<div id="scanline" />'),o("body").addClass("crtmode"),o("#globalFunBoxTheme").attr("href","funbox/crt.css")},clearGlobal(){o("#scanline").remove(),o("body").removeClass("crtmode"),o("#globalFunBoxTheme").attr("href","")}});async function z3(){var s,n;const t=o("body"),e=ze(l.funbox).map(i=>"fb-"+i.name.replaceAll("_","-")),a=((n=(s=t==null?void 0:t.attr("class"))==null?void 0:s.split(/\s+/))==null?void 0:n.filter(i=>!i.startsWith("fb-")))??[];return t.attr("class",[...a,...e].join(" ")),!0}async function H3(){const t=o("#funBoxTheme"),e=ze(l.funbox).find(n=>n.hasCSS==!0),a=e!=null?"funbox/"+e.name+".css":"",s=(t.attr("href")??"")||null;return a!=s&&t.attr("href",a),!0}const U3={keymapShowTopRow:!0,type:"matrix",keys:{row1:[],row2:["sS","tT","pP","hH","**","fF","pP","lL","tT","dD"],row3:["sS","kK","wW","rR","**","rR","bB","gG","sS","zZ"],row4:["aA","oO","eE","uU"],row5:[]}};function K3(t){if(l.mode!=="zen"){t===""&&(t=" ");try{o(".activeKey").removeClass("activeKey");let e;l.language.startsWith("korean")&&(t=pa.disassemble(t)[0]??t),t===" "?e="#keymap .keySpace, #keymap .keySplitSpace":t==='"'?e=`#keymap .keymapKey[data-key*='${t}']`:e=`#keymap .keymapKey[data-key*="${t}"]`,o(e).addClass("activeKey")}catch(e){e instanceof Error&&console.log("could not update highlighted keymap key: "+e.message)}}}async function V3(t,e){if(t===void 0)return;t===" "?t="#keymap .keySpace, #keymap .keySplitSpace":t==='"'?t=`#keymap .keymapKey[data-key*='${t}']`:t=`#keymap .keymapKey[data-key*="${t}"]`;const a=await Vr();try{let s={color:a.bg,backgroundColor:a.sub,borderColor:a.sub};e||l.blindMode?s={color:a.bg,backgroundColor:a.main,borderColor:a.main}:s={color:a.bg,backgroundColor:a.error,borderColor:a.error},o(t).stop(!0,!0).css(s).animate({color:a.sub,backgroundColor:a.subAlt,borderColor:a.sub},ia()?0:500,"easeOutExpo")}catch{}}function G3(){o("#keymap").addClass("hidden")}function Q3(){o("#keymap").removeClass("hidden")}async function ry(t=l.layout){if(l.keymapMode!=="off"&&ft()==="test"&&t)try{let e;try{e=await Vm()}catch(m){g(qe(m,"Failed to refresh keymap"),-1);return}let a=e[t],s=t;l.keymapLayout==="overrideSync"?l.layout==="default"?(a=e.qwerty,s="default"):(a=e[l.layout],s=l.layout):(a=e[l.keymapLayout],s=l.keymapLayout);const n=Lk&&l.keymapMode==="next"||l.keymapShowTopRow==="always"||a.keymapShowTopRow&&l.keymapShowTopRow!=="never",i=l.keymapStyle==="matrix"||l.keymapStyle==="split_matrix",r=l.keymapStyle==="steno"||l.keymapStyle==="steno_matrix";if(r&&(a=U3),a===void 0)throw new Error("Failed to refresh keymap: layout not found");const d=a.type==="iso";let u="";const c=Object.keys(a.keys);for(let m=0;m<c.length;m++){const f=c[m];let h=a.keys[f];f==="row1"&&(i||l.keymapStyle==="staggered")&&(h=h.slice(1));let y="";if(!(f==="row1"&&(!n||r))){if((f==="row2"||f==="row3"||f==="row4")&&!i&&!r&&(y+="<div></div>"),f==="row4"&&!d&&!i&&!r&&(y+="<div></div>"),i&&(f!=="row5"&&a.matrixShowRightColumn?y+='<div class="keymapKey"></div>':y+="<div></div>"),f==="row5"){if(r)continue;const b=s.replace(/_/g," ");let w="";l.keymapLegendStyle==="blank"&&(w='style="display: none;"'),y+="<div></div>",y+=`<div class="keymapKey keySpace">
          <div class="letter" ${w}>${b}</div>
        </div>`,y+='<div class="keymapSplitSpacer"></div>',y+=`<div class="keymapKey keySplitSpace">
          <div class="letter"></div>
        </div>`}else for(let b=0;b<h.length;b++){if(f==="row2"&&b===12||f==="row4"&&i&&d&&b===0)continue;let w=10;if(a.matrixShowRightColumn&&(w=11),f==="row4"&&i&&d&&(w+=1),(l.keymapStyle==="matrix"||l.keymapStyle==="split_matrix")&&b>=w)continue;const $=h[b],E=f==="row3"&&(b===3||b===6);let L=$[0],be="";l.keymapLegendStyle==="blank"?be='style="display: none;"':l.keymapLegendStyle==="uppercase"&&(L=L.toUpperCase());let J="";f==="row1"&&b===0&&!i&&l.keymapStyle!=="staggered"&&(J=" invisible");const k=`<div class="keymapKey${J}" data-key="${$.replace('"',"&quot;")}">
              <span class="letter" ${be}>${L}</span>
              ${E?"<div class='bump'></div>":""}
          </div>`;let S="";(l.keymapStyle==="split"||l.keymapStyle==="split_matrix"||l.keymapStyle==="alice"||r)&&(f==="row4"&&r&&(b===0||b===2||b===4)?S+='<div class="keymapSplitSpacer"></div>':f==="row4"&&(l.keymapStyle==="split"||l.keymapStyle==="alice")&&d?b===6&&(S+='<div class="keymapSplitSpacer"></div>'):f==="row1"&&(l.keymapStyle==="split"||l.keymapStyle==="alice")?b===7&&(S+='<div class="keymapSplitSpacer"></div>'):f==="row4"&&i&&d?b===6&&(S+='<div class="keymapSplitSpacer"></div>'):b===5&&(S+='<div class="keymapSplitSpacer"></div>')),l.keymapStyle==="alice"&&f==="row4"&&(d&&b===6||!d&&b===5)&&(S+='<div class="extraKey"><span class="letter"></span></div>'),y+=S+k}u+=`<div class="row r${m+1}">${y}</div>`}}o("#keymap").html(u),o("#keymap").removeClass("staggered"),o("#keymap").removeClass("matrix"),o("#keymap").removeClass("split"),o("#keymap").removeClass("split_matrix"),o("#keymap").removeClass("alice"),o("#keymap").removeClass("steno"),o("#keymap").removeClass("steno_matrix"),o("#keymap").addClass(l.keymapStyle)}catch(e){e instanceof Error&&console.log("something went wrong when changing layout, resettings: "+e.message)}}Dt((t,e)=>{t==="layout"&&l.keymapLayout==="overrideSync"&&ry(l.keymapLayout),(t==="keymapLayout"||t==="keymapStyle"||t==="keymapShowTopRow"||t==="keymapMode")&&ry(),t==="keymapMode"&&(e==="off"?G3():Q3())});v3((t,e,a)=>{t==="highlight"&&K3(e),t==="flash"&&V3(e,a)});Ns.register(p2,m2,f2,h2,g2,y2,v2,b2,w2,k2,_2,x2,C2,S2);Ns.defaults.animation.duration=0;Ns.defaults.elements.line.tension=.3;Ns.defaults.elements.line.fill="origin";class jl extends Ns{constructor(e,a){super(e,a)}async updateColors(){await J3(this)}getDataset(e){var a;return(a=this.data.datasets)==null?void 0:a.find(s=>s.yAxisID===e)}getScale(e){return this.options.scales[e]}}let Xx;const Ft=new jl(document.querySelector("#wpmChart"),{type:"line",data:{labels:[],datasets:[{clip:!1,label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"wpm",order:2,pointRadius:1},{clip:!1,label:"raw",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:3,yAxisID:"raw",order:3,pointRadius:1},{clip:!1,label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:3},pointHoverRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:5}}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},raw:{axis:"y",display:!1,title:{display:!0,text:"Raw Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{axis:"y",display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1,callbacks:{afterLabel:function(t){var e;if(Xx===t)return"";Xx=t;try{const a=Math.round(parseFloat(t.label))-1,s=(e=lf[a])==null?void 0:e.words,n=[...new Set(s)],i=n[0],r=_r(n);if(i===void 0||r===void 0)return"";h4(i,r)}catch{}return""}}}}}});let hL;const ye=new jl(document.querySelector(".pageAccount #accountHistoryChart"),{type:"line",data:{datasets:[{yAxisID:"wpm",data:[],fill:!1,borderWidth:0,order:3},{yAxisID:"pb",data:[],fill:!1,stepped:!0,pointRadius:0,pointHoverRadius:0,order:4},{yAxisID:"acc",fill:!1,data:[],pointStyle:"triangle",borderWidth:0,pointRadius:3.5,order:3},{yAxisID:"wpmAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"accAvgTen",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:2},{yAxisID:"wpmAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1},{yAxisID:"accAvgHundred",label:"accAvgHundred",data:[],fill:!1,pointRadius:0,pointHoverRadius:0,order:1}]},options:{maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",type:"linear",reverse:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpm:{axis:"y",type:"linear",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Words per Minute"},position:"right"},pb:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1},acc:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!0,title:{display:!0,text:"Accuracy"},grid:{display:!1},position:"left"},wpmAvgTen:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgTen:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}},wpmAvgHundred:{axis:"y",beginAtZero:!0,min:0,ticks:{stepSize:10},display:!1,grid:{display:!1}},accAvgHundred:{axis:"y",beginAtZero:!0,min:0,max:100,reverse:!0,ticks:{stepSize:10},display:!1,grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},enabled:!0,intersect:!1,external:function(t){t!==void 0&&(t.tooltip.options.displayColors=!1)},filter:function(t){return t.datasetIndex!==1&&t.datasetIndex!==3&&t.datasetIndex!==4&&t.datasetIndex!==5&&t.datasetIndex!==6},callbacks:{title:function(){return""},beforeLabel:function(t){if(t.datasetIndex!==0){const n=t.dataset.data[t.dataIndex];return`error rate: ${Oe(n.errorRate)}%
acc: ${Oe(100-n.errorRate)}%`}const e=t.dataset.data[t.dataIndex];let a=`${l.typingSpeedUnit}: ${e.wpm}
raw: ${e.raw}
acc: ${e.acc}

mode: ${e.mode} `;(e.mode==="time"||e.mode==="words")&&(a+=e.mode2);let s=e.difficulty;return s===void 0&&(s="normal"),a+=`
difficulty: ${s}`,a+=`
punctuation: ${e.punctuation}
language: ${e.language}${e.isPb?`

new personal best`:""}

date: ${Ot(new Date(e.timestamp),"dd MMM yyyy HH:mm")}`,a},label:function(){return""},afterLabel:function(t){return hL=t.dataIndex,""}}}}}}),pr=new jl(document.querySelector(".pageAccount #accountActivityChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Seconds",data:[],trendlineLinear:{style:"rgba(255,105,180, .8)",lineStyle:"dotted",width:2},order:3},{yAxisID:"avgWpm",label:"Average Wpm",data:[],type:"line",order:2,tension:0,fill:!1}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},type:"time",time:{unit:"day",displayFormats:{day:"d MMM"}},bounds:"ticks",display:!0,title:{display:!1,text:"Date"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:1},display:!0,title:{display:!0,text:"Time typing (minutes)"}},avgWpm:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,position:"right",title:{display:!0,text:"Average Wpm"},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index",callbacks:{title:function(t){const e=t[0],a=e.dataset.data[e.dataIndex];return Ot(new Date(a.x),"dd MMM yyyy")},beforeLabel:function(t){const e=t.dataset.data[t.dataIndex];switch(t.datasetIndex){case 0:return`Time Typing: ${ts(Math.round(e.y*60),!0,!0)}
Tests Completed: ${e.amount}`;case 1:return`Average ${l.typingSpeedUnit}: ${Oe(e.y)}`;default:return""}},label:function(){return""}}}}}}),Nd=new jl(document.querySelector(".pageAccount #accountHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Tests",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Tests"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),Dd=new jl(document.querySelector(".pageAbout #publicStatsHistogramChart"),{type:"bar",data:{labels:[],datasets:[{yAxisID:"count",label:"Users",data:[]}]},options:{responsive:!0,maintainAspectRatio:!1,hover:{mode:"nearest",intersect:!1},scales:{x:{axis:"x",bounds:"ticks",display:!0,title:{display:!1,text:"Bucket"},offset:!0},count:{axis:"y",beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20,stepSize:10},display:!0,title:{display:!0,text:"Users"}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},intersect:!1,mode:"index"}}}}),Ls=new jl(document.querySelector("#miniResultChartModal canvas"),{type:"line",data:{labels:[],datasets:[{label:"wpm",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:2,yAxisID:"wpm",order:2,pointRadius:2},{label:"raw",data:[],borderColor:"rgba(125, 125, 125, 1)",borderWidth:2,yAxisID:"raw",order:3,pointRadius:2},{label:"errors",data:[],borderColor:"rgba(255, 125, 125, 1)",pointBackgroundColor:"rgba(255, 125, 125, 1)",borderWidth:2,order:1,yAxisID:"error",type:"scatter",pointStyle:"crossRot",pointRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:3},pointHoverRadius:function(t){const e=t.dataIndex;return(t.dataset.data[e]??0)<=0?0:5}}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{x:{axis:"x",ticks:{autoSkip:!0,autoSkipPadding:20},display:!0,title:{display:!1,text:"Seconds"}},wpm:{axis:"y",display:!0,title:{display:!0,text:"Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!0}},raw:{axis:"y",display:!1,title:{display:!0,text:"Raw Words per Minute"},beginAtZero:!0,min:0,ticks:{autoSkip:!0,autoSkipPadding:20},grid:{display:!1}},error:{display:!0,position:"right",title:{display:!0,text:"Errors"},beginAtZero:!0,ticks:{precision:0,autoSkip:!0,autoSkipPadding:20},grid:{display:!1}}},plugins:{annotation:{annotations:[]},tooltip:{animation:{duration:250},mode:"index",intersect:!1}}}});function Y3(){gL(!1),yL(!1),vL(!1),bL(!1)}function yv(t,e){t?o(`.pageAccount ${e}`).addClass("active"):o(`.pageAccount ${e}`).removeClass("active")}function gL(t=!0){const e=l.accountChart[0]==="on";yv(e,".toggleResultsOnChart"),ye.getDataset("wpm").hidden=!e,ye.getDataset("pb").hidden=!e,ye.getDataset("wpmAvgTen").hidden=!e,ye.getDataset("wpmAvgHundred").hidden=!e,ye.getScale("wpm").display=e,t&&ye.updateColors()}function yL(t=!0){const e=l.accountChart[0]==="on",a=l.accountChart[1]==="on";if(yv(a,".toggleAccuracyOnChart"),ye.getDataset("acc").hidden=!a,ye.getDataset("accAvgTen").hidden=!a,ye.getDataset("accAvgHundred").hidden=!a,ye.getScale("acc").display=a,e)ye.getScale("acc").min=0,ye.getScale("accAvgTen").min=0,ye.getScale("accAvgHundred").min=0;else{const s=Math.floor(Math.min(...ye.getDataset("acc").data.map(n=>n.y))/10)*10;ye.getScale("acc").min=s,ye.getScale("accAvgTen").min=s,ye.getScale("accAvgHundred").min=s}t&&ye.updateColors()}function vL(t=!0){const e=l.accountChart[0]==="on",a=l.accountChart[1]==="on",s=l.accountChart[2]==="on";yv(s,".toggleAverage10OnChart"),a&&(ye.getDataset("accAvgTen").hidden=!s),e&&(ye.getDataset("wpmAvgTen").hidden=!s),t&&ye.updateColors()}function bL(t=!0){const e=l.accountChart[0]==="on",a=l.accountChart[1]==="on",s=l.accountChart[3]==="on";yv(s,".toggleAverage100OnChart"),a&&(ye.getDataset("accAvgHundred").hidden=!s),e&&(ye.getDataset("wpmAvgHundred").hidden=!s),t&&ye.updateColors()}async function J3(t){var h,y;const e=await bs("bg"),a=await bs("sub"),s=await bs("subAlt"),n=await bs("main"),i=await bs("error"),r=await bs("text"),d=an(e,s,.75);t.data.datasets[0].borderColor=b=>{var E;return((E=b.raw)==null?void 0:E.isPb)?r:n},t.data.datasets[1]&&(t.data.datasets[1].borderColor=a),t.data.datasets[2]&&(t.data.datasets[2].borderColor=i);const u=t.data.datasets[0];((y=(h=t==null?void 0:t.data)==null?void 0:h.datasets[0])==null?void 0:y.type)===void 0?t.config.type==="line"?u.pointBackgroundColor=b=>{var E;return((E=b.raw)==null?void 0:E.isPb)?r:n}:t.config.type==="bar"&&(u.backgroundColor=n):t.data.datasets[0].type==="bar"?t.data.datasets[0].backgroundColor=n:t.data.datasets[0].type==="line"&&(u.pointBackgroundColor=n);const c=t.data.datasets[1];c!==void 0&&(c.type===void 0?t.config.type==="line"?c.pointBackgroundColor=a:t.config.type==="bar"&&(c.backgroundColor=a):(c==null?void 0:c.type)==="bar"?c.backgroundColor=a:c.type==="line"&&(c.pointBackgroundColor=a)),t.data.datasets.length===2&&(c.borderColor=()=>a);const m=t.data.datasets[2];if(t.data.datasets.length===7){m.borderColor=()=>a;const b=l.accountChart[2]==="on",w=l.accountChart[3]==="on",$=an(e,r,.2),E=an(e,n,.2),L=an(e,n,.4),be=an(e,a,.2),J=an(e,a,.4),[k,S,z,Ee,ca,aa,ma]=t.data.datasets;if(k===void 0||S===void 0||z===void 0||Ee===void 0||ca===void 0||aa===void 0||ma===void 0)return;b&&w?(k.pointBackgroundColor=E,S.borderColor=$,z.pointBackgroundColor=be,Ee.borderColor=L,ca.borderColor=J,aa.borderColor=n,ma.borderColor=a):b&&!w||!b&&w?(S.borderColor=$,k.pointBackgroundColor=L,z.pointBackgroundColor=J,Ee.borderColor=n,aa.borderColor=n,ca.borderColor=a,ma.borderColor=a):(S.borderColor=$,k.pointBackgroundColor=n,z.pointBackgroundColor=a)}const f=t.options;Object.keys(f.scales).forEach(b=>{const w=f.scales[b];w.ticks.color=a,w.title.color=a,w.grid.color=d,w.grid.tickColor=d,w.grid.borderColor=d});try{u.trendlineLinear.style=a}catch{}t.options.plugins.annotation.annotations.forEach(b=>{b.id!=="funbox-label"&&(b.borderColor=a),b.label.backgroundColor=a,b.label.color=e}),t.update("none")}function X3(t){Ns.defaults.font.family=t.replace(/_/g," ")}function wL(){Jm(),ye.updateColors(),Nd.updateColors(),Dd.updateColors(),Ft.updateColors(),pr.updateColors(),Ls.updateColors()}Dt((t,e)=>{t==="accountChart"&&ft()==="account"&&(gL(),yL(),vL(),bL()),t==="fontFamily"&&X3(e)});const Nt={blur:{value:0,default:0},brightness:{value:1,default:1},saturate:{value:1,default:1},opacity:{value:1,default:1}};function ez(){let t="";return Object.keys(Nt).forEach(e=>{const a=e;Nt[a].value!==Nt[a].default&&(t+=`${e}(${Nt[a].value}${e==="blur"?"rem":""}) `)}),t}function Bl(){const e={filter:ez(),width:`calc(100% + ${Nt.blur.value*4}rem)`,height:`calc(100% + ${Nt.blur.value*4}rem)`,left:`-${Nt.blur.value*2}rem`,top:`-${Nt.blur.value*2}rem`,position:"absolute"};o(".customBackground img").css(e)}function tz(){o(".section[data-config-name='customBackgroundFilter'] .blur input").val(Nt.blur.value),o(".section[data-config-name='customBackgroundFilter'] .brightness input").val(Nt.brightness.value),o(".section[data-config-name='customBackgroundFilter'] .saturate input").val(Nt.saturate.value),o(".section[data-config-name='customBackgroundFilter'] .opacity input").val(Nt.opacity.value)}function bf(){o(".section[data-config-name='customBackgroundFilter'] .blur .value").html(Nt.blur.value.toFixed(1)),o(".section[data-config-name='customBackgroundFilter'] .brightness .value").html(Nt.brightness.value.toFixed(1)),o(".section[data-config-name='customBackgroundFilter'] .saturate .value").html(Nt.saturate.value.toFixed(1)),o(".section[data-config-name='customBackgroundFilter'] .opacity .value").html(Nt.opacity.value.toFixed(1))}function kL(){tz(),bf()}function az(t){Nt.blur.value=t[0],Nt.brightness.value=t[1],Nt.saturate.value=t[2],Nt.opacity.value=t[3],kL()}o(".section[data-config-name='customBackgroundFilter'] .blur input").on("input",()=>{Nt.blur.value=parseFloat(o(".section[data-config-name='customBackgroundFilter'] .blur input").val()),bf(),Bl()});o(".section[data-config-name='customBackgroundFilter'] .brightness input").on("input",()=>{Nt.brightness.value=parseFloat(o(".section[data-config-name='customBackgroundFilter'] .brightness input").val()),bf(),Bl()});o(".section[data-config-name='customBackgroundFilter'] .saturate input").on("input",()=>{Nt.saturate.value=parseFloat(o(".section[data-config-name='customBackgroundFilter'] .saturate input").val()),bf(),Bl()});o(".section[data-config-name='customBackgroundFilter'] .opacity input").on("input",()=>{Nt.opacity.value=parseFloat(o(".section[data-config-name='customBackgroundFilter'] .opacity input").val()),bf(),Bl()});o(".section[data-config-name='customBackgroundFilter'] input").on("input",()=>{sz()});const sz=cs(2e3,async()=>{const t=Object.keys(Nt).map(e=>Nt[e].value);Ak(t,!1)});Dt((t,e)=>{t==="customBackgroundFilter"&&e&&(az(e),Bl())});let xa=null,Fw=!1,kd=0;const Di=["--bg-color","--main-color","--caret-color","--sub-color","--sub-alt-color","--text-color","--error-color","--error-extra-color","--colorful-error-color","--colorful-error-extra-color"];async function nz(){setTimeout(async()=>{let t,e;e=await bs("bg"),t=await bs("main"),e===t&&(e="#111",t="#eee");const a=`
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64">
  <style>
    #bg{fill:${e};}
    path{fill:${t};}
  </style>
  <g>
    <path id="bg" d="M0 16Q0 0 16 0h32q16 0 16 16v32q0 16-16 16H16Q0 64 0 48"/>
    <path d="M9.09 24.1v21.2h5.12V33.1q.256-4.61 4.48-4.61 3.46.384 3.46 3.84v12.9h5.12v-11.5q-.128-5.25 4.48-5.25 3.46.384 3.46 3.84v12.9h5.12v-12.2q0-9.47-7.04-9.47-4.22 0-7.04 3.46-2.18-3.46-6.02-3.46-3.46 0-6.02 2.43v-2.05M47 18.9v5.12h-4.61v5.12H47v16.1h5.12v-16.1h4.61v-5.12h-4.61V18.9"/>
  </g>
</svg>`;o("#favicon").attr("href","data:image/svg+xml;base64,"+btoa(a))},125)}function iz(){console.debug("Theme controller clearing custom theme");for(const t of Di)document.documentElement.style.setProperty(t,"")}let tu=[];async function _L(t){return new Promise(e=>{function a(){console.debug("Theme controller swapping elements");const i=o("#currentTheme"),r=o("#nextTheme");if(r.length===0){console.debug("Theme controller failed to swap elements, next is missing");return}i.remove(),r.attr("id","currentTheme")}console.debug("Theme controller loading style",t),tu.push(setTimeout(()=>{ht()},100)),o("#nextTheme").remove();const s=document.querySelector("#currentTheme"),n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.id="nextTheme",n.onload=()=>{console.debug("Theme controller loaded style",t),We(),a(),tu.map(i=>clearTimeout(i)),tu=[],o("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),e()},n.onerror=i=>{console.debug("Theme controller failed to load style",t,i),console.error(`Failed to load theme ${t}`,i),We(),g("Failed to load theme",0),a(),tu.map(r=>clearTimeout(r)),tu=[],o("#keymap .keymapKey").stop(!0,!0).removeAttr("style"),e()},t==="custom"?n.href="/themes/serika_dark.css":n.href=`/themes/${t}.css`,s===null?(console.debug("Theme controller appending link to the head",n),document.head.appendChild(n)):(console.debug("Theme controller inserting link after current theme",n),s.after(n))})}async function wr(t,e,a=!1){console.debug("Theme controller applying theme",t,e,a),iz();const s=e?"custom":t;if(JB(),o(".keymapKey").attr("style",""),await _L(s),Jm(),l.customTheme&&!a||e){const i=e??l.customThemeColors;for(let r=0;r<Di.length;r++){const d=Di[r];document.documentElement.style.setProperty(d,i[r])}}Mi("changedTheme",{theme:s});const n=await Vr();o(".keymapKey").attr("style",""),wL(),nz(),o("#metaThemeColor").attr("content",n.bg),rz(a?t:void 0),DT(await bs("bg"))?o("body").addClass("darkMode"):o("body").removeClass("darkMode")}function rz(t){let e=l.theme;xa!==null&&(e=xa),l.customTheme&&(e="custom"),t!==void 0&&t!==""&&(e=t),e=e.replace(/_/g," "),o(".current-theme .text").text(e)}function oz(t,e){dz(t,e)}const dz=cs(250,(t,e)=>{Fw=!0,wr(t,e,!0)});async function Ea(t,e=!1){console.debug("Theme controller setting theme",t,e),await wr(t,void 0,e),!e&&l.autoSwitchTheme&&(KA(!1),g("Auto switch theme disabled",0))}async function eC(t=!0){Fw&&(Fw=!1,t&&(xa!==null?await wr(xa):l.customTheme?await wr("custom"):await wr(l.theme)))}let Os=[];async function xL(){var e,a;let t;try{t=await ak()}catch(s){console.error(qe(s,"Failed to update random theme list"));return}l.randomTheme==="fav"&&l.favThemes.length>0?Os=l.favThemes:l.randomTheme==="light"?Os=t.filter(s=>hB(s.bgColor)).map(s=>s.name):l.randomTheme==="dark"?Os=t.filter(s=>DT(s.bgColor)).map(s=>s.name):l.randomTheme==="on"?Os=t.map(s=>s.name):l.randomTheme==="custom"&&T()&&(Os=((a=(e=T())==null?void 0:e.customThemes)==null?void 0:a.map(s=>s._id))??[]),ec(Os),kd=0}async function lz(){var e,a,s,n,i;if(Os.length===0&&(await xL(),Os.length===0))return;xa=Os[kd],kd++,kd>=Os.length&&(ec(Os),kd=0);let t;if(l.randomTheme==="custom"){const r=(a=(e=T())==null?void 0:e.customThemes)==null?void 0:a.find(d=>d._id===xa);t=r==null?void 0:r.colors,xa="custom"}if(wi(!1,!0),await wr(xa,t),kd>=Os.length){let r=xa.replace(/_/g," ");l.randomTheme==="custom"&&(r=(((i=(n=(s=T())==null?void 0:s.customThemes)==null?void 0:n.find(d=>d._id===xa))==null?void 0:i.name)??"custom").replace(/_/g," ")),g(r,0)}}async function Qv(){xa!==null&&(xa=null,l.customTheme?await wr("custom"):await wr(l.theme))}function CL(){l.customBackgroundSize==="max"?o(".customBackground img").css({objectFit:""}):o(".customBackground img").css({objectFit:l.customBackgroundSize})}function uz(){l.customBackground===""?(o("#words").removeClass("noErrorBorder"),o("#resultWordsHistory").removeClass("noErrorBorder"),o(".customBackground img").remove()):(o("#words").addClass("noErrorBorder"),o("#resultWordsHistory").addClass("noErrorBorder"),o(".customBackground").html(`<img src="${l.customBackground}" alt="" onerror="javascript:window.dispatchEvent(new Event('customBackgroundFailed'))" />`),Bl(),CL())}var JC,uh,XC;(XC=(uh=(JC=window.matchMedia)==null?void 0:JC.call(window,"(prefers-color-scheme: dark)"))==null?void 0:uh.addEventListener)==null||XC.call(uh,"change",t=>{!l.autoSwitchTheme||l.customTheme||(t.matches?Ea(l.themeDark,!0):Ea(l.themeLight,!0))});Dt(async(t,e,a)=>{var s,n,i;t==="randomTheme"&&xL(),t==="customTheme"&&(e?await Ea("custom"):await Ea(l.theme)),t==="customThemeColors"&&(a?oz("custom"):await Ea("custom")),t==="theme"&&(await Qv(),await eC(!1),await Ea(e)),t==="setThemes"&&(await Qv(),await eC(!1),l.autoSwitchTheme?(s=window.matchMedia)!=null&&s.call(window,"(prefers-color-scheme: dark)").matches?await Ea(l.themeDark,!0):await Ea(l.themeLight,!0):e?await Ea("custom"):await Ea(l.theme)),t==="randomTheme"&&e==="off"&&await Qv(),t==="customBackground"&&uz(),t==="customBackgroundSize"&&CL(),t==="autoSwitchTheme"&&(e?(n=window.matchMedia)!=null&&n.call(window,"(prefers-color-scheme: dark)").matches?await Ea(l.themeDark,!0):await Ea(l.themeLight,!0):await Ea(l.theme)),t==="themeLight"&&l.autoSwitchTheme&&!((i=window.matchMedia)!=null&&i.call(window,"(prefers-color-scheme: dark)").matches)&&!a&&await Ea(l.themeLight,!0),t==="themeDark"&&l.autoSwitchTheme&&window.matchMedia!==void 0&&window.matchMedia("(prefers-color-scheme: dark)").matches&&!a&&await Ea(l.themeDark,!0)});window.addEventListener("customBackgroundFailed",()=>{g("Custom background link is either temporairly unavailable or expired. Please make sure the URL is correct or change it",0,{duration:5})});let ke=null,zw=0;function cz(t){(!Ro||Ro&&t>zw)&&(zw=t)}async function pz(){var i;if(l.paceCaret==="off"&&!Ro||(o("#paceCaret").hasClass("hidden")||o("#paceCaret").addClass("hidden"),l.mode==="zen"))return;const t=o("#paceCaret"),e=(i=document==null?void 0:document.querySelector("#words .word"))==null?void 0:i.querySelector("letter"),a=o(e).height();if(e===void 0||a===void 0)return;const n=(await Kr(l.language)).rightToLeft;t.stop(!0,!0).animate({top:e.offsetTop-a/4,left:e.offsetLeft+(n?e.offsetWidth:0)},0,"linear")}async function SL(){var i;o("#paceCaret").addClass("hidden");const t=Fy(l,pt);let e=0;if(l.paceCaret==="pb"?e=((i=await Nc(l.mode,t,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode,l.funbox))==null?void 0:i.wpm)??0:l.paceCaret==="tagPb"?e=await NB(l.mode,t,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode):l.paceCaret==="average"?([e]=await qT(l.mode,t,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode),e=Math.round(e)):l.paceCaret==="daily"?(e=await RB(l.mode,t,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode),e=Math.round(e)):l.paceCaret==="custom"?e=l.paceCaretCustomSpeed:(l.paceCaret==="last"||Ro)&&(e=zw),e===void 0||e<1||Number.isNaN(e)){ke=null;return}const a=e*5,s=a/60,n=60/a;ke={wpm:e,cps:s,spc:n,correction:0,currentWordIndex:0,currentLetterIndex:-1,wordsStatus:{},timeout:null},await pz()}async function TL(t){if(!(ke===null||!ea||Yt)){try{if(ke.currentLetterIndex++,ke.currentLetterIndex>=I.get(ke.currentWordIndex).length&&(ke.currentLetterIndex=-1,ke.currentWordIndex++),!l.blindMode){if(ke.correction<0)for(;ke.correction<0;)ke.currentLetterIndex--,ke.currentLetterIndex<=-2&&(ke.currentLetterIndex=I.get(ke.currentWordIndex-1).length-1,ke.currentWordIndex--),ke.correction++;else if(ke.correction>0)for(;ke.correction>0;)ke.currentLetterIndex++,ke.currentLetterIndex>=I.get(ke.currentWordIndex).length&&(ke.currentLetterIndex=-1,ke.currentWordIndex++),ke.correction--}}catch{ke=null,o("#paceCaret").addClass("hidden");return}try{const e=o("#paceCaret");let a,s,n;try{const r=ke.currentWordIndex-(I.currentIndex-zt),d=document.querySelectorAll("#words .word")[r];ke.currentLetterIndex===-1?a=d.querySelectorAll("letter")[0]:a=d.querySelectorAll("letter")[ke.currentLetterIndex];const u=o(a).height(),c=o(a).width(),m=e.width();if(u===void 0||c===void 0||m===void 0)throw new Error("Undefined current letter height, width or caret width.");const h=(await Kr(l.language)).rightToLeft;s=d.offsetTop+a.offsetTop-l.fontSize*xr(1)*.1,ke.currentLetterIndex===-1?n=d.offsetLeft+a.offsetLeft-m/2+(h?c:0):n=d.offsetLeft+a.offsetLeft-m/2+(h?0:c),e.removeClass("hidden")}catch{e.addClass("hidden")}const i=t-performance.now();if(s!==void 0){let r=o("#words .smoothScroller").height();r===void 0&&(r=0),o("#paceCaret").css({top:s-r}),l.smoothCaret!=="off"?e.stop(!0,!0).animate({left:n},ia()?0:i,"linear"):e.stop(!0,!0).animate({left:n},0,"linear")}ke.timeout=setTimeout(()=>{TL(t+((ke==null?void 0:ke.spc)??0)*1e3).catch(()=>{ke=null})},i)}catch(e){console.error(e),o("#paceCaret").addClass("hidden")}}}function mz(){(ke==null?void 0:ke.timeout)!=null&&clearTimeout(ke.timeout),ke=null}function tC(t,e){t?ke!==null&&ke.wordsStatus[I.currentIndex]===!0&&!l.blindMode&&(ke.wordsStatus[I.currentIndex]=void 0,ke.correction-=e.length+1):ke!==null&&ke.wordsStatus[I.currentIndex]===void 0&&!l.blindMode&&(ke.wordsStatus[I.currentIndex]=!0,ke.correction+=e.length+1)}function fz(){TL(performance.now()+((ke==null?void 0:ke.spc)??0)*1e3)}Dt(t=>{t==="paceCaret"&&SL()});Dt(t=>{t==="monkey"&&ea&&(l.monkey?o("#monkey").removeClass("hidden"):o("#monkey").addClass("hidden"))});let Yp=!1,Jp=!1;const Yv={"00":document.querySelector("#monkey .up"),"01":document.querySelector("#monkey .right"),10:document.querySelector("#monkey .left"),11:document.querySelector("#monkey .both")},Jv={"00":document.querySelector("#monkey .fast .up"),"01":document.querySelector("#monkey .fast .right"),10:document.querySelector("#monkey .fast .left"),11:document.querySelector("#monkey .fast .both")};let Xv="right";function aC(t){return t?"1":"0"}function $L(){var t,e,a;if(l.monkey&&!((t=document.querySelector("#monkey"))!=null&&t.classList.contains("hidden"))){Object.keys(Yv).forEach(n=>{var i;(i=Yv[n])==null||i.classList.add("hidden")}),Object.keys(Jv).forEach(n=>{var i;(i=Jv[n])==null||i.classList.add("hidden")});const s=`${aC(Yp)}${aC(Jp)}`;(e=Yv[s])==null||e.classList.remove("hidden"),(a=Jv[s])==null||a.classList.remove("hidden")}}function hz(t){if(!l.monkey)return;const e=Fh(t,130,180,0,1);o("#monkey .fast").animate({opacity:e},1e3);let a=Fh(t,130,180,.25,.01);a===.25&&(a=0),o("#monkey").css({animationDuration:a+"s"})}function gz(){l.monkey&&(!Yp&&Xv==="right"?(Yp=!0,Xv="left"):Jp||(Jp=!0,Xv="right"),$L())}function yz(){l.monkey&&(Yp?Yp=!1:Jp&&(Jp=!1),$L())}function vz(){l.monkey&&o("#monkey").css("opacity",0).removeClass("hidden").animate({opacity:1},125)}function AL(){o("#monkey").css("opacity",1).animate({opacity:1},125,()=>{o("#monkey").addClass("hidden"),o("#monkey .fast").stop(!0,!0).css("opacity",0),o("#monkey").stop(!0,!0).css({animationDuration:"0s"})})}const ML=[];function bz(t){ML.push(t)}function Xp(t,e,a){ML.forEach(s=>{try{s(t,e,a)}catch(n){console.error("Timer event subscriber threw an error"),console.error(n)}})}let uo=0,on=null;const Qf=1e3;let Yf=0,Gt=!1;function wz(){Gt=!0}function o_(){n3(0),on!==null&&clearTimeout(on)}function kz(){Gt&&console.time("premid");const t=document.querySelector("#premidSecondsLeft");t!==null&&(t.innerHTML=(l.time-Gp()).toString()),Gt&&console.timeEnd("premid")}function _z(){Gt&&console.time("timer progress update"),(l.mode==="time"||l.mode==="custom"&&Jt()==="time")&&vf(),Gt&&console.timeEnd("timer progress update")}function xz(){Gt&&console.time("calculate wpm and raw");const t=Yk();return Gt&&console.timeEnd("calculate wpm and raw"),Gt&&console.time("update live wpm"),X4(t.wpm,t.raw),Gt&&console.timeEnd("update live wpm"),Gt&&console.time("push to history"),fM(t.wpm),hM(t.raw),Gt&&console.timeEnd("push to history"),t}function Cz(t){Gt&&console.time("update monkey");const e=l.blindMode?t.raw:t.wpm;hz(e),Gt&&console.timeEnd("update monkey")}function Sz(){Gt&&console.time("calculate acc");const t=Oe(yf());return Gt&&console.timeEnd("calculate acc"),t}function Tz(){if(Gt&&console.time("layoutfluid"),l.funbox.split("#").includes("layoutfluid")&&l.mode==="time"){const t=l.customLayoutfluid?l.customLayoutfluid.split("#"):["qwerty","dvorak","colemak"],e=l.time/t.length,a=Gp(),s=Math.floor(a/e),n=t[s],i=[];for(let r=1;r<t.length;r++)i.push(Math.floor(e*r));i.includes(a+3)?(mL(),Vv(3,t[s+1])):i.includes(a+2)?Vv(2,t[s+1]):i.includes(a+1)&&Vv(1,t[s+1]),l.layout!==n&&n!==void 0&&(Ku(),wo(n,!0),bo(n,!0))}Gt&&console.timeEnd("layoutfluid")}function $z(t,e){if(Gt&&console.time("fail conditions"),av(),nv(),sv(),l.minWpm==="custom"&&t.wpm<l.minWpmCustomSpeed&&I.currentIndex>3){on!==null&&clearTimeout(on),jc(),uo=0,Xp("fail","min speed");return}if(l.minAcc==="custom"&&e<l.minAccCustom){on!==null&&clearTimeout(on),jc(),uo=0,Xp("fail","min accuracy");return}Gt&&console.timeEnd("fail conditions")}function Az(){if(Gt&&console.time("times up check"),(l.mode==="time"||l.mode==="custom"&&Jt()==="time")&&(Gp()>=l.time&&l.time!==0&&l.mode==="time"||Gp()>=Bt()&&Bt()!==0&&l.mode==="custom")){on!==null&&clearTimeout(on),pf(),A.pushHistory(),da.pushHistory(),jc(),uo=0,Xp("finish");return}Gt&&console.timeEnd("times up check")}let Hw=[];function Mz(){return Hw}async function Lz(){Gt&&console.time("timer step -----------------------------"),i3(),kz(),_z();const t=xz(),e=Sz();Cz(t),Tz(),$z(t,e),Az(),Gt&&console.timeEnd("timer step -----------------------------")}async function Ez(){jc(),uo=0,Hw=[],Yf=zo+Qf,function t(){const e=Yf-performance.now();Hw.push({dateNow:Date.now(),now:performance.now(),expected:Yf,nextDelay:e}),(l.mode==="time"&&l.time<130&&l.time>0||l.mode==="words"&&l.words<250&&l.words>0)&&(e<Qf/2&&XB(),e<Qf/10&&(uo++,uo>5&&(g('This could be caused by "efficiency mode" on Microsoft Edge.'),g("Stopping the test due to bad performance. This would cause test calculations to be incorrect. If this happens a lot, please report this.",-1),Xp("fail","slow timer")))),on=setTimeout(function(){if(!ea){on!==null&&clearTimeout(on),jc(),uo=0;return}Lz(),Yf+=Qf,t()},e)}()}let em=0,d_=!1,LL;function Iz(t){if(d_&&new Date().getDate()>LL){em=t;return}em+=t}function Oz(){return ts(Math.round(em),!0,!0)+(d_?" today":" session")}function Pz(){const t=new Date;t.setSeconds(0),t.setMinutes(0),t.setHours(0),t.setMilliseconds(0),LL=t.getDate();const e=t.getTime();em=0;const a=T();if(!a)return;const s=a.results;s==null||s.forEach(n=>{const i=new Date(n.timestamp);i.setSeconds(0),i.setMinutes(0),i.setHours(0),i.setMilliseconds(0),i.getTime()>=e&&(em+=n.testDuration+n.incompleteTestSeconds-n.afkDuration)}),d_=!0}let Uw=!1;function EL(){Va&&!Uw&&!ds&&(g("Challenge cleared",0),RT(null))}function Zz(t){var e,a,s;try{if(Va){const n=t.afkDuration/t.testDuration*100;if(n>10)return g("Challenge failed: AFK time is greater than 10%",0),null;if(Va.requirements===void 0)return g(`${Va.display} challenge passed!`,1),Va.name;{let i=!0;const r=[];for(const d in Va.requirements){if(!i)return null;const u=Va.requirements[d];if(u===void 0)throw new Error("Requirement value is undefined");if(d==="wpm"){const c=Object.keys(u)[0];c==="exact"?Math.round(t.wpm)!==u.exact&&(i=!1,r.push(`WPM not ${u.exact}`)):c==="min"&&t.wpm<Number(u.min)&&(i=!1,r.push(`WPM below ${u.min}`))}else if(d==="acc"){const c=Object.keys(u)[0];c==="exact"?t.acc!==u.exact&&(i=!1,r.push(`Accuracy not ${u.exact}`)):c==="min"&&t.acc<Number(u.min)&&(i=!1,r.push(`Accuracy below ${u.min}`))}else if(d==="afk")Object.keys(u)[0]==="max"&&Math.round(n)>Number(u.max)&&(i=!1,r.push(`AFK percentage above ${u.max}`));else if(d==="time")Object.keys(u)[0]==="min"&&Math.round(t.testDuration)<Number(u.min)&&(i=!1,r.push(`Test time below ${u.min}`));else if(d==="funbox"){const c=(e=u.exact)==null?void 0:e.toString().split("#").sort().join("#");if(c===void 0)throw new Error("Funbox mode is undefined");if(c!==t.funbox){i=!1;for(const f of c.split("#"))((a=t.funbox)==null?void 0:a.split("#").find(h=>h===f))===void 0&&r.push(`${f} funbox not active`);const m=(s=t.funbox)==null?void 0:s.split("#");if(m!==void 0&&m.length>0)for(const f of m)c.split("#").find(h=>h===f)===void 0&&r.push(`${f} funbox active`)}}else if(d==="raw")Object.keys(u)[0]==="exact"&&Math.round(t.rawWpm)!==u.exact&&(i=!1,r.push(`Raw WPM not ${u.exact}`));else if(d==="con")Object.keys(u)[0]==="exact"&&Math.round(t.consistency)!==u.exact&&(i=!1,r.push(`Consistency not ${u.exact}`));else if(d==="config")for(const c in u){const m=u[c];l[c]!==m&&(i=!1,r.push(`${c} not set to ${m}`))}}return i?(Va.autoRole&&g("You will receive a role shortly. Please don't post a screenshot in challenge submissions.",1,{duration:5}),g(`${Va.display} challenge passed!`,1),Va.name):(g(`${Va.display} challenge failed: ${r.join(", ")}`,0),null)}}else return null}catch(n){return console.error(n),g(`Something went wrong when verifying challenge: ${n.message}`,0),null}}async function Rz(t){Uw=!0,yi("none");let e;try{e=await CB()}catch(n){const i=qe(n,"Failed to setup challenge");return g(i,-1),$t(),setTimeout(()=>{o("header .config").removeClass("hidden"),o(".page.pageTest").removeClass("hidden")},250),!1}const a=e.filter(n=>n.name.toLowerCase()===t.toLowerCase())[0];let s;try{if(a===void 0)return g("Challenge not found",0),$t(),setTimeout(()=>{o("header .config").removeClass("hidden"),o(".page.pageTest").removeClass("hidden")},250),!1;if(a.type==="customTime")Dn(a.parameters[0],!0),ha("time",!0),Pn("normal",!0),a.name==="englishMaster"&&(ul("english_10k",!0),Fs(!0,!0),xn(!0,!0));else if(a.type==="customWords")Zr(a.parameters[0],!0),ha("words",!0),Pn("normal",!0);else if(a.type==="customText")Pi(a.parameters[0].split(" ")),qp(a.parameters[1]),ko(a.parameters[2]),br(a.parameters[3]),pl(a.parameters[4]),ha("custom",!0),Pn("normal",!0);else if(a.type==="script"){ht();const n=await fetch("/challenges/"+a.parameters[0]);if(We(),n.status!==200)throw new Error(`${n.status} ${n.statusText}`);let r=(await n.text()).trim();r=r.replace(/[\n\r\t ]/gm," "),r=r.replace(/ +/gm," "),Pi(r.split(" ")),qp("repeat"),br("word"),pl(!1),ha("custom",!0),Pn("normal",!0),a.parameters[1]!==null&&VA(a.parameters[1]),a.parameters[2]!==null&&r_(a.parameters[2])}else a.type==="accuracy"?(Dn(0,!0),ha("time",!0),Pn("master",!0)):a.type==="funbox"?(yi(a.parameters[0],!0),Pn("normal",!0),a.parameters[1]==="words"?Zr(a.parameters[2],!0):a.parameters[1]==="time"&&Dn(a.parameters[2],!0),ha(a.parameters[1],!0),a.parameters[3]!==void 0&&Pn(a.parameters[3],!0)):a.type==="special"&&a.name==="semimak"&&(ha("time",!0),Dn(120,!0),ul("english_10k",!0),xn(!0,!0),wk("word",!0),wo("semimak",!0),bo("overrideSync",!0),mn("static",!0));return $t(),s=a.message,o("header .config").removeClass("hidden"),o(".page.pageTest").removeClass("hidden"),s===void 0?g(`Challenge '${a.display}' loaded.`,0):g("Challenge loaded. "+s,0),RT(a),Uw=!1,!0}catch(n){return g(qe(n,"Failed to load challenge"),-1),!1}}Dt(t=>{["difficulty","numbers","punctuation","mode","funbox","paceCaret","showAllLines","showLiveWpm","highlightMode","time","words","keymapMode","keymapLayout","layout"].includes(t)&&EL()});let tn=0,gt=null,Pt=null;function Nz(){gt=null}function Dz(){o("#quoteRateModal .quote .text").text("-"),o("#quoteRateModal .quote .source .val").text("-"),o("#quoteRateModal .quote .id .val").text("-"),o("#quoteRateModal .quote .length .val").text("-"),o("#quoteRateModal .ratingCount .val").text("-"),o("#quoteRateModal .ratingAverage .val").text("-")}function IL(t){return!t.totalRating||!t.ratings?0:Math.round(t.totalRating/t.ratings*10)/10}async function OL(t){if(!t)return;Pt=t;const e=await F.quotes.getRating({query:{quoteId:Pt.id,language:Pt.language}});if(We(),e.status!==200){g("Failed to get quote ratings: "+e.body.message,-1);return}return e.body.data===null?{}:(gt=e.body.data,gt!==void 0&&!gt.average&&(gt.average=IL(gt)),gt)}function Lh(t){const e=t||tn;o("#quoteRateModal .star").removeClass("active");for(let a=1;a<=e;a++)o(`#quoteRateModal .star[data-rating=${a}]`).addClass("active")}async function jz(){var t;gt||await OL(),o("#quoteRateModal .ratingCount .val").text((gt==null?void 0:gt.ratings)??"0"),o("#quoteRateModal .ratingAverage .val").text(((t=gt==null?void 0:gt.average)==null?void 0:t.toFixed(1))??"-")}function Bz(){if(!Pt)return;let t;Pt.group===0?t="short":Pt.group===1?t="medium":Pt.group===2?t="long":Pt.group===3&&(t="thicc"),o("#quoteRateModal .quote .text").text(Pt.text),o("#quoteRateModal .quote .source .val").text(Pt.source),o("#quoteRateModal .quote .id .val").text(Pt.id),o("#quoteRateModal .quote .length .val").text(t),jz()}function qz(t,e){PL.show({...e,beforeAnimation:async()=>{var n,i;Dz(),Pt=t,tn=0;const a=T(),s=(i=(n=a==null?void 0:a.quoteRatings)==null?void 0:n[Pt.language])==null?void 0:i[Pt.id];s&&(tn=s),Lh(),Bz()}})}function Wz(t=!1){PL.hide({clearModalChain:t})}async function Fz(){var n,i;if(tn===0){g("Please select a rating");return}if(!Pt)return;Wz(!0);const t=await F.quotes.addRating({body:{quoteId:Pt.id,language:Pt.language,rating:tn}});if(We(),t.status!==200){g("Failed to submit quote rating: "+t.body.message,-1);return}const e=T();if(!e)return;const a=e.quoteRatings??{},s=(a==null?void 0:a[Pt.language])??{};if(s!=null&&s[Pt.id]){const r=(n=a[Pt.language])==null?void 0:n[Pt.id],d=tn-r;s[Pt.id]=tn,gt={ratings:gt==null?void 0:gt.ratings,totalRating:isNaN(gt==null?void 0:gt.totalRating)?0:(gt==null?void 0:gt.totalRating)+d,quoteId:Pt.id,language:Pt.language},g("Rating updated",1)}else s[Pt.id]=tn,gt!=null&&gt.ratings&&gt.totalRating?(gt.ratings++,gt.totalRating+=tn):gt={ratings:1,totalRating:tn,quoteId:Pt.id,language:Pt.language},g("Rating submitted",1);e.quoteRatings=a,Aa(e),gt.average=IL(gt),o(".pageTest #result #rateQuoteButton .rating").text((i=gt.average)==null?void 0:i.toFixed(1)),o(".pageTest #result #rateQuoteButton .icon").removeClass("far"),o(".pageTest #result #rateQuoteButton .icon").addClass("fas")}async function zz(t){var a;(a=t.querySelector(".submitButton"))==null||a.addEventListener("click",()=>{Fz()});const e=t.querySelectorAll(".stars button.star");for(const s of e)s.addEventListener("click",n=>{tn=parseInt(n.currentTarget.getAttribute("data-rating")),Lh()}),s.addEventListener("mouseenter",n=>{const i=parseInt(n.currentTarget.getAttribute("data-rating"));Lh(i)}),s.addEventListener("mouseleave",()=>{Lh()})}const PL=new Ct({dialogId:"quoteRateModal",setup:zz}),Hz=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"}],Uz=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"}],Kz=[{type:"leaderboard_atf",selectorId:"ad-result-wrapper"},{type:"med_rect_btf",selectorId:"ad-result-small-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-right-wrapper"},{type:"sky_btf",selectorId:"ad-vertical-left-wrapper"},{type:"leaderboard_btf",selectorId:"ad-footer-wrapper"},{type:"med_rect_btf",selectorId:"ad-footer-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-about-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-about-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-2-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-settings-3-wrapper"},{type:"med_rect_btf",selectorId:"ad-settings-3-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-1-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-1-small-wrapper"},{type:"leaderboard_btf",selectorId:"ad-account-2-wrapper"},{type:"med_rect_btf",selectorId:"ad-account-2-small-wrapper"}];let vv=!1;function Vz(){const t="1024888",e="74058";window.ramp={que:[],passiveMode:!0,forcePath:"320x50-test",onReady:()=>{vv=!0,bv()}};const a=document.getElementsByTagName("head")[0],s=document.createElement("script");s.setAttribute("async",!0),s.src=`//cdn.intergient.com/${t}/${e}/ramp.js`,a.appendChild(s),window._pwGA4PageviewId="".concat(Date.now()),window.dataLayer=window.dataLayer||[],window.gtag=window.gtag||function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config","G-KETCPNHRJF",{send_page_view:!1}),gtag("event","ramp_js",{send_to:"G-KETCPNHRJF",pageview_id:window._pwGA4PageviewId})}function ZL(){let t;l.ads==="result"?t=Hz:l.ads==="on"?t=Uz:l.ads==="sellout"&&(t=Kz);const e=[];for(const a of t){const s=document.querySelector(`#${a.selectorId}`);s&&window.getComputedStyle(s).display!=="none"&&s.offsetParent!==null&&e.push(a)}return e}async function bv(){if(vv){if(ft()==="test"&&!Yt){ramp.destroyUnits("all");return}await ramp.destroyUnits("all"),await ramp.addUnits(ZL()),await ramp.displayUnits()}}async function Gz(){}function Qz(){vv&&ramp.destroyUnits("all")}async function Yz(){if(!vv)return;const t=ZL();await ramp.addUnits(t),await ramp.displayUnits()}const Jz=900;let Jf=!0;const Xz=1330;let Xf=!0,wf=!1,wv,tm;function RL(){Vz(),setInterval(()=>{ea||Gz()},6e4),wf=!0}function eH(){Kw(),NL(),tH()}function Kw(){o("#ad-footer-wrapper").remove(),o("#ad-footer-small-wrapper").remove(),o("#ad-about-1-wrapper").remove(),o("#ad-about-1-small-wrapper").remove(),o("#ad-about-2-wrapper").remove(),o("#ad-about-2-small-wrapper").remove(),o("#ad-settings-1-wrapper").remove(),o("#ad-settings-1-small-wrapper").remove(),o("#ad-settings-2-wrapper").remove(),o("#ad-settings-2-small-wrapper").remove(),o("#ad-settings-3-wrapper").remove(),o("#ad-settings-3-small-wrapper").remove(),o("#ad-account-1-wrapper").remove(),o("#ad-account-1-small-wrapper").remove(),o("#ad-account-2-wrapper").remove(),o("#ad-account-2-small-wrapper").remove()}function NL(){o("#ad-vertical-right-wrapper").remove(),o("#ad-vertical-left-wrapper").remove()}function tH(){o("#ad-result-wrapper").remove(),o("#ad-result-small-wrapper").remove()}function aH(){}function DL(t=!1){const e=Jf;window.innerWidth>Jz?Jf=!0:Jf=!1,!t&&(l.ads==="off"||!wf||e!==Jf&&bv())}function jL(t=!1){const e=Xf;window.innerWidth>Xz?Xf=!0:Xf=!1,!t&&(l.ads==="off"||!wf||e!==Xf&&bv())}async function l_(){return new Promise(t=>{window.ramp===void 0&&(wv=!0),t()})}async function u_(){return new Promise(t=>{if(tm===void 0){tm=!1,t();return}t()})}async function sH(){return l.ads==="off"?!1:wf?(await l_(),await u_(),wv||tm?!1:bv()):(RL(),!0)}async function nH(){if(l.ads!=="off"){if(wf||RL(),await l_(),await u_(),wv){o("#ad-result-wrapper .iconAndText .text").html(`
    Using an ad blocker? No worries
    <div class="smalltext">
      We understand ads can be annoying
      <br />
      You can
      <i>disable all ads</i>
      in the settings
    </div>
    `);return}if(tm){o("#ad-result-wrapper .iconAndText .text").html(`
    Ads not working? Ooops
    <div class="smalltext">
      You may have a cookie popup blocker enabled - ads will not show without your consent
      <br />
      You can also 
      <i>disable all ads</i>
      in the settings if you wish
    </div>
    `);return}Yz()}}function oy(t){t?(o("#ad-vertical-left-wrapper").removeClass("testPage"),o("#ad-vertical-right-wrapper").removeClass("testPage"),o("#ad-footer-wrapper").removeClass("testPage"),o("#ad-footer-small-wrapper").removeClass("testPage")):(o("#ad-vertical-left-wrapper").addClass("testPage"),o("#ad-vertical-right-wrapper").addClass("testPage"),o("#ad-footer-wrapper").addClass("testPage"),o("#ad-footer-small-wrapper").addClass("testPage"))}function iH(){ramp.showCmpModal()}function rH(){Qz()}const oH=cs(500,aH),dH=cs(500,DL),lH=cs(500,jL);o(window).on("resize",()=>{oH(),dH(),lH()});Dt((t,e)=>{t==="ads"&&(e==="off"?eH():e==="result"?(Kw(),NL()):e==="on"&&Kw())});W2(()=>{});o(document).ready(()=>{DL(!0),jL()});window.onerror=function(t){};const eb={quotes:[],length:0,language:null,groups:[]};class uH{constructor(){this.quoteCollection=eb,this.quoteQueue=[],this.queueIndex=0}async getQuotes(e,a){var n;const s=Rn(e);if(this.quoteCollection.language!==s){let i;try{i=await fs(`quotes/${s}.json`)}catch(r){if(r instanceof Error&&((n=r==null?void 0:r.message)!=null&&n.includes("404")))return eb;throw r}if(i.quotes===void 0||i.quotes.length===0)return eb;this.quoteCollection={quotes:[],length:i.quotes.length,groups:[],language:i.language},i.quotes.forEach(r=>{const d={text:r.text,britishText:r.britishText,source:r.source,length:r.length,id:r.id,language:i.language,group:0};this.quoteCollection.quotes.push(d)}),i.groups.forEach((r,d)=>{const u=r[0],c=r[1];this.quoteCollection.groups[d]=this.quoteCollection.quotes.filter(m=>m.length>=u&&m.length<=c?(m.group=d,!0):!1)}),a!==void 0&&this.updateQuoteQueue(a)}return this.quoteCollection}getQuoteById(e){return this.quoteCollection.quotes.find(s=>s.id===e)}updateQuoteQueue(e){this.quoteQueue=[],e.forEach(a=>{var s;a<0||(s=this.quoteCollection.groups[a])==null||s.forEach(n=>{this.quoteQueue.push(n)})}),ec(this.quoteQueue),this.queueIndex=0}getRandomQuote(){if(this.quoteQueue.length===0)return null;this.queueIndex>=this.quoteQueue.length&&(this.queueIndex=0,ec(this.quoteQueue));const e=this.quoteQueue[this.queueIndex];return this.queueIndex+=1,e}getRandomFavoriteQuote(e){const a=T();if(!a)return null;const s=Rn(e),n=[],{favoriteQuotes:i}=a;if(i===void 0||(Object.keys(i).forEach(u=>{Rn(u)===s&&n.push(...i[u]??[])}),n.length===0))return null;const r=zn(n);return this.getQuoteById(parseInt(r,10))??null}isQuoteFavorite({language:e,id:a}){const s=T();if(!s)return!1;const{favoriteQuotes:n}=s;if(n===void 0)return!1;const i=Rn(e);return Object.keys(n).find(d=>i!==Rn(d)?!1:(n[d]??[]).includes(a.toString()))!==void 0}async setQuoteFavorite(e,a){var n,i,r,d,u;const s=T();if(!s)throw new Error("Snapshot is not available");if(a){const c=await F.users.addQuoteToFavorites({body:{language:e.language,quoteId:`${e.id}`}});if(c.status===200)s.favoriteQuotes===void 0&&(s.favoriteQuotes={}),s.favoriteQuotes[e.language]||(s.favoriteQuotes[e.language]=[]),(u=s.favoriteQuotes[e.language])==null||u.push(`${e.id}`);else throw new Error(c.body.message)}else{const c=await F.users.removeQuoteFromFavorites({body:{language:e.language,quoteId:`${e.id}`}});if(c.status===200){const m=(i=(n=s.favoriteQuotes)==null?void 0:n[e.language])==null?void 0:i.indexOf(`${e.id}`);(d=(r=s.favoriteQuotes)==null?void 0:r[e.language])==null||d.splice(m,1)}else throw new Error(c.body.message)}}}const _s=new uH;Dt((t,e)=>{t==="quoteLength"&&_s.updateQuoteQueue(e)});let BL=!1;function sC(){return BL}function cH(){BL=!0,console.log("Glarses Mode On - test result will be hidden. You can check the stats in the console (here)"),console.log("To disable Glarses Mode refresh the page.")}function pH(){Vw=!1,o("#result .stats .wpm .crown").css("opacity",0).addClass("hidden")}let Vw=!1,qL="normal";function mH(){return qL}function WL(){if(Vw)return;Vw=!0,o("#result .stats .wpm .crown").removeClass("hidden").css("opacity","0").animate({opacity:1},qt(250),"easeOutCubic")}function FL(t){qL=t;const e=o("#result .stats .wpm .crown");e.removeClass("ineligible"),e.removeClass("pending"),e.removeClass("error"),e.removeClass("warning"),e.addClass(t)}function fH(){o("#testConfig").removeClass("invisible"),o("#mobileTestConfigButton").removeClass("invisible")}function hH(){o("#testConfig").addClass("invisible"),o("#mobileTestConfigButton").addClass("invisible")}async function gH(){o("#testConfig .mode .textButton").removeClass("active"),o("#testConfig .mode .textButton[mode='"+l.mode+"']").addClass("active"),o("#testConfig .puncAndNum").addClass("hidden"),o("#testConfig .spacer").addClass("scrolled"),o("#testConfig .time").addClass("hidden"),o("#testConfig .wordCount").addClass("hidden"),o("#testConfig .customText").addClass("hidden"),o("#testConfig .quoteLength").addClass("hidden"),o("#testConfig .zen").addClass("hidden"),l.mode==="time"?(o("#testConfig .puncAndNum").removeClass("hidden"),o("#testConfig .leftSpacer").removeClass("scrolled"),o("#testConfig .rightSpacer").removeClass("scrolled"),o("#testConfig .time").removeClass("hidden"),no("time",l.time)):l.mode==="words"?(o("#testConfig .puncAndNum").removeClass("hidden"),o("#testConfig .leftSpacer").removeClass("scrolled"),o("#testConfig .rightSpacer").removeClass("scrolled"),o("#testConfig .wordCount").removeClass("hidden"),no("words",l.words)):l.mode==="quote"?(o("#testConfig .rightSpacer").removeClass("scrolled"),o("#testConfig .quoteLength").removeClass("hidden"),no("quoteLength",l.quoteLength)):l.mode==="custom"&&(o("#testConfig .puncAndNum").removeClass("hidden"),o("#testConfig .leftSpacer").removeClass("scrolled"),o("#testConfig .rightSpacer").removeClass("scrolled"),o("#testConfig .customText").removeClass("hidden")),no("numbers",l.numbers),no("punctuation",l.punctuation)}async function yH(t,e){var y,b,w;if(t===e)return;o("#testConfig .mode .textButton").removeClass("active"),o("#testConfig .mode .textButton[mode='"+e+"']").addClass("active");const a={time:"time",words:"wordCount",custom:"customText",quote:"quoteLength",zen:"zen"},s=qt(250),n={both:"easeInOutSine",in:"easeInSine",out:"easeOutSine"},i={time:!0,words:!0,custom:!0,quote:!1,zen:!1},r=o("#testConfig .puncAndNum");if(i[e]!==i[t]){i[e]?o("#testConfig .leftSpacer").removeClass("scrolled"):o("#testConfig .leftSpacer").addClass("scrolled"),r.css({width:"unset",opacity:1}).removeClass("hidden");const $=Math.round(((y=r[0])==null?void 0:y.getBoundingClientRect().width)??0);r.css({width:i[t]?$:0,opacity:i[t]?1:0}).animate({width:i[e]?$:0,opacity:i[e]?1:0},s,n.both,()=>{i[e]?r.css("width","unset"):r.addClass("hidden")})}e==="zen"?o("#testConfig .rightSpacer").addClass("scrolled"):o("#testConfig .rightSpacer").removeClass("scrolled");const d=o(`#testConfig .${a[e]}`),u=o(`#testConfig .${a[t]}`),c=Math.round(((b=u[0])==null?void 0:b.getBoundingClientRect().width)??0);u.addClass("hidden"),d.removeClass("hidden");const m=Math.round(((w=d[0])==null?void 0:w.getBoundingClientRect().width)??0);u.removeClass("hidden"),d.addClass("hidden");const h=(m-c)/2;u.css({opacity:1,width:c}).animate({width:c+h,opacity:0},s/2,n.in,()=>{u.css({opacity:1,width:"unset"}).addClass("hidden"),d.css({opacity:0,width:c+h}).removeClass("hidden").animate({opacity:1,width:m},s/2,n.out,()=>{d.css("width","unset")})})}function no(t,e){if(t==="time"){o("#testConfig .time .textButton").removeClass("active");const a=[15,30,60,120].includes(e)?e:"custom";o("#testConfig .time .textButton[timeConfig='"+a+"']").addClass("active")}else if(t==="words"){o("#testConfig .wordCount .textButton").removeClass("active");const a=[10,25,50,100,200].includes(e)?e:"custom";o("#testConfig .wordCount .textButton[wordCount='"+a+"']").addClass("active")}else t==="quoteLength"?(o("#testConfig .quoteLength .textButton").removeClass("active"),e.forEach(a=>{o("#testConfig .quoteLength .textButton[quoteLength='"+a+"']").addClass("active")})):t==="numbers"?e===!1?o("#testConfig .numbersMode.textButton").removeClass("active"):o("#testConfig .numbersMode.textButton").addClass("active"):t==="punctuation"&&(e===!1?o("#testConfig .punctuationMode.textButton").removeClass("active"):o("#testConfig .punctuationMode.textButton").addClass("active"))}function vH(){o("#testConfig .quoteLength .favorite").removeClass("hidden")}function bH(){o("#testConfig .quoteLength .favorite").addClass("hidden")}Dt((t,e,a,s)=>{if(ft()==="test")if(t==="mode"){yH(s,e);let n;l.mode==="time"?n=l.time:l.mode==="words"?n=l.words:l.mode==="quote"&&(n=l.quoteLength),n!==void 0&&no(l.mode,n)}else["time","quoteLength","words","numbers","punctuation"].includes(t)&&e!==void 0&&no(t,e)});let W,dr,Eh=!1,pi="",_d="";function wH(){Eh=!Eh,g(Eh?"on":"off",1)}let Uo=[];async function zL(){var r;const t=Ta(l.typingSpeedUnit),e=[];for(let d=1;d<=xi.length;d++)Ho&&d===xi.length?e.push(Oe(W.testDuration).toString()):e.push(d.toString());Ft.getScale("wpm").title.text=t.fullUnitString;const a=[...xi.map(d=>Oe(t.fromWpm(d)))];if(W.chartData==="toolong")return;const s=[...W.chartData.raw.map(d=>Oe(t.fromWpm(d)))];l.mode!=="time"&&Ho&&W.testDuration%1<.5&&(e.pop(),a.pop(),s.pop());let n=s;if(Eh||(n=cS(n,1),n=n.map(d=>Math.round(d))),Ft.data.labels=e,Ft.getDataset("wpm").data=a,Ft.getDataset("wpm").label=l.typingSpeedUnit,Ft.getDataset("raw").data=n,dr=Math.max(Math.max(...n),Math.max(...a)),l.startGraphsAtZero)Ft.getScale("wpm").min=0,Ft.getScale("raw").min=0;else{const d=Math.min(Math.min(...n),Math.min(...a));Ft.getScale("wpm").min=d,Ft.getScale("raw").min=d}Ft.getDataset("error").data=W.chartData.err;const i=await bs("sub");if(l.funbox!=="none"){let d="";for(const u of ze(l.funbox))d+=u.name,(r=u.functions)!=null&&r.getResultContent&&(d+="("+u.functions.getResultContent()+")"),d+=" ";d=d.trimEnd(),Uo.push({display:!0,id:"funbox-label",type:"line",scaleID:"wpm",value:Ft.getScale("wpm").min,borderColor:"transparent",borderWidth:1,borderDash:[2,2],label:{backgroundColor:"transparent",font:{family:l.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Ns.defaults.font.weight,lineHeight:Ns.defaults.font.lineHeight},color:i,padding:3,borderRadius:3,position:"start",display:!0,content:`${d}`}})}Ft.getScale("wpm").max=dr,Ft.getScale("raw").max=dr,Ft.getScale("error").max=Math.max(...W.chartData.err)}async function HL(){const t=await Vr(),e=await Nc(W.mode,W.mode2,W.punctuation??!1,W.numbers??!1,W.language,W.difficulty,W.lazyMode??!1,W.funbox??"none"),a=(e==null?void 0:e.wpm)??0;if(a===0)return;const s=Ta(l.typingSpeedUnit),n=Oe(s.fromWpm(a)).toFixed(2);Uo.push({display:!0,type:"line",id:"lpb",scaleID:"wpm",value:n,borderColor:t.sub,borderWidth:1,borderDash:[2,2],label:{backgroundColor:t.sub,font:{family:l.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Ns.defaults.font.weight,lineHeight:Ns.defaults.font.lineHeight},color:t.bg,padding:3,borderRadius:3,position:"center",content:`PB: ${n}`,display:!0}});const i=s.fromWpm(20);dr>=parseFloat(n)-i&&dr<=parseFloat(n)+i&&(dr=Math.round(parseFloat(n)+i)),Ft.getScale("wpm").max=dr,Ft.getScale("raw").max=dr}function UL(){let t=!1;if(W.wpm>=1e3&&(t=!0),o("#result .stats .wpm .top .text").text(l.typingSpeedUnit),t?o("#result .stats .wpm .bottom").text("Infinite"):o("#result .stats .wpm .bottom").text(ve.typingSpeed(W.wpm)),o("#result .stats .raw .bottom").text(ve.typingSpeed(W.rawWpm)),o("#result .stats .acc .bottom").text(W.acc===100?"100%":ve.accuracy(W.acc)),l.alwaysShowDecimalPlaces){l.typingSpeedUnit!="wpm"?(o("#result .stats .wpm .bottom").attr("aria-label",W.wpm.toFixed(2)+" wpm"),o("#result .stats .raw .bottom").attr("aria-label",W.rawWpm.toFixed(2)+" wpm")):(o("#result .stats .wpm .bottom").removeAttr("aria-label"),o("#result .stats .raw .bottom").removeAttr("aria-label"));let e=Oe(W.testDuration).toFixed(2)+"s";W.testDuration>61&&(e=ts(Oe(W.testDuration))),o("#result .stats .time .bottom .text").text(e),o("#result .stats .acc .bottom").attr("aria-label",`${Ps.correct} correct / ${Ps.incorrect} incorrect`)}else{const e={showDecimalPlaces:!0,suffix:` ${l.typingSpeedUnit}`};let a=ve.typingSpeed(W.wpm,e),s=ve.typingSpeed(W.rawWpm,e);l.typingSpeedUnit!="wpm"&&(a+=" ("+W.wpm.toFixed(2)+" wpm)",s+=" ("+W.rawWpm.toFixed(2)+" wpm)"),o("#result .stats .wpm .bottom").attr("aria-label",a),o("#result .stats .raw .bottom").attr("aria-label",s),o("#result .stats .acc .bottom").attr("aria-label",`${W.acc===100?"100":ve.percentage(W.acc,{showDecimalPlaces:!0})} (${Ps.correct} correct / ${Ps.incorrect} incorrect)`)}}function kH(){o("#result .stats .consistency .bottom").text(ve.percentage(W.consistency)),l.alwaysShowDecimalPlaces?o("#result .stats .consistency .bottom").attr("aria-label",ve.percentage(W.keyConsistency,{showDecimalPlaces:!0,suffix:" key"})):o("#result .stats .consistency .bottom").attr("aria-label",`${W.consistency}% (${W.keyConsistency}% key)`)}function _H(){const t=Oe(W.afkDuration/W.testDuration*100);if(o("#result .stats .time .bottom .afk").text(""),t>0&&o("#result .stats .time .bottom .afk").text(t+"% afk"),o("#result .stats .time .bottom").attr("aria-label",`${W.afkDuration}s afk ${t}%`),l.alwaysShowDecimalPlaces){let e=Oe(W.testDuration).toFixed(2)+"s";W.testDuration>61&&(e=ts(Oe(W.testDuration))),o("#result .stats .time .bottom .text").text(e)}else{let e=Math.round(W.testDuration)+"s";W.testDuration>61&&(e=ts(Math.round(W.testDuration))),o("#result .stats .time .bottom .text").text(e),o("#result .stats .time .bottom").attr("aria-label",`${Oe(W.testDuration)}s (${W.afkDuration}s afk ${t}%)`)}}function xH(){o("#result .stats .time .bottom .timeToday").text(Oz())}function CH(){o("#result .stats .key .bottom").text(W.charStats[0]+"/"+W.charStats[1]+"/"+W.charStats[2]+"/"+W.charStats[3])}function Ih(t){WL(),FL(t)}function Vu(t,e=!1){o("#result .stats .wpm .crown").attr("aria-label",t),o("#result .stats .wpm .crown").attr("data-balloon-length",e?"medium":"")}async function SH(t){if(l.mode==="quote"||t){Gw();return}let e=0;const a=await KL();if(a.value){const s=await Nc(l.mode,W.mode2,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode,l.funbox),n=(s==null?void 0:s.wpm)??0;e=W.wpm-n,e<=0?Gw():(Ih("pending"),Vu("+"+ve.typingSpeed(e,{showDecimalPlaces:!0})))}else{const s=await Nc(l.mode,W.mode2,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode,"none"),n=(s==null?void 0:s.wpm)??0;e=W.wpm-n,e<=0?(Ih("warning"),Vu(`This result is not eligible for a new PB (${a.reason})`,!0)):(Ih("ineligible"),Vu(`You could've gotten a new PB (+${ve.typingSpeed(e,{showDecimalPlaces:!0})}), but your config does not allow it (${a.reason})`,!0))}}function Gw(){pH(),Vu("")}function TH(){mH()==="pending"&&(WL(),FL("error"),Vu("Local PB data is out of sync with the server - please refresh (pb mismatch)",!0))}async function KL(){var i;const t=((i=W.funbox)==null?void 0:i.split("#"))??[],a=(await Promise.all(t.map(async r=>_B(r)))).every(r=>r==null?void 0:r.canGetPb),s=W.funbox==="none"||t.length===0||a,n=l.stopOnError!=="letter";return s&&n?{value:!0}:s?n?{value:!1,reason:"unknown"}:{value:!1,reason:"stop on letter"}:{value:!1,reason:"funbox"}}function $H(){if(ia())return;const t=getComputedStyle(document.body),e=[t.getPropertyValue("--main-color"),t.getPropertyValue("--text-color"),t.getPropertyValue("--sub-color")],a=Date.now()+125;(function s(){J_({particleCount:5,angle:60,spread:75,origin:{x:0},colors:e}),J_({particleCount:5,angle:120,spread:75,origin:{x:1},colors:e}),Date.now()<a&&requestAnimationFrame(s)})()}async function AH(t){var i,r,d,u;const e=[],a=((r=(i=T())==null?void 0:i.tags)==null?void 0:r.length)??0;try{(u=(d=T())==null?void 0:d.tags)==null||u.forEach(c=>{c.active===!0&&e.push(c)})}catch{}a===0?o("#result .stats .tags").addClass("hidden"):o("#result .stats .tags").removeClass("hidden"),e.length===0?o("#result .stats .tags .bottom").html("<div class='noTags'>no tags</div>"):o("#result .stats .tags .bottom").text(""),o("#result .stats .tags .editTagsButton").attr("data-result-id",""),o("#result .stats .tags .editTagsButton").attr("data-active-tag-ids",e.map(c=>c._id).join(",")),o("#result .stats .tags .editTagsButton").addClass("invisible");let s="start",n=15;e.forEach(async c=>{const m=await WT(c._id,l.mode,W.mode2,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode);o("#result .stats .tags .bottom").append(`
      <div tagid="${c._id}" aria-label="PB: ${m}" data-balloon-pos="up">${c.display}<i class="fas fa-crown hidden"></i></div>
    `);const f=Ta(l.typingSpeedUnit);if(l.mode!=="quote"&&!t&&(await KL()).value)if(m<W.wpm)await jB(c._id,l.mode,W.mode2,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode,W.wpm,W.acc,W.rawWpm,W.consistency),o(`#result .stats .tags .bottom div[tagid="${c._id}"] .fas`).removeClass("hidden"),o(`#result .stats .tags .bottom div[tagid="${c._id}"]`).attr("aria-label","+"+Oe(W.wpm-m));else{const h=await Vr();Uo.push({display:!0,type:"line",id:"tpb",scaleID:"wpm",value:f.fromWpm(m),borderColor:h.sub,borderWidth:1,borderDash:[2,2],label:{backgroundColor:h.sub,font:{family:l.fontFamily.replace(/_/g," "),size:11,style:"normal",weight:Ns.defaults.font.weight,lineHeight:Ns.defaults.font.lineHeight},color:h.bg,padding:3,borderRadius:3,position:s,xAdjust:n,display:!0,content:`${c.display} PB: ${Oe(f.fromWpm(m)).toFixed(2)}`}}),s==="start"?(s="end",n=-15):(s="start",n=15)}})}function MH(t){let e="";e+=l.mode,l.mode==="time"?e+=" "+l.time:l.mode==="words"?e+=" "+l.words:l.mode==="quote"&&(t==null?void 0:t.group)!==void 0&&(e+=" "+["short","medium","long","thicc"][t.group]);const a=ze(l.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.includes("ignoresLanguage")})!==void 0;l.mode!=="custom"&&!a&&(e+="<br>"+Ar(W.language)),l.punctuation&&(e+="<br>punctuation"),l.numbers&&(e+="<br>numbers"),l.blindMode&&(e+="<br>blind"),l.lazyMode&&(e+="<br>lazy"),l.funbox!=="none"&&(e+="<br>"+l.funbox.replace(/_/g," ").replace(/#/g,", ")),l.difficulty==="expert"?e+="<br>expert":l.difficulty==="master"&&(e+="<br>master"),l.stopOnError!=="off"&&(e+=`<br>stop on ${l.stopOnError}`),o("#result .stats .testType .bottom").html(e)}function LH(t,e,a,s,n){let i="";if(t&&(i+=`<br>failed (${e})`),a&&(i+="<br>afk detected"),Uk){i+="<br>invalid";const r=[];(W.wpm<0||W.wpm>350&&W.mode!=="words"&&W.mode2!=="10"||W.wpm>420&&W.mode==="words"&&W.mode2==="10")&&r.push("wpm"),(W.rawWpm<0||W.rawWpm>350&&W.mode!=="words"&&W.mode2!=="10"||W.rawWpm>420&&W.mode==="words"&&W.mode2==="10")&&r.push("raw"),(W.acc<75||W.acc>100)&&r.push("accuracy"),r.length>0&&(i+=` (${r.join(",")})`)}s&&(i+="<br>repeated"),W.bailedOut&&(i+="<br>bailed out"),n&&(i+="<br>too short"),i===""?o("#result .stats .info").addClass("hidden"):(o("#result .stats .info").removeClass("hidden"),i=i.substring(4),o("#result .stats .info .bottom").html(i))}function EH(t){var e,a,s;if(l.mode==="quote"){if(t===null){console.error("Failed to update quote rating button: randomQuote is null");return}((s=(a=(e=T())==null?void 0:e.quoteRatings)==null?void 0:a[t.language])==null?void 0:s[t.id])&&o(".pageTest #result #rateQuoteButton .icon").removeClass("far").addClass("fas"),OL(t).then(i=>{var r;o(".pageTest #result #rateQuoteButton .rating").text(((r=i==null?void 0:i.average)==null?void 0:r.toFixed(1))??"")}).catch(i=>{o(".pageTest #result #rateQuoteButton .rating").text("?")}),o(".pageTest #result #rateQuoteButton").css({opacity:0}).removeClass("hidden").css({opacity:1})}}function IH(t){const e=o(".pageTest #result #favoriteQuoteButton .icon");if(l.mode!=="quote"||!we()){e.parent().addClass("hidden");return}if(t===null){console.error("Failed to update quote favorite button: randomQuote is null");return}pi=l.mode==="quote"?t.language:"",_d=l.mode==="quote"?t.id.toString():"";const a=_s.isQuoteFavorite(t);e.removeClass(a?"far":"fas").addClass(a?"fas":"far"),e.parent().removeClass("hidden")}function OH(t){l.mode==="quote"?(o("#result .stats .source").removeClass("hidden"),o("#result .stats .source .bottom").html((t==null?void 0:t.source)??"Error: Source unknown")):o("#result .stats .source").addClass("hidden")}async function PH(t,e,a,s,n,i,r,d){Uo=[],W=yn(t),Gw(),o("#resultWordsHistory .words").empty(),o("#result #resultWordsHistory").addClass("hidden"),o("#retrySavingResultButton").addClass("hidden"),o(".pageTest #result #rateQuoteButton .icon").removeClass("fas").addClass("far"),o(".pageTest #result #rateQuoteButton .rating").text(""),o(".pageTest #result #rateQuoteButton").addClass("hidden"),o("#words").removeClass("blurred"),o("#wordsInput").trigger("blur"),o("#result .stats .time .bottom .afk").text(""),we()?o("#result .loginTip").addClass("hidden"):o("#result .loginTip").removeClass("hidden"),l.ads==="off"||l.ads==="result"?o("#result #watchVideoAdButton").addClass("hidden"):o("#result #watchVideoAdButton").removeClass("hidden"),UL(),kH(),_H(),CH(),MH(r),OH(r),IH(r),await SH(d),await zL(),await HL(),await AH(d),LH(e,a,s,n,i),Ft.options.plugins.annotation.annotations=Uo,Ft.updateColors(),Ft.resize(),o("#result .stats .tags").hasClass("hidden")&&o("#result .stats .info").hasClass("hidden")?o("#result .stats .infoAndTags").addClass("hidden"):o("#result .stats .infoAndTags").removeClass("hidden"),sC()?(o("main #result .noStressMessage").remove(),o("main #result").prepend(`

      <div class='noStressMessage' style="
        text-align: center;
        grid-column: 1/3;
        font-size: 2rem;
        padding-bottom: 2rem;
      ">
      <i class="fas fa-check"></i>
      </div>

    `),o("main #result .stats").addClass("hidden"),o("main #result .chart").addClass("hidden"),o("main #result #resultWordsHistory").addClass("hidden"),o("main #result #resultReplay").addClass("hidden"),o("main #result .loginTip").addClass("hidden"),o("main #result #showWordHistoryButton").addClass("hidden"),o("main #result #watchReplayButton").addClass("hidden"),o("main #result #saveScreenshotButton").addClass("hidden"),console.log(`Test Completed: ${W.wpm} wpm ${W.acc}% acc ${W.rawWpm} raw ${W.consistency}% consistency`)):(o("main #result .stats").removeClass("hidden"),o("main #result .chart").removeClass("hidden"),we()||o("main #result .loginTip").removeClass("hidden"),o("main #result #showWordHistoryButton").removeClass("hidden"),o("main #result #watchReplayButton").removeClass("hidden"),o("main #result #saveScreenshotButton").removeClass("hidden")),window.scrollY>0&&o([document.documentElement,document.body]).stop().animate({scrollTop:0},250),hH(),Xn(o("#typingTest"),o("#result"),250,async()=>{o("#result").trigger("focus"),nH(),zM(!1),o("#words").empty(),Ft.resize(),window.scrollTo({top:0})},async()=>{Qr(!1),o("#resultExtraButtons").removeClass("hidden").css("opacity",0).animate({opacity:1},qt(125));const u=zy(l.mode,l.words,l.time,ed(),Ni()??!1);l.alwaysShowWordsHistory&&u&&!sC()&&VM(!0),oy(!0),Md()})}function ZH(t,e){var s,n;const a=[];if(t.length>0)for(const i of t)(n=(s=T())==null?void 0:s.tags)==null||n.forEach(r=>{i===r._id&&a.push(r.display)});if(t.length===0)o(".pageTest #result .tags .bottom").html("<div class='noTags'>no tags</div>");else{o(".pageTest #result .tags .bottom div.noTags").remove();const i=o(".pageTest #result .tags .bottom div[tagid]"),r=[];i.each((u,c)=>{const m=o(c).attr("tagid");t.includes(m)?r.push(m):o(c).remove()});let d="";t.forEach((u,c)=>{r.includes(u)||(e.includes(u)?d+=`<div tagid="${u}" data-balloon-pos="up">${a[c]}<i class="fas fa-crown"></i></div>`:d+=`<div tagid="${u}">${a[c]}</div>`)}),o(".pageTest #result .tags .bottom").append(d),o(".pageTest #result .tags .top .editTagsButton").attr("active-tag-ids",t.join(","))}}o(".pageTest #favoriteQuoteButton").on("click",async()=>{var a,s,n,i,r;if(pi===""||_d===""){g("Could not get quote stats!",-1);return}const t=o(".pageTest #favoriteQuoteButton .icon"),e=T();if(e)if(t.hasClass("fas")){ht();const d=await F.users.removeQuoteFromFavorites({body:{language:pi,quoteId:_d}});if(We(),g(d.body.message,d.status===200?1:-1),d.status===200){t.removeClass("fas").addClass("far");const u=(s=(a=e.favoriteQuotes)==null?void 0:a[pi])==null?void 0:s.indexOf(_d);(i=(n=e.favoriteQuotes)==null?void 0:n[pi])==null||i.splice(u,1)}}else{ht();const d=await F.users.addQuoteToFavorites({body:{language:pi,quoteId:_d}});We(),g(d.body.message,d.status===200?1:-1),d.status===200&&(t.removeClass("far").addClass("fas"),e.favoriteQuotes===void 0&&(e.favoriteQuotes={}),e.favoriteQuotes[pi]||(e.favoriteQuotes[pi]=[]),(r=e.favoriteQuotes[pi])==null||r.push(_d))}});Dt(async t=>{["typingSpeedUnit","startGraphsAtZero"].includes(t)&&Yt&&(Uo=[],UL(),await zL(),await HL(),Zd(),Ft.options.plugins.annotation.annotations=Uo,Ft.updateColors(),Ft.resize())});const _e={particles:[],rendering:!1},RH=1e3,NH=.05,DH=4,jH=.6,eh=1500,ud=.3,nC=[6,3],th=10;function BH(){const t=document.createElement("canvas");return t.style.cssText="position:fixed;top:0;left:0;pointer-events:none;z-index:999999",t.height=window.innerHeight,t.width=window.innerWidth,window.addEventListener("resize",()=>{t.height=window.innerHeight,t.width=window.innerWidth}),document.body.appendChild(t),t}function qH(t,e,a){return{x:t,y:e,color:a,alpha:1,prev:{x:t,y:e},vel:{x:eh-Math.random()*eh*2,y:eh-Math.random()*eh*2}}}function WH(t){!_e.canvas||!_e.deltaTime||(t.prev.x=t.x,t.prev.y=t.y,t.x+=t.vel.x*_e.deltaTime,t.y+=t.vel.y*_e.deltaTime,t.x>_e.canvas.width?(t.vel.x*=-ud,t.x=_e.canvas.width-(t.x-_e.canvas.width)*ud):t.x<0&&(t.vel.x*=-ud,t.x*=-ud),t.y>_e.canvas.height?(t.vel.y*=-ud,t.y=_e.canvas.height-(t.y-_e.canvas.height)*ud):t.y<0&&(t.vel.y*=-1,t.y*=-1),t.vel.y+=RH*_e.deltaTime,t.vel.x*=1-NH*_e.deltaTime,t.alpha*=1-jH*_e.deltaTime)}function FH(){_e.caret=o("#caret"),_e.canvas=BH(),_e.context2d=_e.canvas.getContext("2d")}function VL(){if(!_e.lastFrame||!_e.context2d||!_e.canvas)return;_e.rendering=!0;const t=Date.now();_e.deltaTime=(t-_e.lastFrame)/1e3,_e.lastFrame=t,_e.context2d.clearRect(0,0,_e.canvas.width,_e.canvas.height);const e=[];for(const a of _e.particles)a.alpha<.1||(WH(a),_e.context2d.globalAlpha=a.alpha,_e.context2d.strokeStyle=a.color,_e.context2d.lineWidth=DH,_e.context2d.beginPath(),_e.context2d.moveTo(Math.round(a.prev.x),Math.round(a.prev.y)),_e.context2d.lineTo(Math.round(a.x),Math.round(a.y)),_e.context2d.stroke(),e.push(a));_e.particles=e,_e.particles.length&&!ia()?requestAnimationFrame(VL):(_e.context2d.clearRect(0,0,_e.canvas.width,_e.canvas.height),_e.rendering=!1)}function GL(t=!1){if(!_e.resetTimeOut)return;delete _e.resetTimeOut,clearTimeout(_e.resetTimeOut);const e=o(document.body);e.css("transition","all .25s, transform 0.8s"),e.css("transform","translate(0,0)"),setTimeout(()=>{e.css("transition","all .25s, transform .05s"),o("html").css("overflow","inherit"),o("html").css("overflow-y","scroll")},t?0:1e3)}function zH(){_e.rendering||(_e.lastFrame=Date.now(),VL())}function HH(){const t=Math.floor(Math.random()*256).toString(16),e=Math.floor(Math.random()*256).toString(16),a=Math.floor(Math.random()*256).toString(16);return`#${t}${e}${a}`}async function QL(t=!0,e=!1){var n,i;if(l.monkeyPowerLevel==="off"||ia())return;if(l.blindMode&&(t=!0),["3","4"].includes(l.monkeyPowerLevel)){o("html").css("overflow","hidden");const r=[Math.round(th-Math.random()*th),Math.round(th-Math.random()*th)];o(document.body).css("transform",`translate(${r[0]}px, ${r[1]}px)`),_e.resetTimeOut&&clearTimeout(_e.resetTimeOut),_e.resetTimeOut=setTimeout(GL,2e3)}const a=(n=_e.caret)==null?void 0:n.offset(),s=[(a==null?void 0:a.left)??0,((a==null?void 0:a.top)??0)+(((i=_e.caret)==null?void 0:i.height())??0)];for(let r=Math.round((nC[0]+Math.random()*nC[1])*(e?2:1));r>0;r--){const d=["2","4"].includes(l.monkeyPowerLevel)?HH():t?await bs("caret"):await bs("error");_e.particles.push(qH(...s,d))}zH()}let tb=[];async function UH(){return tb.length===0&&(tb=await fs("languages/britishenglish.json")),tb}async function YL(t,e){var s;const a=await UH();if(t.includes("-"))return(await Promise.all(t.split("-").map(async n=>YL(n,e)))).join("-");{const n=a.find(i=>t.match(RegExp(`^([\\W]*${i[0]}[\\W]*)$`,"gi")));return!n||l.mode==="quote"&&((s=n[2])!=null&&s.includes(e))?t:t.replace(RegExp(`^(?:([\\W]*)(${n[0]})([\\W]*))$`,"gi"),(i,r,d,u)=>r+(d.charAt(0)===d.charAt(0).toUpperCase()?d===d.toUpperCase()?n[1].toUpperCase():Xm(n[1]):n[1])+u)}}const KH=[["áàâäåãąą́āą̄ă","a"],["éèêëẽęę́ēę̄ėě","e"],["íìîïĩįį́īį̄ı","i"],["óòôöøõóōǫǫ́ǭő","o"],["úùûüŭũúūůű","u"],["ńň","n"],["çĉčć","c"],["řŕṛ","r"],["ďđḍ","d"],["ťțṭ","t"],["ṃ","m"],["æ","ae"],["œ","oe"],["ẅŵ","w"],["ĝğg̃","g"],["ĥ","h"],["ĵ","j"],["ńṇṅ","n"],["ŝśšșşṣ","s"],["ß","ss"],["żźž","z"],["ÿỹýÿŷ","y"],["łľĺ","l"],["أإآ","ا"],["َ",""],["ُ",""],["ِ",""],["ْ",""],["ً",""],["ٌ",""],["ٍ",""],["ّ",""],["ё","е"],["ά","α"],["έ","ε"],["ί","ι"],["ύ","υ"],["ό","ο"],["ή","η"],["ώ","ω"],["þ","th"]],VH=new Map(KH.flatMap(t=>[...t[0]].map(e=>[e,t[1]])));function GH(t,e){const a=t.toLowerCase(),s=e==null?void 0:e.find(n=>n[0].includes(a));return s!==void 0?s[1]:VH.get(a)}function QH(t,e){if(!t)return t;const a=t.toUpperCase(),s=[...t].map((i,r)=>i==a[r]),n=[];for(let i=0;i<t.length;i++){const r=t[i],d=s[i],u=GH(r,e);u!==void 0?d?(n.push(u.substring(0,1).toUpperCase()),n.push(u.substring(1))):n.push(u):n.push(d?r.toUpperCase():r)}return n.join("")}const JL=[["are",["aren't"]],["can",["can't"]],["could",["couldn't"]],["did",["didn't"]],["does",["doesn't"]],["do",["don't"]],["had",["hadn't"]],["has",["hasn't"]],["have",["haven't"]],["is",["isn't"]],["it",["it's","it'll"]],["i",["i'm","i'll","i've","i'd"]],["you",["you'll","you're","you've","you'd"]],["that",["that's","that'll","that'd"]],["must",["mustn't","must've"]],["there",["there's","there'll","there'd"]],["he",["he's","he'll","he'd"]],["she",["she's","she'll","she'd"]],["we",["we're","we'll","we'd"]],["they",["they're","they'll","they'd"]],["should",["shouldn't","should've"]],["was",["wasn't"]],["were",["weren't"]],["will",["won't"]],["would",["wouldn't","would've"]],["going",["goin'"]]];async function YH(t){return JL.find(e=>t.match(RegExp(`^([\\W]*${e[0]}[\\W]*)$`,"gi")))!==void 0}async function JH(t){const e=JL.find(s=>t.match(RegExp(`^([\\W]*${s[0]}[\\W]*)$`,"gi")));if(e===void 0)return t;const a=zn(e[1]);return t.replace(RegExp(`^(?:([\\W]*)(${e[0]})([\\W]*))$`,"gi"),(s,n,i,r)=>n+(i.charAt(0)===i.charAt(0).toUpperCase()?XH(i)?a.toUpperCase():Xm(a):a)+r)}function XH(t){return t==="I"?!1:t===t.toUpperCase()}function e9(t){return/[?!.؟]/.test(t)}let cd="";async function t9(t,e,a,s){var u;let n=e;const i=l.language.split("_")[0],r=e1(t),d=ze(l.funbox).find(c=>{var m;return(m=c.functions)==null?void 0:m.punctuateWord});if((u=d==null?void 0:d.functions)!=null&&u.punctuateWord)return d.functions.punctuateWord(n);if(i!=="code"&&i!=="georgian"&&(a===0||e9(r))){if(n=Xm(n),i==="turkish"&&(n=n.replace(/I/g,"İ")),i==="spanish"||i==="catalan"){const c=Math.random();c>.9?(n="¿"+n,cd="?"):c>.8&&(n="¡"+n,cd="!")}}else if(Math.random()<.1&&r!=="."&&r!==","&&a!==s-2||a===s-1)if(i==="spanish"||i==="catalan")(cd==="?"||cd==="!")&&(n+=cd,cd="");else{const c=Math.random();c<=.8?i==="kurdish"?n+=".":i==="nepali"||i==="bangla"||i==="hindi"?n+="।":i==="japanese"||i==="chinese"?n+="。":n+=".":c>.8&&c<.9?i==="french"?n="?":i==="arabic"||i==="persian"||i==="urdu"||i==="kurdish"?n+="؟":i==="greek"?n+=";":i==="japanese"||i==="chinese"?n+="？":n+="?":i==="french"?n="!":i==="japanese"||i==="chinese"?n+="！":n+="!"}else if(Math.random()<.01&&r!==","&&r!=="."&&i!=="russian")n=`"${n}"`;else if(Math.random()<.011&&r!==","&&r!=="."&&i!=="russian"&&i!=="ukrainian"&&i!=="slovak")n=`'${n}'`;else if(Math.random()<.012&&r!==","&&r!==".")if(i==="code"){const c=Math.random(),m=["()","{}","[]","<>"];l.language.startsWith("code_javascript")&&m.push("``");const f=Math.floor(c*m.length),h=m[f];n=`${h[0]}${n}${h[1]}`}else i==="japanese"||i==="chinese"?n=`（${n}）`:n=`(${n})`;else if(Math.random()<.013&&r!==","&&r!=="."&&r!==";"&&r!=="؛"&&r!==":"&&r!=="；"&&r!=="：")i==="french"?n=":":i==="greek"?n="·":i==="chinese"?n+="：":n+=":";else if(Math.random()<.014&&r!==","&&r!=="."&&t!=="-")n="-";else if(Math.random()<.015&&r!==","&&r!=="."&&r!==";"&&r!=="؛"&&r!=="；"&&r!=="：")i==="french"?n=";":i==="greek"?n="·":i==="arabic"||i==="kurdish"?n+="؛":i==="chinese"?n+="；":n+=";";else if(Math.random()<.2&&r!==",")i==="arabic"||i==="urdu"||i==="persian"||i==="kurdish"?n+="،":i==="japanese"?n+="、":i==="chinese"?n+="，":n+=",";else if(Math.random()<.25&&i==="code"){const c=["{","}","[","]","(",")",";","=","+","%","/"],m=["{","}","[","]","(",")",";","=","+","%","/","/*","*/","//","!=","==","<=",">=","||","&&","<<",">>","%=","&=","*=","++","+=","--","-=","/=","^=","|="];l.language.startsWith("code_c")&&!l.language.startsWith("code_css")||l.language.startsWith("code_arduino")?n=zn(m):l.language.startsWith("code_javascript")?n=zn([...c,"`"]):n=zn(c)}else Math.random()<.5&&i==="english"&&await YH(n)&&(n=await a9(n));return n.includes("	")&&(n=n.replace(/\t/g,""),n+="	"),n.includes(`
`)&&(n=n.replace(/\n/g,""),n+=`
`),n}async function a9(t){return JH(t)}function s9(){var e;const t=ze(l.funbox).find(a=>{var s;return(s=a.functions)==null?void 0:s.getWordsFrequencyMode});if((e=t==null?void 0:t.functions)!=null&&e.getWordsFrequencyMode)return t.functions.getWordsFrequencyMode()}async function n9(){var a;const t=[],e=ze(l.funbox).find(s=>{var n;return(n=s.functions)==null?void 0:n.pullSection});if((a=e==null?void 0:e.functions)!=null&&a.pullSection){const s=await e.functions.pullSection(l.language);if(s===!1||s===void 0)throw bk(e.name),new Error("Failed to pull section");for(const n of s.words){if(t.length>=l.words&&l.mode==="words")break;t.push(n)}}return t}function i9(t,e,a){var n;const s=ze(l.funbox).find(i=>{var r;return(r=i.functions)==null?void 0:r.getWord});return(n=s==null?void 0:s.functions)!=null&&n.getWord&&(t=s.functions.getWord(a,e)),t}function r9(t){var e;for(const a of ze(l.funbox))(e=a.functions)!=null&&e.alterText&&(t=a.functions.alterText(t));return t}async function o9(t,e){return!l.britishEnglish||!l.language.includes("english")||l.mode==="quote"&&(pt==null?void 0:pt.britishText)!==void 0&&(pt==null?void 0:pt.britishText)!==""?t:await YL(t,e)}function ab(t,e){const a=!e.noLazyMode||l.mode==="custom";return l.lazyMode&&a&&(t=QH(t,e.additionalAccents)),t}function d9(){var e,a;const t=((a=(e=ze(l.funbox).find(s=>{var n;return(n=s.properties)==null?void 0:n.find(i=>i.startsWith("wordOrder"))}))==null?void 0:e.properties)==null?void 0:a.find(s=>s.startsWith("wordOrder")))??"";return t?t.split(":")[1]:"normal"}function l9(){var s,n;if(l.mode==="zen")return 0;let t=100;const e=pt;if(l.mode==="quote"&&e===null)throw new _a("Random quote is null");const a=((n=(s=ze(l.funbox).find(i=>{var r;return(r=i.properties)==null?void 0:r.find(d=>d.startsWith("toPush"))}))==null?void 0:s.properties)==null?void 0:n.find(i=>i.startsWith("toPush:")))??"";return l.showAllLines&&(l.mode==="custom"&&(t=Bt()),l.mode==="words"&&(t=l.words),l.mode==="quote"&&(t=e.textSplit.length)),l.mode==="words"&&l.words===0&&(t=100),l.mode==="custom"&&(Bt()===0||Jt()==="time"?t=100:t=Bt()>100?100:Bt()),a&&(t=+a.split(":")[1]),l.mode==="words"&&l.words!==0&&l.words<t&&(t=l.words),l.mode==="quote"&&e.textSplit.length<t&&(t=e.textSplit.length),l.mode==="custom"&&Jt()==="word"&&Bt()<t&&Bt()!==0&&(t=Bt()),t}class _a extends Error{constructor(e){super(e),this.name="WordGenError"}}async function u9(t,e){if(nn){if(oa===null)throw new _a("Current wordset is null");return Aw(XL),e==="reverse"?oa.words.reverse():oa.words}const a=t.name.startsWith("swiss_german")?"german":t.name;if((await _s.getQuotes(a,l.quoteLength)).length===0)throw ha("words"),new _a(`No ${l.language.replace(/_\d*k$/g,"").replace(/_/g," ")} quotes found`);let n;if(l.quoteLength.includes(-2)&&l.quoteLength.length===1){const i=_s.getQuoteById(zb);if(i===void 0)throw bi(-1),new _a(`Quote ${zb} does not exist`);n=i}else if(l.quoteLength.includes(-3)){const i=_s.getRandomFavoriteQuote(l.language);if(i===null)throw bi(-1),new _a("No favorite quotes found");n=i}else{const i=_s.getRandomQuote();if(i===null)throw bi(-1),new _a("No quotes found for selected quote length");n=i}if(n.language=Rn(l.language),n.text=n.text.replace(/ +/gm," "),n.text=n.text.replace(/( *(\r\n|\r|\n) *)/g,`
 `),n.text=n.text.replace(/…/g,"..."),n.text=n.text.trim(),n.britishText!==void 0&&n.britishText!==""&&l.britishEnglish?n.textSplit=n.britishText.split(" "):n.textSplit=n.text.split(" "),Aw(n),pt===null)throw new _a("Random quote is null");if(pt.textSplit===void 0)throw new _a("Random quote textSplit is undefined");return pt.textSplit}let oa=null,ao=null,Oh=!1,XL=null;async function c9(t){var m,f;nn||(Qw=[]),XL=pt,Aw(null),co=[],jd=0,Gu=[],ao=t;const e={words:[],sectionIndexes:[],hasTab:!1,hasNewline:!1},a=ze(l.funbox).find(h=>{var y;return(y=h.functions)==null?void 0:y.pullSection});Oh=((m=a==null?void 0:a.functions)==null?void 0:m.pullSection)!==void 0;const s=d9();console.debug("Word order",s);let n=t.words;l.mode==="custom"?n=cf():l.mode==="quote"?n=await u9(t,s):l.mode==="zen"&&(n=[]);const i=l9();console.debug("Words limit",i),s==="reverse"&&(n=n.reverse());const r=ze(l.funbox).find(h=>{var y;return(y=h.functions)==null?void 0:y.withWords});if((f=r==null?void 0:r.functions)!=null&&f.withWords?oa=await r.functions.withWords(n):oa=await R3(n),console.debug("Wordset",oa),i===0)return e;let d=!1,u=0;for(;!d;){const h=await eE(u,i,Wd(e.words,-1)??"",Wd(e.words,-2)??"");e.words.push(h.word),e.sectionIndexes.push(h.sectionIndex),l.mode==="custom"&&Rl()?co.length===0&&jd>=Bt()&&(d=!0):e.words.length>=i&&(d=!0),u++}const c=pt;if(l.mode==="quote"&&c===null)throw new _a("Random quote is null");return e.hasTab=e.words.some(h=>h.includes("	"))||oa.words.some(h=>h.includes("	"))||l.mode==="quote"&&c.textSplit.some(h=>h.includes("	")),e.hasNewline=e.words.some(h=>h.includes(`
`))||oa.words.some(h=>h.includes(`
`))||l.mode==="quote"&&c.textSplit.some(h=>h.includes(`
`)),Gu=[],e}let jd=0,co=[],Gu=[],Qw=[];async function eE(t,e,a,s){if(console.debug("Getting next word",{isRepeated:nn,currentWordset:oa,wordIndex:t,language:ao,wordsBound:e,previousWord:a,previousWord2:s}),oa===null)throw new _a("Current wordset is null");if(ao===null)throw new _a("Current language is null");if(nn&&l.mode!=="quote"){const c=Qw[t];if(c===void 0){let m=!1;if((l.mode==="time"||l.mode==="custom"&&Jt()==="time"||l.mode==="custom"&&Jt()==="word"&&t<Bt()||l.mode==="words"&&t<l.words)&&(m=!0),m)console.debug("Repeated word is undefined but random generation is allowed - getting random word");else throw new _a("Repeated word is undefined")}else return console.debug("Repeated word: ",c),jd++,c}const n=s9()??"normal";let i=oa.randomWord(n);const r=a.replace(/[.?!":\-,]/g,"").toLowerCase(),d=s==null?void 0:s.replace(/[.?!":\-,']/g,"").toLowerCase();if(co.length===0){const c=await n9();if(l.mode==="quote")i=oa.nextWord();else if(l.mode==="custom"&&zu()==="repeat")i=oa.nextWord();else if(l.mode==="custom"&&zu()==="random"&&(oa.length<4||Rt.mode!==null))i=oa.randomWord(n);else if(l.mode==="custom"&&zu()==="shuffle")i=oa.shuffledWord();else if(l.mode==="custom"&&Jt()==="section"){i=oa.randomWord(n);const m=Wd(Gu,-1),f=Wd(Gu,-2);let h=0;for(;h<100&&(m===i||f===i);)h++,i=oa.randomWord(n)}else if(Oh)i=c.join(" ");else{let m=0,f=i.split(" ")[0].toLowerCase(),h=ab(f,ao);for(;m<100&&(r===h||d===h||l.mode!=="custom"&&!l.punctuation&&i==="I"||l.mode!=="custom"&&!l.punctuation&&!l.language.startsWith("code")&&/[-=_+[\]{};'\\:"|,./<>?]/i.test(i)||l.mode!=="custom"&&!l.numbers&&/[0-9]/i.test(i));)m++,i=oa.randomWord(n),f=i.split(" ")[0],h=ab(f,ao)}i=i.replace(/ +/g," "),i=i.replace(/(^ )|( $)/g,""),i=i9(i,t,oa),co=[...i.split(" ")],Gu.push(i),i=co.shift(),jd++}else i=co.shift();if(i===void 0)throw new _a("Random word is undefined");if(i==="")throw new _a("Random word is empty");if(/ /g.test(i))throw new _a("Random word contains spaces");l.mode!=="custom"&&l.mode!=="quote"&&/[A-Z]/.test(i)&&!l.punctuation&&!l.language.startsWith("german")&&!l.language.startsWith("swiss_german")&&!l.language.startsWith("code")&&!l.language.startsWith("klingon")&&!Oh&&(i=i.toLowerCase()),i=i.replace(/ +/gm," "),i=i.replace(/(^ )|( $)/gm,""),i=ab(i,ao),i=await o9(i,r),l.language.startsWith("swiss_german")&&(i=i.replace(/ß/g,"ss")),l.punctuation&&!ao.originalPunctuation&&!Oh&&(i=await t9(a,i,t,e)),l.numbers&&Math.random()<.1&&(i=rL(4),l.language.startsWith("kurdish")?i=lS(i):l.language.startsWith("nepali")?i=uS(i):l.language.startsWith("bangla")?i=qO(i):l.language.startsWith("hindi")&&(i=WO(i))),i=r9(i),console.debug("Word:",i);const u={word:i,sectionIndex:jd};return Qw.push(u),u}let tE=0,aE=0;async function p9(){const t=Fy(l,pt),[e,a]=(await qT(l.mode,t,l.punctuation,l.numbers,l.language,l.difficulty,l.lazyMode)).map(Oe);tE=l.alwaysShowDecimalPlaces?e:Math.round(e),aE=l.alwaysShowDecimalPlaces?a:Math.floor(a)}function m9(){return tE}function f9(){return aE}Dt(t=>{["difficulty","blindMode","stopOnError","paceCaret","minWpm","minAcc","minBurst","confidenceMode","layout","showAverage","typingSpeedUnit","quickRestart"].includes(t)&&jr()});async function jr(){var s,n;o(".pageTest #testModesNotice").empty(),nn&&l.mode!=="quote"&&o(".pageTest #testModesNotice").append('<div class="textButton noInteraction" style="color:var(--error-color);"><i class="fas fa-sync-alt"></i>repeated</div>'),Km||o(".pageTest #testModesNotice").append('<div class="textButton" commands="resultSaving" style="color:var(--error-color);"><i class="fas fa-save"></i>saving disabled</div>'),Np&&(l.quickRestart==="esc"&&(o(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-long-arrow-alt-right"></i>shift + tab to open commandline</div>'),o(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + esc to restart</div>')),l.quickRestart==="tab"&&o(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + tab to restart</div>')),(zg||l.funbox.includes("58008"))&&l.quickRestart==="enter"&&o(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-level-down-alt fa-rotate-90"></i>shift + enter to restart</div>');const t=Hk(),e=Ni();if(l.mode==="custom"&&t!==""&&e&&o(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-book"></i>${t} (shift + enter to save progress)</div>`),Va&&o(".pageTest #testModesNotice").append(`<div class="textButton noInteraction"><i class="fas fa-award"></i>${Va.display}</div>`),l.mode==="zen"&&o(".pageTest #testModesNotice").append('<div class="textButton noInteraction"><i class="fas fa-poll"></i>shift + enter to finish zen </div>'),l.mode!=="zen"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="languages"><i class="fas fa-globe-americas"></i>${Ar(l.language,l.mode==="quote")}</button>`),l.difficulty==="expert"?o(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star-half-alt"></i>expert</button>'):l.difficulty==="master"&&o(".pageTest #testModesNotice").append('<button class="textButton" commands="difficulty"><i class="fas fa-star"></i>master</button>'),l.blindMode&&o(".pageTest #testModesNotice").append('<button class="textButton" commands="blindMode"><i class="fas fa-eye-slash"></i>blind</button>'),l.lazyMode&&o(".pageTest #testModesNotice").append('<button class="textButton" commands="lazyMode"><i class="fas fa-couch"></i>lazy</button>'),l.paceCaret!=="off"||l.repeatedPace&&Ro){const i=ve.typingSpeed((ke==null?void 0:ke.wpm)??0,{showDecimalPlaces:!1,suffix:` ${l.typingSpeedUnit}`});o(".pageTest #testModesNotice").append(`<button class="textButton" commands="paceCaretMode"><i class="fas fa-tachometer-alt"></i>${l.paceCaret==="average"?"average":l.paceCaret==="pb"?"pb":l.paceCaret==="tagPb"?"tag pb":l.paceCaret==="last"?"last":l.paceCaret==="daily"?"daily":"custom"} pace ${i}</button>`)}if(l.showAverage!=="off"){const i=m9(),r=f9();if(we()&&i>0){const d=["speed","both"].includes(l.showAverage)?ve.typingSpeed(i,{suffix:` ${l.typingSpeedUnit}`,showDecimalPlaces:!1}):"",u=["acc","both"].includes(l.showAverage)?ve.accuracy(r,{suffix:" acc",showDecimalPlaces:!1}):"",c=`${d} ${u}`.trim();o(".pageTest #testModesNotice").append(`<button class="textButton" commands="showAverage"><i class="fas fa-chart-bar"></i>avg: ${c}</button>`)}}l.minWpm!=="off"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="minWpm"><i class="fas fa-bomb"></i>min ${ve.typingSpeed(l.minWpmCustomSpeed,{showDecimalPlaces:!1,suffix:` ${l.typingSpeedUnit}`})}</button>`),l.minAcc!=="off"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="minAcc"><i class="fas fa-bomb"></i>min ${l.minAccCustom}% acc</button>`),l.minBurst!=="off"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="minBurst"><i class="fas fa-bomb"></i>min ${ve.typingSpeed(l.minBurstCustomSpeed,{showDecimalPlaces:!1})} ${l.typingSpeedUnit} burst ${l.minBurst==="flex"?"(flex)":""}</button>`),l.funbox!=="none"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="funbox"><i class="fas fa-gamepad"></i>${l.funbox.replace(/_/g," ").replace(/#/g,", ")}</button>`),l.confidenceMode==="on"&&o(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>confidence</button>'),l.confidenceMode==="max"&&o(".pageTest #testModesNotice").append('<button class="textButton" commands="confidenceMode"><i class="fas fa-backspace"></i>max confidence</button>'),l.stopOnError!=="off"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="stopOnError"><i class="fas fa-hand-paper"></i>stop on ${l.stopOnError}</button>`),l.layout!=="default"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="layouts"><i class="fas fa-keyboard"></i>emulating ${l.layout.replace(/_/g," ")}</button>`),l.oppositeShiftMode!=="off"&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="oppositeShiftMode"><i class="fas fa-exchange-alt"></i>opposite shift${l.oppositeShiftMode==="keymap"?" (keymap)":""}</button>`);let a="";try{(n=(s=T())==null?void 0:s.tags)==null||n.forEach(i=>{i.active===!0&&(a+=i.display+", ")}),a!==""&&o(".pageTest #testModesNotice").append(`<button class="textButton" commands="tags"><i class="fas fa-tag"></i>${a.substring(0,a.length-2)}</button>`)}catch{}}const sE=new Ts({key:"prefersArabicLazyMode",schema:Lt.boolean(),fallback:!0});function h9(){return sE.get()}function g9(t){sE.set(t)}let am="";const y9=document.getElementById("koInputVisual");let sn=null;function nE(){sn=null}function v9(t){sn!==null&&(sn.uid=t,delete sn.hash,sn.hash=pS(sn))}function b9(t){var e;if(ac())return!1;we()?Mi("testStarted"):Mi("testStartedNoLogin"),ek(!0),d4(),OM(I.list),q5(),s_(),Xk(),t_(),e_(),vf(),o_(),vz();for(const a of ze(l.funbox))(e=a.functions)!=null&&e.start&&a.functions.start();try{(l.paceCaret!=="off"||l.repeatedPace&&Ro)&&fz()}catch{}return H4(t),Ez(),!0}function ut(t={}){t={...{withSameWordset:!1,practiseMissed:!1,noAnim:!1,nosave:!1},...t};const a=t.noAnim?0:qt(125);if(ds||Fo){event==null||event.preventDefault();return}if(ft()==="test"&&!Z5()&&(l.mode!=="zen"&&(event==null||event.preventDefault()),!zy(l.mode,l.words,l.time,ed(),Ni()??!1))){let n="Use your mouse to confirm.";l.quickRestart==="tab"?n="Press shift + tab or use your mouse to confirm.":l.quickRestart==="esc"?n="Press shift + escape or use your mouse to confirm.":l.quickRestart==="enter"&&(n="Press shift + enter or use your mouse to confirm."),g(`Quick restart disabled in long tests. ${n}`,0,{duration:4,important:!0});return}if(ea&&(nn&&(t.withSameWordset=!0),Km)){av(),nv(),sv();const n=gf(performance.now()),i=Jk(n);let r=Oe(n-i);r<0&&(r=0),Gk(r),eL();const d=Oe(yf());Qk(d,r)}l.mode==="quote"&&pt!==null&&l.language.startsWith(pt.language)&&l.repeatQuotes==="typing"&&(ea||am!=="")&&(t.withSameWordset=!0),Rt.mode!==null&&!t.withSameWordset&&!t.practiseMissed&&(g("Reverting to previous settings.",0),Rt.punctuation!==null&&xn(Rt.punctuation),Rt.numbers!==null&&Fs(Rt.numbers),Rt.customText&&(Pi(Rt.customText.text),br(Rt.customText.limit.mode),ko(Rt.customText.limit.value),pl(Rt.customText.pipeDelimiter)),ha(Rt.mode),nL()),Dp(),o_(),z4(),W5(),da.reset(),s4(),pf(),ek(!1),Dk(),pv(),fv(),mv(),gv(),ff(),NT(!1),mz(),AL(),A.setKoreanStatus(!1),Ku(),fl(),Nz(),$4(),Yt&&(l.randomTheme!=="off"&&lz(),eq()),ta()||Yy();let s=null;Yt?s=o("#result"):s=o("#typingTest"),FM(!1),Io(!0),jw(!0),s.stop(!0,!0).animate({opacity:0},a,async()=>{var r;o("#result").addClass("hidden"),o("#typingTest").css("opacity",0).removeClass("hidden"),o("#wordsInput").val(" "),l.language.startsWith("korean")?(y9.innerText=" ",l.mode!=="zen"?o("#koInputVisualContainer").show():o("#koInputVisualContainer").hide()):o("#koInputVisualContainer").hide(),Qr(!1),ft()==="test"&&oy(!1),fH(),rH(),await F3(),Yw=0,am="";let n=!1;l.repeatedPace&&t.withSameWordset&&(n=!0),ZT(t.withSameWordset??!1),pB(n),await Jw(),await SL();for(const d of ze(l.funbox))(r=d.functions)!=null&&r.restart&&d.functions.restart();l.showAverage!=="off"?p9().then(()=>{jr()}):jr(),o("#wordsInput").is(":focus")&&Ym(),uv(),o("#typingTest").css("opacity",0).removeClass("hidden").stop(!0,!0).animate({opacity:1},a,()=>{r3(),J4(),s3(),e3(),jw(!1),P4(),Dp(),Io(!1)})}),Bk()}let Ph,Yw=0;async function Jw(){if(console.debug("Initializing test"),Yw++,Yw>=4){jw(!1),g("Too many test reinitialization attempts. Something is going very wrong. Please contact support.",-1,{important:!0});return}GL(),Dk(),I.reset(),qk(0),A.resetHistory(),A.resetCurrent();let t;try{t=await Qm(l.language)}catch(u){g(qe(u,"Failed to load language"),-1)}if(!t||t.name!==l.language){ul("english"),await Jw();return}ft()==="test"&&await r_(),l.mode==="quote"&&l.quoteLength.includes(-3)&&!we()&&bi(-1),l.tapeMode!=="off"&&t.rightToLeft&&(g("This language does not support tape mode.",0,{important:!0}),Sk("off"));const e=!t.noLazyMode||l.mode==="custom";l.lazyMode&&!e?(Ph=!0,g("This language does not support lazy mode.",0,{important:!0}),Zp(!1,!0)):Ph&&!t.noLazyMode&&Zp(!0,!0),!l.lazyMode&&!t.noLazyMode&&(Ph=!1),l.mode==="custom"&&console.debug("Custom text",ed());let a,s,n=!1,i=!1;try{const u=await c9(t);a=u.words,s=u.sectionIndexes,n=u.hasTab,i=u.hasNewline}catch(u){console.error(u),u instanceof _a?g(u.message,0,{important:!0}):g(qe(u,"Failed to generate words"),-1,{important:!0}),await Jw();return}const r=!!Lk;let d=!1;for(const u of a)/\d/g.test(u)&&!d&&(d=!0);E5(d),M5(n),L5(i),r!==d&&ry();for(let u=0;u<a.length;u++)I.push(a[u],s[u]);l.keymapMode==="next"&&l.mode!=="zen"&&cr(Wd([...I.getCurrent()],0)),iy(I.getCurrent()),Z4(t.rightToLeft),R4(t.ligatures??!1),A4(),console.debug("Test initialized with words",a),console.debug("Test initialized with section indexes",s)}function c_(){var t;return l.mode==="words"&&I.length>=l.words&&l.words>0||l.mode==="custom"&&Jt()==="word"&&I.length>=Bt()&&Bt()!==0||l.mode==="quote"&&I.length>=(((t=pt==null?void 0:pt.textSplit)==null?void 0:t.length)??0)||l.mode==="custom"&&Jt()==="section"&&jd>=Bt()&&co.length===0&&Bt()!==0}async function iC(){var n,i,r;let t=100;const e=(i=(n=ze(l.funbox).find(d=>{var u;return(u=d.properties)==null?void 0:u.find(c=>c.startsWith("toPush"))}))==null?void 0:n.properties)==null?void 0:i.find(d=>d.startsWith("toPush:")),a=e==null?void 0:e.split(":")[1];if(a!==void 0&&(t=+a-1),I.length-A.history.length>t||c_())return;const s=ze(l.funbox).find(d=>{var u;return(u=d.functions)==null?void 0:u.pullSection});if((r=s==null?void 0:s.functions)!=null&&r.pullSection&&I.length-I.currentIndex<20){const d=await s.functions.pullSection(l.language);if(d===!1){g("Error while getting section. Please try again later",-1),bk(s.name),ut();return}if(d===void 0)return;let u=0;for(let c=0;c<d.words.length;c++){const m=d.words[c];if(u>=l.words&&l.mode==="words")break;u++,I.push(m,c),Fx(m)}}try{const d=await eE(I.length,t,I.get(I.length-1),I.get(I.length-2));I.push(d.word,d.sectionIndex),Fx(d.word)}catch(d){Xp("fail","word generation error"),g(qe(d,"Error while getting next word. Please try again later"),-1)}}const po={completedEvent:null,canRetry:!1};async function w9(){const{completedEvent:t}=po;if(t===null){g("Could not retry saving the result as the result no longer exists.",0,{duration:5,important:!0});return}po.canRetry&&(po.canRetry=!1,o("#retrySavingResultButton").addClass("hidden"),Zs(!0),g("Retrying to save..."),await iE(t,!0))}function k9(t){var z;let e=Oe(It.spacing.first-zo);(e<0||l.mode==="zen")&&(e=0);let a=Oe(Dl-It.spacing.last);(a<0||l.mode==="zen")&&(a=0);const s=Q4();if(s.time%1!==0&&l.mode!=="time"&&U4(),cz(s.wpm),Ho&&!t){const Ee=Yk();fM(Ee.wpm),hM(Ee.raw),av(),nv(),sv()}const n=Bo.map(Ee=>Math.round(Ee/5*60));if(l.mode!=="time"&&Ho&&s.time%1>=.5){const Ee=1/(s.time%1);n[n.length-1]=Math.round(n[n.length-1]*Ee)}const i=qu(n),r=ph(n);let d=Oe(Iv(i/r)),u=It.spacing.array.slice();u.length>0&&(u=u.slice(0,u.length-1));let c=Oe(Iv(qu(u)/ph(u)));(!d||isNaN(d))&&(d=0),(!c||isNaN(c))&&(c=0);const m=[];for(const Ee of lf)m.push(Ee.count??0);const f={wpm:xi,raw:n,err:m},h=qu(f.wpm??[]),y=ph(f.wpm??[]),b=Oe(Iv(h/y)),w=isNaN(b)?0:b;let $;if(l.mode==="custom"){const Ee=ed();$={textLen:Ee.text.length,mode:Ee.mode,pipeDelimiter:Ee.pipeDelimiter,limit:Ee.limit}}const E=[];for(const Ee of((z=T())==null?void 0:z.tags)??[])Ee.active===!0&&E.push(Ee._id);const L=parseFloat(s.time.toString()),be=Jk(L);let J=l.language;l.mode==="quote"&&(J=Rn(l.language));const k=(pt==null?void 0:pt.group)??-1,S={wpm:s.wpm,rawWpm:s.wpmRaw,charStats:[s.correctChars+s.correctSpaces,s.incorrectChars,s.extraChars,s.missedChars],charTotal:s.allChars,acc:s.acc,mode:l.mode,mode2:Fy(l,pt),quoteLength:k,punctuation:l.punctuation,numbers:l.numbers,lazyMode:l.lazyMode,timestamp:Date.now(),language:J,restartCount:Kk,incompleteTests:Vk,incompleteTestSeconds:ty<0?0:Oe(ty),difficulty:l.difficulty,blindMode:l.blindMode,tags:E,keySpacing:It.spacing.array,keyDuration:It.duration.array,keyOverlap:Oe(mi.total),lastKeyToEnd:a,startToFirstKey:e,consistency:d,wpmConsistency:w,keyConsistency:c,funbox:l.funbox,bailedOut:so,chartData:f,customText:$,testDuration:L,afkDuration:be,stopOnLetter:l.stopOnError==="letter"};return S.mode!=="custom"&&delete S.customText,S.mode!=="quote"&&delete S.quoteLength,S}async function hl(t=!1){var b,w,$,E,L,be;if(!ea)return;zM(!0);const e=performance.now();Hx(e),nn&&l.mode==="quote"&&ZT(!1),await jt(1),A.current.length!==0&&(A.pushHistory(),da.pushHistory(),OM(A.history)),j5(e);const a=(e-It.spacing.last)/1e3;if((l.mode==="zen"||so)&&a<7&&Hx(It.spacing.last),FM(!0),ek(!1),Dk(),pf(),pv(),fv(),mv(),gv(),Ym(),o_(),AL(),jr(),ks.length!==((b=A.getHistory())==null?void 0:b.length)){const J=aL();gM(J)}(l.mode==="zen"||so)&&K4();const s=k9(t);console.debug("Completed event object",s);function n(J){return typeof J=="number"?isNaN(J)?1:0:typeof J>"u"?1:typeof J=="object"&&J!==null?Object.values(J).reduce((k,S)=>k+n(S),0):0}let i=!1;n(s)>0&&(console.log(s),g("Failed to build result object: One of the fields is undefined or NaN",-1),i=!0);const r=yn(s);let u=uf.slice(-5).every(J=>J);so&&(u=!1);const c=parseInt(r.mode2);let m=!1;const f=(ey-Xg)/1e3;if(l.mode!=="zen"&&!so&&(s.testDuration<f-.25||s.testDuration>f+.25)?(g("Test invalid - inconsistent test duration",0),console.error("Test duration inconsistent",s.testDuration,f),Vf(),i=!0):t?(g(`Test failed - ${am}`,0,{duration:1}),i=!0):u?(g("Test invalid - AFK detected",0),i=!0):nn?(g("Test invalid - repeated",0),i=!0):r.testDuration<1||l.mode==="time"&&c<15&&c>0||l.mode==="time"&&c===0&&r.testDuration<15||l.mode==="words"&&c<10&&c>0||l.mode==="words"&&c===0&&r.testDuration<15||l.mode==="custom"&&(Jt()==="word"||Jt()==="section")&&Bt()<10||l.mode==="custom"&&Jt()==="time"&&Bt()<15||l.mode==="zen"&&r.testDuration<15?(g("Test invalid - too short",0),m=!0,i=!0):r.wpm<0||r.wpm>350&&r.mode!=="words"&&r.mode2!=="10"||r.wpm>420&&r.mode==="words"&&r.mode2==="10"?(g("Test invalid - wpm",0),Vf(),i=!0):r.rawWpm<0||r.rawWpm>350&&r.mode!=="words"&&r.mode2!=="10"||r.rawWpm>420&&r.mode==="words"&&r.mode2==="10"?(g("Test invalid - raw",0),Vf(),i=!0):(!((w=T())!=null&&w.lbOptOut)&&(r.acc<75||r.acc>100)||(($=T())==null?void 0:$.lbOptOut)===!0&&(r.acc<50||r.acc>100))&&(g("Test invalid - accuracy",0),Vf(),i=!0),nn){const J=r.testDuration,k=r.afkDuration;let S=Oe(J-k);S<0&&(S=0);const z=r.acc;Gk(S),Qk(z,S)}const h=Hk(),y=Ni();if(l.mode==="custom"&&h!==""&&y)if(so||A.history.length<I.length){const J=(E=A.getHistory())==null?void 0:E.length,k=Ik(h)+J;Ew(h,k),g("Long custom text progress saved",1,{duration:5,important:!0});let S=Kg(h,!0);S=S.slice(k),Pi(S)}else{Ew(h,0);const J=Kg(h,!0);Pi(J),g("Long custom text completed",1,{duration:5,important:!0})}if(Iz(r.testDuration-r.afkDuration),xH(),we()?o(".pageTest #result #reportQuoteButton").removeClass("hidden"):(o(".pageTest #result #rateQuoteButton").addClass("hidden"),o(".pageTest #result #reportQuoteButton").addClass("hidden"),Mi("testCompletedNoLogin"),i||(sn=r),i=!0),o("#result .stats .dailyLeaderboard").addClass("hidden"),W4(yn(r)),ta()||Yy(),await PH(r,t,am,u,nn,m,pt,i),r.chartData!=="toolong"&&delete r.chartData.unsmoothedRaw,r.testDuration>122&&(r.chartData="toolong",r.keySpacing="toolong",r.keyDuration="toolong"),i){Mi("testCompletedInvalid");return}if(tL(),r.uid=(be=(L=Qt)==null?void 0:L.currentUser)==null?void 0:be.uid,EH(pt),Zs(!0),!r.bailedOut){const J=Zz(r);J!==null&&(r.challenge=J)}r.hash=pS(r),await iE(r,!1)}async function iE(t,e){var n;if(!Km){g("Result not saved: disabled by user",-1,{duration:3,customTitle:"Notice",important:!0}),Zs(!1);return}if(!ta()){g("Result not saved: offline",-1,{duration:2,customTitle:"Notice",important:!0}),Zs(!1),po.canRetry=!0,o("#retrySavingResultButton").removeClass("hidden"),e||(po.completedEvent=t);return}const a=await F.results.add({body:{result:t}});if(Zs(!1),a.status!==200){[460,461,463,464,465].includes(a.status)||(po.canRetry=!0,o("#retrySavingResultButton").removeClass("hidden"),e||(po.completedEvent=t)),console.log("Error saving result",t),a.body.message==="Old key data format"&&(a.body.message="Old key data format. Please refresh the page to download the new update. If the problem persists, please contact support."),/"result\..+" is (not allowed|required)/gi.test(a.body.message)&&(a.body.message="Looks like your result data is using an incorrect schema. Please refresh the page to download the new update. If the problem persists, please contact support."),g("Failed to save result: "+a.body.message,-1);return}const s=a.body.data;if(o("#result .stats .tags .editTagsButton").attr("data-result-id",s.insertedId),o("#result .stats .tags .editTagsButton").removeClass("invisible"),s.xp!==void 0){const i=((n=T())==null?void 0:n.xp)??0;YT(i,s.xp,Yt?s.xpBreakdown:void 0),UT(s.xp)}if(s.streak!==void 0&&WB(s.streak),s.insertedId!==void 0){const i=yn(t);i._id=s.insertedId,s.isPb!==void 0&&s.isPb&&(i.isPb=!0),zT(i),HT(t.incompleteTests.length+1,t.testDuration+t.incompleteTestSeconds-t.afkDuration)}Mi("testCompleted"),s.isPb!==void 0&&s.isPb?(await Nc(t.mode,t.mode2,t.punctuation,t.numbers,t.language,t.difficulty,t.lazyMode,t.funbox)!==void 0&&$H(),Ih("normal"),await DB(t.mode,t.mode2,t.punctuation,t.numbers,t.language,t.difficulty,t.lazyMode,t.wpm,t.acc,t.rawWpm,t.consistency)):TH(),s.dailyLeaderboardRank===void 0?o("#result .stats .dailyLeaderboard").addClass("hidden"):(o("#result .stats .dailyLeaderboard").css({maxWidth:"13rem",opacity:0}).removeClass("hidden").animate({opacity:1},qt(500)),o("#result .stats .dailyLeaderboard .bottom").html(ve.rank(s.dailyLeaderboardRank,{fallback:""}))),o("#retrySavingResultButton").addClass("hidden"),e&&g("Result saved",1,{important:!0})}function Qu(t){if(am=t,av(),nv(),sv(),hl(!0),!Km)return;const e=gf(performance.now()),a=Jk(e);let s=Oe(e-a);s<0&&(s=0),Gk(s),eL();const n=Oe(yf());Qk(n,s)}o(".pageTest").on("click","#testModesNotice .textButton.restart",()=>{ut()});o(".pageTest").on("click","#restartTestButton",()=>{$t(),!Fo&&(ea&&l.repeatQuotes==="typing"&&l.mode==="quote"?ut({withSameWordset:!0}):ut())});o(".pageTest").on("click","#retrySavingResultButton",w9);o(".pageTest").on("click","#nextTestButton",()=>{$t(),ut()});o(".pageTest").on("click","#restartTestButtonWithSameWordset",()=>{if(l.mode==="zen"){g("Repeat test disabled in zen mode");return}$t(),ut({withSameWordset:!0})});o(".pageTest").on("click","#testConfig .mode .textButton",t=>{if(ds||o(t.currentTarget).hasClass("active"))return;const e=o(t.currentTarget).attr("mode")??"time";e!==void 0&&(ha(e),$t(),ut())});o(".pageTest").on("click","#testConfig .wordCount .textButton",t=>{if(ds)return;const e=o(t.currentTarget).attr("wordCount")??"15";e!=="custom"&&(Zr(parseInt(e)),$t(),ut())});o(".pageTest").on("click","#testConfig .time .textButton",t=>{if(ds)return;const e=o(t.currentTarget).attr("timeConfig")??"10";e!=="custom"&&(Dn(parseInt(e)),$t(),ut())});o(".pageTest").on("click","#testConfig .quoteLength .textButton",t=>{if(ds)return;let e=parseInt(o(t.currentTarget).attr("quoteLength")??"1");e!==-2&&(e===-1&&(e=[0,1,2,3]),bi(e,!1,t.shiftKey),$t(),ut())});o(".pageTest").on("click","#testConfig .punctuationMode.textButton",()=>{ds||(xn(!l.punctuation),$t(),ut())});o(".pageTest").on("click","#testConfig .numbersMode.textButton",()=>{ds||(Fs(!l.numbers),$t(),ut())});o("header").on("click","nav #startTestButton, #logo",()=>{ft()==="test"&&ut()});Dt((t,e,a)=>{ft()==="test"&&(t==="language"&&(e!=null&&e.startsWith("arabic")&&h9()&&Zp(!0,!0),ut()),t==="difficulty"&&!a&&ut(),t==="showAllLines"&&!a&&ut(),t==="customLayoutFluid"&&l.funbox.includes("layoutfluid")&&ut(),t==="keymapMode"&&e==="next"&&l.mode!=="zen"&&setTimeout(()=>{cr(Wd([...I.getCurrent()],0))},0)),t==="lazyMode"&&!a&&(l.language.startsWith("arabic")&&g9(e),e===!1&&(Ph=!1))});bz((t,e)=>{t==="fail"&&e!==void 0&&Qu(e),t==="finish"&&hl()});function rE(t){p_.show({...t,focusFirstInput:"focusAndSelect",beforeAnimation:async e=>{e.querySelector("input").value=`${l.words}`}})}function _9(t=!1){p_.hide({clearModalChain:t})}function x9(){var e;const t=parseInt((e=p_.getModal().querySelector("input"))==null?void 0:e.value,10);t!==null&&!isNaN(t)&&t>=0&&isFinite(t)?Zr(t)&&($t(),ut(),t>2e3?g("Stay safe and take breaks!",0):t===0&&g("Infinite words! Make sure to use Bail Out from the command line to save your result.",0,{duration:7})):g("Custom word amount must be at least 1",0),_9(!0)}const p_=new Ct({dialogId:"customWordAmountModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),x9()})}});var _t;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(_t||(_t={}));var Xw;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(Xw||(Xw={}));var ie=_t.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),lr=t=>{switch(typeof t){case"undefined":return ie.undefined;case"string":return ie.string;case"number":return isNaN(t)?ie.nan:ie.number;case"boolean":return ie.boolean;case"function":return ie.function;case"bigint":return ie.bigint;case"symbol":return ie.symbol;case"object":return Array.isArray(t)?ie.array:t===null?ie.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?ie.promise:typeof Map<"u"&&t instanceof Map?ie.map:typeof Set<"u"&&t instanceof Set?ie.set:typeof Date<"u"&&t instanceof Date?ie.date:ie.object;default:return ie.unknown}},D=_t.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),C9=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),fn=class oE extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof oE))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,_t.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};fn.create=t=>new fn(t);var gl=(t,e)=>{let a;switch(t.code){case D.invalid_type:t.received===ie.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case D.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,_t.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:a=`Unrecognized key(s) in object: ${_t.joinValues(t.keys,", ")}`;break;case D.invalid_union:a="Invalid input";break;case D.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${_t.joinValues(t.options)}`;break;case D.invalid_enum_value:a=`Invalid enum value. Expected ${_t.joinValues(t.options)}, received '${t.received}'`;break;case D.invalid_arguments:a="Invalid function arguments";break;case D.invalid_return_type:a="Invalid function return type";break;case D.invalid_date:a="Invalid date";break;case D.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:_t.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case D.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case D.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case D.custom:a="Invalid input";break;case D.invalid_intersection_types:a="Intersection results could not be merged";break;case D.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case D.not_finite:a="Number must be finite";break;default:a=e.defaultError,_t.assertNever(t)}return{message:a}},dE=gl;function S9(t){dE=t}function dy(){return dE}var ly=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},T9=[];function Q(t,e){let a=dy(),s=ly({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===gl?void 0:gl].filter(n=>!!n)});t.common.issues.push(s)}var ls=class lE{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return je;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return lE.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return je;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},je=Object.freeze({status:"aborted"}),uy=t=>({status:"dirty",value:t}),Fa=t=>({status:"valid",value:t}),e0=t=>t.status==="aborted",t0=t=>t.status==="dirty",sm=t=>t.status==="valid",nm=t=>typeof Promise<"u"&&t instanceof Promise;function cy(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function uE(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var he;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(he||(he={}));var Tu,$u,ii=class{constructor(e,a,s,n){this._cachedPath=[],this.parent=e,this.data=a,this._path=s,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},rC=(t,e)=>{if(sm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new fn(t.common.issues);return this._error=a,this._error}}};function Ye(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var nt=class{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return lr(e.data)}_getOrReturnCtx(e,a){return a||{common:e.parent.common,data:e.data,parsedType:lr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ls,ctx:{common:e.parent.common,data:e.data,parsedType:lr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let a=this._parse(e);if(nm(a))throw new Error("Synchronous parse encountered promise.");return a}_parseAsync(e){let a=this._parse(e);return Promise.resolve(a)}parse(e,a){let s=this.safeParse(e,a);if(s.success)return s.data;throw s.error}safeParse(e,a){var s;let n={common:{issues:[],async:(s=a==null?void 0:a.async)!==null&&s!==void 0?s:!1,contextualErrorMap:a==null?void 0:a.errorMap},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:lr(e)},i=this._parseSync({data:e,path:n.path,parent:n});return rC(n,i)}async parseAsync(e,a){let s=await this.safeParseAsync(e,a);if(s.success)return s.data;throw s.error}async safeParseAsync(e,a){let s={common:{issues:[],contextualErrorMap:a==null?void 0:a.errorMap,async:!0},path:(a==null?void 0:a.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:lr(e)},n=this._parse({data:e,path:s.path,parent:s}),i=await(nm(n)?n:Promise.resolve(n));return rC(s,i)}refine(e,a){let s=n=>typeof a=="string"||typeof a>"u"?{message:a}:typeof a=="function"?a(n):a;return this._refinement((n,i)=>{let r=e(n),d=()=>i.addIssue({code:D.custom,...s(n)});return typeof Promise<"u"&&r instanceof Promise?r.then(u=>u?!0:(d(),!1)):r?!0:(d(),!1)})}refinement(e,a){return this._refinement((s,n)=>e(s)?!0:(n.addIssue(typeof a=="function"?a(s,n):a),!1))}_refinement(e){return new Cn({schema:this,typeName:Me.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return Yn.create(this,this._def)}nullable(){return qr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ko.create(this,this._def)}promise(){return bl.create(this,this._def)}or(e){return cm.create([this,e],this._def)}and(e){return pm.create(this,e,this._def)}transform(e){return new Cn({...Ye(this._def),schema:this,typeName:Me.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let a=typeof e=="function"?e:()=>e;return new gm({...Ye(this._def),innerType:this,defaultValue:a,typeName:Me.ZodDefault})}brand(){return new m_({typeName:Me.ZodBranded,type:this,...Ye(this._def)})}catch(e){let a=typeof e=="function"?e:()=>e;return new ym({...Ye(this._def),innerType:this,catchValue:a,typeName:Me.ZodCatch})}describe(e){let a=this.constructor;return new a({...this._def,description:e})}pipe(e){return f_.create(this,e)}readonly(){return vm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},$9=/^c[^\s-]{8,}$/i,A9=/^[0-9a-z]+$/,M9=/^[0-9A-HJKMNP-TV-Z]{26}$/,L9=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,E9=/^[a-z0-9_-]{21}$/i,I9=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,O9=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,P9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",sb,Z9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,R9=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,N9=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,cE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",D9=new RegExp(`^${cE}$`);function pE(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function j9(t){return new RegExp(`^${pE(t)}$`)}function mE(t){let e=`${cE}T${pE(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function B9(t,e){return!!((e==="v4"||!e)&&Z9.test(t)||(e==="v6"||!e)&&R9.test(t))}var yl=class Au extends nt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ie.string){let n=this._getOrReturnCtx(e);return Q(n,{code:D.invalid_type,expected:ie.string,received:n.parsedType}),je}let a=new ls,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:D.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:D.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?Q(s,{code:D.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&Q(s,{code:D.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")O9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"email",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")sb||(sb=new RegExp(P9,"u")),sb.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"emoji",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")L9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"uuid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")E9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"nanoid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")$9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"cuid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")A9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"cuid2",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")M9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"ulid",code:D.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Q(s,{validation:"url",code:D.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"regex",code:D.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?mE(n).test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?D9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?j9(n).test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{code:D.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?I9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"duration",code:D.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?B9(e.data,n.version)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"ip",code:D.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?N9.test(e.data)||(s=this._getOrReturnCtx(e,s),Q(s,{validation:"base64",code:D.invalid_string,message:n.message}),a.dirty()):_t.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:D.invalid_string,...he.errToObj(s)})}_addCheck(e){return new Au({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...he.errToObj(e)})}url(e){return this._addCheck({kind:"url",...he.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...he.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...he.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...he.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...he.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...he.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...he.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...he.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...he.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...he.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...he.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...he.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...he.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...he.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...he.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...he.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...he.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...he.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...he.errToObj(a)})}nonempty(e){return this.min(1,he.errToObj(e))}trim(){return new Au({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Au({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Au({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};yl.create=t=>{var e;return new yl({checks:[],typeName:Me.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ye(t)})};function q9(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var im=class a0 extends nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ie.number){let n=this._getOrReturnCtx(e);return Q(n,{code:D.invalid_type,expected:ie.number,received:n.parsedType}),je}let a,s=new ls;for(let n of this._def.checks)n.kind==="int"?_t.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),Q(a,{code:D.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?q9(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),Q(a,{code:D.not_finite,message:n.message}),s.dirty()):_t.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,he.toString(a))}gt(e,a){return this.setLimit("min",e,!1,he.toString(a))}lte(e,a){return this.setLimit("max",e,!0,he.toString(a))}lt(e,a){return this.setLimit("max",e,!1,he.toString(a))}setLimit(e,a,s,n){return new a0({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:he.toString(n)}]})}_addCheck(e){return new a0({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:he.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:he.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:he.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:he.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:he.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:he.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:he.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:he.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:he.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&_t.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};im.create=t=>new im({checks:[],typeName:Me.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Ye(t)});var rm=class s0 extends nt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==ie.bigint){let n=this._getOrReturnCtx(e);return Q(n,{code:D.invalid_type,expected:ie.bigint,received:n.parsedType}),je}let a,s=new ls;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),Q(a,{code:D.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):_t.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,he.toString(a))}gt(e,a){return this.setLimit("min",e,!1,he.toString(a))}lte(e,a){return this.setLimit("max",e,!0,he.toString(a))}lt(e,a){return this.setLimit("max",e,!1,he.toString(a))}setLimit(e,a,s,n){return new s0({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:he.toString(n)}]})}_addCheck(e){return new s0({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:he.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:he.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:he.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:he.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:he.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};rm.create=t=>{var e;return new rm({checks:[],typeName:Me.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Ye(t)})};var om=class extends nt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ie.boolean){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.boolean,received:a.parsedType}),je}return Fa(e.data)}};om.create=t=>new om({typeName:Me.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Ye(t)});var dm=class fE extends nt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ie.date){let n=this._getOrReturnCtx(e);return Q(n,{code:D.invalid_type,expected:ie.date,received:n.parsedType}),je}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return Q(n,{code:D.invalid_date}),je}let a=new ls,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:D.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),Q(s,{code:D.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):_t.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new fE({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:he.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:he.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};dm.create=t=>new dm({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Me.ZodDate,...Ye(t)});var py=class extends nt{_parse(e){if(this._getType(e)!==ie.symbol){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.symbol,received:a.parsedType}),je}return Fa(e.data)}};py.create=t=>new py({typeName:Me.ZodSymbol,...Ye(t)});var lm=class extends nt{_parse(e){if(this._getType(e)!==ie.undefined){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.undefined,received:a.parsedType}),je}return Fa(e.data)}};lm.create=t=>new lm({typeName:Me.ZodUndefined,...Ye(t)});var um=class extends nt{_parse(e){if(this._getType(e)!==ie.null){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.null,received:a.parsedType}),je}return Fa(e.data)}};um.create=t=>new um({typeName:Me.ZodNull,...Ye(t)});var vl=class extends nt{constructor(){super(...arguments),this._any=!0}_parse(e){return Fa(e.data)}};vl.create=t=>new vl({typeName:Me.ZodAny,...Ye(t)});var So=class extends nt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Fa(e.data)}};So.create=t=>new So({typeName:Me.ZodUnknown,...Ye(t)});var ji=class extends nt{_parse(e){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.never,received:a.parsedType}),je}};ji.create=t=>new ji({typeName:Me.ZodNever,...Ye(t)});var my=class extends nt{_parse(e){if(this._getType(e)!==ie.undefined){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.void,received:a.parsedType}),je}return Fa(e.data)}};my.create=t=>new my({typeName:Me.ZodVoid,...Ye(t)});var Ko=class Zh extends nt{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==ie.array)return Q(a,{code:D.invalid_type,expected:ie.array,received:a.parsedType}),je;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(Q(a,{code:r?D.too_big:D.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(Q(a,{code:D.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(Q(a,{code:D.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new ii(a,r,a.path,d)))).then(r=>ls.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new ii(a,r,a.path,d)));return ls.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new Zh({...this._def,minLength:{value:e,message:he.toString(a)}})}max(e,a){return new Zh({...this._def,maxLength:{value:e,message:he.toString(a)}})}length(e,a){return new Zh({...this._def,exactLength:{value:e,message:he.toString(a)}})}nonempty(e){return this.min(1,e)}};Ko.create=(t,e)=>new Ko({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Me.ZodArray,...Ye(e)});function xd(t){if(t instanceof zs){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Yn.create(xd(s))}return new zs({...t._def,shape:()=>e})}else return t instanceof Ko?new Ko({...t._def,type:xd(t.element)}):t instanceof Yn?Yn.create(xd(t.unwrap())):t instanceof qr?qr.create(xd(t.unwrap())):t instanceof Br?Br.create(t.items.map(e=>xd(e))):t}var zs=class Xs extends nt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=_t.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==ie.object){let u=this._getOrReturnCtx(e);return Q(u,{code:D.invalid_type,expected:ie.object,received:u.parsedType}),je}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof ji&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new ii(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof ji){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(Q(s,{code:D.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new ii(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>ls.mergeObjectSync(a,u)):ls.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return he.errToObj,new Xs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=he.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new Xs({...this._def,unknownKeys:"strip"})}passthrough(){return new Xs({...this._def,unknownKeys:"passthrough"})}extend(e){return new Xs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Xs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Me.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new Xs({...this._def,catchall:e})}pick(e){let a={};return _t.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new Xs({...this._def,shape:()=>a})}omit(e){let a={};return _t.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new Xs({...this._def,shape:()=>a})}deepPartial(){return xd(this)}partial(e){let a={};return _t.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new Xs({...this._def,shape:()=>a})}required(e){let a={};return _t.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Yn;)n=n._def.innerType;a[s]=n}}),new Xs({...this._def,shape:()=>a})}keyof(){return wE(_t.objectKeys(this.shape))}};zs.create=(t,e)=>new zs({shape:()=>t,unknownKeys:"strip",catchall:ji.create(),typeName:Me.ZodObject,...Ye(e)});zs.strictCreate=(t,e)=>new zs({shape:()=>t,unknownKeys:"strict",catchall:ji.create(),typeName:Me.ZodObject,...Ye(e)});zs.lazycreate=(t,e)=>new zs({shape:t,unknownKeys:"strip",catchall:ji.create(),typeName:Me.ZodObject,...Ye(e)});var cm=class extends nt{_parse(e){let{ctx:a}=this._processInputParams(e),s=this._def.options;function n(i){for(let d of i)if(d.result.status==="valid")return d.result;for(let d of i)if(d.result.status==="dirty")return a.common.issues.push(...d.ctx.common.issues),d.result;let r=i.map(d=>new fn(d.ctx.common.issues));return Q(a,{code:D.invalid_union,unionErrors:r}),je}if(a.common.async)return Promise.all(s.map(async i=>{let r={...a,common:{...a.common,issues:[]},parent:null};return{result:await i._parseAsync({data:a.data,path:a.path,parent:r}),ctx:r}})).then(n);{let i,r=[];for(let u of s){let c={...a,common:{...a.common,issues:[]},parent:null},m=u._parseSync({data:a.data,path:a.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&r.push(c.common.issues)}if(i)return a.common.issues.push(...i.ctx.common.issues),i.result;let d=r.map(u=>new fn(u));return Q(a,{code:D.invalid_union,unionErrors:d}),je}}get options(){return this._def.options}};cm.create=(t,e)=>new cm({options:t,typeName:Me.ZodUnion,...Ye(e)});var Xi=t=>t instanceof mm?Xi(t.schema):t instanceof Cn?Xi(t.innerType()):t instanceof fm?[t.value]:t instanceof kf?t.options:t instanceof hm?_t.objectValues(t.enum):t instanceof gm?Xi(t._def.innerType):t instanceof lm?[void 0]:t instanceof um?[null]:t instanceof Yn?[void 0,...Xi(t.unwrap())]:t instanceof qr?[null,...Xi(t.unwrap())]:t instanceof m_||t instanceof vm?Xi(t.unwrap()):t instanceof ym?Xi(t._def.innerType):[],hE=class gE extends nt{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ie.object)return Q(a,{code:D.invalid_type,expected:ie.object,received:a.parsedType}),je;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(Q(a,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),je)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=Xi(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new gE({typeName:Me.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Ye(s)})}};function n0(t,e){let a=lr(t),s=lr(e);if(t===e)return{valid:!0,data:t};if(a===ie.object&&s===ie.object){let n=_t.objectKeys(e),i=_t.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=n0(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===ie.array&&s===ie.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=n0(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===ie.date&&s===ie.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var pm=class extends nt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=(i,r)=>{if(e0(i)||e0(r))return je;let d=n0(i.value,r.value);return d.valid?((t0(i)||t0(r))&&a.dirty(),{status:a.value,value:d.data}):(Q(s,{code:D.invalid_intersection_types}),je)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,r])=>n(i,r)):n(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}};pm.create=(t,e,a)=>new pm({left:t,right:e,typeName:Me.ZodIntersection,...Ye(a)});var Br=class yE extends nt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.array)return Q(s,{code:D.invalid_type,expected:ie.array,received:s.parsedType}),je;if(s.data.length<this._def.items.length)return Q(s,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),je;!this._def.rest&&s.data.length>this._def.items.length&&(Q(s,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new ii(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>ls.mergeArray(a,i)):ls.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new yE({...this._def,rest:e})}};Br.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Br({items:t,typeName:Me.ZodTuple,rest:null,...Ye(e)})};var vE=class i0 extends nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.object)return Q(s,{code:D.invalid_type,expected:ie.object,received:s.parsedType}),je;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new ii(s,d,s.path,d)),value:r._parse(new ii(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?ls.mergeObjectAsync(a,n):ls.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof nt?new i0({keyType:e,valueType:a,typeName:Me.ZodRecord,...Ye(s)}):new i0({keyType:yl.create(),valueType:e,typeName:Me.ZodRecord,...Ye(a)})}},fy=class extends nt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.map)return Q(s,{code:D.invalid_type,expected:ie.map,received:s.parsedType}),je;let n=this._def.keyType,i=this._def.valueType,r=[...s.data.entries()].map(([d,u],c)=>({key:n._parse(new ii(s,d,s.path,[c,"key"])),value:i._parse(new ii(s,u,s.path,[c,"value"]))}));if(s.common.async){let d=new Map;return Promise.resolve().then(async()=>{for(let u of r){let c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return je;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}})}else{let d=new Map;for(let u of r){let c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return je;(c.status==="dirty"||m.status==="dirty")&&a.dirty(),d.set(c.value,m.value)}return{status:a.value,value:d}}}};fy.create=(t,e,a)=>new fy({valueType:e,keyType:t,typeName:Me.ZodMap,...Ye(a)});var hy=class r0 extends nt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==ie.set)return Q(s,{code:D.invalid_type,expected:ie.set,received:s.parsedType}),je;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(Q(s,{code:D.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(Q(s,{code:D.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return je;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new ii(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new r0({...this._def,minSize:{value:e,message:he.toString(a)}})}max(e,a){return new r0({...this._def,maxSize:{value:e,message:he.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};hy.create=(t,e)=>new hy({valueType:t,minSize:null,maxSize:null,typeName:Me.ZodSet,...Ye(e)});var bE=class Rh extends nt{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ie.function)return Q(a,{code:D.invalid_type,expected:ie.function,received:a.parsedType}),je;function s(d,u){return ly({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,dy(),gl].filter(c=>!!c),issueData:{code:D.invalid_arguments,argumentsError:u}})}function n(d,u){return ly({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,dy(),gl].filter(c=>!!c),issueData:{code:D.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof bl){let d=this;return Fa(async function(...u){let c=new fn([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return Fa(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new fn([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new fn([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Rh({...this._def,args:Br.create(e).rest(So.create())})}returns(e){return new Rh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Rh({args:e||Br.create([]).rest(So.create()),returns:a||So.create(),typeName:Me.ZodFunction,...Ye(s)})}},mm=class extends nt{get schema(){return this._def.getter()}_parse(e){let{ctx:a}=this._processInputParams(e);return this._def.getter()._parse({data:a.data,path:a.path,parent:a})}};mm.create=(t,e)=>new mm({getter:t,typeName:Me.ZodLazy,...Ye(e)});var fm=class extends nt{_parse(e){if(e.data!==this._def.value){let a=this._getOrReturnCtx(e);return Q(a,{received:a.data,code:D.invalid_literal,expected:this._def.value}),je}return{status:"valid",value:e.data}}get value(){return this._def.value}};fm.create=(t,e)=>new fm({value:t,typeName:Me.ZodLiteral,...Ye(e)});function wE(t,e){return new kf({values:t,typeName:Me.ZodEnum,...Ye(e)})}var kf=class o0 extends nt{constructor(){super(...arguments),Tu.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return Q(a,{expected:_t.joinValues(s),received:a.parsedType,code:D.invalid_type}),je}if(cy(this,Tu)||uE(this,Tu,new Set(this._def.values)),!cy(this,Tu).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return Q(a,{received:a.data,code:D.invalid_enum_value,options:s}),je}return Fa(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return o0.create(e,{...this._def,...a})}exclude(e,a=this._def){return o0.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Tu=new WeakMap;kf.create=wE;var hm=class extends nt{constructor(){super(...arguments),$u.set(this,void 0)}_parse(e){let a=_t.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ie.string&&s.parsedType!==ie.number){let n=_t.objectValues(a);return Q(s,{expected:_t.joinValues(n),received:s.parsedType,code:D.invalid_type}),je}if(cy(this,$u)||uE(this,$u,new Set(_t.getValidEnumValues(this._def.values))),!cy(this,$u).has(e.data)){let n=_t.objectValues(a);return Q(s,{received:s.data,code:D.invalid_enum_value,options:n}),je}return Fa(e.data)}get enum(){return this._def.values}};$u=new WeakMap;hm.create=(t,e)=>new hm({values:t,typeName:Me.ZodNativeEnum,...Ye(e)});var bl=class extends nt{unwrap(){return this._def.type}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==ie.promise&&a.common.async===!1)return Q(a,{code:D.invalid_type,expected:ie.promise,received:a.parsedType}),je;let s=a.parsedType===ie.promise?a.data:Promise.resolve(a.data);return Fa(s.then(n=>this._def.type.parseAsync(n,{path:a.path,errorMap:a.common.contextualErrorMap})))}};bl.create=(t,e)=>new bl({type:t,typeName:Me.ZodPromise,...Ye(e)});var Cn=class extends nt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Me.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:a,ctx:s}=this._processInputParams(e),n=this._def.effect||null,i={addIssue:r=>{Q(s,r),r.fatal?a.abort():a.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),n.type==="preprocess"){let r=n.transform(s.data,i);if(s.common.async)return Promise.resolve(r).then(async d=>{if(a.value==="aborted")return je;let u=await this._def.schema._parseAsync({data:d,path:s.path,parent:s});return u.status==="aborted"?je:u.status==="dirty"||a.value==="dirty"?uy(u.value):u});{if(a.value==="aborted")return je;let d=this._def.schema._parseSync({data:r,path:s.path,parent:s});return d.status==="aborted"?je:d.status==="dirty"||a.value==="dirty"?uy(d.value):d}}if(n.type==="refinement"){let r=d=>{let u=n.refinement(d,i);if(s.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return d};if(s.common.async===!1){let d=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return d.status==="aborted"?je:(d.status==="dirty"&&a.dirty(),r(d.value),{status:a.value,value:d.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(d=>d.status==="aborted"?je:(d.status==="dirty"&&a.dirty(),r(d.value).then(()=>({status:a.value,value:d.value}))))}if(n.type==="transform")if(s.common.async===!1){let r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!sm(r))return r;let d=n.transform(r.value,i);if(d instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:a.value,value:d}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(r=>sm(r)?Promise.resolve(n.transform(r.value,i)).then(d=>({status:a.value,value:d})):r);_t.assertNever(n)}};Cn.create=(t,e,a)=>new Cn({schema:t,typeName:Me.ZodEffects,effect:e,...Ye(a)});Cn.createWithPreprocess=(t,e,a)=>new Cn({schema:e,effect:{type:"preprocess",transform:t},typeName:Me.ZodEffects,...Ye(a)});var Yn=class extends nt{_parse(e){return this._getType(e)===ie.undefined?Fa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Yn.create=(t,e)=>new Yn({innerType:t,typeName:Me.ZodOptional,...Ye(e)});var qr=class extends nt{_parse(e){return this._getType(e)===ie.null?Fa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};qr.create=(t,e)=>new qr({innerType:t,typeName:Me.ZodNullable,...Ye(e)});var gm=class extends nt{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return a.parsedType===ie.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:a.path,parent:a})}removeDefault(){return this._def.innerType}};gm.create=(t,e)=>new gm({innerType:t,typeName:Me.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ye(e)});var ym=class extends nt{_parse(e){let{ctx:a}=this._processInputParams(e),s={...a,common:{...a.common,issues:[]}},n=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return nm(n)?n.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new fn(s.common.issues)},input:s.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new fn(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}};ym.create=(t,e)=>new ym({innerType:t,typeName:Me.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ye(e)});var gy=class extends nt{_parse(e){if(this._getType(e)!==ie.nan){let a=this._getOrReturnCtx(e);return Q(a,{code:D.invalid_type,expected:ie.nan,received:a.parsedType}),je}return{status:"valid",value:e.data}}};gy.create=t=>new gy({typeName:Me.ZodNaN,...Ye(t)});var W9=Symbol("zod_brand"),m_=class extends nt{_parse(e){let{ctx:a}=this._processInputParams(e),s=a.data;return this._def.type._parse({data:s,path:a.path,parent:a})}unwrap(){return this._def.type}},f_=class kE extends nt{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?je:n.status==="dirty"?(a.dirty(),uy(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?je:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new kE({in:e,out:a,typeName:Me.ZodPipeline})}},vm=class extends nt{_parse(e){let a=this._def.innerType._parse(e),s=n=>(sm(n)&&(n.value=Object.freeze(n.value)),n);return nm(a)?a.then(n=>s(n)):s(a)}unwrap(){return this._def.innerType}};vm.create=(t,e)=>new vm({innerType:t,typeName:Me.ZodReadonly,...Ye(e)});function _E(t,e={},a){return t?vl.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):vl.create()}var F9={object:zs.lazycreate},Me;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Me||(Me={}));var z9=(t,e={message:`Input not instance of ${t.name}`})=>_E(a=>a instanceof t,e),xE=yl.create,CE=im.create,H9=gy.create,U9=rm.create,SE=om.create,K9=dm.create,V9=py.create,G9=lm.create,Q9=um.create,Y9=vl.create,J9=So.create,X9=ji.create,eU=my.create,tU=Ko.create,aU=zs.create,sU=zs.strictCreate,nU=cm.create,iU=hE.create,rU=pm.create,oU=Br.create,dU=vE.create,lU=fy.create,uU=hy.create,cU=bE.create,pU=mm.create,d0=fm.create,mU=kf.create,fU=hm.create,hU=bl.create,oC=Cn.create,gU=Yn.create,yU=qr.create,vU=Cn.createWithPreprocess,bU=f_.create,wU=()=>xE().optional(),kU=()=>CE().optional(),_U=()=>SE().optional(),xU={string:t=>yl.create({...t,coerce:!0}),number:t=>im.create({...t,coerce:!0}),boolean:t=>om.create({...t,coerce:!0}),bigint:t=>rm.create({...t,coerce:!0}),date:t=>dm.create({...t,coerce:!0})},CU=je,v=Object.freeze({__proto__:null,defaultErrorMap:gl,setErrorMap:S9,getErrorMap:dy,makeIssue:ly,EMPTY_PATH:T9,addIssueToContext:Q,ParseStatus:ls,INVALID:je,DIRTY:uy,OK:Fa,isAborted:e0,isDirty:t0,isValid:sm,isAsync:nm,get util(){return _t},get objectUtil(){return Xw},ZodParsedType:ie,getParsedType:lr,ZodType:nt,datetimeRegex:mE,ZodString:yl,ZodNumber:im,ZodBigInt:rm,ZodBoolean:om,ZodDate:dm,ZodSymbol:py,ZodUndefined:lm,ZodNull:um,ZodAny:vl,ZodUnknown:So,ZodNever:ji,ZodVoid:my,ZodArray:Ko,ZodObject:zs,ZodUnion:cm,ZodDiscriminatedUnion:hE,ZodIntersection:pm,ZodTuple:Br,ZodRecord:vE,ZodMap:fy,ZodSet:hy,ZodFunction:bE,ZodLazy:mm,ZodLiteral:fm,ZodEnum:kf,ZodNativeEnum:hm,ZodPromise:bl,ZodEffects:Cn,ZodTransformer:Cn,ZodOptional:Yn,ZodNullable:qr,ZodDefault:gm,ZodCatch:ym,ZodNaN:gy,BRAND:W9,ZodBranded:m_,ZodPipeline:f_,ZodReadonly:vm,custom:_E,Schema:nt,ZodSchema:nt,late:F9,get ZodFirstPartyTypeKind(){return Me},coerce:xU,any:Y9,array:tU,bigint:U9,boolean:SE,date:K9,discriminatedUnion:iU,effect:oC,enum:mU,function:cU,instanceof:z9,intersection:rU,lazy:pU,literal:d0,map:lU,nan:H9,nativeEnum:fU,never:X9,null:Q9,nullable:yU,number:CE,object:aU,oboolean:_U,onumber:kU,optional:gU,ostring:wU,pipeline:bU,preprocess:vU,promise:hU,record:dU,set:uU,strictObject:sU,string:xE,symbol:V9,transformer:oC,tuple:oU,undefined:G9,union:nU,unknown:J9,void:eU,NEVER:CU,ZodIssueCode:D,quotelessJson:C9,ZodError:fn}),To=v.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(v.number().transform(String)),_f=()=>v.string().regex(/^[a-zA-Z0-9_]+$/),kv=_f();_f().max(50);var td=v.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");v.string().nullable().optional().transform(t=>t??void 0);v.number().nonnegative().max(100);v.number().nonnegative().max(420);v.enum(["repeat","random","shuffle"]);v.enum(["word","time","section"]);var h_=v.enum(["normal","expert","master"]),au=v.object({acc:v.number().nonnegative().max(100),consistency:v.number().nonnegative().max(100),difficulty:h_,lazyMode:v.boolean().optional(),language:v.string().max(100).regex(/[\w+]+/),punctuation:v.boolean().optional(),numbers:v.boolean().optional(),raw:v.number().nonnegative(),wpm:v.number().nonnegative(),timestamp:v.number().nonnegative()}),_v=v.object({time:v.record(To.describe("Number of seconds as string"),v.array(au)),words:v.record(To.describe("Number of words as string"),v.array(au)),quote:v.record(To,v.array(au)),custom:v.record(v.literal("custom"),v.array(au)),zen:v.record(v.literal("zen"),v.array(au))}),SU=v.union([v.literal("10"),v.literal("25"),v.literal("50"),v.literal("100")]),TU=v.union([v.literal("15"),v.literal("30"),v.literal("60"),v.literal("120")]),$U=v.union([v.literal("short"),v.literal("medium"),v.literal("long"),v.literal("thicc")]),g_=_v.keyof(),TE=v.union([To,d0("zen"),d0("custom")],{errorMap:()=>({message:'Needs to be either a number, "zen" or "custom".'})}),AU=v.enum(["off","slow","medium","fast"]),MU=v.enum(["off","esc","tab","enter"]),LU=v.union([v.literal(-3),v.literal(-2),v.literal(-1),v.literal(0),v.literal(1),v.literal(2),v.literal(3)]),EU=v.array(LU),dC=v.enum(["off","default","block","outline","underline","carrot","banana"]),IU=v.enum(["off","on","max"]),OU=v.enum(["off","below","replace"]),PU=v.enum(["off","bar","text","mini"]),nb=v.enum(["off","text","mini"]),ZU=v.enum(["off","on","fav","light","dark","custom"]),RU=v.enum(["black","sub","text","main"]),NU=v.enum(["0.25","0.5","0.75","1"]),DU=v.enum(["off","word","letter"]),jU=v.enum(["off","static","react","next"]),BU=v.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),qU=v.enum(["lowercase","uppercase","blank","dynamic"]),WU=v.enum(["always","layout","never"]),FU=v.number().min(.5).max(3.5).step(.1),zU=v.enum(["manual","on"]),HU=v.enum(["off","1","2","3","4"]),UU=v.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),KU=v.number().min(0).max(1),VU=v.enum(["off","average","pb","tagPb","last","custom","daily"]),GU=v.tuple([v.enum(["on","off"]),v.enum(["on","off"]),v.enum(["on","off"]),v.enum(["on","off"])]),QU=v.enum(["off","custom"]),YU=v.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),JU=v.enum(["off","letter","word"]),XU=v.enum(["wpm","cpm","wps","cps","wph"]),eK=v.enum(["off","result","on","sellout"]),tK=v.enum(["off","custom"]),aK=v.enum(["off","typing"]),sK=v.enum(["off","on","keymap"]),nK=v.enum(["cover","contain","max"]),iK=v.tuple([v.number(),v.number(),v.number(),v.number()]),rK=v.string().regex(/^[0-9a-zA-Z_#]+$/),oK=v.enum(["off","1","2","3","4"]),dK=v.enum(["off","fixed","flex"]),lK=v.enum(["off","speed","acc","both"]),Ln=v.string().regex(/^#([\da-f]{3}){1,2}$/i),uK=h_,$E=v.tuple([Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln,Ln]),cK=v.array(_f().max(50)),pK=v.string().max(100).regex(/[\w#]+/),mK=v.number().nonnegative(),fK=v.number().nonnegative(),hK=v.number().nonnegative().max(100),gK=v.number().nonnegative(),yK=v.number().int().nonnegative(),vK=v.number().int().nonnegative(),bK=v.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),ib=_f().max(50),wK=v.string().max(50).regex(/[\w\-_]+/),kK=_f().max(50),_K=v.number().positive(),xK=v.number().min(20).max(1e3).or(v.literal(0)),CK=v.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(v.literal("")),SK=v.object({theme:ib,themeLight:ib,themeDark:ib,autoSwitchTheme:v.boolean(),customTheme:v.boolean(),customThemeColors:$E,favThemes:cK,showKeyTips:v.boolean(),smoothCaret:AU,quickRestart:MU,punctuation:v.boolean(),numbers:v.boolean(),words:vK,time:yK,mode:g_,quoteLength:EU,language:td,fontSize:_K,freedomMode:v.boolean(),difficulty:uK,blindMode:v.boolean(),quickEnd:v.boolean(),caretStyle:dC,paceCaretStyle:dC,flipTestColors:v.boolean(),layout:kK,funbox:pK,confidenceMode:IU,indicateTypos:OU,timerStyle:PU,liveSpeedStyle:nb,liveAccStyle:nb,liveBurstStyle:nb,colorfulMode:v.boolean(),randomTheme:ZU,timerColor:RU,timerOpacity:NU,stopOnError:DU,showAllLines:v.boolean(),keymapMode:jU,keymapStyle:BU,keymapLegendStyle:qU,keymapLayout:wK,keymapShowTopRow:WU,keymapSize:FU,fontFamily:bK,smoothLineScroll:v.boolean(),alwaysShowDecimalPlaces:v.boolean(),alwaysShowWordsHistory:v.boolean(),singleListCommandLine:zU,capsLockWarning:v.boolean(),playSoundOnError:HU,playSoundOnClick:UU,soundVolume:KU,startGraphsAtZero:v.boolean(),showOutOfFocusWarning:v.boolean(),paceCaret:VU,paceCaretCustomSpeed:mK,repeatedPace:v.boolean(),accountChart:GU,minWpm:QU,minWpmCustomSpeed:fK,highlightMode:YU,tapeMode:JU,typingSpeedUnit:XU,ads:eK,hideExtraLetters:v.boolean(),strictSpace:v.boolean(),minAcc:tK,minAccCustom:hK,monkey:v.boolean(),repeatQuotes:aK,oppositeShiftMode:sK,customBackground:CK,customBackgroundSize:nK,customBackgroundFilter:iK,customLayoutfluid:rK,monkeyPowerLevel:oK,minBurst:dK,minBurstCustomSpeed:gK,burstHeatmap:v.boolean(),britishEnglish:v.boolean(),lazyMode:v.boolean(),showAverage:lK,maxLineWidth:xK}).strict();SK.partial();var lC={a:["а","à","á","ạ","ą"],c:["с","ƈ","ċ"],d:["ԁ","ɗ"],e:["е","ẹ","ė","ė","é","è"],g:["ġ"],h:["һ"],i:["і","í","ì","ï"],j:["ј","ʝ"],k:["κ"],l:["ӏ","ḷ"],n:["ո"],o:["о","ο","օ","ȯ","ọ","ỏ","ơ","ö","ó","ò"],p:["р"],q:["զ"],s:["ʂ"],u:["υ","ս","ü","ú","ù"],v:["ν","ѵ"],x:["х","ҳ"],y:["у","ý"],z:["ʐ","ż"]};function TK(t){for(let e in lC)lC[e].forEach(a=>{t=t.replace(a,e)});return t}function $K(t,e){let a=t.toLowerCase().split(/[.,"/#!?$%^&*;:{}=\-_`~()\s\n]+/g).map(s=>TK(AK(s)??""));return LK.some(s=>a.some(n=>n.startsWith(s)))}function AK(t){return t===void 0||t===""?t:t.replace(/[\u0300-\u036F]/g,"").trim().replace(/\n{3,}/g,`

`).replace(/\s{3,}/g,"  ")}function MK(t,e){return e.refine(a=>!$K(a),a=>({message:`Profanity detected. Please remove it. If you believe this is a mistake, please contact us. (${a})`}))}var LK=["miodec","bitly","niqqa","niqqer","ni99a","ni99er","niggas","niga","niger","retard","ahole","anus","ash0le","asholes","assh0le","assh0lez","asshole","assholes","assholz","asswipe","azzhole","bassterds","bastard","bastards","bastardz","basterds","basterdz","biatch","bitch","bitches","blow job","boffing","butthole","buttwipe","c0ck","c0cks","c0k","carpet muncher","cawk","cawks","clit","cnts","cntz","cock","cockhead","cock-head","cocks","cocksucker","cock-sucker","crap","cum","cunt","cunts","cuntz","dick","dild0","dild0s","dildo","dildos","dilld0","dilld0s","dominatricks","dominatrics","dominatrix","dyke","enema","f u c k","f u c k e r","fag","fag1t","faget","fagg1t","faggit","faggot","fagit","fags","fagz","faigs","flipping the bird","fudge packer","fukah","fuken","fuker","fukin","fukk","fukkah","fukken","fukker","fukkin","g00k","gayboy","gaygirl","gayz","god-damned","h00r","h0ar","h0re","jackoff","japs","jerk-off","jisim","jiss","jizm","jizz","knob","knobs","knobz","kunt","kunts","kuntz","lezzian","lipshits","lipshitz","masochist","masokist","massterbait","masstrbait","masstrbate","masterbaiter","masterbate","masterbates","n1gr","nastt","nigger;","nigur;","niiger;","niigr;","orafis","orgasim;","orgasm","orgasum","oriface","orifice","orifiss","peeenus","peeenusss","peenus","peinus","pen1s","penas","penis","penis-breath","penus","penuus","phuc","phuck","phuk","phuker","phukker","poonani","pr1c","pr1ck","pr1k","puss","pussee","pussy","puuke","puuker","qweers","qweerz","qweir","recktum","rectum","retard","sadist","scank","schlong","semen","sex","sexy","sh!t","sh1t","sh1ter","sh1ts","sh1tter","sh1tz","shit","shits","shitter","shitty","shity","shitz","shyt","shyte","shytty","shyty","skanck","skank","skankee","skankey","skanks","skanky","slut","sluts","slutty","slutz","son-of-a-bitch","turd","va1jina","vag1na","vagiina","vagina","vaj1na","vajina","vullva","vulva","wh00r","wh0re","whore","xrated","b!+ch","bitch","blowjob","clit","arschloch","shit","asshole","b!tch","b17ch","b1tch","bastard","bi+ch","boiolas","buceta","c0ck","cawk","chink","cipa","clits","cum","cunt","dildo","dirsa","ejakulate","fatass","fcuk","fux0r","hoer","hore","jism","kawk","l3itch","l3i+ch","masturbate","masterbat","masterbat3","motherfucker","s.o.b.","mofo","nazi","nigga","nigger","nutsack","phuck","pimpis","pusse","pussy","scrotum","sh!t","shemale","shi+","sh!+","slut","smut","teets","tits","boobs","b00bs","teez","testical","testicle","titt","w00se","jackoff","wank","whoar","whore","dyke","fuck","shit","amcik","andskota","arse","assrammer","ayir","bi7ch","bitch","bollock","breasts","butt-pirate","cabron","cazzo","chraa","chuj","cunt","daygo","dego","dick","dike","dupa","dziwka","ejackulate","ekrem","enculer","fag","fanculo","fanny","feces","felcher","ficken","flikker","foreskin","fotze","futkretzn","gook","guiena","h4x0r","helvete","hoer","honkey","huevon","injun","jizz","kanker","klootzak","kraut","knulle","kuksuger","kurac","kurwa","kusi","kyrpa","lesbo","mamhoon","masturbat","merd","mibun","monkleigh","mouliewop","muie","mulkku","muschi","nazis","nepesaurio","nigger","orospu","paska","perse","picka","pierdol","pillu","pimmel","piss","pizda","poontsee","porn","p0rn","pr0n","preteen","pula","pule","puta","puto","qahbeh","queef","rautenberg","schaffer","scheiss","schlampe","schmuck","sh!t","sharmuta","sharmute","skurwysyn","sphencter","spierdalaj","splooge","suka","b00b","testicle","titt","twat","vittu","wank","wetback","wichser","zabourah"],AE=v.object({_id:kv,name:v.string().regex(/^[0-9a-zA-Z_.-]+$/).max(16),pb:v.object({no:v.boolean(),yes:v.boolean()}).strict(),difficulty:v.record(h_,v.boolean()),mode:v.record(g_,v.boolean()),words:v.record(SU.or(v.literal("custom")),v.boolean()),time:v.record(TU.or(v.literal("custom")),v.boolean()),quoteLength:v.record($U,v.boolean()),punctuation:v.object({on:v.boolean(),off:v.boolean()}).strict(),numbers:v.object({on:v.boolean(),off:v.boolean()}).strict(),date:v.object({last_day:v.boolean(),last_week:v.boolean(),last_month:v.boolean(),last_3months:v.boolean(),all:v.boolean()}).strict(),tags:v.record(v.string(),v.boolean()),language:v.record(td,v.boolean()),funbox:v.record(v.string(),v.boolean())}),EK=v.number().int().min(-11).max(12),IK=v.object({lastResultTimestamp:v.number().int().nonnegative(),length:v.number().int().nonnegative(),maxLength:v.number().int().nonnegative(),hourOffset:EK.optional()}).strict(),OK=v.object({_id:kv,name:v.string(),personalBests:_v}).strict();function su(t){return MK("word",t).optional().transform(e=>e===null?void 0:e)}var ME=v.object({bio:su(v.string().max(250)).or(v.literal("")),keyboard:su(v.string().max(75)).or(v.literal("")),socialProfiles:v.object({twitter:su(v.string().max(20).regex(/^[0-9a-zA-Z_.-]+$/)).or(v.literal("")),github:su(v.string().max(39).regex(/^[0-9a-zA-Z_.-]+$/)).or(v.literal("")),website:su(v.string().url().max(200).startsWith("https://")).or(v.literal(""))}).strict().optional()}).strict(),PK=v.string().regex(/^[0-9a-zA-Z_-]+$/).max(16),ZK=v.object({_id:kv,name:PK,colors:$E}).strict(),RK=v.object({startTimestamp:v.number().int().nonnegative(),expirationTimestamp:v.number().int().nonnegative().or(v.literal(-1).describe("lifetime premium"))}),NK=v.record(td,v.record(To.describe("quoteId as string"),v.number().nonnegative())),DK=v.record(g_,v.record(TE,v.record(td,v.number().int().nonnegative()))),jK=v.object({rank:v.number().int().nonnegative().optional(),count:v.number().int().nonnegative()}),BK=v.object({time:v.record(TE,v.record(td,jK.optional()))}),LE=v.object({id:v.number().int().nonnegative(),selected:v.boolean().optional()}).strict(),qK=v.object({badges:v.array(LE)}).strict(),WK=v.boolean().describe("Admin for all languages if true").or(td.describe("Admin for the given language")),FK=v.object({testsByDays:v.array(v.number().int().nonnegative().or(v.null())).describe("Number of tests by day. Last element of the array is on the date `lastDay`. `null` means no tests on that day."),lastDay:v.number().int().nonnegative().describe("Timestamp of the last day included in the test activity")}).strict();v.record(To.describe("year"),v.array(v.number().int().nonnegative().nullable().describe("number of tests, position in the array is the day of the year")));var zK=v.record(td,v.array(To)),HK=v.object({name:v.string(),email:v.string().email(),uid:v.string(),addedAt:v.number().int().nonnegative(),personalBests:_v,lastReultHashes:v.array(v.string()).optional(),completedTests:v.number().int().nonnegative().optional(),startedTests:v.number().int().nonnegative().optional(),timeTyping:v.number().nonnegative().optional().describe("time typing in seconds"),streak:IK.optional(),xp:v.number().int().nonnegative().optional(),discordId:v.string().optional(),discordAvatar:v.string().optional(),tags:v.array(OK).optional(),profileDetails:ME.optional(),customThemes:v.array(ZK).optional(),premium:RK.optional(),isPremium:v.boolean().optional(),quoteRatings:NK.optional(),favoriteQuotes:zK.optional(),lbMemory:DK.optional(),allTimeLbs:BK,inventory:qK.optional(),banned:v.boolean().optional(),lbOptOut:v.boolean().optional(),verified:v.boolean().optional(),needsToChangeName:v.boolean().optional(),quoteMod:WK.optional(),resultFilterPresets:v.array(AE).optional(),testActivity:FK.optional()});v.string().regex(/^[0-9a-zA-Z_.-]+$/).max(16);var UK=v.object({completedTests:v.number().int().nonnegative().optional(),startedTests:v.number().int().nonnegative().optional(),timeTyping:v.number().int().nonnegative().optional()});HK.pick({uid:!0,name:!0,banned:!0,addedAt:!0,discordId:!0,discordAvatar:!0,xp:!0,lbOptOut:!0,isPremium:!0,inventory:!0,allTimeLbs:!0}).extend({typingStats:UK,personalBests:_v.pick({time:!0,words:!0}),streak:v.number().int().nonnegative(),maxStreak:v.number().int().nonnegative(),details:ME}).partial({inventory:!0,details:!0,allTimeLbs:!0,uid:!0});var EE=v.enum(["xp","badge"]),KK=v.object({type:v.literal(EE.enum.xp),item:v.number().int()}),VK=v.object({type:v.literal(EE.enum.badge),item:LE}),GK=KK.or(VK);v.object({id:kv,subject:v.string(),body:v.string(),timestamp:v.number().int().nonnegative(),read:v.boolean(),rewards:v.array(GK)});v.enum(["Inappropriate name","Inappropriate bio","Inappropriate social links","Suspected cheating"]);const QK={_id:"default",name:"defaults",pb:{no:!0,yes:!0},difficulty:{normal:!0,expert:!0,master:!0},mode:{words:!0,time:!0,quote:!0,zen:!0,custom:!0},words:{10:!0,25:!0,50:!0,100:!0,custom:!0},time:{15:!0,30:!0,60:!0,120:!0,custom:!0},quoteLength:{short:!0,medium:!0,long:!0,thicc:!0},punctuation:{on:!0,off:!0},numbers:{on:!0,off:!0},date:{last_day:!1,last_week:!1,last_month:!1,last_3months:!1,all:!0},tags:{none:!0},language:{},funbox:{none:!0}},Pa=yn(QK);function YK(t){try{const e={};for(const a of Ti(Pa))if(a==="_id"){let s=t[a]??Pa[a];(s==="default-result-filters-id"||s==="")&&(s="default"),e[a]=s}else a==="name"?e[a]=t[a]??Pa[a]:e[a]={...Pa[a],...t[a]};return e}catch{return Pa}}const IE=new Ts({key:"resultFilters",schema:AE,fallback:Pa,migrate:(t,e)=>oS(t)?YK(t):Pa}),JK=["language","funbox","tags"],Yu={};let He=Pa;function Bi(){IE.set(He)}async function XK(){try{He=IE.get();const t={none:!1};Object.keys(Pa.tags).forEach(e=>{He.tags[e]!==void 0?t[e]=He.tags[e]:t[e]=!0}),He.tags=t,Bi()}catch{console.log("error in loading result filters"),He=Pa,Bi()}}async function y_(){var s;const t=document.querySelector(".pageAccount .presetFilterButtons"),e=document.querySelector(".pageAccount .presetFilterButtons .filterBtns");if(!t||!e)return;e.innerHTML="";const a=((s=T())==null?void 0:s.filterPresets.map(n=>(n.name=n.name.replace(/_/g," "),n)))??[];if(a.length>0){let n="";for(const i of a)n+=`<div class="filterPresets">
      <div class="select-filter-preset button" data-id="${i._id}">${i.name} </div>
      <div class="button delete-filter-preset" data-id="${i._id}">
        <i class="fas fa-fw fa-trash"></i>
      </div>
    </div>`;e.innerHTML=n,t.classList.remove("hidden")}else t.classList.add("hidden")}async function eV(t){var a;const e=(a=T())==null?void 0:a.filterPresets.find(s=>s._id===t);e&&(He=uV(e),Bi(),Fi()),o(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active"),o(`.pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset[data-id=${t}]`).addClass("active")}function tV(t){const e=T();e&&Aa({...e,filterPresets:[...e.filterPresets,yn(t)]})}async function aV(t){t=t.replace(/ /g,"_"),ht();const e=await F.users.addResultFilterPreset({body:{...He,name:t}});We(),e.status===200?(tV({...He,name:t,_id:e.body.data}),y_(),g("Filter preset created",1)):(g("Error creating filter preset: "+e.body.message,-1),console.log("error creating filter preset: "+e.body.message))}function sV(t){const e=T();if(!e)return;const a=[...e.filterPresets],s=a.findIndex(n=>n._id===t);s>-1&&a.splice(s,1),Aa({...e,filterPresets:a})}async function nV(t){ht();const e=await F.users.removeResultFilterPreset({params:{presetId:t}});We(),e.status===200?(sV(t),y_(),b_(),g("Filter preset deleted",1)):(g("Error deleting filter preset: "+e.body.message,-1),console.log("error deleting filter preset",e.body.message))}function v_(){o(".pageAccount .group.presetFilterButtons .filterBtns .filterPresets .select-filter-preset").removeClass("active")}function wl(){return He}function l0(t){return He[t]}function sa(t,e){return He[t][e]}function iV(t,e,a){He[t][e]=a}function qn(t,e){Object.keys(l0(t)).forEach(a=>{He[t][a]=e})}function rV(t){t.forEach(e=>{Pa.tags[e._id]=!0})}function b_(){He=Pa,Bi()}function Fi(){var s,n,i,r,d;const t={};for(const u of Ti(wl()))if(!(u==="_id"||u==="name")){t[u]={all:!0,array:[]};for(const c of Ti(l0(u))){const m=t[u];if(m===void 0)continue;const f=sa(u,c);if(f===!0?(s=m.array)==null||s.push(c):m.all!==void 0&&(m.all=!1),JK.includes(u)){const h=o(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] option[value="${c}"]`);f===!0?h.prop("selected",!0):h.prop("selected",!1)}else{let h;u==="date"?h=o(`.pageAccount .group.topFilters .filterGroup[group="${u}"] button[filter="${c}"]`):h=o(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] button[filter="${c}"]`),f===!0?h.addClass("active"):h.removeClass("active")}}}for(const[u,c]of Object.entries(Yu)){const m=c,f=l0(u),h=Object.values(f).every(w=>w===!0),y=m.store.getData(),b=o(`.pageAccount .group.filterButtons .filterGroup[group="${u}"] option[value="all"]`);if(h){b.prop("selected",!0);for(const w of y)"value"in w&&(w.value==="all"?w.selected=!0:w.selected=!1);m.store.setData(y),m.render.renderValues()}else b.prop("selected",!1);for(const w of y)"value"in w&&(f[w.value]===!0?w.selected=!0:(!h||w.value!=="all")&&(w.selected=!1));setTimeout(()=>{m.store.setData(y),h||m.render.renderValues(),m.render.renderOptions(y)},0)}function e(u){var m,f,h,y,b;let c="";return c+="<div class='group'>",u==="difficulty"?c+='<span aria-label="Difficulty" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i>':u==="mode"?c+='<span aria-label="Mode" data-balloon-pos="up"><i class="fas fa-fw fa-bars"></i>':u==="punctuation"?c+='<span aria-label="Punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i>':u==="numbers"?c+='<span aria-label="Numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i>':u==="words"?c+='<span aria-label="Words" data-balloon-pos="up"><i class="fas fa-fw fa-font"></i>':u==="time"?c+='<span aria-label="Time" data-balloon-pos="up"><i class="fas fa-fw fa-clock"></i>':u==="date"?c+='<span aria-label="Date" data-balloon-pos="up"><i class="fas fa-fw fa-calendar"></i>':u==="tags"?c+='<span aria-label="Tags" data-balloon-pos="up"><i class="fas fa-fw fa-tags"></i>':u==="language"?c+='<span aria-label="Language" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i>':u==="funbox"&&(c+='<span aria-label="Funbox" data-balloon-pos="up"><i class="fas fa-fw fa-gamepad"></i>'),(m=t[u])!=null&&m.all?c+="all":u==="tags"?c+=(h=(f=t.tags)==null?void 0:f.array)==null?void 0:h.map(w=>{var L,be,J;if(w==="none")return w;const $=T();if($===void 0)return w;const E=(L=$.tags)==null?void 0:L.filter(k=>k._id===w)[0];return E!==void 0?(J=(be=$.tags)==null?void 0:be.filter(k=>k._id===w)[0])==null?void 0:J.display:E}).join(", "):c+=(b=(y=t[u])==null?void 0:y.array)==null?void 0:b.join(", ").replace(/_/g," "),c+="</span></div>",c}let a="";a+=e("date"),a+='<div class="spacer"></div>',a+=e("mode"),a+='<div class="spacer"></div>',(i=(n=t.mode)==null?void 0:n.array)!=null&&i.includes("time")&&(a+=e("time"),a+='<div class="spacer"></div>'),(d=(r=t.mode)==null?void 0:r.array)!=null&&d.includes("words")&&(a+=e("words"),a+='<div class="spacer"></div>'),a+=e("difficulty"),a+='<div class="spacer"></div>',a+=e("punctuation"),a+='<div class="spacer"></div>',a+=e("numbers"),a+='<div class="spacer"></div>',a+=e("language"),a+='<div class="spacer"></div>',a+=e("funbox"),a+='<div class="spacer"></div>',a+=e("tags"),setTimeout(()=>{o(".pageAccount .group.chart .above").html(a)},0)}function oV(t,e){v_();try{t==="date"&&qn("date",!1);const s=!He[t][e];He[t][e]=s,Bi()}catch(a){g("Something went wrong toggling filter. Reverting to defaults.",0),console.log("toggling filter error"),console.error(a),b_(),Fi()}}o(".pageAccount .filterButtons .buttonsAndTitle .buttons, .pageAccount .group.topFilters .buttonsAndTitle.testDate .buttons").on("click","button",t=>{const e=o(t.target).parents(".buttons").attr("group"),a=o(t.target).attr("filter");o(t.target).hasClass("allFilters")?(Ti(wl()).forEach(s=>{s==="_id"||s==="name"||qn(s,!0)}),qn("date",!1),He.date.all=!0):o(t.target).hasClass("noFilters")?Ti(wl()).forEach(s=>{s==="_id"||s==="name"||s!=="date"&&qn(s,!1)}):o(t.target).is("button")&&(t.shiftKey?(qn(e,!1),He[e][a]=!0):oV(e,a)),Fi(),Bi()});o(".pageAccount .topFilters button.allFilters").on("click",()=>{v_(),console.log(wl()),Ti(wl()).forEach(t=>{t==="_id"||t==="name"||qn(t,!0)}),qn("date",!1),He.date.all=!0,Fi(),Bi()});o(".pageAccount .topFilters button.currentConfigFilter").on("click",()=>{var t,e;if(v_(),Ti(wl()).forEach(a=>{a==="_id"||a==="name"||qn(a,!1)}),He.pb.no=!0,He.pb.yes=!0,He.difficulty[l.difficulty]=!0,He.mode[l.mode]=!0,l.mode==="time")if([15,30,60,120].includes(l.time)){const a=`${l.time}`;He.time[a]=!0}else He.time.custom=!0;else if(l.mode==="words")if([10,25,50,100,200].includes(l.words)){const a=`${l.words}`;He.words[a]=!0}else He.words.custom=!0;else l.mode==="quote"&&["short","medium","long","thicc"].forEach((s,n)=>{l.quoteLength.includes(n)?He.quoteLength[s]=!0:He.quoteLength[s]=!1});if(l.punctuation?He.punctuation.on=!0:He.punctuation.off=!0,l.numbers?He.numbers.on=!0:He.numbers.off=!0,l.mode==="quote"&&/english.*/.test(l.language)?He.language.english=!0:He.language[l.language]=!0,l.funbox==="none")He.funbox.none=!0;else for(const a of l.funbox.split("#"))He.funbox[a]=!0;He.tags.none=!0,(e=(t=T())==null?void 0:t.tags)==null||e.forEach(a=>{a.active===!0&&(He.tags.none=!1,He.tags[a._id]=!0)}),He.date.all=!0,Fi(),Bi()});o(".pageAccount .topFilters button.toggleAdvancedFilters").on("click",()=>{o(".pageAccount .filterButtons").slideToggle(250),o(".pageAccount .topFilters button.toggleAdvancedFilters").toggleClass("active")});function rb(t,e=0){const a=Yu[t];if(a===void 0)return;const s=a.render.content.list,n=s.children.item(e);s.scrollTop=n.offsetTop-s.offsetTop}function ob(t,e,a){const s=e.some(i=>i.value==="all"),n=a.some(i=>i.value==="all");s?n?e.length<a.length&&(e=e.filter(i=>i.value!=="all")):e=e.filter(i=>i.value==="all"):n&&(e=[]),qn(t,!1);for(const i of e){if(i.value==="all"){qn(t,!0);break}iV(t,i.value,!0)}return Fi(),Bi(),OE(),!1}let OE=()=>{};async function dV(t){var n;OE=t;let e;try{e=await sk()}catch(i){console.error(qe(i,"Failed to append language buttons"))}if(e){let i="";i+="<select class='languageSelect' group='language' placeholder='select a language' multiple>",i+="<option value='all'>all</option>";for(const d of e)i+=`<option value="${d}" filter="${d}">${Ar(d)}</option>`;i+="</select>";const r=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.languages .select");r&&(r.innerHTML=i,Yu.language=new ya({select:r.querySelector(".languageSelect"),settings:{showSearch:!0,placeholderText:"select a language",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(d,u)=>ob("language",d,u),beforeOpen:()=>{rb("language")}}}))}let a;try{a=await Ol()}catch(i){console.error(qe(i,"Failed to append funbox buttons"))}if(a){let i="";i+="<select class='funboxSelect' group='funbox' placeholder='select a funbox' multiple>",i+="<option value='all'>all</option>",i+="<option value='none'>no funbox</option>";for(const d of a)i+=`<option value="${d.name}" filter="${d.name}">${d.name.replace(/_/g," ")}</option>`;i+="</select>";const r=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.funbox .select");r&&(r.innerHTML=i,Yu.funbox=new ya({select:r.querySelector(".funboxSelect"),settings:{showSearch:!0,placeholderText:"select a funbox",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(d,u)=>ob("funbox",d,u),beforeOpen:()=>{rb("funbox")}}}))}const s=T();if(s!==void 0&&(((n=s.tags)==null?void 0:n.length)??0)>0){o(".pageAccount .content .filterButtons .buttonsAndTitle.tags").removeClass("hidden");let i="";i+="<select class='tagsSelect' group='tags' placeholder='select a tag' multiple>",i+="<option value='all'>all</option>",i+="<option value='none'>no tag</option>";for(const d of s.tags)i+=`<option value="${d._id}" filter="${d.name}">${d.display}</option>`;i+="</select>";const r=document.querySelector(".pageAccount .content .filterButtons .buttonsAndTitle.tags .select");r&&(r.innerHTML=i,Yu.tags=new ya({select:r.querySelector(".tagsSelect"),settings:{showSearch:!0,placeholderText:"select a tag",allowDeselect:!0,closeOnSelect:!1},events:{beforeChange:(d,u)=>ob("tags",d,u),beforeOpen:()=>{rb("tags")}}}))}else o(".pageAccount .content .filterButtons .buttonsAndTitle.tags").addClass("hidden");y_()}function lV(){o(".pageAccount .content .filterButtons .buttonsAndTitle.languages .buttons").empty(),o(".pageAccount .content .filterButtons .buttonsAndTitle.funbox .buttons").empty(),o(".pageAccount .content .filterButtons .buttonsAndTitle.tags .buttons").empty()}o(".group.presetFilterButtons .filterBtns").on("click",".filterPresets .delete-filter-preset",t=>{nV(o(t.currentTarget).data("id"))});function uV(t){const e=yn(t);return Object.entries(Pa).forEach(a=>{const s=a[0],n=a[1];e[s]===void 0&&(e[s]=n)}),e}function cV(t){let e=[];for(let i=1;i<=t.wpm.length;i++)e.push(i.toString());t.wpm=t.wpm.slice(0,t.raw.length),t.err=t.err.slice(0,t.raw.length),e=e.slice(0,t.raw.length);const a=cS(t.raw,1);Ls.data.labels=e,Ls.getDataset("wpm").data=t.wpm,Ls.getDataset("raw").data=a,Ls.getDataset("error").data=t.err;const s=Math.max(Math.max(...t.wpm),Math.max(...t.raw)),n=Math.min(Math.min(...t.wpm),Math.min(...t.raw));Ls.getScale("wpm").max=Math.round(s),Ls.getScale("raw").max=Math.round(s),l.startGraphsAtZero?(Ls.getScale("wpm").min=0,Ls.getScale("raw").min=0):(Ls.getScale("wpm").min=Math.round(n),Ls.getScale("raw").min=Math.round(n)),Ls.updateColors()}function pV(t){cV(t),mV.show()}const mV=new Ct({dialogId:"miniResultChartModal"});function fV(t){const e=t?"Profile":"Account",s=t?"":`<div class="buttonGroup"><button
  class="showAllButton"
  data-balloon-pos="left"
  aria-label="Show all personal bests"
>
  <i class="fas fa-ellipsis-v"></i>
</button></div>`;o(`.page${e} .profile .pbsWords`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">10 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">25 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">50 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">100 words</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${s}
  `),o(`.page${e} .profile .pbsTime`).html(`
      <div class="group">
      <div class="quick">
        <div class="test">15 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">30 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">60 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    <div class="group">
      <div class="quick">
        <div class="test">120 seconds</div>
        <div class="wpm">-</div>
        <div class="acc">-</div>
      </div>
    </div>
    ${s}
  `)}function u0(t,e=!1){if(fV(e),t===void 0)return;let a="";const s=e?"Profile":"Account";o(`.page${s} .profile .pbsTime`).html(""),o(`.page${s} .profile .pbsWords`).html("");const n=["15","30","60","120"],i=["10","25","50","100"];n.forEach(d=>{a+=uC(t,"time",d)});const r=e?"":`<div class="buttonGroup"><button
      class="showAllButton"
      data-balloon-pos="left"
      aria-label="Show all personal bests"
    >
      <i class="fas fa-ellipsis-v"></i>
    </button></div>`;o(`.page${s} .profile .pbsTime`).append(a+r),a="",i.forEach(d=>{a+=uC(t,"words",d)}),o(`.page${s} .profile .pbsWords`).append(a+r)}function uC(t,e,a){let s="",n="";const i=`${a} ${e==="time"?"seconds":"words"}`,r=l.typingSpeedUnit;try{const d=(t[e][a]??[]).sort((c,m)=>m.wpm-c.wpm)[0];if(d===void 0)throw new Error("No PB data found");const u=new Date(d.timestamp);d.timestamp!==void 0&&d.timestamp>0&&(n=Ot(u,"dd MMM yyyy")),s=`<div class="quick">
      <div class="test">${i}</div>
      <div class="wpm">${ve.typingSpeed(d.wpm,{showDecimalPlaces:!1})}</div>
      <div class="acc">${ve.accuracy(d.acc,{showDecimalPlaces:!1})}</div>
    </div>
    <div class="fullTest">
      <div>${i}</div>
      <div>${ve.typingSpeed(d.wpm,{suffix:` ${r}`})}</div>
      <div>${ve.typingSpeed(d.raw,{suffix:" raw"})}</div>
      <div>${ve.accuracy(d.acc,{suffix:" acc"})}</div>
      <div>${ve.percentage(d.consistency,{suffix:" con"})}</div>
      <div>${n}</div>
    </div>`}catch{s=`<div class="quick">
    <div class="test">${i}</div>
    <div class="wpm">-</div>
    <div class="acc">-</div>
  </div>`}return`
  <div class="group">
  ${s}
  </div>
  `}function ah(t=0){let e=t*36e5,a=Date.now();return bm(a,e)}function bm(t,e=0){return t-(t-e)%864e5}function hV(t,e=0){let a=e*36e5,s=bm(Date.now()-864e5,a),n=bm(t,a);return s===n}function gV(t,e=0){let a=e*36e5,s=bm(Date.now(),a),n=bm(t,a);return s===n}const PE={1:{id:1,name:"Developer",description:"I made this",icon:"fa-laptop",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},2:{id:2,name:"Collaborator",description:"I helped make this",icon:"fa-code",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},3:{id:3,name:"Server Mod",description:"Discord server moderator",icon:"fa-hammer",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},4:{id:4,name:"OG Account",description:"First 1000 users on the site",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},5:{id:5,name:"OG Discordian",description:"First 1000 Discord server members",icon:"fa-baby",color:"var(--bg-color)",background:"var(--main-color)"},6:{id:6,name:"Supporter",description:"Donated money",icon:"fa-heart",color:"var(--text-color)",background:"var(--sub-color)"},7:{id:7,name:"Sugar Daddy",description:"Donated a lot of money",icon:"fa-gem",color:"var(--bg-color)",background:"var(--main-color)"},8:{id:8,name:"Monkey Supporter",description:"Donated more money",icon:"fa-heart",color:"var(--bg-color)",background:"var(--main-color)"},9:{id:9,name:"White Hat",description:"Reported critical vulnerabilities on the site",icon:"fa-user-secret",color:"var(--bg-color)",background:"var(--main-color)"},10:{id:10,name:"Bug Hunter",description:"Reported or helped track down bugs on the site",icon:"fa-bug",color:"var(--text-color)",background:"var(--sub-color)"},11:{id:11,name:"Content Creator",description:"Verified content creator",icon:"fa-video",color:"var(--text-color)",background:"var(--sub-color)"},12:{id:12,name:"Contributor",description:"Contributed to the site",icon:"fa-hands-helping",color:"var(--text-color)",background:"var(--sub-color)"},13:{id:13,name:"Mythical",description:"Yes, I'm actually this fast",icon:"fa-rocket",color:"white",customStyle:"animation: rgb-bg 10s linear infinite;"},14:{id:14,name:"All Year Long",description:"Reached a streak of 365 days",icon:"fa-fire",color:"var(--bg-color)",background:"var(--main-color)"}};function yy(t,e=!1,a=!1,s=!1){const n=PE[t];if(!n&&!s)return"";let i="";(n==null?void 0:n.background)!==void 0&&(i+=`background: ${n.background};`),(n==null?void 0:n.color)!==void 0&&(i+=`color: ${n.color};`),(n==null?void 0:n.customStyle)!==void 0&&(i+=n.customStyle);const r=(n==null?void 0:n.name)??"Badge Name Missing",d=(n==null?void 0:n.description)??"Badge Description Missing",u=(e?r+": ":"")+d;let c="";a||(c=`aria-label="${u}" data-balloon-pos="right"`);let m="";(n==null?void 0:n.icon)!==void 0?m=`<i class="fas ${e?"fa-fw":""} ${n.icon}"></i>`:m='<i class="fas fa-question"></i>';const f=`<div class="text">${r}</div>`;return`<div class="badge" ${c} style="${i}">${m}${e?"":f}</div>`}function yV(t){return PE[t]}async function vy(t,e){var L,be,J,k,S,z,Ee,ca,aa,ma,La,Tn,Ev,sd,Wl,Fl,zl,Lf,Hl,Xr,ui,Ef,nd,Ul,Kl;const a=t.charAt(0).toUpperCase()+t.slice(1),s=o(`.page${a} .profile`),n=o(`.page${a} .profile .details`);s.attr("uid",e.uid??""),s.attr("name",e.name??"");const i=e.banned===!0;if(n===void 0||e===void 0||e.name===void 0||e.addedAt===void 0)return;if(n.find(".placeholderAvatar").removeClass("hidden"),e.discordAvatar!==void 0&&e.discordId!==void 0&&!i?P0(e.discordId,e.discordAvatar,256).then(Wt=>{Wt!==null&&(n.find(".placeholderAvatar").addClass("hidden"),n.find(".avatar").css("background-image",`url(${Wt})`))}):n.find(".avatar").removeAttr("style"),(L=e.inventory)!=null&&L.badges&&!i){let Wt="",x="";for(const ot of e.inventory.badges)ot.selected===!0?Wt=yy(ot.id):x+=yy(ot.id,!0);n.find(".badges").empty().append(Wt),n.find(".allBadges").empty().append(x)}n.find(".name").text(e.name),n.find(".userFlags").html(Jy(e)),e.lbOptOut===!0&&(t==="profile"?s.find(".lbOptOutReminder").removeClass("hidden").text("Note: This account has opted out of the leaderboards, meaning their results aren't verified by the anticheat system and may not be legitimate."):s.find(".lbOptOutReminder").addClass("hidden")),setTimeout(()=>{w_(t)},10);const r="Joined "+Ot(e.addedAt??0,"dd MMM yyyy"),d=new Date(e.addedAt),u=Sd(new Date,d),c=`${u} day${u!==1?"s":""} ago`;n.find(".joined").text(r).attr("aria-label",c);let m="";if(e.streak&&(e==null?void 0:e.streak)>1?(n.find(".streak").text(`Current streak: ${e.streak} ${e.streak===1?"day":"days"}`),m=`Longest streak: ${e.maxStreak} ${e.maxStreak===1?"day":"days"}`):(n.find(".streak").text(""),m=""),t==="account"){const Wt=(be=T())==null?void 0:be.results,x=Wt==null?void 0:Wt[0],ot=e.streakHourOffset,At=1e3*60*60*24;let hs=ah(ot)+At;hs<Date.now()&&(hs+=At);const Ks=mS(hs);if(console.debug("Streak hour offset"),console.debug("date.now()",Date.now(),new Date(Date.now())),console.debug("dayInMilis",At),console.debug("difTarget",new Date(ah(ot)+At)),console.debug("timeDif",Ks),console.debug("DateTime.getCurrentDayTimestamp()",ah(),new Date(ah())),console.debug("profile.streakHourOffset",ot),x!==void 0){const ci=gV(x.timestamp,ot),Mt=hV(x.timestamp,ot);console.debug("lastResult.timestamp",x.timestamp,new Date(x.timestamp)),console.debug("isToday",ci),console.debug("isYesterday",Mt);const gs=ot?`(${ot>0?"+":""}${ot} offset)`:"";ci?(m+=`
Claimed today: yes`,m+=`
Come back in: ${Ks} ${gs}`):Mt?(m+=`
Claimed today: no`,m+=`
Streak lost in: ${Ks} ${gs}`):(m+=`
Streak lost ${Ks} ${gs} ago`,m+=`
It will be removed from your profile on the next result save`),console.debug(m),ot===void 0&&(m+=`

If the streak reset time doesn't line up with your timezone, you can change it in Settings > Danger zone > Update streak hour offset.`)}}n.find(".streak").attr("aria-label",m).attr("data-balloon-break","");let f="",h="";e.typingStats.completedTests!==void 0&&e.typingStats.startedTests!==void 0&&(f=Math.floor(e.typingStats.completedTests/e.typingStats.startedTests*100).toString(),h=((e.typingStats.startedTests-e.typingStats.completedTests)/e.typingStats.completedTests).toFixed(1));const y=n.find(".typingStats");y.find(".started .value").text(((J=e.typingStats)==null?void 0:J.startedTests)??0),y.find(".completed .value").text(((k=e.typingStats)==null?void 0:k.completedTests)??0).attr("data-balloon-pos","up").attr("aria-label",`${f}% (${h} restarts per completed test)`),y.find(".timeTyping .value").text(ts(Math.round(((S=e.typingStats)==null?void 0:S.timeTyping)??0),!0,!0));let b=!1,w=!1,$=!1;if(!i&&(b=!!(((z=e.details)==null?void 0:z.bio)??""),n.find(".bio .value").text(((Ee=e.details)==null?void 0:Ee.bio)??""),w=!!(((ca=e.details)==null?void 0:ca.keyboard)??""),n.find(".keyboard .value").text(((aa=e.details)==null?void 0:aa.keyboard)??""),((La=(ma=e.details)==null?void 0:ma.socialProfiles)==null?void 0:La.github)!==void 0||((Ev=(Tn=e.details)==null?void 0:Tn.socialProfiles)==null?void 0:Ev.twitter)!==void 0||((Wl=(sd=e.details)==null?void 0:sd.socialProfiles)==null?void 0:Wl.website)!==void 0)){$=!0;const Wt=n.find(".socials .value");Wt.empty();const x=((Fl=e.details)==null?void 0:Fl.socialProfiles.github)??"";x&&Wt.append(`<a href='https://github.com/${vs(x)}/' target="_blank" rel="nofollow me" aria-label="${vs(x)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-github"></i></a>`);const ot=((zl=e.details)==null?void 0:zl.socialProfiles.twitter)??"";ot&&Wt.append(`<a href='https://x.com/${vs(ot)}' target="_blank" rel="nofollow me" aria-label="${vs(ot)}" data-balloon-pos="up" class="textButton"><i class="fab fa-fw fa-twitter"></i></a>`);const At=((Lf=e.details)==null?void 0:Lf.socialProfiles.website)??"",hs=/^https?:\/\/(?:www\.)?([^/]+)/,Ks=((Hl=At==null?void 0:At.match(hs))==null?void 0:Hl[1])??At;At&&Wt.append(`<a href='${vs(At)}' target="_blank" rel="nofollow me" aria-label="${vs(Ks??"")}" data-balloon-pos="up" class="textButton"><i class="fas fa-fw fa-globe"></i></a>`)}if(ZE(e.xp??0),i)s.find(".leaderboardsPositions").addClass("hidden");else{s.find(".leaderboardsPositions").removeClass("hidden");const Wt=((Ef=(ui=(Xr=e.allTimeLbs)==null?void 0:Xr.time)==null?void 0:ui["15"])==null?void 0:Ef.english)??null,x=((Kl=(Ul=(nd=e.allTimeLbs)==null?void 0:nd.time)==null?void 0:Ul["60"])==null?void 0:Kl.english)??null;Wt===null&&x===null?s.find(".leaderboardsPositions").addClass("hidden"):(Wt!==null&&(s.find(".leaderboardsPositions .group.t15 .pos").text(ve.rank(Wt==null?void 0:Wt.rank)),s.find(".leaderboardsPositions .group.t15 .topPercentage").text(cC(Wt))),x!==null&&(s.find(".leaderboardsPositions .group.t60 .pos").text(ve.rank(x==null?void 0:x.rank)),s.find(".leaderboardsPositions .group.t60 .topPercentage").text(cC(x))))}const E=b||w;b?n.find(".bio").removeClass("hidden"):n.find(".bio").addClass("hidden"),w?n.find(".keyboard").removeClass("hidden"):n.find(".keyboard").addClass("hidden"),E?(n.find(".bioAndKeyboard").removeClass("hidden"),n.find(".sep2").removeClass("hidden")):(n.find(".bioAndKeyboard").addClass("hidden"),n.find(".sep2").addClass("hidden")),$?(n.find(".socials").removeClass("hidden"),n.find(".sep3").removeClass("hidden")):(n.find(".socials").addClass("hidden"),n.find(".sep3").addClass("hidden")),n.removeClass("none"),n.removeClass("bioAndKey"),n.removeClass("soc"),n.removeClass("both"),!$&&!E?n.addClass("none"):$&&!E?n.addClass("soc"):!$&&E?n.addClass("bioAndKey"):$&&E&&n.addClass("both")}function ZE(t){const e=o(" .profile .details .levelAndBar");if(e==null)return;const a=Dc(t),s=a.levelMaxXp,n=a.levelCurrentXp;e.find(".level").text(a.level).attr("aria-label",`${sh(t)} total xp`),e.find(".xp").text(`${sh(n)}/${sh(s)}`).attr("aria-label",`${sh(s-n)} xp until next level`),e.find(".xpBar .bar").css("width",`${n/s*100}%`),e.find(".xpBar").attr("aria-label",`${(n/s*100).toFixed(2)}%`)}function w_(t){if(/^((?!chrome|android).)*safari/i.test(navigator.userAgent))return;let a;if(t==="account"?a=o(".pageAccount .profile .details"):t==="profile"&&(a=o(".pageProfile .profile .details")),!a)return;const s=a.find(".user"),n=s.parent()[0],i=s[0],r=xr(2);if(!i||!n)return;i.style.fontSize="10px";const d=n.clientWidth,u=i.clientWidth,m=d/u*10,f=Math.min(Math.max(m,10),r);i.style.fontSize=`${f}px`}const vV=N0(1e3,()=>{const t=ft();t&&["account","profile"].includes(t)&&w_(t)});o(window).on("resize",()=>{vV()});function cC(t){return t.rank===void 0?"-":t.rank===1?"GOAT":"Top "+Oe(t.rank/t.count*100)+"%"}function sh(t){return t<1e3?Math.round(t).toString():F2(t)}let RE;function xv(){return RE}async function bV(){const t=await F.configuration.get();if(t.status!==200){console.error("Could not fetch configuration",t.body.message);return}else RE=t.body.data??void 0}function c0(){o(".pageAccount .resultBatches").addClass("hidden")}function wV(){o(".pageAccount .resultBatches").removeClass("hidden")}async function kV(){var m,f,h,y,b;const t=(m=T())==null?void 0:m.results;if(t===void 0){console.error("(Result batches) Results are missing but they should be available at the time of drawing the account page?"),c0();return}_V();const e=((h=(f=T())==null?void 0:f.typingStats)==null?void 0:h.completedTests)??0,a=Math.round(t.length/e*100),s=((y=xv())==null?void 0:y.results.limits)??{regularUser:0,premiumUser:0},n=(b=T())!=null&&b.isPremium?s.premiumUser:s.regularUser,i=Math.round((t==null?void 0:t.length)/n*100),r=o(".pageAccount .resultBatches .bars"),d={downloaded:{fill:r.find(".downloaded .fill"),rightText:r.find(".downloaded.rightText")},limit:{fill:r.find(".limit .fill"),rightText:r.find(".limit.rightText")}};d.downloaded.fill.css("width",Math.min(a,100)+"%"),d.downloaded.rightText.text(`${t==null?void 0:t.length} / ${e} (${a}%)`);const u=await Vr();d.limit.fill.css({width:Math.min(i,100)+"%",background:an(u.sub,u.error,Fh(i,50,100,0,1))}),d.limit.rightText.text(`${t==null?void 0:t.length} / ${n} (${i}%)`),o(".pageAccount .resultBatches > .text").text(""),t.length>=e&&(p0(),pC("all results loaded")),t.length>=n&&(p0(),pC("limit reached"))}function p0(){o(".pageAccount .resultBatches button").prop("disabled",!0)}function _V(){o(".pageAccount .resultBatches button").prop("disabled",!1)}function pC(t){o(".pageAccount .resultBatches button").text(t)}function xV(){var s,n,i,r;if(!(((s=T())==null?void 0:s.isPremium)??!1)){c0();return}const e=((i=(n=T())==null?void 0:n.typingStats)==null?void 0:i.completedTests)??0,a=((r=xv())==null?void 0:r.results.maxBatchSize)??0;if(e<=a){c0();return}wV()}let Ka;function CV(t,e){if(t===void 0){o("#testActivity").addClass("hidden");return}o("#testActivity").removeClass("hidden"),Ka=jE(),DE("current",(e==null?void 0:e.getFullYear())||2022),NE(t)}function NE(t){const e=document.querySelector("#testActivity .activity");if(e===null)return;if(e.innerHTML="",t===void 0){mC([]),o("#testActivity .nodata").removeClass("hidden");return}mC(t.getMonths()),o("#testActivity .nodata").addClass("hidden");const a=document.querySelector("#testActivity .title");a!==null&&(a.innerHTML=t.getTotalTests()+" tests");for(const s of t.getDays()){const n=document.createElement("div");n.setAttribute("data-level",s.level),s.label!==void 0&&(n.setAttribute("aria-label",s.label),n.setAttribute("data-balloon-pos","up")),e.appendChild(n)}}function DE(t,e){var i,r;const a=new Date().getFullYear(),s=[{text:"last 12 months",value:"current",selected:t==="current"}];for(let d=a;d>=e;d--)(s.length<2||(i=xv())!=null&&i.users.premium.enabled&&((r=T())!=null&&r.isPremium))&&s.push({text:d.toString(),value:d.toString(),selected:d===t});const n=jE();n.setData(s),s.length>1?n.enable():n.disable()}function mC(t){const e=document.querySelector("#testActivity .months");e.innerHTML=t.map(a=>`<div style="grid-column: span ${a.weeks}">${a.text}</div>`).join("")}function jE(){return Ka!==void 0||(Ka=new ya({select:"#testActivity .yearSelect",settings:{showSearch:!1},events:{afterChange:async t=>{var s;Ka==null||Ka.disable();const e=(s=t[0])==null?void 0:s.value,a=await FB(e);NE(a),((Ka==null?void 0:Ka.getData())??[]).length>1&&(Ka==null||Ka.enable())}}})),Ka}let ba=!1;function SV(){ba=!ba,ba&&console.log("filterDebug is on")}let Kt=[],io=0;function Cv(t){var a;if(Kt===void 0||Kt.length===0)return;let e;t&&t>io?e=Math.ceil(t/10)*10:e=io+10;for(let s=io;s<e;s++){const n=Kt[s];if(!n)continue;let i=n.difficulty;i===void 0&&(i="normal");let r=`<span aria-label="${(a=n.language)==null?void 0:a.replace("_"," ")}" data-balloon-pos="up"><i class="fas fa-fw fa-globe-americas"></i></span>`;i==="normal"?r+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="far fa-fw fa-star"></i></span>`:i==="expert"?r+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star-half-alt"></i></span>`:i==="master"&&(r+=`<span aria-label="${n.difficulty}" data-balloon-pos="up"><i class="fas fa-fw fa-star"></i></span>`),n.punctuation&&(r+='<span aria-label="punctuation" data-balloon-pos="up"><i class="fas fa-fw fa-at"></i></span>'),n.numbers&&(r+='<span aria-label="numbers" data-balloon-pos="up"><i class="fas fa-fw fa-hashtag"></i></span>'),n.blindMode&&(r+='<span aria-label="blind mode" data-balloon-pos="up"><i class="fas fa-fw fa-eye-slash"></i></span>'),n.lazyMode&&(r+='<span aria-label="lazy mode" data-balloon-pos="up"><i class="fas fa-fw fa-couch"></i></span>'),n.funbox!=="none"&&n.funbox!==void 0&&(r+=`<span aria-label="${n.funbox.replace(/_/g," ").replace(/#/g,", ")}" data-balloon-pos="up"><i class="fas fa-gamepad"></i></span>`),n.chartData===void 0?r+='<span class="miniResultChartButton" aria-label="No chart data found" data-balloon-pos="up"><i class="fas fa-chart-line"></i></span>':n.chartData==="toolong"?r+='<span class="miniResultChartButton" aria-label="Chart history is not available for long tests" data-balloon-pos="up"><i class="fas fa-chart-line"></i></span>':r+=`<span class="miniResultChartButton" aria-label="View graph" data-balloon-pos="up" filteredResultsId="${s}" style="opacity: 1"><i class="fas fa-chart-line"></i></span>`;let d="no tags";n.tags!==void 0&&n.tags.length>0&&(d="",n.tags.forEach($=>{var E,L;(L=(E=T())==null?void 0:E.tags)==null||L.forEach(be=>{$===be._id&&(d+=be.display+", ")})}),d=d.substring(0,d.length-2));let u;n.tags===void 0?u="[]":u=JSON.stringify(n.tags);const c=n.tags!==void 0&&n.tags.length>0,m=n.tags!==void 0&&n.tags.length>1?"fa-tags":"fa-tag",f=`<button class="textButton resultEditTagsButton ${c?"active":""}" data-result-id="${n._id}" data-tags='${u}' aria-label="${d}" data-balloon-pos="up"><i class="fas fa-fw ${m}"></i></button>`;let h="";n.isPb?h='<i class="fas fa-fw fa-crown"></i>':h="";const y=n.charStats.join("/"),b=n.mode==="custom"?"":n.mode2,w=new Date(n.timestamp);o(".pageAccount .history table tbody").append(`
    <tr class="resultRow" id="result-${s}">
    <td>${h}</td>
    <td>${ve.typingSpeed(n.wpm,{showDecimalPlaces:!0})}</td>
    <td>${ve.typingSpeed(n.rawWpm,{showDecimalPlaces:!0})}</td>
    <td>${ve.percentage(n.acc,{showDecimalPlaces:!0})}</td>
    <td>${ve.percentage(n.consistency,{showDecimalPlaces:!0})}</td>
    <td>${y}</td>
    <td>${n.mode} ${b}</td>
    <td class="infoIcons">${r}</td>
    <td>${f}</td>
    <td>${Ot(w,"dd MMM yyyy")}<br>
    ${Ot(w,"HH:mm")}
    </td>
    </tr>`)}io=e,io>=Kt.length?o(".pageAccount .loadMoreButton").addClass("hidden"):o(".pageAccount .loadMoreButton").removeClass("hidden")}async function TV(){await ye.updateColors(),await jt(0),await pr.updateColors(),await jt(0),await Nd.updateColors(),await jt(0)}function $V(){o(".pageAccount .history table tbody").empty(),Nd.getDataset("count").data=[],pr.getDataset("count").data=[],pr.getDataset("avgWpm").data=[],ye.getDataset("wpm").data=[],ye.getDataset("pb").data=[],ye.getDataset("acc").data=[],ye.getDataset("wpmAvgTen").data=[],ye.getDataset("accAvgTen").data=[],ye.getDataset("wpmAvgHundred").data=[],ye.getDataset("accAvgHundred").data=[]}let nh=0,Ua=[],pd=[];async function BE(){var Ul,Kl,Wt;lg("Displaying stats..."),Zn(100),console.log("updating account page"),Jm();const t=T();if(!t)return;u0(t.personalBests),vy("account",t),CV(t.testActivity,new Date(t.addedAt)),kV(),Ua=[],pd=[];const e=[];io=0;let a=0,s="",n=0,i=0,r=0,d=0,u=0,c=0,m=0,f=0;const h={total:0,count:0,last10Total:0,last10Count:0,max:0};let y=0;nh=0;let b=0,w=0,$=0,E=0;const L={},be=[],J=Ta(l.typingSpeedUnit);Kt=[],o(".pageAccount .history table tbody").empty(),(Kl=(Ul=T())==null?void 0:Ul.results)==null||Kl.forEach(x=>{var gs,Vl,If,Of;try{if(!sa("pb",x.isPb?"yes":"no")){ba&&console.log("skipping result due to pb filter",x);return}let ys=x.difficulty;if(ys===void 0&&(ys="normal"),!sa("difficulty",ys)){ba&&console.log("skipping result due to difficulty filter",x);return}if(!sa("mode",x.mode)){ba&&console.log("skipping result due to mode filter",x);return}if(x.mode==="time"){let ra="custom";if(["15","30","60","120"].includes(`${x.mode2}`)&&(ra=`${x.mode2}`),!sa("time",ra)){ba&&console.log("skipping result due to time filter",x);return}}else if(x.mode==="words"){let ra="custom";if(["10","25","50","100","200"].includes(`${x.mode2}`)&&(ra=`${x.mode2}`),!sa("words",ra)){ba&&console.log("skipping result due to word filter",x);return}}if(x.quoteLength!==null){let ra;if(x.quoteLength===0?ra="short":x.quoteLength===1?ra="medium":x.quoteLength===2?ra="long":x.quoteLength===3&&(ra="thicc"),ra!==void 0&&!sa("quoteLength",ra)){ba&&console.log("skipping result due to quoteLength filter",x);return}}let eo=sa("language",x.language??"english");if(x.language==="english_expanded"&&sa("language","english_1k")&&(eo=!0),!eo){ba&&console.log("skipping result due to language filter",x);return}let Pf="off";if(x.punctuation&&(Pf="on"),!sa("punctuation",Pf)){ba&&console.log("skipping result due to punctuation filter",x);return}let Zf="off";if(x.numbers&&(Zf="on"),!sa("numbers",Zf)){ba&&console.log("skipping result due to numbers filter",x);return}if(x.funbox==="none"||x.funbox===void 0){if(!sa("funbox","none")){ba&&console.log("skipping result due to funbox filter",x);return}}else{let ra=0;for(const id of x.funbox.split("#"))if(sa("funbox",id)){ra++;break}if(ra===0){ba&&console.log("skipping result due to funbox filter",x);return}}let Ha=!0;if(x.tags===void 0||x.tags.length===0)(((Vl=(gs=T())==null?void 0:gs.tags)==null?void 0:Vl.length)??0)>0?sa("tags","none")&&(Ha=!1):Ha=!1;else{const ra=(Of=(If=T())==null?void 0:If.tags)==null?void 0:Of.map(id=>id._id);if(ra===void 0)return;x.tags.forEach(id=>{Ha&&(ra!=null&&ra.includes(id)?sa("tags",id)&&(Ha=!1):sa("tags","none")&&(Ha=!1))})}if(Ha){ba&&console.log("skipping result due to tag filter",x);return}const $s=Math.abs(x.timestamp-Date.now())/1e3;let U_=!0;if((sa("date","all")||sa("date","last_day")&&$s<=86400||sa("date","last_week")&&$s<=604800||sa("date","last_month")&&$s<=2592e3||sa("date","last_3months")&&$s<=7776e3)&&(U_=!1),U_){ba&&console.log("skipping result due to date filter",x);return}Kt.push(x)}catch(ys){g("Something went wrong when filtering. Resetting filters.",0),console.log(x),console.error(ys),b_(),Fi(),kl();return}y+=Math.round(x.wpm/60*x.testDuration);const ot=new Date(x.timestamp);ot.setSeconds(0),ot.setMinutes(0),ot.setHours(0),ot.setMilliseconds(0);const At=ot.getTime(),hs=L[At];hs!==void 0?(hs.amount++,hs.time+=x.testDuration+(x.incompleteTestSeconds??0)-(x.afkDuration??0),hs.totalWpm+=x.wpm):L[At]={amount:1,time:x.testDuration+(x.incompleteTestSeconds??0)-(x.afkDuration??0),totalWpm:x.wpm};const Ks=J.histogramDataBucketSize,ci=Math.floor(Math.round(J.fromWpm(x.wpm))/Ks);if(be.length<=ci)for(let ys=be.length;ys<=ci;ys++)be.push(0);be[ci]++;let Mt=0;if(x.testDuration===void 0&&x.mode2!=="custom"&&x.mode2!=="zen"?x.mode==="time"?Mt=parseInt(x.mode2):x.mode==="words"&&(Mt=parseInt(x.mode2)/x.wpm*60):Mt=parseFloat(x.testDuration),x.incompleteTestSeconds!==void 0?Mt+=x.incompleteTestSeconds:x.restartCount!==void 0&&x.restartCount>0&&(Mt+=Mt/4*x.restartCount),nh+=Mt,d<10&&(d++,u+=x.wpm,f+=x.acc,x.consistency!==void 0&&($+=x.consistency)),r++,x.consistency!==void 0&&(E++,w+=x.consistency,x.consistency>b&&(b=x.consistency)),x.rawWpm!==null&&(h.last10Count<10&&(h.last10Count++,h.last10Total+=x.rawWpm),h.total+=x.rawWpm,h.count++,x.rawWpm>h.max&&(h.max=x.rawWpm)),x.acc>c&&(c=x.acc),m+=x.acc,x.restartCount!==void 0&&(n+=x.restartCount),Ua.push({x:Kt.length,y:Oe(J.fromWpm(x.wpm)),wpm:Oe(J.fromWpm(x.wpm)),acc:x.acc,mode:x.mode,mode2:x.mode2,punctuation:x.punctuation,language:x.language,timestamp:x.timestamp,difficulty:x.difficulty,raw:Oe(J.fromWpm(x.rawWpm)),isPb:x.isPb??!1}),e.push(x.wpm),pd.push({x:Kt.length,y:x.acc,errorRate:100-x.acc}),x.wpm>a){const ys=x.punctuation?",<br>with punctuation":"",eo=x.numbers?",<br> "+(x.punctuation?"&":"")+"with numbers":"";a=x.wpm,x.mode==="custom"?s=x.mode:s=x.mode+" "+x.mode2+ys+eo}i+=x.wpm}),o(".pageAccount .group.history table thead tr td:nth-child(2)").text(l.typingSpeedUnit),await jt(0),Cv();const k=[],S=[],z=J.historyStepSize;for(const x of Object.keys(L)){const ot=parseInt(x),At=L[ot];At!==void 0&&(k.push({x:ot,y:At.time/60,amount:At.amount}),S.push({x:ot,y:Oe(J.fromWpm(At.totalWpm)/At.amount)}))}const ca=pr.options.scales.avgWpm;ca.title.text="Average "+l.typingSpeedUnit,ca.ticks.stepSize=z,pr.getDataset("count").data=k,pr.getDataset("avgWpm").data=S;const aa=[],ma=[],La=J.histogramDataBucketSize,Tn=La-(La<=1?.01:1);be.forEach((x,ot)=>{const At=ot*La;ma.push(`${At} - ${At+Tn}`),aa.push({x:At,y:x})}),Nd.data.labels=ma,Nd.getDataset("count").data=aa;const sd=ye.options.scales.wpm;if(sd.title.text=J.fullUnitString,Ua.length>0){let x=0;const ot=[];for(let Mt=Ua.length-1;Mt>=0;Mt--){const gs=Ua[Mt];gs.y>x&&(x=gs.y,ot.push(gs))}ot.push({x:1,y:(Wt=_r(ot))==null?void 0:Wt.y});const At=[],hs=[],Ks=[],ci=[];for(let Mt=0;Mt<Ua.length;Mt++){const gs=Ua.slice(Mt,Mt+10),Vl=pd.slice(Mt,Mt+10),If=gs.reduce((Ha,{y:$s})=>Ha+$s,0)/gs.length,Of=Vl.reduce((Ha,{y:$s})=>Ha+$s,0)/Vl.length;At.push({x:Mt+1,y:If}),hs.push({x:Mt+1,y:Of});const ys=Ua.slice(Mt,Mt+100),eo=pd.slice(Mt,Mt+100),Pf=ys.reduce((Ha,{y:$s})=>Ha+$s,0)/ys.length,Zf=eo.reduce((Ha,{y:$s})=>Ha+$s,0)/eo.length;Ks.push({x:Mt+1,y:Pf}),ci.push({x:Mt+1,y:Zf})}ye.getDataset("wpm").data=Ua,ye.getDataset("pb").data=ot,ye.getDataset("acc").data=pd,ye.getDataset("wpmAvgTen").data=At,ye.getDataset("accAvgTen").data=hs,ye.getDataset("wpmAvgHundred").data=Ks,ye.getDataset("accAvgHundred").data=ci,ye.getScale("x").max=Ua.length+1}const Wl=Ua.map(x=>x.y),Fl=Math.min(...Wl),zl=Math.max(...Wl),Lf=isFinite(Fl)?Fl:0,Hl=isFinite(zl)?zl:0,Xr=Math.floor(Hl)+(z-Math.floor(Hl)%z);if(sd.max=Xr,sd.ticks.stepSize=z,ye.getScale("pb").max=Xr,ye.getScale("wpmAvgTen").max=Xr,ye.getScale("wpmAvgHundred").max=Xr,l.startGraphsAtZero)ye.getScale("wpm").min=0,ye.getScale("pb").min=0,ye.getScale("wpmAvgTen").min=0,ye.getScale("wpmAvgHundred").min=0;else{const x=Math.floor(Lf/z)*z;ye.getScale("wpm").min=x,ye.getScale("pb").min=x,ye.getScale("wpmAvgTen").min=x,ye.getScale("wpmAvgHundred").min=x}Ua===void 0||Ua.length===0?(o(".pageAccount .group.noDataError").removeClass("hidden"),o(".pageAccount .group.chart").addClass("hidden"),o(".pageAccount .group.dailyActivityChart").addClass("hidden"),o(".pageAccount .group.histogramChart").addClass("hidden"),o(".pageAccount .group.aboveHistory").addClass("hidden"),o(".pageAccount .group.history").addClass("hidden"),o(".pageAccount .triplegroup.stats").addClass("hidden"),o(".pageAccount .group.estimatedWordsTyped").addClass("hidden")):(o(".pageAccount .group.noDataError").addClass("hidden"),o(".pageAccount .group.chart").removeClass("hidden"),o(".pageAccount .group.dailyActivityChart").removeClass("hidden"),o(".pageAccount .group.histogramChart").removeClass("hidden"),o(".pageAccount .group.aboveHistory").removeClass("hidden"),o(".pageAccount .group.history").removeClass("hidden"),o(".pageAccount .triplegroup.stats").removeClass("hidden"),o(".pageAccount .group.estimatedWordsTyped").removeClass("hidden")),o(".pageAccount .timeTotalFiltered .val").text(ts(Math.round(nh),!0,!0));const ui=l.typingSpeedUnit;o(".pageAccount .highestWpm .title").text(`highest ${ui}`),o(".pageAccount .highestWpm .val").text(ve.typingSpeed(a)),o(".pageAccount .averageWpm .title").text(`average ${ui}`),o(".pageAccount .averageWpm .val").text(ve.typingSpeed(i/r)),o(".pageAccount .averageWpm10 .title").text(`average ${ui} (last 10 tests)`),o(".pageAccount .averageWpm10 .val").text(ve.typingSpeed(u/d)),o(".pageAccount .highestRaw .title").text(`highest raw ${ui}`),o(".pageAccount .highestRaw .val").text(ve.typingSpeed(h.max)),o(".pageAccount .averageRaw .title").text(`average raw ${ui}`),o(".pageAccount .averageRaw .val").text(ve.typingSpeed(h.total/h.count)),o(".pageAccount .averageRaw10 .title").text(`average raw ${ui} (last 10 tests)`),o(".pageAccount .averageRaw10 .val").text(ve.typingSpeed(h.last10Total/h.last10Count)),o(".pageAccount .highestWpm .mode").html(s),o(".pageAccount .testsTaken .val").text(r),o(".pageAccount .highestAcc .val").text(ve.accuracy(c)),o(".pageAccount .avgAcc .val").text(ve.accuracy(m/r)),o(".pageAccount .avgAcc10 .val").text(ve.accuracy(f/d)),w===0||w===void 0?(o(".pageAccount .avgCons .val").text("-"),o(".pageAccount .avgCons10 .val").text("-")):(o(".pageAccount .highestCons .val").text(ve.percentage(b)),o(".pageAccount .avgCons .val").text(ve.percentage(w/E)),o(".pageAccount .avgCons10 .val").text(ve.percentage($/Math.min(d,E)))),o(".pageAccount .testsStarted .val").text(`${r+n}`),o(".pageAccount .testsCompleted .val").text(`${r}(${Math.floor(r/(r+n)*100)}%)`),o(".pageAccount .testsCompleted .avgres").text(`
    ${(n/r).toFixed(1)} restarts per completed test
  `);const Ef=Kt.map(x=>x.wpm).reverse(),nd=z2(Ef);if(nd){const ot=(nd[1][1]-nd[0][1])*(3600/nh),At=ot>0?"+":"";o(".pageAccount .group.chart .below .text").text(`Speed change per hour spent typing: ${At+ve.typingSpeed(ot,{showDecimalPlaces:!0})} ${l.typingSpeedUnit}`)}o(".pageAccount .estimatedWordsTyped .val").text(y),(Ua.length||pd.length)&&(Y3(),ye.options.animation=!1,ye.update(),delete ye.options.animation),await jt(0),pr.update(),Nd.update(),Zn(100,!0),Qr(!1),Xn(o(".pageAccount .preloader"),o(".pageAccount .content"),250,async()=>{o(".page.pageAccount").css("height","unset")},async()=>{setTimeout(()=>{w_("account")},10)})}async function k_(t){const e=await ik(t);if(!e&&!ta()){g("Could not get results - you are offline",-1,{duration:5});return}Pz(),e&&Fi()}async function kl(){if(Zn(0,!0),T()===null)g("Missing account data. Please refresh.",-1),o(".pageAccount .preloader").html("Missing account data. Please refresh.");else{Zn(90),await k_();try{await jt(0),await BE()}catch(t){console.error(t),g(`Something went wrong: ${t}`,-1)}}}function AV(t,e){var n,i;const a=[];if(e.length>0)for(const r of e)(i=(n=T())==null?void 0:n.tags)==null||i.forEach(d=>{r===d._id&&a.push(d.display)});const s=o(`.pageAccount .resultEditTagsButton[data-result-id='${t}']`);s.attr("data-tags",JSON.stringify(e)),e.length>0?(s.attr("aria-label",a.join(", ")),s.addClass("active"),e.length>1?s.html('<i class="fas fa-fw fa-tags"></i>'):s.html('<i class="fas fa-fw fa-tag"></i>')):(s.attr("aria-label","no tags"),s.removeClass("active"),s.html('<i class="fas fa-fw fa-tag"></i>'))}function Yr(t,e,a=null){var d,u;if(o("td").removeClass("headerSorted"),o("td").children("i").remove(),o(e).addClass("headerSorted"),Kt.length<2)return;const s=t;let n=!0;a!==null?a?o(e).append('<i class="fas fa-sort-down" aria-hidden="true"></i>'):(n=!1,o(e).append('<i class="fas fa-sort-up" aria-hidden="true"></i>')):parseInt((d=Kt==null?void 0:Kt[0])==null?void 0:d[s])<=parseInt((u=Kt==null?void 0:Kt[Kt.length-1])==null?void 0:u[s])?(n=!0,o(e).append('<i class="fas fa-sort-down" aria-hidden="true"></i>')):(n=!1,o(e).append('<i class="fas fa-sort-up", aria-hidden="true"></i>'));const i=[],r=[];for(;i.length<Kt.length;){let c=Number.MAX_VALUE,m=-1,f=-1;for(const[h,y]of Kt.entries())n?y[s]>=m&&!r.includes(h)&&(m=y[s],f=h):y[s]<=c&&!r.includes(h)&&(c=y[s],f=h);i.push(Kt[f]),r.push(f)}Kt=i,o(".pageAccount .history table tbody").empty(),io=0,Cv()}o(".pageAccount button.toggleResultsOnChart").on("click",()=>{const t=l.accountChart;t[0]=t[0]==="on"?"off":"on",nf(t)});o(".pageAccount button.toggleAccuracyOnChart").on("click",()=>{const t=l.accountChart;t[1]=t[1]==="on"?"off":"on",nf(t)});o(".pageAccount button.toggleAverage10OnChart").on("click",()=>{const t=l.accountChart;t[2]=t[2]==="on"?"off":"on",nf(t)});o(".pageAccount button.toggleAverage100OnChart").on("click",()=>{const t=l.accountChart;t[3]=t[3]==="on"?"off":"on",nf(t)});o(".pageAccount .loadMoreButton").on("click",()=>{Cv()});o(".pageAccount #accountHistoryChart").on("click",()=>{var n;const t=hL;if(Cv(t),window===void 0)return;const e=o(window).height()??0,s=(((n=o(`#result-${t}`).offset())==null?void 0:n.top)??0)-e/2;o([document.documentElement,document.body]).animate({scrollTop:s},qt(500)),o(".resultRow").removeClass("active"),o(`#result-${t}`).addClass("active")});o(".pageAccount").on("click",".miniResultChartButton",t=>{var a;console.log("updating");const e=o(t.currentTarget).attr("filteredResultsId");e!==void 0&&pV((a=Kt[parseInt(e)])==null?void 0:a.chartData)});o(".pageAccount .group.history").on("click",".history-wpm-header",()=>{Yr("wpm",".history-wpm-header")});o(".pageAccount .group.history").on("click",".history-raw-header",()=>{Yr("rawWpm",".history-raw-header")});o(".pageAccount .group.history").on("click",".history-acc-header",()=>{Yr("acc",".history-acc-header")});o(".pageAccount .group.history").on("click",".history-correct-chars-header",()=>{Yr("correctChars",".history-correct-chars-header")});o(".pageAccount .group.history").on("click",".history-incorrect-chars-header",()=>{Yr("incorrectChars",".history-incorrect-chars-header")});o(".pageAccount .group.history").on("click",".history-consistency-header",()=>{Yr("consistency",".history-consistency-header")});o(".pageAccount .group.history").on("click",".history-date-header",()=>{Yr("timestamp",".history-date-header")});o(".pageAccount .group.history").on("click",".buttonsAndTitle .buttons button",()=>{Yr("timestamp",".history-date-header",!0)});o(".pageAccount .group.topFilters, .pageAccount .filterButtons").on("click","button",()=>{setTimeout(()=>{kl()},0)});o(".pageAccount .group.presetFilterButtons").on("click",".filterBtns .filterPresets .select-filter-preset",async t=>{await eV(o(t.target).data("id")),kl()});o(".pageAccount .content .group.aboveHistory .exportCSV").on("click",()=>{FO(Kt)});o(".pageAccount .profile").on("click",".details .copyLink",()=>{const t=T();if(!t)return;const{name:e}=t,a=`${location.origin}/profile/${e}`;navigator.clipboard.writeText(a).then(function(){g("URL Copied to clipboard",0)},function(){alert("Failed to copy using the Clipboard API. Here's the link: "+a)})});o(".pageAccount button.loadMoreResults").on("click",async()=>{var e,a;const t=((a=(e=T())==null?void 0:e.results)==null?void 0:a.length)??0;ht(),p0(),await k_(t),await BE(),We()});Dt(t=>{ft()==="account"&&t==="typingSpeedUnit"&&kl()});const MV=new di({name:"account",element:o(".page.pageAccount"),path:"/account",afterHide:async()=>{$V(),lV(),Na("pageAccount")},beforeShow:async()=>{Cs("pageAccount","main");const t=T();(t==null?void 0:t.results)===void 0&&(o(".pageLoading .fill, .pageAccount .fill").css("width","0%"),o(".pageAccount .content").addClass("hidden"),o(".pageAccount .preloader").removeClass("hidden"),await OT()),await dV(kl),Fi(),await jt(0),DE("current",t!==void 0?new Date(t.addedAt).getFullYear():2020),kl().then(()=>{var e,a;TV(),o(".pageAccount .content .accountVerificatinNotice").remove(),((a=(e=Qt)==null?void 0:e.currentUser)==null?void 0:a.emailVerified)===!1&&o(".pageAccount .content").prepend('<div class="accountVerificatinNotice"><i class="fas icon fa-exclamation-triangle"></i><p>Your email address is still not verified</p><button class="sendVerificationEmail">resend verification email</button></div>'),xV()})}});o(()=>{ms("pageAccount")});const Vt={resultId:"",startingTags:[],tags:[],source:"accountPage"};function qE(t,e,a){if(!ta()){g("You are offline",0,{duration:2});return}if(t===""){g("Failed to show edit result tags modal: result id is empty",-1);return}Vt.resultId=t,Vt.startingTags=[...e],Vt.tags=[...e],Vt.source=a,__.show({beforeAnimation:async()=>{LV(),WE()}})}function fC(){__.hide()}function LV(){var a,s;const t=__.getModal().querySelector(".buttons");if(t===null){g("Failed to append buttons to edit result tags modal: could not find buttons element",-1);return}const e=new Set([...((a=T())==null?void 0:a.tags.map(n=>n._id))??[],...Vt.tags]);t.innerHTML="";for(const n of e){const i=(s=T())==null?void 0:s.tags.find(d=>d._id===n),r=document.createElement("button");r.classList.add("toggleTag"),r.setAttribute("data-tag-id",n),r.innerHTML=(i==null?void 0:i.display)??"unknown tag",r.addEventListener("click",d=>{EV(n),WE()}),t.appendChild(r)}}function WE(){for(const t of o("#editResultTagsModal .modal .buttons button")){const e=o(t).attr("data-tag-id")??"";Vt.tags.includes(e)?o(t).addClass("active"):o(t).removeClass("active")}}function EV(t){Vt.tags.includes(t)?Vt.tags=Vt.tags.filter(e=>e!==t):Vt.tags.push(t)}async function IV(){var a,s,n;ht();const t=await F.results.updateTags({body:{resultId:Vt.resultId,tagIds:Vt.tags}});if(We(),Vt.tags=Vt.tags.filter(i=>i!==void 0),t.status!==200){g("Failed to update result tags: "+t.body.message,-1);return}const e=((a=t.body.data)==null?void 0:a.tagPbs)??[];g("Tags updated",1,{duration:2}),(n=(s=T())==null?void 0:s.results)==null||n.forEach(i=>{i._id===Vt.resultId&&(i.tags=Vt.tags)}),Vt.source==="accountPage"?AV(Vt.resultId,Vt.tags):Vt.source==="resultPage"&&ZH(Vt.tags,e)}const __=new Ct({dialogId:"editResultTagsModal",setup:async t=>{var e;(e=t.querySelector("button.saveButton"))==null||e.addEventListener("click",a=>{if(zO(Vt.startingTags,Vt.tags)){fC();return}fC(),IV()})}});function FE(t){const e=/((-\s*)?\d+(\.\d+)?\s*[hms]?)/g,a=[...t.toLowerCase().matchAll(e)].map(s=>{const n=s[0],i=parseFloat(n.replace(/\s+/g,""));return n.includes("h")?3600*i:n.includes("m")?60*i:i}).reduce((s,n)=>s+n,0);return Math.floor(a)}function OV(t){const e=Math.floor(t/3600),a=Math.floor(t%3600/60),s=t%3600%60,n=[];return e>0&&n.push(`${e} hour${e===1?"":"s"}`),a>0&&n.push(`${a} minute${a===1?"":"s"}`),s>0&&n.push(`${s} second${s===1?"":"s"}`),n.length===3?`${n[0]}, ${n[1]} and ${n[2]}`:n.length===2?`${n[0]} and ${n[1]}`:`${n[0]}`}function zE(){const t=o("#customTestDurationModal input").val(),e=FE(t);let a="";e<0?a="Negative time? Really?":e===0?a="Infinite test":a=OV(e),o("#customTestDurationModal .preview").text(a)}function HE(t){UE.show({...t,focusFirstInput:"focusAndSelect",beforeAnimation:async e=>{e.querySelector("input").value=`${l.time}`,zE()}})}function PV(t=!1){UE.hide({clearModalChain:t})}function ZV(){const t=FE(o("#customTestDurationModal input").val());if(t!==null&&!isNaN(t)&&t>=0&&isFinite(t))Dn(t),$t(),ut(),t>=1800?g("Stay safe and take breaks!",0):t===0&&g("Infinite time! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});else{g("Custom time must be a positive number or zero",0);return}PV(!0)}async function RV(t){var e;t.addEventListener("submit",a=>{a.preventDefault(),ZV()}),(e=t.querySelector("input"))==null||e.addEventListener("input",a=>{zE()})}const UE=new Ct({dialogId:"customTestDurationModal",setup:RV}),NV=Fm.recaptchaSiteKey,Si={};function xf(t,e,a){if(Si[e]!==void 0&&Si[e]!==null)return;const s=grecaptcha.render(t,{sitekey:NV,callback:a});Si[e]=s}function ql(t){Si[t]===void 0||Si[t]===null||grecaptcha.reset(Si[t])}function Sv(t){return Si[t]===void 0||Si[t]===null?"":grecaptcha.getResponse(Si[t])}class wm{constructor(e,a){this.textareaElement=e,this.maxLength=a,this.textareaElement.attr("maxlength",this.maxLength.toString()),this.textareaElement.parent().hasClass("textareaWithCounter")||o(this.textareaElement).wrap('<div class="textareaWithCounter"></div>'),this.parentElement=o(this.textareaElement).parent(".textareaWithCounter"),this.parentElement.find(".char-counter").length===0?(this.counterElement=o('<span class="char-counter"></span>'),this.parentElement.append(this.counterElement)):this.counterElement=this.parentElement.find(".char-counter"),this.updateCounter(),this.textareaElement.on("input",()=>this.updateCounter())}updateCounter(){const e=this.maxLength,a=this.textareaElement.val().length,s=e-a;this.counterElement.text(`${a}/${e}`);const n=s/this.maxLength*100;this.counterElement.removeClass("warning"),this.counterElement.removeClass("error"),n===0?this.counterElement.addClass("error"):n<10&&this.counterElement.addClass("warning")}setMaxLength(e){this.maxLength=e,this.updateCounter()}}let hC=!1;async function DV(){if(hC)return;const t=await nk();for(const e of t)e.name!=="swiss_german"&&o("#quoteSubmitModal .newQuoteLanguage").append(`<option value="${e.name}">${e.name.replace(/_/g," ")}</option>`);hC=!0}let Mu;async function jV(){const t=o("#quoteSubmitModal .newQuoteText").val(),e=o("#quoteSubmitModal .newQuoteSource").val(),a=o("#quoteSubmitModal .newQuoteLanguage").val(),s=Sv("submitQuote");if(!t||!e||!a){g("Please fill in all fields",0);return}ht();const n=await F.quotes.add({body:{text:t,source:e,language:a,captcha:s}});if(We(),n.status!==200){g("Failed to submit quote: "+n.body.message,-1);return}g("Quote submitted.",1),o("#quoteSubmitModal .newQuoteText").val(""),o("#quoteSubmitModal .newQuoteSource").val(""),ql("submitQuote")}async function BV(t){KE.show({...t,mode:"dialog",focusFirstInput:!0,afterAnimation:async()=>{xf(document.querySelector("#quoteSubmitModal .g-recaptcha"),"submitQuote"),await DV(),Mu=new ya({select:"#quoteSubmitModal .newQuoteLanguage"}),o("#quoteSubmitModal .newQuoteLanguage").val(Rn(l.language)),o("#quoteSubmitModal .newQuoteLanguage").trigger("change"),o("#quoteSubmitModal input").val(""),new wm(o("#quoteSubmitModal .newQuoteText"),250)}})}function qV(t){KE.hide({clearModalChain:t,afterAnimation:async()=>{ql("submitQuote"),Mu==null||Mu.destroy(),Mu=void 0}})}async function WV(t){var e;(e=t.querySelector("button"))==null||e.addEventListener("click",()=>{jV(),qV(!0)})}const KE=new Ct({dialogId:"quoteSubmitModal",setup:WV});let Wr=[];function Tv(){o("#quoteApproveModal .quotes").empty(),Wr.forEach((t,e)=>{const a=o(`
      <div class="quote" data-id="${e}" data-db-id="${t._id}">
        <textarea class="text">${t.text}</textarea>
        <input type="text" class="source" placeholder="Source" value="${t.source}">
        <div class="buttons">
          <button disabled class="textButton undo" aria-label="Undo changes" data-balloon-pos="left"><i class="fas fa-fw fa-undo-alt"></i></button>
          <button class="textButton refuse" aria-label="Refuse quote" data-balloon-pos="left"><i class="fas fa-fw fa-times"></i></button>
          <button class="textButton approve" aria-label="Approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-check"></i></button>
          <button class="textButton edit hidden" aria-label="Edit and approve quote" data-balloon-pos="left"><i class="fas fa-fw fa-pen"></i></button>
        </div>
        <div class="bottom">
          <div class="length ${t.text.length<60?"red":""}"><i class="fas fa-fw fa-ruler"></i>${t.text.length}</div>
          <div class="language"><i class="fas fa-fw fa-globe-americas"></i>${t.language}</div>
          <div class="timestamp"><i class="fas fa-fw fa-calendar"></i>${Ot(new Date(t.timestamp),"dd MMM yyyy HH:mm")}</div>
        </div>
      </div>
    `);o("#quoteApproveModal .quotes").append(a),a.find(".source").on("input",()=>{o(`#quoteApproveModal .quote[data-id=${e}] .undo`).prop("disabled",!1),o(`#quoteApproveModal .quote[data-id=${e}] .approve`).addClass("hidden"),o(`#quoteApproveModal .quote[data-id=${e}] .edit`).removeClass("hidden")}),a.find(".text").on("input",()=>{o(`#quoteApproveModal .quote[data-id=${e}] .undo`).prop("disabled",!1),o(`#quoteApproveModal .quote[data-id=${e}] .approve`).addClass("hidden"),o(`#quoteApproveModal .quote[data-id=${e}] .edit`).removeClass("hidden"),VE(e)}),a.find(".undo").on("click",()=>{zV(e)}),a.find(".approve").on("click",()=>{HV(e,t._id)}),a.find(".refuse").on("click",()=>{UV(e,t._id)}),a.find(".edit").on("click",()=>{KV(e,t._id)})})}function VE(t){var a;const e=(a=o(`#quoteApproveModal .quote[data-id=${t}] .text`).val())==null?void 0:a.length;o(`#quoteApproveModal .quote[data-id=${t}] .length`).html(`<i class="fas fa-fw fa-ruler"></i>${e}`),e<60?o(`#quoteApproveModal .quote[data-id=${t}] .length`).addClass("red"):o(`#quoteApproveModal .quote[data-id=${t}] .length`).removeClass("red")}async function GE(){ht();const t=await F.quotes.get();if(We(),t.status!==200){g("Failed to get new quotes: "+t.body.message,-1);return}Wr=t.body.data??[],Tv()}async function FV(t){GV.show({...t,beforeAnimation:async()=>{Wr=[],GE()}})}function x_(t){const e=o(`#quoteApproveModal .quotes .quote[data-id=${t}]`);e.find("button").prop("disabled",!1),e.find(".edit").hasClass("hidden")&&e.find(".undo").prop("disabled",!0)}function zV(t){var e,a;o(`#quoteApproveModal .quote[data-id=${t}] .text`).val(((e=Wr[t])==null?void 0:e.text)??""),o(`#quoteApproveModal .quote[data-id=${t}] .source`).val(((a=Wr[t])==null?void 0:a.source)??""),o(`#quoteApproveModal .quote[data-id=${t}] .undo`).prop("disabled",!0),o(`#quoteApproveModal .quote[data-id=${t}] .approve`).removeClass("hidden"),o(`#quoteApproveModal .quote[data-id=${t}] .edit`).addClass("hidden"),VE(t)}async function HV(t,e){if(!confirm("Are you sure?"))return;const a=o(`#quoteApproveModal .quotes .quote[data-id=${t}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),ht();const s=await F.quotes.approveSubmission({body:{quoteId:e}});if(We(),s.status!==200){x_(t),a.find("textarea, input").prop("disabled",!1),g("Failed to approve quote: "+s.body.message,-1);return}g(`Quote approved. ${s.body.message??""}`,1),Wr.splice(t,1),Tv()}async function UV(t,e){if(!confirm("Are you sure?"))return;const a=o(`#quoteApproveModal .quotes .quote[data-id=${t}]`);a.find("button").prop("disabled",!0),a.find("textarea, input").prop("disabled",!0),ht();const s=await F.quotes.rejectSubmission({body:{quoteId:e}});if(We(),s.status!==200){x_(t),a.find("textarea, input").prop("disabled",!1),g("Failed to refuse quote: "+s.body.message,-1);return}g("Quote refused.",1),Wr.splice(t,1),Tv()}async function KV(t,e){if(!confirm("Are you sure?"))return;const a=o(`#quoteApproveModal .quote[data-id=${t}] .text`).val(),s=o(`#quoteApproveModal .quote[data-id=${t}] .source`).val(),n=o(`#quoteApproveModal .quotes .quote[data-id=${t}]`);n.find("button").prop("disabled",!0),n.find("textarea, input").prop("disabled",!0),ht();const i=await F.quotes.approveSubmission({body:{quoteId:e,editText:a,editSource:s}});if(We(),i.status!==200){x_(t),n.find("textarea, input").prop("disabled",!1),g("Failed to approve quote: "+i.body.message,-1);return}g(`Quote edited and approved. ${i.body.message??""}`,1),Wr.splice(t,1),Tv()}async function VV(t){var e;(e=t.querySelector("button.refreshList"))==null||e.addEventListener("click",()=>{o("#quoteApproveModal .quotes").empty(),GE()})}const GV=new Ct({dialogId:"quoteApproveModal",setup:VV}),Bd={quoteToReport:void 0,reasonSelect:void 0};async function QE(t,e){YE.show({mode:"dialog",...e,beforeAnimation:async()=>{var n;xf(document.querySelector("#quoteReportModal .g-recaptcha"),"quoteReportModal");const a=l.language==="swiss_german"?"german":l.language,{quotes:s}=await _s.getQuotes(a);Bd.quoteToReport=s.find(i=>i.id===t),o("#quoteReportModal .quote").text((n=Bd.quoteToReport)==null?void 0:n.text),o("#quoteReportModal .reason").val("Grammatical error"),o("#quoteReportModal .comment").val(""),Bd.reasonSelect=new ya({select:"#quoteReportModal .reason",settings:{showSearch:!1}}),new wm(o("#quoteReportModal .comment"),250)}})}async function QV(t=!1){YE.hide({clearModalChain:t,afterAnimation:async()=>{var e;ql("quoteReportModal"),(e=Bd.reasonSelect)==null||e.destroy(),Bd.reasonSelect=void 0}})}async function YV(){var u;const t=Sv("quoteReportModal");if(!t){g("Please complete the captcha");return}const e=(u=Bd.quoteToReport)==null?void 0:u.id.toString(),a=Rn(l.language),s=o("#quoteReportModal .reason").val(),n=o("#quoteReportModal .comment").val(),i=t;if(e===void 0||e===""){g("Please select a quote");return}if(!s){g("Please select a valid report reason");return}if(!n){g("Please provide a comment");return}const r=n.length-250;if(r>0){g(`Report comment is ${r} character(s) too long`);return}ht();const d=await F.quotes.report({body:{quoteId:e,quoteLanguage:a,reason:s,comment:n,captcha:i}});if(We(),d.status!==200){g("Failed to report quote: "+d.body.message,-1);return}g("Report submitted. Thank you!",1),QV(!0)}async function JV(t){var e;(e=t.querySelector("button"))==null||e.addEventListener("click",async()=>{await YV()})}const YE=new Ct({dialogId:"quoteReportModal",setup:JV}),XV={fuzzyMatchSensitivity:.2,scoreForSimilarMatch:.5,scoreForExactMatch:1};function e6(t,e){return e===0?0:Math.log10(t/e)}const gC=.4;function t6(t,e){return gC+(1-gC)*(e.termFrequencies[t]/e.maxTermFrequency)}function yC(t){return t.match(/[^\\\][.,"/#!?$%^&*;:{}=\-_`~()\s]+/g)??[]}const a6=(t,e,a=XV)=>{const s={},n={};t.forEach((d,u)=>{const c=yC(e(d)),m={id:u,termFrequencies:{},maxTermFrequency:0};let f=0;c.forEach(h=>{var b,w;const y=X_(h);Object.hasOwn(n,y)||(n[y]=new Set),(b=n[y])==null||b.add(h),Object.hasOwn(s,y)||(s[y]=new Set),(w=s[y])==null||w.add(m),y in m.termFrequencies||(m.termFrequencies[y]=0),m.termFrequencies[y]++,f=Math.max(f,m.termFrequencies[y])}),m.maxTermFrequency=f});const i=Object.keys(s);return{query:d=>{const u={results:[],matchedQueryTerms:[]},c=new Set(yC(d).map(y=>X_(y)));if(c.size===0)return u;const m=new Map,f=new Set;c.forEach(y=>{i.forEach(b=>{var L;const{similarity:w}=T2(y,b),$=b===y,E=w>=1-a.fuzzyMatchSensitivity;if($||E){const be=s[b],J=e6(t.length,be.size);be.forEach(k=>{const S=m.get(k.id)??0,z=t6(b,k),Ee=$?a.scoreForExactMatch:0,ca=E?a.scoreForSimilarMatch:0,ma=(Ee+ca)*J*z;m.set(k.id,S+ma)}),(L=n[b])==null||L.forEach(k=>{f.add(k)})}})});const h=[...m].sort((y,b)=>b[1]-y[1]).map(y=>t[y[0]]);return u.results=h,u.matchedQueryTerms=[...f],u}}},db={},lb=100;let mr=1;function s6(t,e,a){if(t in db)return db[t];const s=a6(e,a);return db[t]=s,s}function ub(t,e){return e.length===0?t:oq(t,'.,"/#!$%^&*;:{}=-_`~() '.split("")).map(n=>e.find(r=>n.startsWith(r))!==void 0?`<span class="highlight">${n}</span>`:n).join("")}function n6(t){const e=o("#quoteSearchModal .quoteLengthFilter").val();if(e.length===0)return t;const a=e.map(n=>parseInt(n,10));return t.filter(n=>a.includes(n.group))}function i6(t){const e=document.querySelector(".toggleFavorites").classList.contains("active");return t.filter(s=>e?_s.isQuoteFavorite(s):!0)}function r6(t,e){let a;t.length<101?a="short":t.length<301?a="medium":t.length<601?a="long":a="thicc";const s=!we(),n=!s&&_s.isQuoteFavorite(t);return`
  <div class="searchResult" data-quote-id="${t.id}">

    <div class="text">
      ${ub(t.text,e)}
    </div>

    <div class="id">
      <div class="sub">id</div>
      <span class="quote-id">
        ${ub(t.id.toString(),e)}
      </span>
    </div>

    <div class="length">
      <div class="sub">length</div>
      ${a}
    </div>

    <div class="source">
      <div class="sub">source</div>
      ${ub(t.source,e)}
    </div>

    <div class="textButton report ${s&&"hidden"}" aria-label="Report quote" data-balloon-pos="left">
      <i class="fas fa-flag report"></i>
    </div>

    <div class="textButton favorite ${s&&"hidden"}" aria-label="Favorite quote" data-balloon-pos="left">
      <i class="${n?"fas":"far"} fa-heart favorite"></i>
    </div>

  </div>
  `}async function by(t){var f,h;const{quotes:e}=await _s.getQuotes(l.language),a=s6(l.language,e,y=>`${y.text} ${y.id} ${y.source}`),{results:s,matchedQueryTerms:n}=a.query(t),i=n6(i6(t===""?e:s)),r=o("#quoteSearchResults");r.empty();const d=Math.ceil(i.length/lb);if(mr>=d?o("#quoteSearchPageNavigator .nextPage").prop("disabled",!0):o("#quoteSearchPageNavigator .nextPage").prop("disabled",!1),mr<=1?o("#quoteSearchPageNavigator .prevPage").prop("disabled",!0):o("#quoteSearchPageNavigator .prevPage").prop("disabled",!1),i.length===0){o("#quoteSearchModal  .pageInfo").html("No search results");return}const u=(mr-1)*lb,c=Math.min(mr*lb,i.length);o("#quoteSearchModal  .pageInfo").html(`${u+1} - ${c} of ${i.length}`),i.slice(u,c).forEach(y=>{const b=r6(y,n);r.append(b)});const m=Vo.getModal().querySelectorAll(".searchResult");for(const y of m){const b=parseInt(y.dataset.quoteId);(f=y.querySelector(".textButton.favorite"))==null||f.addEventListener("click",w=>{if(w.stopPropagation(),b===void 0||isNaN(b)){g("Could not toggle quote favorite: quote id is not a number",-1);return}l6(`${b}`)}),(h=y.querySelector(".textButton.report"))==null||h.addEventListener("click",w=>{if(w.stopPropagation(),b===void 0||isNaN(b)){g("Could not open quote report modal: quote id is not a number",-1);return}QE(b,{modalChain:Vo})}),y.addEventListener("click",w=>{tk(b),d6(b)})}}let Lu;async function JE(t){Vo.show({...t,focusFirstInput:!0,beforeAnimation:async()=>{var a,s,n;we()?(o("#quoteSearchModal .goToQuoteSubmit").removeClass("hidden"),o("#quoteSearchModal .toggleFavorites").removeClass("hidden")):(o("#quoteSearchModal .goToQuoteSubmit").addClass("hidden"),o("#quoteSearchModal .toggleFavorites").addClass("hidden")),((a=T())==null?void 0:a.quoteMod)!==void 0&&(((s=T())==null?void 0:s.quoteMod)===!0||((n=T())==null?void 0:n.quoteMod)!=="")?o("#quoteSearchModal .goToQuoteApprove").removeClass("hidden"):o("#quoteSearchModal .goToQuoteApprove").addClass("hidden"),Lu=new ya({select:"#quoteSearchModal .quoteLengthFilter",settings:{showSearch:!1,placeholderText:"filter by length",contentLocation:Vo.getModal()},data:[{text:"short",value:"0"},{text:"medium",value:"1"},{text:"long",value:"2"},{text:"thicc",value:"3"}]})},afterAnimation:async()=>{const e=o("#quoteSearchModal input").val();mr=1,by(e)}})}function o6(t=!1){Vo.hide({clearModalChain:t,afterAnimation:async()=>{Lu==null||Lu.destroy(),Lu=void 0}})}function d6(t){if(isNaN(t)&&(t=parseInt(document.getElementById("searchBox").value)),t!==null&&!isNaN(t)&&t>=0)bi(-2,!1),tk(t),$t();else{g("Quote ID must be at least 1",0);return}ut(),o6(!0)}const cb=cs(250,()=>{const t=document.getElementById("searchBox").value;mr=1,by(t)});async function l6(t){const e=l.language;if(e===""||t===""){g("Could not get quote stats!",-1);return}const a={language:e,id:parseInt(t,10)},s=_s.isQuoteFavorite(a),n=o(`#quoteSearchModal .searchResult[data-quote-id=${t}] .textButton.favorite i`);if(T())if(s)try{ht(),await _s.setQuoteFavorite(a,!1),We(),n.removeClass("fas").addClass("far")}catch(r){We();const d=qe(r,"Failed to remove quote from favorites");g(d,-1)}else try{ht(),await _s.setQuoteFavorite(a,!0),We(),n.removeClass("far").addClass("fas")}catch(r){We();const d=qe(r,"Failed to add quote to favorites");g(d,-1)}}async function u6(t){var e,a,s,n,i,r,d;(e=t.querySelector(".searchBox"))==null||e.addEventListener("input",u=>{cb()}),(a=t.querySelector("button.toggleFavorites"))==null||a.addEventListener("click",u=>{we()&&(o(u.target).toggleClass("active"),cb())}),(s=t.querySelector(".goToQuoteApprove"))==null||s.addEventListener("click",u=>{FV({modalChain:Vo})}),(n=t.querySelector(".goToQuoteSubmit"))==null||n.addEventListener("click",async u=>{var f;ht();const c=await F.quotes.isSubmissionEnabled(),m=(c.status===200&&((f=c.body.data)==null?void 0:f.isEnabled))??!1;if(We(),!m){g("Quote submission is disabled temporarily due to a large submission queue.",0,{duration:5});return}BV({modalChain:Vo})}),(i=t.querySelector(".quoteLengthFilter"))==null||i.addEventListener("change",cb),(r=t.querySelector(".nextPage"))==null||r.addEventListener("click",()=>{const u=document.getElementById("searchBox").value;mr++,by(u)}),(d=t.querySelector(".prevPage"))==null||d.addEventListener("click",()=>{const u=document.getElementById("searchBox").value;mr--,by(u)})}const Vo=new Ct({dialogId:"quoteSearchModal",setup:u6}),XE={homeKeys:{display:"home keys",getIncludeString:t=>{const e=t.keys.row3.slice(0,4),a=t.keys.row3.slice(6,10);return[...e,...a]},getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row4,s=t.keys.row3.slice(10),n=t.keys.row3.slice(4,6);return[...e,...n,...s,...a]}},leftHand:{display:"left hand",getIncludeString:t=>{const e=t.keys.row2.slice(0,5),a=t.keys.row3.slice(0,5),s=t.keys.row4.slice(0,5);return[...e,...a,...s]},getExcludeString:t=>{const e=t.keys.row2.slice(5),a=t.keys.row3.slice(5),s=t.keys.row4.slice(5);return[...e,...a,...s]}},rightHand:{display:"right hand",getIncludeString:t=>{const e=t.keys.row2.slice(5),a=t.keys.row3.slice(5),s=t.keys.row4.slice(4);return[...e,...a,...s]},getExcludeString:t=>{const e=t.keys.row2.slice(0,5),a=t.keys.row3.slice(0,5),s=t.keys.row4.slice(0,4);return[...e,...a,...s]}},homeRow:{display:"home row",getIncludeString:t=>t.keys.row3,getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row4;return[...e,...a]}},topRow:{display:"top row",getIncludeString:t=>t.keys.row2,getExcludeString:t=>{const e=t.keys.row3,a=t.keys.row4;return[...e,...a]}},bottomRow:{display:"bottom row",getIncludeString:t=>t.keys.row4,getExcludeString:t=>{const e=t.keys.row2,a=t.keys.row3;return[...e,...a]}}};async function c6(){o("#wordFilterModal .languageInput").empty(),o("#wordFilterModal .layoutInput").empty(),o("wordFilterModal .presetInput").empty();let t,e;try{t=await sk()}catch(a){console.error(qe(a,"Failed to initialise word filter popup language list"));return}try{e=await Vm()}catch(a){console.error(qe(a,"Failed to initialise word filter popup preset list"));return}t.forEach(a=>{const s=a.replace(/_/gi," ");o("#wordFilterModal .languageInput").append(`
        <option value=${a}>${s}</option>
      `)});for(const a in e){const s=a.replace(/_/gi," ");o("#wordFilterModal .layoutInput").append(`
      <option value=${a}>${s}</option>
    `)}for(const[a,s]of Object.entries(XE))o("#wordFilterModal .presetInput").append(`<option value=${a}>${s.display}</option>`)}let Eu,Iu,Ou;async function p6(t){qd.show({...t,beforeAnimation:async e=>{Eu=new ya({select:"#wordFilterModal .languageInput",settings:{contentLocation:e}}),Iu=new ya({select:"#wordFilterModal .layoutInput",settings:{contentLocation:qd.getModal()}}),Ou=new ya({select:"#wordFilterModal .presetInput",settings:{contentLocation:qd.getModal()}}),o("#wordFilterModal .loadingIndicator").removeClass("hidden"),eI()}})}function m6(t){qd.hide({...t,afterAnimation:async()=>{Eu==null||Eu.destroy(),Iu==null||Iu.destroy(),Ou==null||Ou.destroy(),Eu=void 0,Iu=void 0,Ou=void 0}})}async function f6(t){let e=o("#wordFilterModal .wordIncludeInput").val();e=K_(e==null?void 0:e.trim()),e=e.replace(/\s+/gi,"|");const a=new RegExp(e,"i");let s=o("#wordFilterModal .wordExcludeInput").val();s=K_(s.trim()),s=s.replace(/\s+/gi,"|");const n=new RegExp(s,"i"),i=[];let r;try{r=await Qm(t)}catch(f){return g(qe(f,"Failed to filter language words"),-1),[]}const d=o("#wordFilterModal .wordMaxInput").val(),u=o("#wordFilterModal .wordMinInput").val();let c,m;d===""?c=999:c=parseInt(d),u===""?m=1:m=parseInt(u);for(const f of r.words){const h=a.test(f),y=n.test(f);(h&&!y||h&&s==="")&&f.length<=c&&f.length>=m&&i.push(f)}return i}async function vC(t){const e=o("#wordFilterModal .languageInput").val(),a=await f6(e);if(a.length===0){g("No words found",0),eI();return}const s=a.join(Rl()?"|":" ");m6({modalChainData:{text:s,set:t}})}function bC(){for(const t of qd.getModal().querySelectorAll("button"))t.setAttribute("disabled","true")}function eI(){for(const t of qd.getModal().querySelectorAll("button"))t.removeAttribute("disabled")}async function h6(){await c6(),o("#wordFilterModal button.generateButton").on("click",async()=>{const t=o("#wordFilterModal .presetInput").val(),e=o("#wordFilterModal .layoutInput").val(),a=XE[t];if(a===void 0){g(`Preset ${t} not found`,-1);return}const s=await Gm(e);o("#wordIncludeInput").val(a.getIncludeString(s).map(n=>n[0]).join(" ")),o("#wordExcludeInput").val(a.getExcludeString(s).map(n=>n[0]).join(" "))}),o("#wordFilterModal button.addButton").on("click",()=>{o("#wordFilterModal .loadingIndicator").removeClass("hidden"),bC(),setTimeout(()=>{vC(!1)},0)}),o("#wordFilterModal button.setButton").on("click",()=>{o("#wordFilterModal .loadingIndicator").removeClass("hidden"),bC(),setTimeout(()=>{vC(!0)},0)})}const qd=new Ct({dialogId:"wordFilterModal",setup:h6});class le{constructor(e,a,s,n,i){if(this.configName=e,this.configValue=l[e],this.mode=s,this.configFunction=a,this.setCallback=n,this.updateCallback=i,this.updateUI(),this.mode==="select"){const r=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] select`);r==null||r.addEventListener("change",d=>{const u=o(d.target);u.hasClass("disabled")||u.hasClass("no-auto-handle")||this.setValue(u.val())})}else if(this.mode==="button")o(".pageSettings").on("click",`.section[data-config-name='${this.configName}'] button`,r=>{const d=o(r.currentTarget);if(d.hasClass("disabled")||d.hasClass("no-auto-handle"))return;const u=d.attr("data-config-value");if(u===void 0||u===""){console.error(`Failed to handle settings button click for ${e}: data-${e} is missing or empty.`),g("Button is missing data property. Please report this.",-1);return}let c=u;c==="true"&&(c=!0),c==="false"&&(c=!1),this.setValue(c)});else if(this.mode==="range"){const r=document.querySelector(`.pageSettings .section[data-config-name=${this.configName}] input[type=range]`);if(!r){g(`Failed to find range element for ${e}`,-1);return}const d=cs(250,u=>{this.setValue(u)});r.addEventListener("input",u=>{const c=o(u.target);if(c.hasClass("disabled")||c.hasClass("no-auto-handle"))return;const m=parseFloat(c.val());this.updateUI(m),d(m)})}}setValue(e){this.configFunction(e),this.updateUI(),this.setCallback&&this.setCallback()}updateUI(e){if(this.configValue=e??l[this.configName],o(`.pageSettings .section[data-config-name='${this.configName}'] button`).removeClass("active"),this.mode==="select"){const a=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] select`);if(a===null)return;a.value=this.configValue;const s=a.slim;s==null||s.store.setSelectedBy("value",[this.configValue]),s==null||s.render.renderValues(),s==null||s.render.renderOptions(s.store.getData())}else if(this.mode==="button")o(`.pageSettings .section[data-config-name='${this.configName}'] button[data-config-value='${this.configValue}']`).addClass("active");else if(this.mode==="range"){const a=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] input[type=range]`),s=document.querySelector(`.pageSettings .section[data-config-name='${this.configName}'] .value`);if(a===null||s===null)return;a.value=this.configValue,s.textContent=`${this.configValue.toFixed(1)}`}this.updateCallback&&this.updateCallback()}}const tI=new Ts({key:"activeTags",schema:Lt.array(nA),fallback:[]});function Cf(){var e,a;const t=[];(a=(e=T())==null?void 0:e.tags)==null||a.forEach(s=>{s.active===!0&&t.push(s._id)}),tI.set(t)}function g6(t=!1){var a;const e=T();e&&(e.tags=(a=e.tags)==null?void 0:a.map(s=>(s.active=!1,s)),Aa(e),jr(),t||Cf())}function y6(t,e,a=!1){var n;const s=T();s&&(s.tags=(n=s.tags)==null?void 0:n.map(i=>(i._id===t&&(i.active=e),i)),Aa(s),jr(),a||Cf())}function aI(t,e=!1){var a,s;(s=(a=T())==null?void 0:a.tags)==null||s.forEach(n=>{n._id===t&&(n.active===void 0?n.active=!0:n.active=!n.active)}),jr(),e||Cf()}function v6(){const t=tI.get();for(const e of t)aI(e,!0);Cf()}async function b6(t){var s,n;const e=T();if(!e)return;const a=(s=e.presets)==null?void 0:s.find(i=>i._id===t);if(a!==void 0){if(wC(a)){const i={...$w(),...BT(a.config)};await cl(Rc(i))}else await cl(Rc(a.config));if((!wC(a)||(n=a.settingGroups)!=null&&n.includes("behavior"))&&(g6(!0),a.config.tags)){for(const i of a.config.tags)y6(i,!0,!1);Cf()}ut(),g("Preset applied",1,{duration:2}),Pl()}}function wC(t){return t.settingGroups!==void 0&&t.settingGroups!==null}async function w6(t){var s;const e=T();if(!e)return;const a=(s=e.presets)==null?void 0:s.find(n=>n._id===t);if(a===void 0){g("Preset not found",0);return}return a}function k6(){var e;let t=l.theme;l.randomTheme!=="off"&&l.randomTheme!=="custom"&&xa!==null&&(t=xa),document.querySelectorAll(".pageSettings .section.themes .theme").forEach(a=>{a.classList.remove("active")}),(e=document.querySelector(`.pageSettings .section.themes .theme[theme='${t}']`))==null||e.classList.add("active")}function _l(t,e,a=!1,s=!1){if(a){const u=t.find("input.color").attr("id");u===void 0&&console.error("Could not find color ID!"),!s&&u!==void 0&&document.documentElement.style.setProperty(u,e);const c=t.find("label");c.val(e),c.attr("value",e),c.attr("for")!=="--bg-color"&&c.css("background-color",e),t.find("input.input").val(e),t.find("input.color").attr("value",e);return}const n=[{rule:/\b[0-9]{1,3},\s?[0-9]{1,3},\s?[0-9]{1,3}\s*\b/,start:"rgb(",end:")"},{rule:/\b[A-Z, a-z, 0-9]{6}\b/,start:"#",end:""},{rule:/\b[0-9]{1,3},\s?[0-9]{1,3}%,\s?[0-9]{1,3}%?\s*\b/,start:"hsl(",end:")"}];e=e.replace("°","");for(const u of n)if(e.match(u.rule)){e=u.start+e+u.end;break}o(".colorConverter").css("color",e);const i=gB(o(".colorConverter").css("color"));if(i===void 0)return;e=i;const r=t.find("input.color").attr("id");r===void 0&&console.error("Could not find color ID!"),!s&&r!==void 0&&document.documentElement.style.setProperty(r,e);const d=t.find("label");d.val(e),d.attr("value",e),d.attr("for")!=="--bg-color"&&d.css("background-color",e),t.find("input.input").val(e),t.find("input.color").attr("value",e)}async function xl(){var t;if(l.customTheme){const e=o(".pageSettings .section.themes .allCustomThemes.buttons").empty(),a=o(".pageSettings .section.themes .addCustomThemeButton");if(we())o(".pageSettings .section.themes .customThemeEdit #saveCustomThemeButton").text("save as new");else{o(".pageSettings .section.themes .customThemeEdit #saveCustomThemeButton").text("save");return}a.removeClass("hidden"),(((t=T())==null?void 0:t.customThemes)??[]).forEach(n=>{const i=n.colors[0],r=n.colors[1];e.append(`<div class="customTheme button" customThemeId='${n._id}' 
        style="color:${r};background:${i}">
        <div class="editButton"><i class="fas fa-pen"></i></div>
        <div class="text">${n.name.replace(/_/g," ")}</div>
        <div class="delButton"><i class="fas fa-trash fa-fw"></i></div>
        </div>`)})}else{const e=document.querySelector(".pageSettings .section.themes .favThemes.buttons");e.innerHTML="";let a="";const s=document.querySelector(".pageSettings .section.themes .allThemes.buttons");s.innerHTML="";let n="",i=l.theme;l.randomTheme!=="off"&&l.randomTheme!=="custom"&&xa!==null&&(i=xa);let r;try{r=await bB()}catch(d){g(qe(d,"Failed to refresh theme buttons"),-1);return}if(l.favThemes.length>0){e.style.marginBottom="1rem",e.style.marginTop="1rem";for(const d of r)if(l.favThemes.includes(d.name)){const u=i===d.name?"active":"";a+=`<div class="theme button ${u}" theme='${d.name}' style="background: ${d.bgColor}; color: ${d.mainColor};outline: 0 solid ${d.mainColor};">
            <div class="favButton active"><i class="fas fa-star"></i></div>
            <div class="text">${d.name.replace(/_/g," ")}</div>
            <div class="themeBubbles" style="background: ${d.bgColor};outline: 0.25rem solid ${d.bgColor};">
              <div class="themeBubble" style="background: ${d.mainColor}"></div>
              <div class="themeBubble" style="background: ${d.subColor}"></div>
              <div class="themeBubble" style="background: ${d.textColor}"></div>
            </div>
            </div>
            `}e.innerHTML=a}else e.style.marginBottom="0",e.style.marginTop="0";for(const d of r){if(l.favThemes.includes(d.name))continue;const u=i===d.name?"active":"";n+=`<div class="theme button ${u}" theme='${d.name}' style="background: ${d.bgColor}; color: ${d.mainColor};outline: 0 solid ${d.mainColor};">
        <div class="favButton"><i class="far fa-star"></i></div>
        <div class="text">${d.name.replace(/_/g," ")}</div>
        <div class="themeBubbles" style="background: ${d.bgColor};outline: 0.25rem solid ${d.bgColor};">
          <div class="themeBubble" style="background: ${d.mainColor}"></div>
          <div class="themeBubble" style="background: ${d.subColor}"></div>
          <div class="themeBubble" style="background: ${d.textColor}"></div>
        </div>
        </div>
        `}s.innerHTML=n}}function _6(t=!1){o(".pageSettings .section.themes .tabContainer .customTheme .colorPicker").each((e,a)=>{const s=l.customThemeColors[Di.indexOf(o(a).find("input.color").attr("id"))];_l(o(a),s,!1,t)})}function x6(t){if(l.favThemes.includes(t))Tw(l.favThemes.filter(e=>e!==t));else{const e=l.favThemes;e.push(t),Tw(e)}Pl()}function C6(){const t=[];for(const e of Di)t.push(o(`.pageSettings .customTheme .customThemeEdit #${e}[type='color']`).attr("value"));Rp(t),g("Custom theme saved",1)}function m0(t=!1){const e=o(".pageSettings .section.themes .tabs button[data-tab='preset']"),a=o(".pageSettings .section.themes .tabs button[data-tab='custom']");l.customTheme?(e.removeClass("active"),(!a.hasClass("active")||t)&&(a.addClass("active"),xl()),Xn(o('.pageSettings [tabContent="preset"]'),o('.pageSettings [tabContent="custom"]'),250)):(a.removeClass("active"),(!e.hasClass("active")||t)&&(e.addClass("active"),xl()),Xn(o('.pageSettings [tabContent="custom"]'),o('.pageSettings [tabContent="preset"]'),250))}o(".pageSettings .section.themes .tabs button").on("click",t=>{o(".pageSettings .section.themes .tabs button").removeClass("active");const e=o(t.currentTarget);e.addClass("active"),e.attr("data-tab")==="preset"?wi(!1):wi(!0)});o(".pageSettings").on("click"," .section.themes .customTheme.button",t=>{var s,n;if(o(t.target).hasClass("delButton")||o(t.target).hasClass("editButton"))return;const e=o(t.currentTarget).attr("customThemeId")??"",a=(n=(s=T())==null?void 0:s.customThemes)==null?void 0:n.find(i=>i._id===e);if(a===void 0){console.error("Could not find custom theme in snapshot for id ",e);return}Rp(a.colors)});o(".pageSettings").on("click",".section.themes .theme .favButton",t=>{const e=o(t.currentTarget).parents(".theme.button").attr("theme");e!==void 0?x6(e):console.error("Could not find the theme attribute attached to the button clicked!")});o(".pageSettings").on("click",".section.themes .theme.button",t=>{const e=o(t.currentTarget).attr("theme");!o(t.target).hasClass("favButton")&&e!==void 0&&VA(e)});o(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("input",t=>{const e=o(t.currentTarget).attr("id"),a=o(t.currentTarget).val();_l(o(".colorPicker #"+e).parent(),a,!0)});o(".pageSettings .section.themes .tabContainer .customTheme input[type=color]").on("change",t=>{const e=o(t.currentTarget).attr("id"),a=o(t.currentTarget).val();_l(o(".colorPicker #"+e).parent(),a)});o(".pageSettings .section.themes .tabContainer .customTheme input.input").on("blur",t=>{if(t.target.id==="name")return;const e=o(t.currentTarget).attr("id"),a=o(t.currentTarget).val();_l(o(".colorPicker #"+e).parent(),a)}).on("keypress",function(t){if(t.target.id!=="name"&&t.code==="Enter"){o(this).attr("disabled","disabled");const e=o(t.currentTarget).attr("id"),a=o(t.currentTarget).val();_l(o(".colorPicker #"+e).parent(),a),o(this).removeAttr("disabled")}});o(".pageSettings #loadCustomColorsFromPreset").on("click",async()=>{await _L(l.theme),Di.forEach(e=>{document.documentElement.style.setProperty(e,"")}),wL();const t=await Vr();Di.forEach(e=>{let a;e==="--bg-color"?a=t.bg:e==="--main-color"?a=t.main:e==="--sub-color"?a=t.sub:e==="--sub-alt-color"?a=t.subAlt:e==="--caret-color"?a=t.caret:e==="--text-color"?a=t.text:e==="--error-color"?a=t.error:e==="--error-extra-color"?a=t.errorExtra:e==="--colorful-error-color"?a=t.colorfulError:e==="--colorful-error-extra-color"&&(a=t.colorfulErrorExtra),_l(o(".colorPicker #"+e).parent(),a)})});o(".pageSettings #saveCustomThemeButton").on("click",async()=>{if(C6(),we()){const t={name:"custom",colors:l.customThemeColors};ht();const e=await OB(t);We(),e&&m0(!0)}else m0(!0)});Dt(t=>{t==="customThemeId"&&xl(),t==="theme"&&ft()==="settings"&&k6()});const hi={mode:"import",value:""};function sI(t,e){hi.mode=t,hi.value="",Nh.show({focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{var s,n,i,r;a.querySelector("input").value=hi.value,hi.mode==="export"?((s=a.querySelector("button"))==null||s.classList.add("hidden"),(n=a.querySelector("input"))==null||n.setAttribute("readonly","true")):hi.mode==="import"&&((i=a.querySelector("button"))==null||i.classList.remove("hidden"),(r=a.querySelector("input"))==null||r.removeAttribute("readonly"))}})}const Nh=new Ct({dialogId:"importExportSettingsModal",setup:async t=>{var e;(e=t.querySelector("input"))==null||e.addEventListener("input",a=>{hi.value=a.target.value}),t==null||t.addEventListener("submit",async a=>{if(a.preventDefault(),hi.mode==="import"){if(hi.value===""){Nh.hide();return}try{const s=mW.strip().parse(JSON.parse(hi.value));await cl(Rc(s))}catch(s){g("Failed to import settings: incorrect data schema",0),console.error(s),Nh.hide();return}g("Settings imported",1),Pl(),Nh.hide()}})}}),X={};async function S6(){await sM,X.smoothCaret=new le("smoothCaret",jA,"button"),X.difficulty=new le("difficulty",Pn,"button"),X.quickRestart=new le("quickRestart",WA,"button"),X.showAverage=new le("showAverage",LA,"button"),X.keymapMode=new le("keymapMode",mn,"button",()=>{var t;(t=X.showLiveWpm)==null||t.updateUI()},()=>{l.keymapMode==="off"?(o(".pageSettings .section[data-config-name='keymapStyle']").addClass("hidden"),o(".pageSettings .section[data-config-name='keymapLayout']").addClass("hidden"),o(".pageSettings .section[data-config-name='keymapLegendStyle']").addClass("hidden"),o(".pageSettings .section[data-config-name='keymapShowTopRow']").addClass("hidden"),o(".pageSettings .section[data-config-name='keymapSize']").addClass("hidden")):(o(".pageSettings .section[data-config-name='keymapStyle']").removeClass("hidden"),o(".pageSettings .section[data-config-name='keymapLayout']").removeClass("hidden"),o(".pageSettings .section[data-config-name='keymapLegendStyle']").removeClass("hidden"),o(".pageSettings .section[data-config-name='keymapShowTopRow']").removeClass("hidden"),o(".pageSettings .section[data-config-name='keymapSize']").removeClass("hidden"))}),X.keymapMatrix=new le("keymapStyle",eM,"button"),X.keymapLayout=new le("keymapLayout",bo,"select"),X.keymapLegendStyle=new le("keymapLegendStyle",XA,"button"),X.keymapShowTopRow=new le("keymapShowTopRow",tM,"button"),X.keymapSize=new le("keymapSize",rf,"range"),X.showKeyTips=new le("showKeyTips",DA,"button",void 0,()=>{l.showKeyTips?o(".pageSettings .tip").removeClass("hidden"):o(".pageSettings .tip").addClass("hidden")}),X.freedomMode=new le("freedomMode",zA,"button",()=>{var t;(t=X.confidenceMode)==null||t.updateUI()}),X.strictSpace=new le("strictSpace",TA,"button"),X.oppositeShiftMode=new le("oppositeShiftMode",$A,"button"),X.confidenceMode=new le("confidenceMode",HA,"button",()=>{var t,e;(t=X.freedomMode)==null||t.updateUI(),(e=X.stopOnError)==null||e.updateUI()}),X.indicateTypos=new le("indicateTypos",UA,"button"),X.hideExtraLetters=new le("hideExtraLetters",EA,"button"),X.blindMode=new le("blindMode",lA,"button"),X.quickEnd=new le("quickEnd",kA,"button"),X.repeatQuotes=new le("repeatQuotes",xA,"button"),X.ads=new le("ads",_A,"button"),X.alwaysShowWordsHistory=new le("alwaysShowWordsHistory",vA,"button"),X.britishEnglish=new le("britishEnglish",JA,"button"),X.singleListCommandLine=new le("singleListCommandLine",bA,"button"),X.capsLockWarning=new le("capsLockWarning",wA,"button"),X.flipTestColors=new le("flipTestColors",CA,"button"),X.showOutOfFocusWarning=new le("showOutOfFocusWarning",pA,"button"),X.colorfulMode=new le("colorfulMode",SA,"button"),X.startGraphsAtZero=new le("startGraphsAtZero",BA,"button"),X.autoSwitchTheme=new le("autoSwitchTheme",KA,"button"),X.randomTheme=new le("randomTheme",YA,"button"),X.stopOnError=new le("stopOnError",wk,"button",()=>{var t;(t=X.confidenceMode)==null||t.updateUI()}),X.soundVolume=new le("soundVolume",dA,"range"),X.playSoundOnError=new le("playSoundOnError",rA,"button",()=>{l.playSoundOnError!=="off"&&ov()}),X.playSoundOnClick=new le("playSoundOnClick",oA,"button",()=>{l.playSoundOnClick!=="off"&&Ri("KeyQ")}),X.showAllLines=new le("showAllLines",Pp,"button"),X.paceCaret=new le("paceCaret",mA,"button"),X.repeatedPace=new le("repeatedPace",fA,"button"),X.minWpm=new le("minWpm",hA,"button"),X.minAcc=new le("minAcc",gA,"button"),X.minBurst=new le("minBurst",yA,"button"),X.smoothLineScroll=new le("smoothLineScroll",qA,"button"),X.lazyMode=new le("lazyMode",Zp,"button"),X.layout=new le("layout",wo,"select"),X.language=new le("language",ul,"select"),X.fontSize=new le("fontSize",Xy,"button"),X.maxLineWidth=new le("maxLineWidth",of,"button"),X.caretStyle=new le("caretStyle",AA,"button"),X.paceCaretStyle=new le("paceCaretStyle",MA,"button"),X.timerStyle=new le("timerStyle",IA,"button"),X.liveSpeedStyle=new le("liveSpeedStyle",OA,"button"),X.liveAccStyle=new le("liveAccStyle",PA,"button"),X.liveBurstStyle=new le("liveBurstStyle",ZA,"button"),X.highlightMode=new le("highlightMode",Gr,"button"),X.tapeMode=new le("tapeMode",Sk,"button"),X.timerOpacity=new le("timerOpacity",NA,"button"),X.timerColor=new le("timerColor",RA,"button"),X.fontFamily=new le("fontFamily",FA,"button",void 0,()=>{const t=o(".pageSettings .section[data-config-name='fontFamily'] .buttons button[data-config-value='custom']");o(".pageSettings .section[data-config-name='fontFamily'] .buttons .active").length===0?(t.addClass("active"),t.text(`Custom (${l.fontFamily.replace(/_/g," ")})`)):t.text("Custom")}),X.alwaysShowDecimalPlaces=new le("alwaysShowDecimalPlaces",uA,"button"),X.typingSpeedUnit=new le("typingSpeedUnit",cA,"button"),X.customBackgroundSize=new le("customBackgroundSize",$k,"button")}function T6(){var t,e;o(".pageSettings .section.themes .favThemes.buttons").empty(),o(".pageSettings .section.themes .allThemes.buttons").empty(),o(".pageSettings .section.themes .allCustomThemes.buttons").empty(),o(".pageSettings .section[data-config-name='funbox'] .buttons").empty(),o(".pageSettings .section[data-config-name='fontFamily'] .buttons").empty();for(const a of document.querySelectorAll(".pageSettings select"))(e=(t=a==null?void 0:a.slim)==null?void 0:t.destroy)==null||e.call(t)}let kC=!1;async function $6(){var J;l.showKeyTips?o(".pageSettings .tip").removeClass("hidden"):o(".pageSettings .tip").addClass("hidden");let t;try{t=await nk()}catch(k){console.error(qe(k,"Failed to initialize settings language picker"))}const e=document.querySelector(".pageSettings .section[data-config-name='language'] select");let a="";if(t)for(const k of t){a+=`<optgroup label="${k.name}">`;for(const S of k.languages){const z=S===l.language?"selected":"",Ee=Ar(S);a+=`<option value="${S}" ${z}>${Ee}</option>`}a+="</optgroup>"}e.innerHTML=a,new ya({select:e,settings:{searchPlaceholder:"search"}});let s;try{s=await Vm()}catch(k){console.error(qe(k,"Failed to refresh keymap"))}const n=document.querySelector(".pageSettings .section[data-config-name='layout'] select"),i=document.querySelector(".pageSettings .section[data-config-name='keymapLayout'] select");let r='<option value="default">off</option>',d='<option value="overrideSync">emulator sync</option>';if(s)for(const k of Object.keys(s)){const S=`<option value="${k}">${k.replace(/_/g," ")}</option>`;k.toString()!=="korean"&&(r+=S),k.toString()!=="default"&&(d+=S)}n.innerHTML=r,i.innerHTML=d,new ya({select:n}),new ya({select:i});let u;try{u=await ak()}catch(k){console.error(qe(k,"Failed to load themes into dropdown boxes"))}const c=document.querySelector(".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.light"),m=document.querySelector(".pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.dark");let f="",h="";if(u)for(const k of u){const S=`<option value="${k.name}" ${k.name===l.themeLight?"selected":""}>${k.name.replace(/_/g," ")}</option>`;f+=S;const z=`<option value="${k.name}" ${k.name===l.themeDark?"selected":""}>${k.name.replace(/_/g," ")}</option>`;h+=z}c.innerHTML=f,m.innerHTML=h,new ya({select:c,events:{afterChange:k=>{var S;GA((S=k[0])==null?void 0:S.value)}}}),new ya({select:m,events:{afterChange:k=>{var S;QA((S=k[0])==null?void 0:S.value)}}});const y=document.querySelector(".pageSettings .section[data-config-name='funbox'] .buttons");y.innerHTML=`<div class="funbox button" data-config-value='none'>none</div>`;let b="",w;try{w=await Ol()}catch(k){console.error(qe(k,"Failed to get funbox list"))}if(w){for(const k of w)k.name==="mirror"?b+=`<div class="funbox button" data-config-value='${k.name}' aria-label="${k.info}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1);">${k.name.replace(/_/g," ")}</div>`:k.name==="upside_down"?b+=`<div class="funbox button" data-config-value='${k.name}' aria-label="${k.info}" data-balloon-pos="up" data-balloon-length="fit" style="transform:scaleX(-1) scaleY(-1); z-index:1;">${k.name.replace(/_/g," ")}</div>`:b+=`<div class="funbox button" data-config-value='${k.name}' aria-label="${k.info}" data-balloon-pos="up" data-balloon-length="fit">${k.name.replace(/_/g," ")}</div>`;y.innerHTML=b}let $=!0;const E=document.querySelector(".pageSettings .section[data-config-name='fontFamily'] .buttons");E.innerHTML="";let L="",be;try{be=await xB()}catch(k){console.error(qe(k,"Failed to update fonts settings buttons"))}if(be){for(const k of be){let S=k.name;S==="Helvetica"&&(S="Comic Sans MS"),(k.systemFont??!1)===!1&&(S+=" Preview");const z=l.fontFamily===k.name?" active":"",Ee=k.display!==void 0?k.display:k.name;l.fontFamily===k.name&&($=!1),L+=`<button class="${z}" style="font-family:${S}" data-config-value="${k.name.replace(/ /g,"_")}">${Ee}</button>`}L+=$?`<button class="no-auto-handle active" data-config-value="custom">Custom (${l.fontFamily.replace(/_/g," ")})</button>`:'<button class="no-auto-handle" data-config-value="custom"">Custom</button>',E.innerHTML=L}if(o(".pageSettings .section[data-config-name='customBackgroundSize'] input").val(l.customBackground),lI(),o(".pageSettings .section[data-config-name='fontSize'] input").val(l.fontSize),o(".pageSettings .section[data-config-name='maxLineWidth'] input").val(l.maxLineWidth),o(".pageSettings .section[data-config-name='keymapSize'] input").val(l.keymapSize),o(".pageSettings .section[data-config-name='customLayoutfluid'] input").val(l.customLayoutfluid.replace(/#/g," ")),wy(!0),!kC)await S6(),kC=!0;else for(const k of Object.keys(X))(J=X[k])==null||J.updateUI();wy(!1),await xl(),await sM}function nI(){o(".pageSettings .section.needsAccount").addClass("hidden")}function A6(){o(".pageSettings .section.needsAccount").removeClass("hidden"),rI(),oI()}function iI(){o(".pageSettings .section[data-config-name='funbox'] .button").removeClass("active"),o(".pageSettings .section[data-config-name='funbox'] .button").removeClass("disabled"),Ol().then(t=>{t.forEach(e=>{!ok(l.funbox,e.name)&&!l.funbox.split("#").includes(e.name)&&o(`.pageSettings .section[data-config-name='funbox'] .button[data-config-value='${e.name}']`).addClass("disabled")})}).catch(t=>{const e=qe(t,"Failed to update funbox buttons");g(e,-1)}),l.funbox.split("#").forEach(t=>{o(`.pageSettings .section[data-config-name='funbox'] .button[data-config-value='${t}']`).addClass("active")})}function rI(){var t,e;if(we()&&T()){const a=o(".pageSettings .section.tags .tagsList").empty();(e=(t=T())==null?void 0:t.tags)==null||e.forEach(s=>{a.append(`

      <div class="buttons tag" data-id="${s._id}" data-name="${s.name}" data-display="${s.display}">
        <button class="tagButton ${s.active?"active":""}" active="${s.active}">
          ${s.display}
        </button>
        <button class="clearPbButton" aria-label="clear tags personal bests" data-balloon-pos="left" >
          <i class="fas fa-crown fa-fw"></i>
        </button>
        <button class="editButton" aria-label="rename tag" data-balloon-pos="left" >
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton" aria-label="remove tag"  data-balloon-pos="left" >
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>

      `)}),o(".pageSettings .section.tags").removeClass("hidden")}else o(".pageSettings .section.tags").addClass("hidden")}function oI(){var t,e;if(we()&&T()){const a=o(".pageSettings .section.presets .presetsList").empty();(e=(t=T())==null?void 0:t.presets)==null||e.forEach(s=>{a.append(`
      <div class="buttons preset" data-id="${s._id}" data-name="${s.name}" data-display="${s.display}">
        <button class="presetButton">${s.display}</button>
        <button class="editButton">
          <i class="fas fa-pen fa-fw"></i>
        </button>
        <button class="removeButton">
          <i class="fas fa-trash fa-fw"></i>
        </button>
      </div>
      
      `)}),o(".pageSettings .section.presets").removeClass("hidden")}else o(".pageSettings .section.presets").addClass("hidden")}async function fr(t=!0){var n;if(t)for(const i of Object.keys(X))(n=X[i])==null||n.updateUI();rI(),oI(),iI(),await jt(0),m0(!0),_6(!0),o(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val(Ta(l.typingSpeedUnit).fromWpm(l.paceCaretCustomSpeed)),o(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val(Ta(l.typingSpeedUnit).fromWpm(l.minWpmCustomSpeed)),o(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val(l.minAccCustom),o(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val(Ta(l.typingSpeedUnit).fromWpm(l.minBurstCustomSpeed)),l.autoSwitchTheme?o(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").removeClass("hidden"):o(".pageSettings .section[data-config-name='autoSwitchThemeInputs']").addClass("hidden"),l.customBackground!==""?o(".pageSettings .section[data-config-name='customBackgroundFilter']").removeClass("hidden"):o(".pageSettings .section[data-config-name='customBackgroundFilter']").addClass("hidden"),lI(),o(".pageSettings .section[data-config-name='customBackgroundSize'] input").val(l.customBackground),we()?A6():nI(),kL();const e=window.navigator.userAgent.toLowerCase(),a=e.includes("mac")&&!e.includes("firefox")?"cmd":"ctrl",s=l.quickRestart==="esc"?"tab":"esc";o(".pageSettings .tip").html(`
    tip: You can also change all these settings quickly using the
    command line (<key>${s}</key> or <key>${a}</key> + <key>shift</key> + <key>p</key>)`)}function dI(t){const e=o(`.pageSettings .settingsGroup.${t}`);e.stop(!0,!0).slideToggle(250).toggleClass("slideup"),e.hasClass("slideup")?o(`.pageSettings .sectionGroupTitle[group=${t}]`).addClass("rotateIcon"):o(`.pageSettings .sectionGroupTitle[group=${t}]`).removeClass("rotateIcon")}function lI(){const t=o(".pageSettings .section[data-config-name='customBackgroundSize'] button.remove");l.customBackground!==void 0&&l.customBackground.length>0?t.removeClass("hidden"):t.addClass("hidden")}o(".pageSettings .section[data-config-name='paceCaret']").on("focusout","input.customPaceCaretSpeed",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val()),e=Ta(l.typingSpeedUnit).toWpm(t);kk(e)});o(".pageSettings .section[data-config-name='paceCaret']").on("click","button.save",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='paceCaret'] input.customPaceCaretSpeed").val()),e=Ta(l.typingSpeedUnit).toWpm(t);kk(e)});o(".pageSettings .section[data-config-name='minWpm']").on("focusout","input.customMinWpmSpeed",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val()),e=Ta(l.typingSpeedUnit).toWpm(t);_k(e)});o(".pageSettings .section[data-config-name='minWpm']").on("click","button.save",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='minWpm'] input.customMinWpmSpeed").val()),e=Ta(l.typingSpeedUnit).toWpm(t);_k(e)});o(".pageSettings .section[data-config-name='minAcc']").on("focusout","input.customMinAcc",()=>{xk(parseInt(o(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val()))});o(".pageSettings .section[data-config-name='minAcc']").on("click","button.save",()=>{xk(parseInt(o(".pageSettings .section[data-config-name='minAcc'] input.customMinAcc").val()))});o(".pageSettings .section[data-config-name='minBurst']").on("focusout","input.customMinBurst",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val()),e=Ta(l.typingSpeedUnit).toWpm(t);Ck(e)});o(".pageSettings .section[data-config-name='minBurst']").on("click","button.save",()=>{const t=parseInt(o(".pageSettings .section[data-config-name='minBurst'] input.customMinBurst").val()),e=Ta(l.typingSpeedUnit).toWpm(t);Ck(e)});o(".pageSettings .section[data-config-name='funbox']").on("click",".button",t=>{const e=o(t.currentTarget).attr("data-config-value");fL(e),iI()});o(".pageSettings .section.tags").on("click",".tagsList .tag .tagButton",t=>{const e=t.currentTarget,a=o(e).parent(".tag").attr("data-id");aI(a),o(e).toggleClass("active")});o(".pageSettings .section.presets").on("click",".presetsList .preset .presetButton",async t=>{const e=t.currentTarget,a=o(e).parent(".preset").attr("data-id");await b6(a),fr()});o("#importSettingsButton").on("click",()=>{sI("import")});o("#exportSettingsButton").on("click",()=>{const t=JSON.stringify(l);navigator.clipboard.writeText(t).then(function(){g("JSON Copied to clipboard",0)},function(){sI("export")})});o(".pageSettings .sectionGroupTitle").on("click",t=>{dI(o(t.currentTarget).attr("group"))});o(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton button.save").on("click",()=>{df(o(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").val())});o(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton button.remove").on("click",()=>{df("")});o(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&df(o(".pageSettings .section[data-config-name='customBackgroundSize'] .inputAndButton input").val())});o(".pageSettings .section[data-config-name='fontSize'] .inputAndButton button.save").on("click",()=>{Xy(parseFloat(o(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&Xy(parseFloat(o(".pageSettings .section[data-config-name='fontSize'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton button.save").on("click",()=>{of(parseFloat(o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").on("focusout",()=>{of(parseFloat(o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&of(parseFloat(o(".pageSettings .section[data-config-name='maxLineWidth'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton button.save").on("click",()=>{rf(parseFloat(o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("focusout",()=>{rf(parseFloat(o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").on("keypress",t=>{t.key==="Enter"&&rf(parseFloat(o(".pageSettings .section[data-config-name='keymapSize'] .inputAndButton input").val()))&&g("Saved",1,{duration:1})});o(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton button.save").on("click",()=>{Tk(o(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton input").val()).then(t=>{t&&g("Custom layoutfluid saved",1)})});o(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton .input").on("keypress",t=>{t.key==="Enter"&&Tk(o(".pageSettings .section[data-config-name='customLayoutfluid'] .inputAndButton input").val()).then(e=>{e&&g("Custom layoutfluid saved",1)})});o(".pageSettings .quickNav .links a").on("click",t=>{const e=t.target.innerText;o(`.pageSettings .settingsGroup.${e}`).hasClass("slideup")&&dI(e)});let uI=!1;function wy(t){uI=t}Dt((t,e)=>{t==="fullConfigChange"&&wy(!0),t==="fullConfigChangeFinished"&&wy(!1),t==="themeLight"?o(`.pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.light option[value="${e}"]`).attr("selected","true"):t==="themeDark"&&o(`.pageSettings .section[data-config-name='autoSwitchThemeInputs'] select.dark option[value="${e}"]`).attr("selected","true"),!(uI||t==="saveToLocalStorage")&&ft()==="settings"&&t!=="theme"&&fr()});const M6=new di({name:"settings",element:o(".page.pageSettings"),path:"/settings",afterHide:async()=>{T6(),Na("pageSettings")},beforeShow:async()=>{Cs("pageSettings","main"),await $6(),await fr(!1)}});o(async()=>{ms("pageSettings")});class Jr{constructor(e,a){var n;this.inputElement=e,o(this.inputElement).wrap('<div class="inputAndIndicator"></div>'),this.parentElement=o(this.inputElement).parent(".inputAndIndicator"),this.options=a,this.currentStatus=null;let s='<div class="statusIndicator">';for(const[i,r]of Object.entries(a))s+=`
      <div
        class="indicator level${r.level} hidden"
        data-option-id="${i}"
        
        ${(((n=r.message)==null?void 0:n.length)??0)>27?'data-balloon-length="large"':""}
        data-balloon-pos="up"
        ${r.message??""?`aria-label="${r.message}"`:""}
      >
        <i class="fas fa-fw ${r.icon} ${r.spinIcon?"fa-spin":""}"></i>
      </div>
      `;s+="</div>",this.parentElement.append(s)}hide(){this.parentElement.find(".statusIndicator div").addClass("hidden"),this.currentStatus=null,o(this.inputElement).css("padding-right","0.5em")}show(e,a){this.hide(),this.currentStatus=e;const s=this.parentElement.find(`[data-option-id="${e}"]`);s.removeClass("hidden"),a!==void 0&&a!==""&&(a.length>20?s.attr("data-balloon-length","large"):s.removeAttr("data-balloon-length"),s.attr("aria-label",a)),o(this.inputElement).css("padding-right","2.1em")}get(){return this.currentStatus}}const L6=["gmaill.com","gamil.com","gmali.com","gnail.com","gmil.com","gamail.com","hotmai.com","gmial.com","hotmal.com","yaho.com","outlokk.com","gmil.com","hotmial.com","yahooo.com","otulook.com","gamil.com","hotnail.com","yaoo.com","outlok.com","gmail.cmo","hotmail.cmo","yahho.com","outloook.com","gmaail.com","hottmail.com","yaho.com","outllok.com","gmai.com","hotmil.com","yhaoo.com","outlookk.com","gmil.com","htmial.com","yaahoo.com","otlook.com","gamail.com","hotnail.com","yaoho.com","outlok.com","gemail.com","hotmiall.com","yahhoo.com","outloookk.com","gmal.com","hottmail.com","yahio.com","outlokkk.com",".comm",".con",".cmo",".coom",".cim",".vom","-online.de","-tonline.de","acor.de","aecor.de","ahoo.de","al.com","ao.com","aol.cm","aol.con","aol.ocm","aol.om","aoll.com","apl.com","arco.de","arocr.de","aror.de","feenet.de","freeenet.de","freeent.de","freeet.de","freemet.de","freeneet.de","freent.de","frenet.de","gm.de","gm.net","gm.xde","gmc.de","gmx.ded","gmx.dw","gmxx.de","gmy.de","gx.de","hmx.de","homail.de","hotmai.de","hotmal.de","mx.de","mx.net","@otmail.com","r-online.de","rcor.de","reenet.de","t--online.de","t-0nline.de","t-nline.de","t-oline.de","t-omline.de","t-onine.de","t-onlien.de","t-onliine.de","t-onlin.de","t-onlinde.de","t-onlinr.de","t-onlione.de","t-onlline.de","t-onlne.de","t-onlone.de","t.-online.de","t.online.de","tonline.de","wb.de","we.de","web.ded","web.dw","wed.de","weeb.de","wen.de","wweb.de","yaho.de","yahooo.de","yaoo.de","yhoo.de","yahhoo.de","icoud.com","icloud.cim","icloud.con","icloud.ocm","icloud.om","icloud.cm"];function C_(){o(".page.pageLogin .register.side button").prop("disabled",!1)}function Sf(){o(".page.pageLogin .register.side button").prop("disabled",!0)}function Ja(){o(".pageLogin input").prop("disabled",!1),o(".pageLogin button").prop("disabled",!1)}function S_(){o(".pageLogin input").prop("disabled",!0),o(".pageLogin button").prop("disabled",!0)}function T_(){o(".pageLogin .preloader").removeClass("hidden")}function Qa(){o(".pageLogin .preloader").addClass("hidden")}const Xa=()=>{hr.get()!=="available"||Wn.get()!=="valid"&&Wn.get()!=="typo"&&Wn.get()!=="edu"||Cl.get()!=="match"||gr.get()!=="good"||Sl.get()!=="match"?Sf():C_()},E6=cs(1e3,async()=>{const t=o(".page.pageLogin .register.side .usernameInput").val();if(!t){Xa();return}const e=await F.users.getNameAvailability({params:{name:t}});e.status===200?hr.show("available",e.body.message):e.status===422?hr.show("unavailable",e.body.message):e.status===409?hr.show("taken",e.body.message):(hr.show("unavailable",e.body.message),g("Failed to check name availability: "+e.body.message,-1)),Xa()}),I6=()=>{const t=o(".page.pageLogin .register.side .emailInput").val(),e=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,a=/@.*(student|education|school|\.edu$|\.edu\.|\.ac\.|\.sch\.)/i,s=L6.some(n=>t.endsWith(n));e.test(t)?s?Wn.show("typo","Please check your email address, it may contain a typo."):a.test(t)?Wn.show("edu","Some education emails will fail to receive our messages, or disable the account as soon as you graduate. Consider using a personal email address."):Wn.show("valid"):Wn.show("invalid"),Xa()},cI=()=>{const t=o(".page.pageLogin .register.side .emailInput").val(),e=o(".page.pageLogin .register.side .verifyEmailInput").val();t===e?Cl.show("match"):Cl.show("mismatch"),Xa()},pI=()=>{const t=o(".page.pageLogin .register.side .passwordInput").val();Z0(t)?gr.show("good","Password is good"):t.length<8?gr.show("short","Password must be at least 8 characters"):t.length>64?gr.show("long","Password must be at most 64 characters"):gr.show("weak","Password must contain at least one capital letter, number, and special character"),Xa()},mI=()=>{const t=o(".page.pageLogin .register.side .passwordInput").val(),e=o(".page.pageLogin .register.side .verifyPasswordInput").val();t===e?Sl.show("match"):Sl.show("mismatch"),Xa()},hr=new Jr(o(".page.pageLogin .register.side input.usernameInput"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},taken:{icon:"fa-user",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),Wn=new Jr(o(".page.pageLogin .register.side input.emailInput"),{valid:{icon:"fa-check",level:1},invalid:{icon:"fa-times",level:-1},typo:{icon:"fa-exclamation-triangle",level:1},edu:{icon:"fa-exclamation-triangle",level:1}}),Cl=new Jr(o(".page.pageLogin .register.side input.verifyEmailInput"),{match:{icon:"fa-check",level:1},mismatch:{icon:"fa-times",level:-1}}),gr=new Jr(o(".page.pageLogin .register.side input.passwordInput"),{good:{icon:"fa-check",level:1},short:{icon:"fa-times",level:-1},long:{icon:"fa-times",level:-1},weak:{icon:"fa-times",level:-1}}),Sl=new Jr(o(".page.pageLogin .register.side input.verifyPasswordInput"),{match:{icon:"fa-check",level:1},mismatch:{icon:"fa-times",level:-1}});o(".page.pageLogin .register.side .usernameInput").on("input",()=>{setTimeout(()=>{if(o(".page.pageLogin .register.side .usernameInput").val()===""){hr.hide();return}else hr.show("checking"),E6()},1)});o(".page.pageLogin .register.side .emailInput").on("input",()=>{const t=o(".page.pageLogin .register.side .emailInput").val(),e=o(".page.pageLogin .register.side .verifyEmailInput").val();if(!t&&!e){Wn.hide(),Cl.hide();return}I6(),cI()});o(".page.pageLogin .register.side .verifyEmailInput").on("input",()=>{const t=o(".page.pageLogin .register.side .emailInput").val(),e=o(".page.pageLogin .register.side .verifyEmailInput").val();if(!t&&!e){Wn.hide(),Cl.hide();return}cI()});o(".page.pageLogin .register.side .passwordInput").on("input",()=>{const t=o(".page.pageLogin .register.side .passwordInput").val(),e=o(".page.pageLogin .register.side .verifyPasswordInput").val();if(!t&&!e){gr.hide(),Sl.hide();return}pI(),mI()});o(".page.pageLogin .register.side .verifyPasswordInput").on("input",()=>{const t=o(".page.pageLogin .register.side .passwordInput").val(),e=o(".page.pageLogin .register.side .verifyPasswordInput").val();if(!t&&!e){gr.hide(),Sl.hide();return}pI(),mI()});const O6=new di({name:"login",element:o(".page.pageLogin"),path:"/login",afterHide:async()=>{o(".pageLogin input").val(""),hr.hide(),Wn.hide(),Cl.hide(),gr.hide(),Sl.hide(),Na("pageLogin")},beforeShow:async()=>{Cs("pageLogin","main"),Ja(),Sf()}});o(()=>{ms("pageLogin")});let ky,fI=new Promise(t=>{ky=t});function P6(){hI.show({mode:"dialog",beforeAnimation:async t=>{fI=new Promise(e=>{ky=e}),ql("register"),xf(t.querySelector(".g-recaptcha"),"register",e=>{ky(e),f0()})}})}function f0(t=!1){t&&ky(),hI.hide()}const hI=new Ct({dialogId:"registerCaptchaModal",customEscapeHandler:async()=>{f0(!0)},customWrapperClickHandler:async()=>{f0(!0)}});async function Z6(t){const e=sn;if(e===null)return;v9(t);const a=await F.results.add({body:{result:e}});if(a.status!==200){g("Failed to save last result: "+a.body.message,-1);return}const s=yn(e);s._id=a.body.data.insertedId,a.body.data.isPb&&(s.isPb=!0),zT(s),HT(1,s.testDuration+s.incompleteTestSeconds-s.afkDuration),nE(),g(`Last test result saved ${a.body.data.isPb?"(new pb!)":""}`,1)}function R6(){km.getModal().querySelector(".result").innerHTML=`
  <div class="group wpm">
        <div class="sub">wpm</div>
        <div class="val">-</div>
      </div>
      <div class="group acc">
        <div class="sub">accuracy</div>
        <div class="val">-</div>
      </div>
      <div class="group raw">
        <div class="sub">raw</div>
        <div class="val">-</div>
      </div>
      <div class="group con">
        <div class="sub">consistency</div>
        <div class="val">-</div>
      </div>
      <div class="group chardata">
        <div class="sub">characters</div>
        <div class="val">-</div>
      </div>
      <div class="group testType">
        <div class="sub">test type</div>
        <div class="val">-</div>
      </div>`}function N6(){const t=sn;md("wpm",t.wpm),md("acc",t.acc+"%"),md("raw",t.rawWpm),md("con",t.consistency+"%"),md("chardata",t.charStats.join("/"));let e=t.mode+" "+t.mode2;e+="<br>"+t.language,t.numbers&&(e+="<br>numbers"),t.punctuation&&(e+="<br>punctuation"),t.blindMode&&(e+="<br>blind"),t.lazyMode&&(e+="<br>lazy"),t.funbox!=="none"&&(e+="<br>"+t.funbox.replace(/_/g," ").replace(/#/g,", ")),t.difficulty!=="normal"&&(e+="<br>"+t.difficulty),t.tags.length>0&&(e+="<br>"+t.tags.length+" tags"),md("testType",e,!0)}function md(t,e,a=!1){a?o(km.getModal()).find(`.group.${t} .val`).html(`${e}`):o(km.getModal()).find(`.group.${t} .val`).text(e)}function D6(){if(!sn){g("Failed to show last signed out result modal: no last result",-1);return}R6(),km.show({beforeAnimation:async()=>{N6()}})}function _C(){km.hide()}const km=new Ct({dialogId:"lastSignedOutResult",setup:async t=>{var e,a;(e=t.querySelector("button.save"))==null||e.addEventListener("click",async s=>{var n,i;Z6((i=(n=Qt)==null?void 0:n.currentUser)==null?void 0:i.uid),_C()}),(a=t.querySelector("button.discard"))==null||a.addEventListener("click",s=>{nE(),g("Last test result discarded",0),_C()})},customWrapperClickHandler:()=>{}});async function j6(t){if(!t)return;const e=new URLSearchParams(t.slice(1));if(e.has("access_token")){history.replaceState(null,"","/");const a=e.get("access_token"),s=e.get("token_type"),n=e.get("state");ht();const i=await F.users.linkDiscord({body:{tokenType:s,accessToken:a,state:n}});if(We(),i.status!==200){g("Failed to link Discord: "+i.body.message,-1);return}if(i.body.data===null){g("Failed to link Discord: data returned was null",-1);return}g(i.body.message,1);const r=T();if(!r)return;const{discordId:d,discordAvatar:u}=i.body.data;d!==void 0?r.discordId=d:r.discordAvatar=u,Aa(r),hg(d,u)}}const B6=Lt.object({c:pk,i:Lt.string().optional(),s:uk.optional(),f:ck.optional()});function q6(t){const e=R0("customTheme",t);if(e===null)return;let a;try{a=HO(atob(e),B6)}catch(c){console.log("Custom theme URL decoding failed",c),g("Failed to load theme from URL: "+c.message,0);return}let s,n,i,r;if(Array.isArray(a.c)&&a.c.length===10?(s=a.c,n=a.i,i=a.s,r=a.f):Array.isArray(a)&&a.length===10&&(s=a),s===void 0||s.length!==10){g("Failed to load theme from URL: no colors found",0);return}const d=l.customTheme,u=l.customThemeColors;try{Rp(s),g("Custom theme applied",1),n!==void 0&&i!==void 0&&r!==void 0&&(df(n),$k(i),Ak(r)),l.customTheme||wi(!0)}catch(c){g("Something went wrong. Reverting to previous state.",0),console.error(c),wi(d),Rp(u)}}function W6(t){const e=R0("testSettings",t);if(e===null)return;const a=JSON.parse($2.decompressFromURI(e)??""),s={};if(a[0]!==null&&(ha(a[0],!0),s.mode=a[0]),a[1]!==null&&(l.mode==="time"?Dn(parseInt(a[1],10),!0):l.mode==="words"?Zr(parseInt(a[1],10),!0):l.mode==="quote"&&(bi(-2,!1),tk(parseInt(a[1],10)),$t()),s.mode2=a[1]),a[2]!==null){const i=a[2];Pi(i.text),br(i.limit.mode),ko(i.limit.value),pl(i.pipeDelimiter),s["custom text settings"]=""}a[3]!==null&&(xn(a[3],!0),s.punctuation=a[3]?"on":"off"),a[4]!==null&&(Fs(a[4],!0),s.numbers=a[4]?"on":"off"),a[5]!==null&&(ul(a[5],!0),s.language=a[5]),a[6]!==null&&(Pn(a[6],!0),s.difficulty=a[6]),a[7]!==null&&(yi(a[7],!0),s.funbox=a[7]),ut({nosave:!0});let n="";Object.keys(s).forEach(i=>{const r=s[i];r!==void 0&&(n+=`${i}${vs(r?": "+r:"")}<br>`)}),n!==""&&g("Settings applied from URL:<br><br>"+n,1,{duration:10,allowHTML:!0})}function F6(t){const e=(R0("challenge",t)??"").toLowerCase();e!==""&&(g("Loading challenge",0),Rz(e).then(a=>{a&&(g("Challenge loaded",1),ut({nosave:!0}))}).catch(a=>{g("Failed to load challenge",-1),console.error(a)}))}let hn=[],gI=0,vi=[],$o=[];const kr={notifications:[],psas:[]};function pb(){yI(!1),bI.hide({afterAnimation:async()=>{var r;o("#alertsPopup .notificationHistory .list").empty(),o("#alertsPopup .psas .list").empty();const t=[];let e=0;if(vi.length===0&&$o.length===0)return;const a=await F.users.updateInbox({body:{mailIdsToMarkRead:vi.length>0?vi:void 0,mailIdsToDelete:$o.length>0?$o:void 0}}),s=a.status,n=a.body.message;if(s!==200){g(`Failed to update inbox: ${n}`,-1);return}const i=hn.filter(d=>d.rewards.length>0&&vi.includes(d.id)).map(d=>d.rewards).reduce(function(d,u){return d.concat(u)},[]);for(const d of i)if(d.type==="xp")e+=d.item;else if(d.type==="badge"){const u=yV(d.item.id);u&&(t.push(u.name),qB(d.item))}if(t.length>0&&g(`New badge${t.length>1?"s":""} unlocked: ${t.join(", ")}`,1,{duration:5,customTitle:"Reward",customIcon:"gift"}),e>0){const d=((r=T())==null?void 0:r.xp)??0;YT(d,e),ZE(d+e),UT(e)}}})}async function z6(){bI.show({beforeAnimation:async()=>{we()?(o("#alertsPopup .accountAlerts").removeClass("hidden"),o("#alertsPopup .separator.accountSeparator").removeClass("hidden"),o("#alertsPopup .accountAlerts .list").html(`
          <div class="preloader"><i class="fas fa-fw fa-spin fa-circle-notch"></i></div>`)):(o("#alertsPopup .accountAlerts").addClass("hidden"),o("#alertsPopup .separator.accountSeparator").addClass("hidden")),hn=[],$o=[],vi=[],V6(),K6()},afterAnimation:async()=>{we()&&H6()}})}async function H6(){if(!ta()){o("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    You are offline
    </div>
    `);return}const t=await F.users.getInbox();if(t.status===503){o("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Account inboxes are temporarily unavailable
    </div>
    `);return}else if(t.status!==200){o("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Error getting inbox: ${t.body.message} Please try again later
    </div>
    `);return}const e=t.body.data;if(hn=e.inbox,$_(),hn.length===0){o("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `);return}gI=e.maxMail,vI(),o("#alertsPopup .accountAlerts .list").empty();for(const a of hn){!a.read&&a.rewards.length===0&&vi.push(a.id);let s="";a.rewards.length>0&&!a.read&&(s=`<div class="rewards">
        <i class="fas fa-fw fa-gift"></i>
        <span>${a.rewards.length}</span>
      </div>`),o("#alertsPopup .accountAlerts .list").append(`
    
      <div class="item" data-id="${a.id}">
        <div class="indicator ${a.read?"":"main"}"></div>
        <div class="timestamp">${mS(new Date(a.timestamp))} ago</div>
        <div class="title">${a.subject}</div>
        <div class="body">
          ${a.body}

${s}
        </div>
        <div class="buttons">
          ${a.rewards.length>0&&!a.read?'<button class="markReadAlert textButton" aria-label="Claim" data-balloon-pos="left"><i class="fas fa-gift"></i></button>':""}
          ${a.rewards.length>0&&a.read||a.rewards.length===0?'<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>':""}
        </div>
      </div>
    
    `)}}function U6(t,e){kr.psas.push({message:t,level:e})}function K6(){if(kr.psas.length===0)o("#alertsPopup .psas .list").html('<div class="nothing">Nothing to show</div>');else{o("#alertsPopup .psas .list").empty();for(const t of kr.psas){const{message:e,level:a}=t;let s="";a===-1?s="error":a===1?s="main":a===0&&(s="sub"),o("#alertsPopup .psas .list").prepend(`
        <div class="item">
        <div class="indicator ${s}"></div>
        <div class="body">
          ${vs(e)}
        </div>
      </div>
      `)}}}function V6(){if(kr.notifications.length===0)o("#alertsPopup .notificationHistory .list").html('<div class="nothing">Nothing to show</div>');else{o("#alertsPopup .notificationHistory .list").empty();for(const t of kr.notifications){const{message:e,level:a,customTitle:s}=t;let n="Notice",i="sub";a===-1?(i="error",n="Error"):a===1&&(i="main",n="Success"),s!==void 0&&(n=s),o("#alertsPopup .notificationHistory .list").prepend(`
      <div class="item">
      <div class="indicator ${i}"></div>
      <div class="title">${n}</div>
      <div class="body">
        ${vs(e)}
      </div>
    </div>
    `)}}}function yI(t){t?o("header nav .showAlerts .notificationBubble").removeClass("hidden"):o("header nav .showAlerts .notificationBubble").addClass("hidden")}function vI(){o("#alertsPopup .accountAlerts .title .right").text(`${hn.length}/${gI}`)}function xC(t){$o.push(t),o(`#alertsPopup .accountAlerts .list .item[data-id="${t}"]`).remove(),o("#alertsPopup .accountAlerts .list .item").length==0&&o("#alertsPopup .accountAlerts .list").html(`
    <div class="nothing">
    Nothing to show
    </div>
    `),$_(),vI()}function CC(t){vi.push(t);const e=o(`#alertsPopup .accountAlerts .list .item[data-id="${t}"]`);$_(),e.find(".indicator").removeClass("main"),e.find(".buttons").empty(),e.find(".buttons").append('<button class="deleteAlert textButton" aria-label="Delete" data-balloon-pos="left"><i class="fas fa-trash"></i></button>'),e.find(".rewards").animate({opacity:0,height:0,marginTop:0},250,"easeOutCubic",()=>{e.find(".rewards").remove()})}function $_(){const t=o("#alertsPopup .accountAlerts .claimAll"),e=o("#alertsPopup .accountAlerts .deleteAll");if(t.addClass("hidden"),e.addClass("hidden"),hn.length>0){let a=0;for(const s of hn)!s.read&&!vi.includes(s.id)&&(a+=s.rewards.length);a>0?t.removeClass("hidden"):e.removeClass("hidden")}$o.length===hn.length&&e.addClass("hidden")}o("header nav .showAlerts").on("click",()=>{z6()});H2((t,e,a)=>{kr.notifications.push({message:t,level:e,customTitle:a}),kr.notifications.length>25&&kr.notifications.shift()});const bI=new Ct({dialogId:"alertsPopup",customAnimations:{show:{modal:{from:{marginRight:"-10rem"},to:{marginRight:"0"},easing:"easeOutCirc"}},hide:{modal:{from:{marginRight:"0"},to:{marginRight:"-10rem"},easing:"easeInCirc"}}},customEscapeHandler:()=>{pb()},customWrapperClickHandler:()=>{pb()},setup:async()=>{o("#alertsPopup .accountAlerts").on("click",".claimAll",()=>{for(const t of hn)!t.read&&!vi.includes(t.id)&&CC(t.id)}),o("#alertsPopup .accountAlerts").on("click",".deleteAll",()=>{for(const t of hn)$o.includes(t.id)||xC(t.id)}),o("#alertsPopup .mobileClose").on("click",()=>{pb()}),o("#alertsPopup .accountAlerts .list").on("click",".item .buttons .deleteAlert",t=>{const e=o(t.currentTarget).closest(".item").attr("data-id");xC(e)}),o("#alertsPopup .accountAlerts .list").on("click",".item .buttons .markReadAlert",t=>{const e=o(t.currentTarget).closest(".item").attr("data-id");CC(e)})}});function G6(){if(!ta()){g("You are offline",0,{duration:2});return}_m.show({focusFirstInput:!0,beforeAnimation:async t=>{var e,a,s,n;((e=T())==null?void 0:e.streakHourOffset)!==void 0?((a=t.querySelector("input"))==null||a.remove(),(s=t.querySelector(".preview"))==null||s.remove(),(n=t.querySelector("button"))==null||n.remove(),t.querySelector(".text").textContent="You have already set your streak hour offset."):(t.querySelector("input").value="0",wI())}})}function wI(){var n;const t=parseInt((n=_m.getModal().querySelector("input"))==null?void 0:n.value,10),e=_m.getModal().querySelector(".preview"),a=new Date;a.setUTCHours(0),a.setUTCMinutes(0),a.setUTCSeconds(0),a.setUTCMilliseconds(0);const s=new Date;s.setUTCHours(0),s.setUTCMinutes(0),s.setUTCSeconds(0),s.setUTCMilliseconds(0),s.setHours(s.getHours()- -1*t),e.innerHTML=`
    <div class="row"><div>Current local reset time:</div><div>${a.toLocaleTimeString()}</div></div>
    <div class="row"><div>New local reset time:</div><div>${s.toLocaleTimeString()}</div></div>
  `}function Q6(){_m.hide()}async function Y6(){var a;const t=parseInt((a=_m.getModal().querySelector("input"))==null?void 0:a.value,10);if(isNaN(t)){g("Streak hour offset must be a number",0);return}if(t<-11||t>12){g("Streak hour offset must be between -11 and 12",0);return}ht();const e=await F.users.setStreakHourOffset({body:{hourOffset:t}});if(We(),e.status!==200)g("Failed to set streak hour offset: "+e.body.message,-1);else{g("Streak hour offset set",1);const s=T();s.streakHourOffset=t,Aa(s),Q6()}}const _m=new Ct({dialogId:"streakHourOffsetModal",setup:async t=>{var e,a;(e=t.querySelector("input"))==null||e.addEventListener("input",()=>{wI()}),(a=t.querySelector("button"))==null||a.addEventListener("click",()=>{Y6()})}});function ih({tagname:t,classes:e,attributes:a,innerHTML:s}){let n=`<${t}`;return e!==void 0&&(n+=` class="${e.join(" ")}"`),a!==void 0&&(n+=" "+Object.entries(a).filter(i=>i[1]!==void 0).sort((i,r)=>i[0].localeCompare(r[0])).map(i=>i[1]===!0?`${i[0]}`:`${i[0]}="${i[1]}"`).join(" ")),s!==void 0?n+=`>${s}</${t}>`:n+=" />",n}class Zt{constructor(e){this.parameters=[],this.id=e.id,this.execFn=e.execFn,this.title=e.title,this.inputs=e.inputs??[],this.text=e.text,this.textAllowHtml=e.textAllowHtml??!1,this.wrapper=nu.getWrapper(),this.element=nu.getModal(),this.modal=nu,this.buttonText=e.buttonText,this.beforeInitFn=e.beforeInitFn,this.beforeShowFn=e.beforeShowFn,this.canClose=e.canClose??!0,this.onlineOnly=e.onlineOnly??!1,this.hideCallsExec=e.hideCallsExec??!1,this.showLabels=e.showLabels??!1}reset(){this.element.innerHTML=`
    <div class="title"></div>
    <div class="inputs"></div>
    <div class="text"></div>
    <button type="submit" class="submitButton"></button>`}init(){const e=o(this.element);e.find("input").val(""),this.reset(),e.attr("data-popup-id",this.id),e.find(".title").text(this.title),this.textAllowHtml?e.find(".text").html(this.text??""):e.find(".text").text(this.text??""),this.initInputs(),this.buttonText===""?e.find(".submitButton").remove():e.find(".submitButton").text(this.buttonText),(this.text??"")===""?e.find(".text").addClass("hidden"):e.find(".text").removeClass("hidden")}initInputs(){const e=o(this.element);if(this.inputs.every(n=>n.hidden)||this.inputs.length===0){e.find(".inputs").addClass("hidden");return}const s=e.find(".inputs");this.showLabels&&s.addClass("withLabel"),this.inputs.forEach((n,i)=>{var m,f,h,y;const r=`${this.id}_${i}`;this.showLabels&&!n.hidden&&s.append(`<label for="${r}">${n.label??""}</label>`);const d=n.type==="textarea"?"textarea":"input",u=n.hidden?["hidden"]:void 0,c={id:r,placeholder:n.placeholder??"",autocomplete:"off"};if(n.type!=="textarea"&&(c.value=((m=n.initVal)==null?void 0:m.toString())??"",c.type=n.type),!n.hidden&&!n.optional&&(c.required=!0),n.disabled&&(c.disabled=!0),n.type==="textarea")s.append(ih({tagname:d,classes:u,attributes:c,innerHTML:n.initVal}));else if(n.type==="checkbox"){let b=ih({tagname:d,classes:u,attributes:c});n.description!==void 0&&(b+=`<span>${n.description}</span>`),this.showLabels?b=`<div>${b}</div>`:b=`
          <label class="checkbox">
            ${b}
            <div>${n.label}</div>
          </label>
        `,s.append(b)}else if(n.type==="range")s.append(`
          <div>
            ${ih({tagname:d,classes:u,attributes:{...c,min:n.min.toString(),max:n.max.toString(),step:(f=n.step)==null?void 0:f.toString(),oninput:"this.nextElementSibling.innerHTML = this.value"}})}
            <span>${n.initVal??""}</span>
          </div>
          `);else{switch(n.type){case"text":case"password":case"email":break;case"datetime-local":{n.min!==void 0&&(c.min=Ot(n.min,"yyyy-MM-dd'T'HH:mm:ss")),n.max!==void 0&&(c.max=Ot(n.max,"yyyy-MM-dd'T'HH:mm:ss")),n.initVal!==void 0&&(c.value=Ot(n.initVal,"yyyy-MM-dd'T'HH:mm:ss"));break}case"date":{n.min!==void 0&&(c.min=Ot(n.min,"yyyy-MM-dd")),n.max!==void 0&&(c.max=Ot(n.max,"yyyy-MM-dd")),n.initVal!==void 0&&(c.value=Ot(n.initVal,"yyyy-MM-dd"));break}case"number":{c.min=(h=n.min)==null?void 0:h.toString(),c.max=(y=n.max)==null?void 0:y.toString();break}}s.append(ih({tagname:d,classes:u,attributes:c}))}n.oninput!==void 0&&(document.querySelector("#"+c.id).oninput=n.oninput)}),e.find(".inputs").removeClass("hidden")}exec(){if(!this.canClose)return;const e=[];for(const s of o("#simpleModal input, #simpleModal textarea"))o(s).is(":checkbox")?e.push(o(s).is(":checked")?"true":"false"):e.push(o(s).val());const a=[];for(let s=0;s<this.inputs.length;s++)a.push({...this.inputs[s],currentValue:e[s]});if(a.filter(s=>s.hidden!==!0&&s.optional!==!0).some(s=>s.currentValue===void 0||s.currentValue==="")){g("Please fill in all fields",0);return}this.disableInputs(),ht(),this.execFn(this,...e).then(s=>{We(),(s.showNotification??!0)&&g(s.message,s.status,s.notificationOptions),s.status===1?this.hide(!0,s.hideOptions).then(()=>{s.afterHide&&s.afterHide()}):(this.enableInputs(),o(o("#simpleModal").find("input")[0]).trigger("focus"))})}disableInputs(){o("#simpleModal input").prop("disabled",!0),o("#simpleModal button").prop("disabled",!0),o("#simpleModal textarea").prop("disabled",!0),o("#simpleModal .checkbox").addClass("disabled")}enableInputs(){o("#simpleModal input").prop("disabled",!1),o("#simpleModal button").prop("disabled",!1),o("#simpleModal textarea").prop("disabled",!1),o("#simpleModal .checkbox").removeClass("disabled")}show(e=[],a){if(this.onlineOnly&&!ta()){g("You are offline",0,{duration:2});return}Ao=this,this.parameters=e,nu.show({focusFirstInput:!0,...a,beforeAnimation:async()=>{var s,n;(s=this.beforeInitFn)==null||s.call(this,this),this.init(),(n=this.beforeShowFn)==null||n.call(this,this)}})}async hide(e,a){this.canClose&&(this.hideCallsExec&&!e?this.exec():(Ao=null,await nu.hide(a)))}}function SC(){if(Ao){Ao.hide();return}}let Ao=null;const nu=new Ct({dialogId:"simpleModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),Ao==null||Ao.exec()})},customEscapeHandler:t=>{SC()},customWrapperClickHandler:t=>{SC()}}),J6=new Zt({id:"editApeKey",title:"Edit Ape key",inputs:[{type:"text",placeholder:"name",initVal:""}],buttonText:"edit",onlineOnly:!0,execFn:async(t,e)=>{const a=await F.apeKeys.save({params:{apeKeyId:t.parameters[0]??""},body:{name:e}});return a.status!==200?{status:-1,message:"Failed to update key: "+a.body.message}:{status:1,message:"Key updated",hideOptions:{clearModalChain:!0}}}}),X6=new Zt({id:"deleteApeKey",title:"Delete Ape key",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async t=>{const e=await F.apeKeys.delete({params:{apeKeyId:t.parameters[0]??""}});return e.status!==200?{status:-1,message:"Failed to delete key: "+e.body.message}:(Mo==null||Mo(),{status:1,message:"Key deleted",hideOptions:{clearModalChain:!0}})}}),eG=new Zt({id:"viewApeKey",title:"Ape key",inputs:[{type:"textarea",disabled:!0,placeholder:"key",initVal:""}],textAllowHtml:!0,text:`
    This is your new Ape Key. Please keep it safe. You will only see it once!<br><br>
    <strong>Note:</strong> Ape Keys are disabled by default, you need to enable them before they can be used.`,buttonText:"close",hideCallsExec:!0,execFn:async t=>({status:1,message:"Key generated",showNotification:!1,hideOptions:{clearModalChain:!0}}),beforeInitFn:t=>{t.inputs[0].initVal=t.parameters[0]},beforeShowFn:t=>{t.canClose=!1,o("#simpleModal textarea").css("height","110px"),o("#simpleModal .submitButton").addClass("hidden"),setTimeout(()=>{t.canClose=!0,o("#simpleModal .submitButton").removeClass("hidden")},5e3)}}),tG=new Zt({id:"generateApeKey",title:"Generate new Ape key",inputs:[{type:"text",placeholder:"Name",initVal:""}],buttonText:"generate",onlineOnly:!0,execFn:async(t,e)=>{const a=await F.apeKeys.add({body:{name:e,enabled:!1}});if(a.status!==200)return{status:-1,message:"Failed to generate key: "+a.body.message};const s=a.body.data,n=t.modal.getPreviousModalInChain();return Mo==null||Mo(),{status:1,message:"Key generated",hideOptions:{clearModalChain:!0,animationMode:"modalOnly"},afterHide:()=>{eG.show([s.apeKey],{modalChain:n,animationMode:"modalOnly"})}}}});let Ld={};const kI=o("#pageAccountSettings .tab[data-tab='api']");async function aG(){sG();const t=await F.apeKeys.get();return t.status!==200?t.body.message==="You have lost access to ape keys, please contact support"?(xI=!0,CI(),!1):(g("Error getting ape keys: "+t.body.message,-1),!1):(Ld=t.body.data,!0)}function sG(){const t=kI.find("table tbody");t.empty(),t.append("<tr><td colspan='6' style='text-align: center;font-size:1rem;'><i class='fas fa-spin fa-circle-notch'></i></td></tr>")}function _I(){var s,n,i;const t=Ld;if(t==null)return;const e=kI.find("table tbody");e.empty();const a=Object.keys(t);if(a.length===0){e.append("<tr><td colspan='6' style='text-align: center;'>No keys found</td></tr>");return}a.forEach(r=>{const d=t[r];e.append(`
      <tr keyId="${r}">
        <td>
          <button class="textButton toggleActive" style="font-size: 1.25rem">
            ${d.enabled?'<i class="fas fa-fw fa-check-square"></i>':'<i class="far fa-fw fa-square"></i>'}
          </button>
        </td>
        <td>${d.name}</td>
        <td>${Ot(new Date(d.createdOn),"dd MMM yyyy HH:mm")}</td>
        <td>${Ot(new Date(d.modifiedOn),"dd MMM yyyy HH:mm")}</td>
        <td>${d.lastUsedOn===-1?"-":Ot(new Date(d.lastUsedOn),"dd MMM yyyy HH:mm")}</td>
        <td>
          <div class="keyButtons">
            <button class="editButton">
              <i class="fas fa-fw fa-pen"></i>
            </button>
            <button class="deleteButton">
              <i class="fas fa-fw fa-trash-alt"></i>
            </button>
          </div>
        </td>
      </tr>
    `)});for(const r of e.find("tr")){const d=r.getAttribute("keyid");(s=r.querySelector("button.toggleActive"))==null||s.addEventListener("click",u=>{nG(d)}),(n=r.querySelector("button.deleteButton"))==null||n.addEventListener("click",u=>{X6.show([d],{})}),(i=r.querySelector("button.editButton"))==null||i.addEventListener("click",u=>{J6.show([d],{})})}}async function nG(t){const e=Ld==null?void 0:Ld[t];if(!e||Ld===void 0)return;ht();const a=await F.apeKeys.save({params:{apeKeyId:t},body:{enabled:!e.enabled}});if(We(),a.status!==200){g("Failed to update key: "+a.body.message,-1);return}e.enabled=!e.enabled,_I(),e.enabled?g("Key active",1):g("Key inactive",1)}let Mo,xI=!1;async function CI(t){if(xI){o(".pageAccountSettings .tab[data-tab='api'] table").remove(),o(".pageAccountSettings .section.apeKeys .buttons").remove(),o(".pageAccountSettings .section.apeKeys .lostAccess").removeClass("hidden");return}Mo=t,await aG(),_I()}o(".pageAccountSettings").on("click","#generateNewApeKey",()=>{tG.show([],{})});const lt=o(".page.pageAccountSettings"),Dh={activeTab:"general"};function iG(){if(lt.find(".section.passwordAuthSettings button").addClass("hidden"),lt.find(".section.googleAuthSettings button").addClass("hidden"),lt.find(".section.githubAuthSettings button").addClass("hidden"),!we())return;const t=Hy(),e=t.providerData.some(n=>n.providerId==="password"),a=t.providerData.some(n=>n.providerId==="google.com"),s=t.providerData.some(n=>n.providerId==="github.com");e?(lt.find(".section.passwordAuthSettings #emailPasswordAuth").removeClass("hidden"),lt.find(".section.passwordAuthSettings #passPasswordAuth").removeClass("hidden"),(a||s)&&lt.find(".section.passwordAuthSettings #removePasswordAuth").removeClass("hidden")):lt.find(".section.passwordAuthSettings #addPasswordAuth").removeClass("hidden"),a?(lt.find(".section.googleAuthSettings #removeGoogleAuth").removeClass("hidden"),e||s?lt.find(".section.googleAuthSettings #removeGoogleAuth").removeClass("disabled"):lt.find(".section.googleAuthSettings #removeGoogleAuth").addClass("disabled")):lt.find(".section.googleAuthSettings #addGoogleAuth").removeClass("hidden"),s?(lt.find(".section.githubAuthSettings #removeGithubAuth").removeClass("hidden"),e||a?lt.find(".section.githubAuthSettings #removeGithubAuth").removeClass("disabled"):lt.find(".section.githubAuthSettings #removeGithubAuth").addClass("disabled")):lt.find(".section.githubAuthSettings #addGithubAuth").removeClass("hidden")}function rG(){var t;if(!we())lt.find(".section.discordIntegration").addClass("hidden");else{if(!T())return;lt.find(".section.discordIntegration").removeClass("hidden"),((t=T())==null?void 0:t.discordId)===void 0?(lt.find(".section.discordIntegration .buttons").removeClass("hidden"),lt.find(".section.discordIntegration .info").addClass("hidden")):(lt.find(".section.discordIntegration .buttons").addClass("hidden"),lt.find(".section.discordIntegration .info").removeClass("hidden"))}}function SI(){Xn(lt.find(".tab.active"),lt.find(`.tab[data-tab="${Dh.activeTab}"]`),250,async()=>{},async()=>{lt.find(".tab").removeClass("active"),lt.find(`.tab[data-tab="${Dh.activeTab}"]`).addClass("active")}),lt.find("button").removeClass("active"),lt.find(`button[data-tab="${Dh.activeTab}"]`).addClass("active")}function oG(){lt.find(".section.optOutOfLeaderboards .optedOut").addClass("hidden"),lt.find(".section.optOutOfLeaderboards .buttons").removeClass("hidden"),lt.find(".section.setStreakHourOffset .info").addClass("hidden"),lt.find(".section.setStreakHourOffset .buttons").removeClass("hidden");const t=T();if((t==null?void 0:t.lbOptOut)===!0&&(lt.find(".section.optOutOfLeaderboards .optedOut").removeClass("hidden"),lt.find(".section.optOutOfLeaderboards .buttons").addClass("hidden")),(t==null?void 0:t.streakHourOffset)!==void 0){lt.find(".section.setStreakHourOffset .info").removeClass("hidden");const e=(t==null?void 0:t.streakHourOffset)>0?"+":"";lt.find(".section.setStreakHourOffset .info span").text(e+(t==null?void 0:t.streakHourOffset)),lt.find(".section.setStreakHourOffset .buttons").addClass("hidden")}}function zi(){ft()==="accountSettings"&&(iG(),rG(),oG(),CI(zi),SI())}o(".page.pageAccountSettings").on("click",".tabs button",t=>{Dh.activeTab=o(t.target).data("tab"),SI()});o(".page.pageAccountSettings .section.discordIntegration .getLinkAndGoToOauth").on("click",()=>{ht(),F.users.getDiscordOAuth().then(t=>{t.status===200?window.open(t.body.data.url,"_self"):g("Failed to get OAuth from discord: "+t.body.message,-1)})});o(".page.pageAccountSettings #setStreakHourOffset").on("click",()=>{G6()});const dG=new di({name:"accountSettings",element:lt,path:"/account-settings",afterHide:async()=>{Na("pageAccountSettings")},beforeShow:async()=>{Cs("pageAccountSettings","main"),zi()}});o(()=>{ms("pageAccountSettings")});const TI=[];function lG(t){TI.push(t)}function uG(t,e){TI.forEach(a=>{try{a(t,e)}catch(s){console.error("Google Sign Up event subscriber threw an error"),console.error(s)}})}const cG=new di({name:"test",element:o(".page.pageTest"),path:"/",beforeHide:async()=>{$t(),ut(),Md(),jr(),o("#wordsInput").trigger("focusout")},afterHide:async()=>{oy(!0)},beforeShow:async()=>{oy(!1),tL(),$t(),ut({noAnim:!0}),gH(),r_(),ry()}});function pG(){o(".pageAbout .contributors").empty(),o(".pageAbout .supporters").empty(),Dd.getDataset("count").data=[],Dd.updateColors()}let _y,ar;function mG(){var t;if(_y){Dd.updateColors();const e=gG(_y);Dd.data.labels=e.labels,Dd.getDataset("count").data=e.data}if(ar){const e=Math.round(ar.timeTyping),a=A2({start:0,end:e*1e3});o(".pageAbout #totalTimeTypingStat .val").text(((t=a.years)==null?void 0:t.toString())??""),o(".pageAbout #totalTimeTypingStat .valSmall").text("years"),o(".pageAbout #totalTimeTypingStat").attr("aria-label",Ov(Math.round(e/3600))+" hours");const s=ex(ar.testsStarted);o(".pageAbout #totalStartedTestsStat .val").text(s.rounded<10?s.roundedTo2:s.rounded),o(".pageAbout #totalStartedTestsStat .valSmall").text(s.orderOfMagnitude),o(".pageAbout #totalStartedTestsStat").attr("aria-label",Ov(ar.testsStarted)+" tests");const n=ex(ar.testsCompleted);o(".pageAbout #totalCompletedTestsStat .val").text(n.rounded<10?n.roundedTo2:n.rounded),o(".pageAbout #totalCompletedTestsStat .valSmall").text(n.orderOfMagnitude),o(".pageAbout #totalCompletedTestsStat").attr("aria-label",Ov(ar.testsCompleted)+" tests")}}async function fG(){if(_y&&ar)return;if(!ta()){g("Cannot update all time stats - offline",0);return}const t=await F.public.getSpeedHistogram({query:{language:"english",mode:"time",mode2:"60"}});t.status===200?_y=t.body.data:g(`Failed to get global speed stats for histogram: ${t.body.message}`,-1);const e=await F.public.getTypingStats();e.status===200?ar=e.body.data:g(`Failed to get global typing stats: ${t.body.message}`,-1)}async function hG(){let t;try{t=await SB()}catch(r){g(qe(r,"Failed to get supporters"),-1),t=[]}let e;try{e=await TB()}catch(r){g(qe(r,"Failed to get contributors"),-1),e=[]}fG().then(()=>{mG()});const a=document.querySelector(".pageAbout .supporters");let s="";for(const r of t)s+=`<div>${r}</div>`;a&&(a.innerHTML=s);const n=document.querySelector(".pageAbout .contributors");let i="";for(const r of e)i+=`<div>${r}</div>`;n&&(n.innerHTML=i)}function gG(t){const e=[],a=[],s=Object.keys(t).sort((n,i)=>parseInt(n,10)-parseInt(i,10));for(const[n,i]of s.entries()){const r=s[n+1],d=parseInt(i,10);if(e.push({x:d,y:t[d]}),a.push(`${d} - ${d+9}`),r!==void 0&&d+10!==parseInt(r,10))for(let u=d+10;u<parseInt(r,10);u+=10)e.push({x:u,y:0}),a.push(`${u} - ${u+9}`)}return{data:e,labels:a}}const yG=new di({name:"about",element:o(".page.pageAbout"),path:"/about",afterHide:async()=>{pG(),Na("pageAbout")},beforeShow:async()=>{Cs("pageAbout","main"),hG()}});o(()=>{ms("pageAbout")});const xy={userUid:void 0,lbOptOut:void 0};let Pu;async function vG(t){if(!we()){g("You must be logged in to submit a report",0);return}$I.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async e=>{xf(e.querySelector(".g-recaptcha"),"userReportModal");const{name:a}=t;xy.userUid=t.uid,xy.lbOptOut=t.lbOptOut,e.querySelector(".user").textContent=a,e.querySelector(".reason").value="Inappropriate name",e.querySelector(".comment").value="",Pu=new ya({select:e.querySelector(".reason"),settings:{showSearch:!1,contentLocation:e}})}}),new wm(o("#userReportModal .comment"),250)}async function bG(){$I.hide({afterAnimation:async()=>{Pu==null||Pu.destroy(),Pu=void 0,ql("userReportModal")}})}async function wG(){const t=Sv("userReportModal");if(!t){g("Please complete the captcha");return}const e=o("#userReportModal .reason").val(),a=o("#userReportModal .comment").val(),s=t;if(!e){g("Please select a valid report reason");return}if(!a){g("Please provide a comment");return}if(e==="Suspected cheating"&&xy.lbOptOut){g("You cannot report this user for suspected cheating as they have opted out of the leaderboards.",0,{duration:10});return}const n=a.length-250;if(n>0){g(`Report comment is ${n} character(s) too long`);return}ht();const i=await F.users.report({body:{uid:xy.userUid,reason:e,comment:a,captcha:s}});if(We(),i.status!==200){g("Failed to report user: "+i.body.message,-1);return}g("Report submitted. Thank you!",1),bG()}const $I=new Ct({dialogId:"userReportModal",setup:async t=>{var e;(e=t.querySelector("button"))==null||e.addEventListener("click",()=>{wG()})}});function TC(){o(".page.pageProfile .preloader").removeClass("hidden"),o(".page.pageProfile .profile").html(`
      <div class="details none">
        <div class="avatarAndName">
          <div class="avatars">
            <div class="placeholderAvatar">
              <i class="fas fa-user-circle"></i>
            </div>
            <div class="avatar"></div>
          </div>
          <div>
             <div class="user">
              <div class="name">-</div>
              <div class="userFlags"></div>
            </div>
            <div class="badges"></div>
            <div class="allBadges"></div>
            <div class="joined" data-balloon-pos="up">-</div>
	          <div class="streak" data-balloon-pos="up">-</div>
          </div>
          <div class="levelAndBar">
            <div class="level" data-balloon-pos="up">-</div>
            <div class="xpBar" data-balloon-pos="up">
              <div class="bar" style="width: 0%;"></div>
            </div>
            <div class="xp" data-balloon-pos="up">-/-</div>
          </div>
        </div>
        <div class="separator sep1"></div>
        <div class="typingStats vertical">
          <div class="started">
            <div class="title">tests started</div>
            <div class="value">-</div>
          </div>
          <div class="completed">
            <div class="title">tests completed</div>
            <div class="value">-</div>
          </div>
          <div class="timeTyping">
            <div class="title">time typing</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep2 hidden"></div>

        <div class="bioAndKeyboard vertical hidden">
          <div class="bio">
            <div class="title">bio</div>
            <div class="value">-</div>
          </div>
          <div class="keyboard hidden">
            <div class="title">keyboard</div>
            <div class="value">-</div>
          </div>
        </div>
        <div class="separator sep3 hidden"></div>

        <div class="socials big hidden">
          <div class="title">socials</div>
          <div class="value">-</div>
        </div>
        <div class="buttonGroup">
          <button
            class="userReportButton"
            data-balloon-pos="left"
            aria-label="Report user"
          >
            <i class="fas fa-flag"></i>
          </button>
        </div>
      </div>
      <div class="leaderboardsPositions">
        <div class="title">All-Time English Leaderboards</div>
        <div class="group t15">
          <div class="testType">15 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
        <div class="group t60">
          <div class="testType">60 seconds</div>
          <div class="pos">-</div>
          <div class="topPercentage">-</div>
        </div>
      </div>
      <div class="pbsWords">
        <div class="group">
          <div class="quick">
            <div class="test">10 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">25 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">50 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">100 words</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div>
      <div class="pbsTime">
        <div class="group">
          <div class="quick">
            <div class="test">15 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">30 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">60 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
        <div class="group">
          <div class="quick">
            <div class="test">120 seconds</div>
            <div class="wpm">-</div>
            <div class="acc">-</div>
          </div>
        </div>
      </div><div class="lbOptOutReminder hidden"></div>`)}async function kG(t){const e=UO("isUid");if(t.data)o(".page.pageProfile .preloader").addClass("hidden"),await vy("profile",t.data),u0(t.data.personalBests,!0);else if(t.uidOrName!==void 0&&t.uidOrName!==""){const a=await F.users.getProfile({params:{uidOrName:t.uidOrName},query:{isUid:e}});if(o(".page.pageProfile .preloader").addClass("hidden"),a.status===404){const s=e?"User not found":`User ${t.uidOrName} not found`;o(".page.pageProfile .preloader").addClass("hidden"),o(".page.pageProfile .error").removeClass("hidden"),o(".page.pageProfile .error .message").text(s)}else if(a.status===200)window.history.replaceState(null,"",`/profile/${a.body.data.name}`),await vy("profile",a.body.data),u0(a.body.data.personalBests,!0);else{g("Failed to load profile: "+a.body.message,-1);return}}else g("Missing update parameter!",-1)}o(".page.pageProfile").on("click",".profile .userReportButton",()=>{const t=o(".page.pageProfile .profile").attr("uid")??"",e=o(".page.pageProfile .profile").attr("name")??"",a=(o(".page.pageProfile .profile").attr("lbOptOut")??"false")==="true";vG({uid:t,name:e,lbOptOut:a})});const _G=new di({name:"profile",element:o(".page.pageProfile"),path:"/profile",afterHide:async()=>{Na("pageProfile"),TC()},beforeShow:async t=>{var a;Cs("pageProfile","main");const e=((a=t==null?void 0:t.params)==null?void 0:a.uidOrName)??"";e?(o(".page.pageProfile .preloader").removeClass("hidden"),o(".page.pageProfile .search").addClass("hidden"),o(".page.pageProfile .content").removeClass("hidden"),TC(),kG({uidOrName:e,data:t==null?void 0:t.data})):(o(".page.pageProfile .preloader").addClass("hidden"),o(".page.pageProfile .search").removeClass("hidden"),o(".page.pageProfile .content").addClass("hidden"))}});ms("pageProfile");const xG=new di({name:"profileSearch",element:o(".page.pageProfileSearch"),path:"/profile",afterHide:async()=>{Na("pageProfileSearch")},beforeShow:async()=>{Cs("pageProfileSearch","main"),o(".page.pageProfileSearch input").val("")},afterShow:async()=>{o(".page.pageProfileSearch input").trigger("focus")}}),CG=new di({name:"404",element:o(".page.page404"),path:"/404",afterHide:async()=>{Na("page404")},beforeShow:async()=>{Cs("page404","main")}});ms("page404");async function In(t,e={}){return e={...{force:!1},...e},new Promise(s=>{if(ac()){console.debug(`change page to ${t} stopped, page transition is true`),s(!1);return}if(!e.force&&ft()===t){console.debug(`change page ${t} stoped, page already active`),s(!1);return}else console.log(`changing page ${t}`);const n={loading:lB,test:cG,settings:M6,about:yG,account:MV,login:O6,profile:_G,profileSearch:xG,404:CG,accountSettings:dG},i=n[ft()],r=n[t];i==null||i.beforeHide().then(()=>{Io(!0),o(".page").removeClass("active"),Xn(i.element,r.element,250,async()=>{Io(!1),r.element.addClass("active"),s(!0),await(r==null?void 0:r.afterShow()),sH()},async()=>{r.name==="test"?V_():V_(Xm(r.name)+" | Monkeytype"),Qr(!1),k4(r.name),await(i==null?void 0:i.afterHide()),await(r==null?void 0:r.beforeShow({params:e.params,data:e.data}))})})})}const A_="leaderboardsWrapper";let xs="allTime",Fr="english",Tl=!1,Za={15:[],60:[]},as={15:{},60:{}},Go={15:[],60:[]};const rh={15:!1,60:!1},$l=50;let h0;function Cy(t){t==="15"?o("#leaderboardsWrapper table.left tbody").empty():t==="60"&&o("#leaderboardsWrapper table.right tbody").empty()}function $C(t){t==="15"?o("#leaderboardsWrapper table.left tfoot").empty():t==="60"&&o("#leaderboardsWrapper table.right tfoot").empty()}function SG(){Za={15:[],60:[]},as={15:{},60:{}},Go={15:[],60:[]}}function TG(){clearInterval(h0),h0=void 0,o("#leaderboards .subTitle").text("-")}function AC(){if(xs==="daily"){const t=new Date;t.setUTCHours(0,0,0,0),t.setDate(t.getDate()+1);const e=new Date;e.setUTCMilliseconds(0);const a=M2(t,e);o("#leaderboards .subTitle").text("Next reset in: "+ts(a,!0))}else{const t=new Date,e=14-t.getMinutes()%15,a=60-t.getSeconds(),s=e*60+a;o("#leaderboards .subTitle").text("Next update in: "+ts(s,!0))}}function $G(){AC(),h0=setInterval(()=>{AC()},1e3)}function Sy(t){t==="15"?o("#leaderboardsWrapper .leftTableLoader").removeClass("hidden"):t==="60"&&o("#leaderboardsWrapper .rightTableLoader").removeClass("hidden")}function Lo(t){t==="15"?o("#leaderboardsWrapper .leftTableLoader").addClass("hidden"):t==="60"&&o("#leaderboardsWrapper .rightTableLoader").addClass("hidden")}function AG(t){var i,r,d,u;let e;if(t==="15"?e="left":e="right",!we()){o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;"></>
    </tr>
    `);return}if((((r=(i=T())==null?void 0:i.typingStats)==null?void 0:r.timeTyping)??0)<7200){o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Your account must have 2 hours typed to be placed on the leaderboard.</>
    </tr>
    `);return}if(((d=T())==null?void 0:d.lbOptOut)===!0){o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">You have opted out of the leaderboards</>
    </tr>
    `);return}const a=as[t];if(xs==="daily"&&a!==null&&a.minWpm===void 0){o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Looks like the server returned data in a new format, please refresh</>
    </tr>
    `);return}let s="";if(xs==="allTime"&&a!==void 0&&(a!=null&&a.rank)){const c=Oe(a.rank/as[t].count*100);as[t].rank===1?s="GOAT":s=`Top ${c}%`,s=`<br><span class="sub">${s}</span>`}const n=a==null?void 0:a.entry;if(n){const c=new Date(n.timestamp);o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
    <td>${a.rank}</td>
    <td><span class="top">You</span>${s||""}</td>
    <td class="alignRight">${ve.typingSpeed(n.wpm,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ve.percentage(n.acc,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${ve.typingSpeed(n.raw,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ve.percentage(n.consistency,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${Ot(c,"dd MMM yyyy")}<br>
    <div class='sub'>${Ot(c,"HH:mm")}</div></td>
  </tr>
  `)}else xs==="daily"?o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Not qualified ${`(min speed required: ${(u=as[t])==null?void 0:u.minWpm} wpm)`}</>
    </tr>
    `):o(`#leaderboardsWrapper table.${e} tfoot`).html(`
    <tr>
      <td colspan="6" style="text-align:center;">Not qualified</>
    </tr>
    `)}function MG(t){var n,i,r,d,u;if(xs==="daily")return;let e;t==="15"?e="left":e="right";const a=((d=(r=(i=(n=T())==null?void 0:n.lbMemory)==null?void 0:i.time)==null?void 0:r[t])==null?void 0:d.english)??0,s=(u=as[t])==null?void 0:u.rank;if(s){const c=a-s;c>0?(Tx("time",t,"english",s,!0),a!==0&&o(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(` (<i class="fas fa-fw fa-angle-up"></i>${Math.abs(c)} since you last checked)`)):c<0?(Tx("time",t,"english",s,!0),a!==0&&o(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(` (<i class="fas fa-fw fa-angle-down"></i>${Math.abs(c)} since you last checked)`)):a!==0&&o(`#leaderboardsWrapper table.${e} tfoot tr td .top`).append(" ( = since you last checked)")}}async function M_(t){var n;if(Za[t]===void 0)return;let e;t==="15"?e="left":e="right",Za[t].length===0&&o(`#leaderboardsWrapper table.${e} tbody`).html("<tr><td colspan='7'>No results found</td></tr>");const a=(n=T())==null?void 0:n.name;let s="";for(let i=0;i<Za[t].length;i++){const r=Za[t][i];if(r===void 0)break;let d="";r.name===a&&(d=' class="me"');const u=new Date(r.timestamp);xs==="daily"&&!r.rank&&(r.rank=i+1);let c='<div class="avatarPlaceholder"><i class="fas fa-user-circle"></i></div>';r.discordAvatar!==void 0&&(c='<div class="avatarPlaceholder"><i class="fas fa-circle-notch fa-spin"></i></div>'),s+=`
    <tr ${d}>
    <td>${r.rank===1?'<i class="fas fa-fw fa-crown"></i>':r.rank}</td>
    <td>
    <div class="avatarNameBadge">
      <div class="lbav">${c}</div>
      <a href="${location.origin}/profile/${r.uid}?isUid" class="entryName" uid=${r.uid} router-link>${r.name}</a>
      <div class="flagsAndBadge">
        ${Jy(r)}
        ${r.badgeId?yy(r.badgeId):""}
      </div>
    </div>
    </td>
    <td class="alignRight">${ve.typingSpeed(r.wpm,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ve.percentage(r.acc,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${ve.typingSpeed(r.raw,{showDecimalPlaces:!0})}<br>
    <div class="sub">${ve.percentage(r.consistency,{showDecimalPlaces:!0})}</div></td>
    <td class="alignRight">${Ot(u,"dd MMM yyyy")}<br>
    <div class='sub'>${Ot(u,"HH:mm")}</div></td>
  </tr>
  `}o(`#leaderboardsWrapper table.${e} tbody`).html(s)}const MC=o("#leaderboardsWrapper .showYesterdayButton"),LC=o("#leaderboardsWrapper .showYesterdayButton .text");function L_(){o("#leaderboardsWrapper").stop(!0,!0).css("opacity",1).animate({opacity:0},qt(100),()=>{es==null||es.destroy(),es=void 0,Cy("15"),Cy("60"),$C("15"),$C("60"),SG(),TG(),Tl=!1,E_(),o("#leaderboardsWrapper").addClass("hidden"),Na(A_)})}function AI(){const t=o("#leaderboardsWrapper .mainTitle"),e=xs==="daily"?"Daily":"All-Time",a=Fr.charAt(0).toUpperCase()+Fr.slice(1);let s=`${e} ${a} Leaderboards`;Tl&&xs!=="allTime"&&(s+=" (Yesterday)"),t.text(s)}function E_(){MC.addClass("hidden"),xs==="daily"&&MC.removeClass("hidden"),Tl?LC.text("Show today"):LC.text("Show yesterday")}function I_(){const t=xs==="daily";return{isDaily:t,daysBefore:t&&Tl?1:void 0}}async function xm(){var y;ri=!1,Cm=!1,Sy("15"),Sy("60");const{isDaily:t,daysBefore:e}=I_(),a=t?F.leaderboards.getDaily:F.leaderboards.get,s=t?F.leaderboards.getDailyRank:F.leaderboards.getRank,n={language:Fr,mode:"time",daysBefore:e},i={status:200,body:{message:"",data:null}},r=we()?s({query:{...n,mode2:"15"}}):i,d=we()?s({query:{...n,mode2:"60"}}):i,[u,c,m,f]=await Promise.all([a({query:{...n,mode2:"15"}}),a({query:{...n,mode2:"60"}}),r,d]);if(u.status!==200||c.status!==200||m.status!==200||f.status!==200){const b=[u,c,m,f].filter(w=>w.status!==200);Lo("15"),Lo("60"),g("Failed to load leaderboards: "+((y=b[0])==null?void 0:y.body.message),-1);return}u.body.data!==null&&(Za[15]=u.body.data),c.body.data!==null&&(Za[60]=c.body.data),m.body.data!==null&&(as[15]=m.body.data),f.body.data!==null&&(as[60]=f.body.data),["15","60"].forEach(async b=>{Lo(b),Cy(b),AG(b),MG(b),await M_(b),O_(Za[b]).then(w=>{Go[b]=w,P_(b)})}),o("#leaderboardsWrapper .leftTableWrapper").removeClass("invisible"),o("#leaderboardsWrapper .rightTableWrapper").removeClass("invisible"),AI(),E_(),o("#leaderboardsWrapper .buttons .button").removeClass("active"),o("#leaderboardsWrapper .buttonGroup.timeRange .button."+xs).addClass("active"),o("#leaderboardsWrapper #leaderboards .leftTableWrapper").scrollTop(0),o("#leaderboardsWrapper #leaderboards .rightTableWrapper").scrollTop(0),ri=!0,Cm=!0}async function LG(t,e=!1){var c,m,f;if(e&&((c=Za[t][0])==null?void 0:c.rank)===1||rh[t])return;rh[t]=!0,Sy(t);let a=(m=_r(Za[t]))==null?void 0:m.rank;e&&(a=(((f=Za[t][0])==null?void 0:f.rank)??0)-$l);let s;a<0&&(s=Math.abs(a)-1,a=0);const{isDaily:n,daysBefore:i}=I_(),d=await(n?F.leaderboards.getDaily:F.leaderboards.get)({query:{language:Fr,mode:"time",mode2:t,skip:a,limit:s,daysBefore:i}});if(d.status!==200||d.body.data===null||d.body.data.length===0){Lo(t),rh[t]=!1;return}const u=d.body.data;e?Za[t].unshift(...u):Za[t].push(...u),e&&!s&&(s=$l-1),await M_(t),O_(u).then(h=>{e?Go[t].unshift(...h):Go[t].push(...h),P_(t)}),Lo(t),rh[t]=!1}async function $v(t,e){Sy(t);const{isDaily:a,daysBefore:s}=I_(),i=await(a?F.leaderboards.getDaily:F.leaderboards.get)({query:{language:Fr,mode:"time",mode2:t,skip:e,daysBefore:s}});if(i.status===503){g("Leaderboards are currently updating - please try again later",-1);return}if(Cy(t),Za[t]=[],Go[t]=[],i.status!==200||i.body.data===null||i.body.data.length===0){Lo(t);return}const r=i.body.data;Za[t]=r,await M_(t),O_(r).then(d=>{Go[t]=d,P_(t)}),Lo(t)}async function O_(t){return Promise.allSettled(t.map(async e=>P0(e.discordId,e.discordAvatar))).then(e=>e.map(a=>a.status==="fulfilled"?a.value:null))}function P_(t){const a=o(`#leaderboardsWrapper table.${t==="15"?"left":"right"} tbody .lbav`);for(const[s,n]of Go[t].entries()){const i=a[s];n!==null?o(i).html(`<div class="avatar" style="background-image:url(${n})"></div>`):o(i).html('<div class="avatarPlaceholder"><i class="fas fa-user-circle"></i></div>')}}function EG(){if(!ta()){g("You can't view leaderboards while offline",0);return}Cs(A_,"popups"),Ra("leaderboardsWrapper")||(we()?(o("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").removeClass("disabled"),o("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").removeClass("disabled")):(o("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").addClass("disabled"),o("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").addClass("disabled")),o("#leaderboards table thead tr td:nth-child(3)").html(l.typingSpeedUnit+'<br><div class="sub">accuracy</div>'),es=new ya({select:"#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .languageSelect",settings:{showSearch:!1},data:["english","spanish","german","french","portuguese","indonesian","italian"].map(t=>({value:t,text:t,selected:t===Fr})),events:{afterChange:t=>{var e;Fr=(e=t[0])==null?void 0:e.value,AI(),xm()}}}),o("#leaderboardsWrapper").stop(!0,!0).css("opacity",0).removeClass("hidden").animate({opacity:1},qt(125),()=>{xm(),$G()}))}o("#leaderboardsWrapper").on("click",t=>{o(t.target).attr("id")==="leaderboardsWrapper"&&L_()});let es,ri=!0;o("#leaderboardsWrapper #leaderboards .leftTableWrapper").on("scroll",t=>{if(!ri)return;const e=o(t.currentTarget);Math.round(e.scrollTop())<=50&&Av("15",!0)});const Av=cs(500,LG);o("#leaderboardsWrapper #leaderboards .leftTableWrapper").on("scroll",t=>{if(!ri)return;const e=o(t.currentTarget);e===void 0||e[0]===void 0||Math.round(e[0].scrollHeight-e.scrollTop())<=Math.round(e.outerHeight())+50&&Av("15")});let Cm=!0;o("#leaderboardsWrapper #leaderboards .rightTableWrapper").on("scroll",t=>{if(!Cm)return;const e=o(t.currentTarget);Math.round(e.scrollTop())<=50&&Av("60",!0)});o("#leaderboardsWrapper #leaderboards .rightTableWrapper").on("scroll",t=>{const e=o(t.currentTarget);e===void 0||e[0]===void 0||Math.round(e[0].scrollHeight-e.scrollTop())<=Math.round(e.outerHeight()+50)&&Av("60")});o("#leaderboardsWrapper #leaderboards .leftTableJumpToTop").on("click",async()=>{ri=!1,o("#leaderboardsWrapper #leaderboards .leftTableWrapper").scrollTop(0),await $v("15",0),ri=!0});o("#leaderboardsWrapper #leaderboards .leftTableJumpToMe").on("click",async()=>{var e;if(!((e=as[15])!=null&&e.rank))return;ri=!1,await $v("15",as[15].rank-$l/2);const t=o("#leaderboardsWrapper #leaderboards .leftTableWrapper table tbody td").outerHeight();o("#leaderboardsWrapper #leaderboards .leftTableWrapper").animate({scrollTop:t*Math.min(as[15].rank,$l/2)-o("#leaderboardsWrapper #leaderboards .leftTableWrapper").outerHeight()/2.25},0,()=>{ri=!0})});o("#leaderboardsWrapper #leaderboards .rightTableJumpToTop").on("click",async()=>{Cm=!1,o("#leaderboardsWrapper #leaderboards .rightTableWrapper").scrollTop(0),await $v("60",0),Cm=!0});o("#leaderboardsWrapper #leaderboards .rightTableJumpToMe").on("click",async()=>{var e;if(!((e=as[60])!=null&&e.rank))return;ri=!1,await $v("60",as[60].rank-$l/2);const t=o("#leaderboardsWrapper #leaderboards .rightTableWrapper table tbody td").outerHeight();o("#leaderboardsWrapper #leaderboards .rightTableWrapper").animate({scrollTop:t*Math.min(as[60].rank,$l/2)-o("#leaderboardsWrapper #leaderboards .rightTableWrapper").outerHeight()/2.25},0,()=>{ri=!0})});o("#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .allTime").on("click",()=>{xs="allTime",Fr="english",es==null||es.disable(),es==null||es.setSelected("english"),xm()});o("#leaderboardsWrapper #leaderboards .leaderboardsTop .buttonGroup.timeRange .daily").on("click",()=>{xs="daily",E_(),es==null||es.enable(),xm()});o("#leaderboardsWrapper .showYesterdayButton").on("click",()=>{Tl=!Tl,xm()});o(document).on("keydown",t=>{t.key==="Escape"&&Ra("leaderboardsWrapper")&&(L_(),t.preventDefault())});o("header nav").on("click",".textButton",t=>{o(t.currentTarget).hasClass("leaderboards")&&EG()});ms(A_);function IG(t){return new RegExp("^"+t.replace(/\//g,"\\/").replace(/:\w+/g,"(.+)")+"$")}function OG(t){const e=t.result.slice(1),s=Array.from(t.route.path.matchAll(/:(\w+)/g)).map(n=>n[1]).map((n,i)=>[n,e[i]]);return Object.fromEntries(s)}const PG={path:"404",load:()=>{In("404")}},ZG=[{path:"/",load:()=>{In("test")}},{path:"/verify",load:()=>{In("test")}},{path:"/about",load:()=>{In("about")}},{path:"/settings",load:()=>{In("settings")}},{path:"/login",load:()=>{if(!Qt){Ca("/");return}if(we()){Ca("/account");return}In("login")}},{path:"/account",load:(t,e)=>{if(!Qt){Ca("/");return}In("account",{data:e.data})}},{path:"/account-settings",load:(t,e)=>{if(!Qt){Ca("/");return}if(!we()){Ca("/login");return}In("accountSettings",{data:e.data})}},{path:"/profile",load:t=>{In("profileSearch")}},{path:"/profile/:uidOrName",load:(t,e)=>{In("profile",{force:!0,params:{uidOrName:t.uidOrName},data:e.data})}}];function Ca(t=window.location.pathname+window.location.search,e={}){if(ds||Fo||ac()){console.debug(`navigate: ${t} ignored, page is busy (testRestarting: ${ds}, resultCalculating: ${Fo}, pageTransition: ${ac()})`);return}t=t.replace(/\/$/,""),t===""&&(t="/"),history.pushState(null,"",t),MI(e)}async function MI(t={}){const a=ZG.map(s=>({route:s,result:location.pathname.match(IG(s.path))})).find(s=>s.result!==null);if(a===void 0){PG.load({},{});return}a.route.load(OG(a),t)}window.addEventListener("popstate",()=>{MI()});document.addEventListener("DOMContentLoaded",()=>{document.body.addEventListener("click",t=>{const e=t==null?void 0:t.target;e.matches("[router-link]")&&(e!=null&&e.href)&&(t.preventDefault(),Ca(e.href))})});o("#popups").on("click","#leaderboards a.entryName",()=>{L_()});const Z_=new Ts({key:"confirmedPSAs",schema:Lt.array(nA),fallback:[]});function RG(){Z_.set([])}function LI(){return Z_.get()}function NG(t){const e=LI();e.push(t),Z_.set(e)}async function DG(){const t=await F.psas.get();return t.status===500?(tc("Looks like the server is experiencing maintenance or some unexpected down time.<br>Check the <a target= '_blank' href='https://monkeytype.instatus.com/'>status page</a> or <a target= '_blank' href='https://x.com/monkeytype'>Twitter</a> for more information.",-1,"exclamation-triangle",!1,void 0,!0),null):t.status===503?(tc("Server is currently under maintenance. <a target= '_blank' href='https://monkeytype.instatus.com/'>Check the status page</a> for more info.",-1,"bullhorn",!0,void 0,!0),null):t.status!==200?null:t.body.data}async function jG(){const t=await DG();if(t===null)return;if(t.length===0){RG();return}const e=LI();t.forEach(a=>{if(a.date){const s=new Date(a.date),n=a.date-Date.now(),i=ts(n/1e3,!1,!1,"text",!1,!0);a.message=a.message.replace("{dateDifference}",i),a.message=a.message.replace("{dateNoTime}",Ot(s,"dd MMM yyyy")),a.message=a.message.replace("{date}",Ot(s,"dd MMM yyyy HH:mm"))}U6(a.message,a.level??-1),!(e.includes(a._id)&&!(a.sticky??!1))&&tc(a.message,a.level,"bullhorn",a.sticky,()=>{NG(a._id)},!0)})}const R_=new L2,N_=new E2;async function EI(){if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}ht(),o(".sendVerificationEmail").prop("disabled",!0);const t=await F.users.verificationEmail();o(".sendVerificationEmail").prop("disabled",!1),t.status!==200?(We(),g("Failed to request verification email: "+t.body.message,-1)):(We(),g("Verification email sent",1))}async function BG(){try{console.log("getting account data"),window.location.pathname!=="/account"?Zn(90):Zn(45),lg("Downloading user data..."),await OT(),await IB()}catch(a){if(console.error(a),Zs(!1),Ja(),o("header nav .view-account").css("opacity",1),a instanceof hu)a.responseCode===429&&(g("Doing so will save you bandwidth, make the next test be ready faster and will not sign you out (which could mean your new personal best would not save to your account).",0,{duration:0}),g("You will run into this error if you refresh the website to restart the test. It is NOT recommended to do that. Instead, use tab + enter or just tab (with quick tab mode enabled) to restart the test.",0,{duration:0})),g("Failed to get user data: "+a.message,-1);else{const s=qe(a,"Failed to get user data");g(s,-1)}return!1}ft()==="loading"?Zn(100):Zn(45),lg("Applying settings...");const t=T();JT(t),yI(t.inboxUnreadSize>0),vH(),rV(t.tags),Promise.all([sk(),Ol()]).then(a=>{const[s,n]=a;s.forEach(i=>{Pa.language[i]=!0}),n.forEach(i=>{Pa.funbox[i.name]=!0}),XK()}).catch(a=>{console.log(qe(a,"Something went wrong while loading the filters"))}),t.needsToChangeName&&tc("You need to update your account name. <a class='openNameChange'>Click here</a> to change it and learn more about why.",-1,void 0,!0,void 0,!0);const e=JSON.stringify(l)===JSON.stringify(t.config);return(l===void 0||!e)&&(console.log("no local config or local and db configs are different - applying db"),await cl(t.config),Pl(!0)),Zs(!1),v6(),window.location.pathname==="/account"&&(Zn(90),await k_()),window.location.pathname==="/login"?Ca("/account"):Ca(),!0}async function Tf(t){Io(!1),Zs(!0),await BG()||ad(),Qa(),sn!==null&&D6()}async function EC(t,e){const a=window.location.search,s=window.location.hash;console.debug("account controller ready"),t?(jG(),console.debug(`auth state changed, user ${!!e}`),console.debug(e),e?await Tf():(window.location.pathname==="/account"&&window.history.replaceState("","","/login"),Io(!1),Ca())):(console.debug("auth not initialised or not connected"),window.location.pathname==="/account"&&window.history.replaceState("","","/login"),Io(!1),Ca()),q6(a),W6(a),F6(a),j6(s),zi()}let Mv;var eS;Qt&&ta()?Mv=(eS=Qt)==null?void 0:eS.onAuthStateChanged(function(t){EC(!0,t)}):o(()=>{EC(!1,null)});async function qG(t,e){if(Qt===void 0){g("Authentication uninitialized",-1);return}if(!ta()){g("You are offline",0,{duration:2});return}if(Mv(),T_(),S_(),Sf(),t===""||e===""){g("Please fill in all fields",0),Qa(),Ja(),C_();return}const a=o(".pageLogin .login #rememberMe input").prop("checked")?fS:hS;return await gS(Qt,a),I2(Qt,t,e).then(async s=>{await Tf(s.user)}).catch(function(s){console.error(s);let n=qe(s,"Failed to sign in with email and password");s instanceof yS&&(s.code==="auth/wrong-password"?n="Incorrect password":s.code==="auth/user-not-found"?n="User not found":s.code==="auth/invalid-email"?n="Invalid email format (make sure you are using your email to login - not your username)":s.code==="auth/invalid-credential"&&(n="Email/password is incorrect or your account does not have password authentication enabled.")),g(n,-1),Qa(),Ja(),Xa()})}async function II(t){if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}if(!ta()){g("You are offline",0,{duration:2});return}T_(),S_(),Sf(),Mv();const e=o(".pageLogin .login #rememberMe input").prop("checked")?fS:hS;await gS(Qt,e),Z2(Qt,t).then(async a=>{var s;(s=D0(a))!=null&&s.isNewUser?uG(a,!0):await Tf(a.user)}).catch(a=>{console.log(a);let s=qe(a,"Failed to sign in with popup");a instanceof yS&&(a.code==="auth/wrong-password"?s="Incorrect password":a.code==="auth/user-not-found"?s="User not found":a.code==="auth/invalid-email"?s="Invalid email format (make sure you are using your email to login - not your username)":a.code==="auth/popup-closed-by-user"?s="":a.code==="auth/popup-blocked"?s="Sign in popup was blocked by the browser. Check the address bar for a blocked popup icon, or update your browser settings to allow popups.":a.code==="auth/user-cancelled"?s="":a.code==="auth/account-exists-with-different-credential"&&(s="Account already exists, but its using a different authentication method. Try signing in with a different method")),s!==""&&g(s,-1),Qa(),Ja(),Xa()})}async function WG(){return II(R_)}async function FG(){return II(N_)}async function zG(){return OI("Google",R_)}async function HG(){return OI("GitHub",N_)}async function OI(t,e){if(!ta()){g("You are offline",0,{duration:2});return}if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}ht(),we()&&O2(Hy(),e).then(function(){We(),g(`${t} authentication added`,1),zi()}).catch(function(a){We();const s=qe(a,`Failed to add ${t} authentication`);g(s,-1)})}function ad(){if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}we()&&Qt.signOut().then(function(){g("Signed out",0,{duration:2}),nI(),JT(void 0),Ca("/login"),Aa(void 0),setTimeout(()=>{bH()},125)}).catch(function(t){const e=qe(t,"Failed to sign out");g(e,-1)})}async function UG(){if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}if(!ta()){g("You are offline",0,{duration:2});return}P6();const t=await fI;if(t===void 0||t===""){g("Please complete the captcha",-1);return}S_(),Sf(),T_();const e=o(".pageLogin .register input")[0].value,a=o(".pageLogin .register input")[1].value,s=o(".pageLogin .register input")[2].value,n=o(".pageLogin .register input")[3].value,i=o(".pageLogin .register input")[4].value;if(e===""||a===""||s===""||n===""){Qa(),Ja(),Xa(),g("Please fill in all fields",0);return}if(!a.match(/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)){g("Invalid email",0),Qa(),Ja(),Xa();return}if(a!==s){g("Emails do not match",0),Qa(),Ja(),Xa();return}if(n!==i){g("Passwords do not match",0),Qa(),Ja(),Xa();return}if(!Z0(n)){g("Password must contain at least one capital letter, number, a special character and must be between 8 and 64 characters long",0,{duration:4}),Qa(),Ja(),Xa();return}Mv();try{const r=await P2(Qt,a,n),d=await F.users.create({body:{name:e,captcha:t,email:a,uid:r.user.uid}});if(d.status!==200)throw new Error(`Failed to sign in: ${d.body.message}`);await vS(r.user,{displayName:e}),await EI(),Qa(),await Tf(r.user),g("Account created",1)}catch(r){let d=qe(r,"Failed to create account");r instanceof Error&&"code"in r&&r.code==="auth/email-already-in-use"&&(d=qe({message:"Email already in use"},"Failed to create account")),g(d,-1),Qa(),Ja(),Xa(),ad();return}}o(".pageLogin .login form").on("submit",t=>{t.preventDefault();const e=o(".pageLogin .login input")[0].value??"",a=o(".pageLogin .login input")[1].value??"";qG(e,a)});o(".pageLogin .login button.signInWithGoogle").on("click",()=>{WG()});o(".pageLogin .login button.signInWithGitHub").on("click",()=>{FG()});o("nav .accountButtonAndMenu .menu button.signOut").on("click",()=>{if(Qt===void 0){g("Authentication uninitialized",-1,{duration:3});return}ad()});o(".pageLogin .register form").on("submit",t=>{t.preventDefault(),UG()});o(".pageAccountSettings").on("click","#addGoogleAuth",()=>{zG()});o(".pageAccountSettings").on("click","#addGithubAuth",()=>{HG()});o(".pageAccount").on("click",".sendVerificationEmail",()=>{if(!ta()){g("You are offline",0,{duration:2});return}EI()});const Ut={updateEmail:void 0,updateName:void 0,updatePassword:void 0,removeGoogleAuth:void 0,removeGithubAuth:void 0,removePasswordAuth:void 0,addPasswordAuth:void 0,deleteAccount:void 0,resetAccount:void 0,clearTagPb:void 0,optOutOfLeaderboards:void 0,applyCustomFont:void 0,resetPersonalBests:void 0,resetSettings:void 0,revokeAllTokens:void 0,unlinkDiscord:void 0,editApeKey:void 0,deleteCustomText:void 0,deleteCustomTextLong:void 0,resetProgressCustomTextLong:void 0,updateCustomTheme:void 0,deleteCustomTheme:void 0,forgotPassword:void 0,devGenerateData:void 0};function KG(t){const a=["password","github.com","google.com"].filter(s=>s!==t);for(const s of a)if(Lv(s))return s}function li(){return Lv("password")}function VG(){return Lv("github.com")}function GG(){return Lv("google.com")}function Lv(t){var e,a;return((a=(e=Qt)==null?void 0:e.currentUser)==null?void 0:a.providerData.some(s=>s.providerId===t))||!1}async function Us(t){if(Qt===void 0)return{status:-1,message:"Authentication is not initialized"};if(!we())return{status:-1,message:"User is not signed in"};const e=Hy(),a=KG(t.excludeMethod);try{if(a===void 0)return{status:-1,message:"Failed to reauthenticate: there is no valid authentication present on the account."};if(a==="password"){if(t.password===void 0)return{status:-1,message:"Failed to reauthenticate using password: password missing."};const s=bS.credential(e.email,t.password);await N2(e,s)}else await D2(e,a==="github.com"?N_:R_);return{status:1,message:"Reauthenticated",user:e}}catch(s){const n=s;return n.code==="auth/wrong-password"?{status:0,message:"Incorrect password"}:{status:-1,message:"Failed to reauthenticate: "+((n==null?void 0:n.message)??JSON.stringify(s))}}}Ut.updateEmail=new Zt({id:"updateEmail",title:"Update email",inputs:[{placeholder:"Password",type:"password",initVal:""},{type:"text",placeholder:"New email",initVal:""},{type:"text",placeholder:"Confirm new email",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a,s)=>{if(a!==s)return{status:0,message:"Emails don't match"};const n=await Us({password:e});if(n.status!==1)return{status:n.status,message:n.message};const i=await F.users.updateEmail({body:{newEmail:a,previousEmail:n.user.email}});return i.status!==200?{status:-1,message:"Failed to update email: "+i.body.message}:(ad(),{status:1,message:"Email updated"})},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="",t.text="Password authentication is not enabled"))}});Ut.removeGoogleAuth=new Zt({id:"removeGoogleAuth",title:"Remove Google authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(t,e)=>{const a=await Us({password:e,excludeMethod:"google.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await j0(a.user,"google.com")}catch(s){return{status:-1,message:qe(s,"Failed to unlink Google account")}}return zi(),Wi(3),{status:1,message:"Google authentication removed"}},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],VG()||(t.buttonText="",t.text="Password or GitHub authentication is not enabled")))}});Ut.removeGithubAuth=new Zt({id:"removeGithubAuth",title:"Remove GitHub authentication",inputs:[{placeholder:"Password",type:"password",initVal:""}],onlineOnly:!0,buttonText:"remove",execFn:async(t,e)=>{const a=await Us({password:e,excludeMethod:"github.com"});if(a.status!==1)return{status:a.status,message:a.message};try{await j0(a.user,"github.com")}catch(s){return{status:-1,message:qe(s,"Failed to unlink GitHub account")}}return zi(),Wi(3),{status:1,message:"GitHub authentication removed"}},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],GG()||(t.buttonText="",t.text="Password or Google authentication is not enabled")))}});Ut.removePasswordAuth=new Zt({id:"removePaswordAuth",title:"Remove Password authentication",inputs:[{type:"checkbox",label:"I understand I will lose access to my Monkeytype account if my Google/GitHub account is lost or disabled."}],onlineOnly:!0,buttonText:"reauthenticate to remove",execFn:async t=>{const e=await Us({excludeMethod:"password"});if(e.status!==1)return{status:e.status,message:e.message};try{await j0(e.user,"password")}catch(a){return{status:-1,message:qe(a,"Failed to remove password authentication")}}return zi(),Wi(3),{status:1,message:"Password authentication removed"}},beforeInitFn:()=>{we()}});Ut.updateName=new Zt({id:"updateName",title:"Update name",inputs:[{placeholder:"password",type:"password",initVal:""},{placeholder:"new name",type:"text",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a)=>{const s=await Us({password:e});if(s.status!==1)return{status:s.status,message:s.message};const n=await F.users.getNameAvailability({params:{name:a}});if(n.status===409)return{status:0,message:"Name not available"};if(n.status!==200)return{status:-1,message:"Failed to check name: "+n.body.message};const i=await F.users.updateName({body:{name:a}});if(i.status!==200)return{status:-1,message:"Failed to update name: "+i.body.message};const r=T();return r&&(r.name=a,r.needsToChangeName&&Wi(2)),Gb(a),{status:1,message:"Name updated"}},beforeInitFn:t=>{if(!we())return;const e=T();e&&(li()||(t.inputs[0].hidden=!0,t.buttonText="reauthenticate to update"),e.needsToChangeName===!0&&(t.text="You need to change your account name. This might be because you have a duplicate name, no account name or your name is not allowed (contains whitespace or invalid characters). Sorry for the inconvenience."))}});Ut.updatePassword=new Zt({id:"updatePassword",title:"Update password",inputs:[{placeholder:"current password",type:"password",initVal:""},{placeholder:"new password",type:"password",initVal:""},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a,s)=>{if(a!==s)return{status:0,message:"New passwords don't match"};if(a===e)return{status:0,message:"New password must be different from previous password"};if(!Z0(a))return{status:0,message:"New password must contain at least one capital letter, number, a special character and must be between 8 and 64 characters long"};const n=await Us({password:e});if(n.status!==1)return{status:n.status,message:n.message};const i=await F.users.updatePassword({body:{newPassword:a}});return i.status!==200?{status:-1,message:"Failed to update password: "+i.body.message}:(ad(),{status:1,message:"Password updated"})},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="",t.text="Password authentication is not enabled"))}});Ut.addPasswordAuth=new Zt({id:"addPasswordAuth",title:"Add password authentication",inputs:[{placeholder:"email",type:"email",initVal:""},{placeholder:"confirm email",type:"email",initVal:""},{placeholder:"new password",type:"password",initVal:""},{placeholder:"confirm new password",type:"password",initVal:""}],buttonText:"reauthenticate to add",onlineOnly:!0,execFn:async(t,e,a,s,n)=>{if(e!==a)return{status:0,message:"Emails don't match"};if(s!==n)return{status:0,message:"Passwords don't match"};const i=await Us({password:s});if(i.status!==1)return{status:i.status,message:i.message};try{const d=bS.credential(e,s);await R2(i.user,d)}catch(d){return{status:-1,message:qe(d,"Failed to add password authentication")}}const r=await F.users.updateEmail({body:{newEmail:e,previousEmail:i.user.email}});return r.status!==200?{status:-1,message:"Password authentication added but updating the database email failed. This shouldn't happen, please contact support. Error: "+r.body.message}:(zi(),{status:1,message:"Password authentication added"})}});Ut.deleteAccount=new Zt({id:"deleteAccount",title:"Delete account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"delete",onlineOnly:!0,execFn:async(t,e)=>{const a=await Us({password:e});if(a.status!==1)return{status:a.status,message:a.message};g("Deleting all data...",0);const s=await F.users.delete();return s.status!==200?{status:-1,message:"Failed to delete user data: "+s.body.message}:(Wi(3),{status:1,message:"Account deleted, goodbye"})},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="reauthenticate to delete"))}});Ut.resetAccount=new Zt({id:"resetAccount",title:"Reset account",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"This is the last time you can change your mind. After pressing the button everything is gone.",buttonText:"reset",onlineOnly:!0,execFn:async(t,e)=>{const a=await Us({password:e});if(a.status!==1)return{status:a.status,message:a.message};g("Resetting settings...",0),await Mk(),g("Resetting account...",0);const s=await F.users.reset();return s.status!==200?{status:-1,message:"Failed to reset account: "+s.body.message}:(Wi(3),{status:1,message:"Account reset"})},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="reauthenticate to reset"))}});Ut.optOutOfLeaderboards=new Zt({id:"optOutOfLeaderboards",title:"Opt out of leaderboards",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to opt out of leaderboards?",buttonText:"opt out",onlineOnly:!0,execFn:async(t,e)=>{const a=await Us({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await F.users.optOutOfLeaderboards();return s.status!==200?{status:-1,message:"Failed to opt out: "+s.body.message}:(Wi(3),{status:1,message:"Leaderboards opt out successful"})},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="reauthenticate to opt out"))}});Ut.clearTagPb=new Zt({id:"clearTagPb",title:"Clear tag PB",text:"Are you sure you want to clear this tags PB?",buttonText:"clear",execFn:async t=>{var n,i;const e=t.parameters[0],a=await F.users.deleteTagPersonalBest({params:{tagId:e}});if(a.status!==200)return{status:-1,message:"Failed to clear tag PB: "+a.body.message};const s=(i=(n=T())==null?void 0:n.tags)==null?void 0:i.filter(r=>r._id===e)[0];return s===void 0?{status:-1,message:"Tag not found"}:(s.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},o(`.pageSettings .section.tags .tagsList .tag[id="${e}"] .clearPbButton`).attr("aria-label","No PB found"),{status:1,message:"Tag PB cleared"})},beforeInitFn:t=>{t.text=`Are you sure you want to clear PB for tag ${t.parameters[1]}?`}});Ut.applyCustomFont=new Zt({id:"applyCustomFont",title:"Custom font",inputs:[{type:"text",placeholder:"Font name",initVal:""}],text:"Make sure you have the font installed on your computer before applying",buttonText:"apply",execFn:async(t,e)=>{var a;return(a=X.fontFamily)==null||a.setValue(e.replace(/\s/g,"_")),{status:1,message:"Font applied"}}});Ut.resetPersonalBests=new Zt({id:"resetPersonalBests",title:"Reset personal bests",inputs:[{placeholder:"password",type:"password",initVal:""}],buttonText:"reset",onlineOnly:!0,execFn:async(t,e)=>{const a=await Us({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await F.users.deletePersonalBests();if(s.status!==200)return{status:-1,message:"Failed to reset personal bests: "+s.body.message};const n=T();return n?(n.personalBests={time:{},words:{},quote:{},zen:{},custom:{}},{status:1,message:"Personal bests reset"}):{status:-1,message:"Failed to reset personal bests: no snapshot"}},beforeInitFn:t=>{we()&&(li()||(t.inputs=[],t.buttonText="reauthenticate to reset"))}});Ut.resetSettings=new Zt({id:"resetSettings",title:"Reset settings",text:"Are you sure you want to reset all your settings?",buttonText:"reset",onlineOnly:!0,execFn:async()=>(await Mk(),{status:1,message:"Settings reset"})});Ut.revokeAllTokens=new Zt({id:"revokeAllTokens",title:"Revoke all tokens",inputs:[{placeholder:"password",type:"password",initVal:""}],text:"Are you sure you want to this? This will log you out of all devices.",buttonText:"revoke all",onlineOnly:!0,execFn:async(t,e)=>{const a=await Us({password:e});if(a.status!==1)return{status:a.status,message:a.message};const s=await F.users.revokeAllTokens();return s.status!==200?{status:-1,message:"Failed to revoke tokens: "+s.body.message}:(Wi(3),{status:1,message:"Tokens revoked"})},beforeInitFn:t=>{!we()||!T()||li()||(t.inputs[0].hidden=!0,t.buttonText="reauthenticate to revoke all tokens")}});Ut.unlinkDiscord=new Zt({id:"unlinkDiscord",title:"Unlink Discord",text:"Are you sure you want to unlink your Discord account?",buttonText:"unlink",onlineOnly:!0,execFn:async()=>{const t=T();if(!t)return{status:-1,message:"Failed to unlink Discord: no snapshot"};const e=await F.users.unlinkDiscord();return e.status!==200?{status:-1,message:"Failed to unlink Discord: "+e.body.message}:(t.discordAvatar=void 0,t.discordId=void 0,hg(void 0,void 0),Aa(t),zi(),{status:1,message:"Discord unlinked"})}});Ut.deleteCustomText=new Zt({id:"deleteCustomText",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async t=>(bM(t.parameters[0],!1),Dr("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:t=>{t.text=`Are you sure you want to delete custom text ${t.parameters[0]}?`}});Ut.deleteCustomTextLong=new Zt({id:"deleteCustomTextLong",title:"Delete custom text",text:"Are you sure?",buttonText:"delete",execFn:async t=>(bM(t.parameters[0],!0),Dr("",void 0),{status:1,message:"Custom text deleted"}),beforeInitFn:t=>{t.text=`Are you sure you want to delete custom text ${t.parameters[0]}?`}});Ut.resetProgressCustomTextLong=new Zt({id:"resetProgressCustomTextLong",title:"Reset progress for custom text",text:"Are you sure?",buttonText:"reset",execFn:async t=>{Ew(t.parameters[0],0);const e=Kg(t.parameters[0],!0);return Pi(e),{status:1,message:"Custom text progress reset"}},beforeInitFn:t=>{t.text=`Are you sure you want to reset your progress for custom text ${t.parameters[0]}?`}});Ut.updateCustomTheme=new Zt({id:"updateCustomTheme",title:"Update custom theme",inputs:[{type:"text",placeholder:"name",initVal:""},{type:"checkbox",initVal:!1,label:"Update custom theme to current colors",optional:!0}],buttonText:"update",onlineOnly:!0,execFn:async(t,e,a)=>{var u;const s=T();if(!s)return{status:-1,message:"Failed to update custom theme: no snapshot"};const n=(u=s.customThemes)==null?void 0:u.find(c=>c._id===t.parameters[0]);if(n===void 0)return{status:-1,message:"Failed to update custom theme: theme not found"};let i=[];if(a==="true")for(const c of Di)i.push(o(`.pageSettings .customTheme .customThemeEdit #${c}[type='color']`).attr("value"));else i=n.colors;const r={name:e.replaceAll(" ","_"),colors:i};return await PB(n._id,r)?(Rp(i),xl(),{status:1,message:"Custom theme updated"}):{status:-1,message:"Failed to update custom theme"}},beforeInitFn:t=>{var s;const e=T();if(!e)return;const a=(s=e.customThemes)==null?void 0:s.find(n=>n._id===t.parameters[0]);a&&(t.inputs[0].initVal=a.name)}});Ut.deleteCustomTheme=new Zt({id:"deleteCustomTheme",title:"Delete custom theme",text:"Are you sure?",buttonText:"delete",onlineOnly:!0,execFn:async t=>(await ZB(t.parameters[0]),xl(),{status:1,message:"Custom theme deleted"})});Ut.forgotPassword=new Zt({id:"forgotPassword",title:"Forgot password",inputs:[{type:"text",placeholder:"email",initVal:""}],buttonText:"send",execFn:async(t,e)=>{const a=await F.users.forgotPasswordEmail({body:{email:e.trim()}});return a.status!==200?{status:-1,message:"Failed to send password reset email: "+a.body.message}:{status:1,message:a.body.message,notificationOptions:{duration:8}}},beforeInitFn:t=>{const e=o('.pageLogin .login input[name="current-email"]').val();e&&(t.inputs[0].initVal=e)}});Ut.devGenerateData=new Zt({id:"devGenerateData",title:"Generate data",showLabels:!0,inputs:[{type:"text",label:"username",placeholder:"username",oninput:t=>{const e=t.target,a=document.querySelector("#devGenerateData_1 + span");a.innerHTML=`if checked, user will be created with ${e.value}@example.com and password: password`}},{type:"checkbox",label:"create user",description:"if checked, user will be created with {username}@example.com and password: password",optional:!0},{type:"date",label:"first test",optional:!0},{type:"date",label:"last test",max:new Date,optional:!0},{type:"range",label:"min tests per day",initVal:0,min:0,max:200,step:10},{type:"range",label:"max tests per day",initVal:50,min:0,max:200,step:10}],buttonText:"generate (might take a while)",execFn:async(t,e,a,s,n,i,r)=>{const d={username:e,createUser:a==="true"};s!==void 0&&s.length>0&&(d.firstTestTimestamp=Date.parse(s)),n!==void 0&&n.length>0&&(d.lastTestTimestamp=Date.parse(n)),i!==void 0&&i.length>0&&(d.minTestsPerDay=Number.parseInt(i)),r!==void 0&&r.length>0&&(d.maxTestsPerDay=Number.parseInt(r));const u=await F.dev.generateData({body:d});return{status:u.status===200?1:-1,message:u.body.message,hideOptions:{clearModalChain:!0}}}});function Xt(t,e=[],a={}){const s=Ut[t];if(s===void 0){g("Failed to show popup - popup is not defined",-1);return}s.show(e,a)}o(".pageLogin #forgotPasswordButton").on("click",()=>{Xt("forgotPassword")});o(".pageAccountSettings").on("click","#unlinkDiscordButton",()=>{Xt("unlinkDiscord")});o(".pageAccountSettings").on("click","#removeGoogleAuth",()=>{Xt("removeGoogleAuth")});o(".pageAccountSettings").on("click","#removeGithubAuth",()=>{Xt("removeGithubAuth")});o(".pageAccountSettings").on("click","#removePasswordAuth",()=>{Xt("removePasswordAuth")});o("#resetSettingsButton").on("click",()=>{Xt("resetSettings")});o(".pageAccountSettings").on("click","#revokeAllTokens",()=>{Xt("revokeAllTokens")});o(".pageAccountSettings").on("click","#resetPersonalBestsButton",()=>{Xt("resetPersonalBests")});o(".pageAccountSettings").on("click","#updateAccountName",()=>{Xt("updateName")});o("#bannerCenter").on("click",".banner .text .openNameChange",()=>{Xt("updateName")});o(".pageAccountSettings").on("click","#addPasswordAuth",()=>{Xt("addPasswordAuth")});o(".pageAccountSettings").on("click","#emailPasswordAuth",()=>{Xt("updateEmail")});o(".pageAccountSettings").on("click","#passPasswordAuth",()=>{Xt("updatePassword")});o(".pageAccountSettings").on("click","#deleteAccount",()=>{Xt("deleteAccount")});o(".pageAccountSettings").on("click","#resetAccount",()=>{Xt("resetAccount")});o(".pageAccountSettings").on("click","#optOutOfLeaderboardsButton",()=>{Xt("optOutOfLeaderboards")});o(".pageSettings").on("click",".section.themes .customTheme .delButton",t=>{const a=o(t.currentTarget).parent(".customTheme.button").attr("customThemeId");Xt("deleteCustomTheme",[a])});o(".pageSettings").on("click",".section.themes .customTheme .editButton",t=>{const a=o(t.currentTarget).parent(".customTheme.button").attr("customThemeId");Xt("updateCustomTheme",[a],{focusFirstInput:"focusAndSelect"})});o(".pageSettings").on("click",".section[data-config-name='fontFamily'] button[data-config-value='custom']",()=>{Xt("applyCustomFont")});async function PI(){const t=Iw(),e=o("#savedTextsModal .list").empty();let a="";if(t.length===0)a+="<div>No saved custom texts found</div>";else for(const r of t)a+=`<div class="savedText" data-name="${vs(r)}">
      <div class="button name">${vs(r)}</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;e.html(a);const s=Iw(!0),n=o("#savedTextsModal .listLong").empty();let i="";if(s.length===0)i+="<div>No saved long custom texts found</div>";else for(const r of s)i+=`<div class="savedLongText" data-name="${vs(r)}">
      <div class="button name">${vs(r)}</div>
      <div class="button ${Ik(r)<=0?"disabled":""} resetProgress">reset</div>
      <div class="button delete">
      <i class="fas fa-fw fa-trash"></i>
      </div>
      </div>`;n.html(i),o("#savedTextsModal .list .savedText .button.delete").on("click",r=>{const d=o(r.target).closest(".savedText").data("name");if(d===void 0){g("Failed to show delete modal: no name found",-1);return}Xt("deleteCustomText",[d],{modalChain:Ju})}),o("#savedTextsModal .listLong .savedLongText .button.delete").on("click",r=>{const d=o(r.target).closest(".savedLongText").data("name");if(d===void 0){g("Failed to show delete modal: no name found",-1);return}Xt("deleteCustomTextLong",[d],{modalChain:Ju})}),o("#savedTextsModal .listLong .savedLongText .button.resetProgress").on("click",r=>{const d=o(r.target).closest(".savedLongText").data("name");if(d===void 0){g("Failed to show delete modal: no name found",-1);return}Xt("resetProgressCustomTextLong",[d],{modalChain:Ju})}),o("#savedTextsModal .list .savedText .button.name").on("click",r=>{const d=o(r.target).text();Dr(d,!1);const u=OC(d,!1);IC({modalChainData:{text:u,long:!1}})}),o("#savedTextsModal .listLong .savedLongText .button.name").on("click",r=>{const d=o(r.target).text();Dr(d,!0);const u=OC(d,!0);IC({modalChainData:{text:u,long:!0}})})}async function QG(t){Ju.show({...t,beforeAnimation:async()=>{PI()}})}function IC(t){Ju.hide({...t})}function OC(t,e){let a=Kg(t,e);return e&&(a=a.slice(Ik(t))),a.join(" ")}async function YG(){}const Ju=new Ct({dialogId:"savedTextsModal",setup:YG,showOptionsWhenInChain:{beforeAnimation:async()=>{PI()}}});let ka;const Ty={textToSave:[]};async function JG(t){Ty.textToSave=[],ZI.show({...t,beforeAnimation:async(e,a)=>{Ty.textToSave=(a==null?void 0:a.text)??[],o("#saveCustomTextModal .textName").val(""),o("#saveCustomTextModal .isLongText").prop("checked",!1),o("#saveCustomTextModal button.save").prop("disabled",!0)}})}function XG(){ZI.hide()}function e7(){const t=o("#saveCustomTextModal .textName").val(),e=o("#saveCustomTextModal .isLongText").prop("checked");return t?Ty.textToSave.length===0?(g("Custom text can't be empty",0),!1):(V5(t,Ty.textToSave,e),Dr(t,e),g("Custom text saved",1),!0):(g("Custom text needs a name",0),!1)}function t7(){const t=o("#saveCustomTextModal .textName").val(),e=o("#saveCustomTextModal .isLongText").prop("checked");t?Iw(e).includes(t)?(ka==null||ka.show("unavailable"),o("#saveCustomTextModal button.save").prop("disabled",!0)):(ka==null||ka.show("available"),o("#saveCustomTextModal button.save").prop("disabled",!1)):(ka==null||ka.hide(),o("#saveCustomTextModal button.save").prop("disabled",!0))}const PC=cs(500,t7);async function a7(t){var e,a;ka=new Jr(o("#saveCustomTextModal .textName"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},loading:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),t.addEventListener("submit",s=>{s.preventDefault(),e7()&&XG()}),(e=t.querySelector(".textName"))==null||e.addEventListener("input",s=>{s.target.value.length>0&&(ka==null||ka.show("loading"),PC())}),(a=t.querySelector(".isLongText"))==null||a.addEventListener("input",s=>{s.target.value.length>0&&(ka==null||ka.show("loading"),PC())})}const ZI=new Ct({dialogId:"saveCustomTextModal",setup:a7}),Fe="#customTextModal .modal",M={textarea:cf().join(Rl()?"|":" "),longCustomTextWarning:!1,challengeWarning:!1,customTextMode:"simple",customTextLimits:{word:"",time:"",section:""},removeFancyTypographyEnabled:!0,replaceControlCharactersEnabled:!0,customTextPipeDelimiter:!1,replaceNewlines:"off"};function Es(){o(`${Fe} .inputs .group[data-id="mode"] button`).removeClass("active"),o(`${Fe} .inputs .group[data-id="mode"] button[value="${M.customTextMode}"]`).addClass("active"),o(`${Fe} .inputs .group[data-id="limit"] input.words`).addClass("hidden"),o(`${Fe} .inputs .group[data-id="limit"] input.sections`).addClass("hidden"),o(`${Fe} .inputs .group[data-id="limit"] input.words`).val(M.customTextLimits.word),o(`${Fe} .inputs .group[data-id="limit"] input.time`).val(M.customTextLimits.time),o(`${Fe} .inputs .group[data-id="limit"] input.sections`).val(M.customTextLimits.section),M.customTextLimits.word!==""&&o(`${Fe} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),M.customTextLimits.section!==""&&o(`${Fe} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),M.customTextPipeDelimiter?(o(`${Fe} .inputs .group[data-id="limit"] input.sections`).removeClass("hidden"),o(`${Fe} .inputs .group[data-id="limit"] input.words`).addClass("hidden")):(o(`${Fe} .inputs .group[data-id="limit"] input.words`).removeClass("hidden"),o(`${Fe} .inputs .group[data-id="limit"] input.sections`).addClass("hidden")),M.customTextMode==="simple"?(o(`${Fe} .inputs .group[data-id="limit"]`).addClass("disabled"),o(`${Fe} .inputs .group[data-id="limit"] input`).val(""),o(`${Fe} .inputs .group[data-id="limit"] input`).prop("disabled",!0)):(o(`${Fe} .inputs .group[data-id="limit"]`).removeClass("disabled"),o(`${Fe} .inputs .group[data-id="limit"] input`).prop("disabled",!1)),o(`${Fe} .inputs .group[data-id="fancy"] button`).removeClass("active"),o(`${Fe} .inputs .group[data-id="fancy"] button[value="${M.removeFancyTypographyEnabled}"]`).addClass("active"),o(`${Fe} .inputs .group[data-id="control"] button`).removeClass("active"),o(`${Fe} .inputs .group[data-id="control"] button[value="${M.replaceControlCharactersEnabled}"]`).addClass("active"),o(`${Fe} .inputs .group[data-id="delimiter"] button`).removeClass("active"),o(`${Fe} .inputs .group[data-id="delimiter"] button[value="${M.customTextPipeDelimiter}"]`).addClass("active"),o(`${Fe} .inputs .group[data-id="newlines"] button`).removeClass("active"),o(`${Fe} .inputs .group[data-id="newlines"] button[value="${M.replaceNewlines}"]`).addClass("active"),o(`${Fe} textarea`).val(M.textarea),M.longCustomTextWarning?(o(`${Fe} .longCustomTextWarning`).removeClass("hidden"),o(`${Fe} .randomWordsCheckbox input`).prop("checked",!1),o(`${Fe} .delimiterCheck input`).prop("checked",!1),o(`${Fe} .typographyCheck`).prop("checked",!0),o(`${Fe} .replaceNewlineWithSpace input`).prop("checked",!1),o(`${Fe} .inputs`).addClass("disabled")):(o(`${Fe} .longCustomTextWarning`).addClass("hidden"),o(`${Fe} .inputs`).removeClass("disabled")),M.challengeWarning?(o(`${Fe} .challengeWarning`).removeClass("hidden"),o(`${Fe} .randomWordsCheckbox input`).prop("checked",!1),o(`${Fe} .delimiterCheck input`).prop("checked",!1),o(`${Fe} .typographyCheck`).prop("checked",!0),o(`${Fe} .replaceNewlineWithSpace input`).prop("checked",!1),o(`${Fe} .inputs`).addClass("disabled")):(o(`${Fe} .challengeWarning`).addClass("hidden"),o(`${Fe} .inputs`).removeClass("disabled"))}async function RI(t,e){if(M.customTextMode=zu(),M.customTextMode==="repeat"&&Jt()==="word"&&Bt()===cf().length&&(M.customTextMode="simple"),M.customTextLimits.word="",M.customTextLimits.time="",M.customTextLimits.section="",Jt()==="word"?M.customTextLimits.word=`${Bt()}`:Jt()==="time"?M.customTextLimits.time=`${Bt()}`:Jt()==="section"&&(M.customTextLimits.section=`${Bt()}`),M.customTextPipeDelimiter=Rl(),M.longCustomTextWarning=Ni()??!1,(e==null?void 0:e.text)!==void 0){e.long!==!0&&Ni()&&(Dr("",void 0),g("Disabled long custom text progress tracking",0,{duration:5}),M.longCustomTextWarning=!1);const a=e.set??!0?e.text:M.textarea+" "+e.text;M.textarea=a,M.customTextMode="simple",M.customTextLimits.word=`${$y().length}`,M.customTextLimits.time="",M.customTextLimits.section=""}Es()}async function NI(){!M.challengeWarning&&!M.longCustomTextWarning&&o(`${Fe} textarea`).trigger("focus")}function DI(t){M.textarea=cf().join(Rl()?"|":" "),Xu.show({...t,beforeAnimation:RI,afterAnimation:NI})}function g0(){Xu.hide()}function s7(){var e;const t=(e=o("#fileInput")[0].files)==null?void 0:e[0];if(t){if(t.type!=="text/plain"){g("File is not a text file",-1,{duration:5});return}const a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=s=>{var i;const n=(i=s.target)==null?void 0:i.result;M.textarea=n,Es(),o("#fileInput").val("")},a.onerror=()=>{g("Failed to read file",-1,{duration:5})}}}function $y(){let t=M.textarea;return t===""?[]:(t=t.normalize().trim(),t=t.replace(/[\u2000-\u200A\u202F\u205F\u00A0]/g," "),t=t.replace(/[\u200B-\u200D\u2060\uFEFF]/g,""),M.replaceControlCharactersEnabled&&(t=t.replace(/([^\\]|^)\\t/gm,"$1	"),t=t.replace(/\\n/g,` 
`),t=t.replace(/([^\\]|^)\\n/gm,`$1
`),t=t.replace(/\\\\t/gm,"\\t"),t=t.replace(/\\\\n/gm,"\\n")),t=t.replace(/ +/gm," "),t=t.replace(/( *(\r\n|\r|\n) *)/g,`
 `),M.removeFancyTypographyEnabled&&(t=t1(t)),M.replaceNewlines!=="off"&&(M.replaceNewlines==="periodSpace"?(t=t.replace(/\n/gm,". "),t=t.replace(/\.\. /gm,". "),t=t.replace(/ +/gm," ")):(t=t.replace(/\n/gm," "),t=t.replace(/ +/gm," "))),t.split(M.customTextPipeDelimiter?"|":" ").filter(a=>a!==""))}function n7(){if(M.textarea===""){g("Text cannot be empty",0);return}if([M.customTextLimits.word,M.customTextLimits.time,M.customTextLimits.section].filter(e=>e!=="").length>1){g("You can only specify one limit",0,{duration:5});return}if(M.customTextMode!=="simple"&&M.customTextLimits.word===""&&M.customTextLimits.time===""&&M.customTextLimits.section===""){g("You need to specify a limit",0,{duration:5});return}(M.customTextLimits.section==="0"||M.customTextLimits.word==="0"||M.customTextLimits.time==="0")&&g("Infinite test! Make sure to use Bail Out from the command line to save your result.",0,{duration:7});const t=$y();M.customTextMode==="simple"?(qp("repeat"),M.customTextLimits.word=`${t.length}`,M.customTextLimits.time="",M.customTextLimits.section=""):qp(M.customTextMode),pl(M.customTextPipeDelimiter),Pi(t),M.customTextLimits.word!==""?(br("word"),ko(parseInt(M.customTextLimits.word))):M.customTextLimits.time!==""?(br("time"),ko(parseInt(M.customTextLimits.time))):M.customTextLimits.section!==""&&(br("section"),ko(parseInt(M.customTextLimits.section))),EL(),$t(),l.mode!=="custom"&&ha("custom"),ut(),g0()}function i7(){let t=M.textarea.split(M.customTextPipeDelimiter?" ":"|").join(M.customTextPipeDelimiter?"|":" ");t=t.replace(/\n /g,`
`),M.textarea=t}async function r7(t){var s,n,i,r,d,u,c,m,f,h;(s=t.querySelector("#fileInput"))==null||s.addEventListener("change",s7);const e=t.querySelectorAll(".group[data-id='mode'] button");for(const y of e)y.addEventListener("click",b=>{if(M.customTextMode=b.target.value,M.customTextMode==="simple"){const w=$y();M.customTextLimits.word=`${w.length}`,M.customTextLimits.time="",M.customTextLimits.section=""}Es()});for(const y of t.querySelectorAll(".group[data-id='fancy'] button"))y.addEventListener("click",b=>{M.removeFancyTypographyEnabled=b.target.value==="true",Es()});for(const y of t.querySelectorAll(".group[data-id='control'] button"))y.addEventListener("click",b=>{M.replaceControlCharactersEnabled=b.target.value==="true",Es()});for(const y of t.querySelectorAll(".group[data-id='delimiter'] button"))y.addEventListener("click",b=>{M.customTextPipeDelimiter=b.target.value==="true",M.customTextPipeDelimiter&&M.customTextLimits.word!==""&&(M.customTextLimits.word=""),!M.customTextPipeDelimiter&&M.customTextLimits.section!==""&&(M.customTextLimits.section=""),i7(),Es()});for(const y of t.querySelectorAll(".group[data-id='newlines'] button"))y.addEventListener("click",b=>{M.replaceNewlines=b.target.value,Es()});(n=t.querySelector(".group[data-id='limit'] input.words"))==null||n.addEventListener("input",y=>{M.customTextLimits.word=y.target.value,M.customTextLimits.time="",M.customTextLimits.section="",Es()}),(i=t.querySelector(".group[data-id='limit'] input.time"))==null||i.addEventListener("input",y=>{M.customTextLimits.time=y.target.value,M.customTextLimits.word="",M.customTextLimits.section="",Es()}),(r=t.querySelector(".group[data-id='limit'] input.sections"))==null||r.addEventListener("input",y=>{M.customTextLimits.section=y.target.value,M.customTextLimits.word="",M.customTextLimits.time="",Es()});const a=t.querySelector("textarea");a==null||a.addEventListener("input",y=>{M.textarea=y.target.value}),a==null||a.addEventListener("keydown",y=>{if(y.key!=="Tab")return;y.preventDefault();const b=y.target,w=b.selectionStart,$=b.selectionEnd;b.value=b.value.substring(0,w)+"	"+b.value.substring($),b.selectionStart=b.selectionEnd=w+1,M.textarea=b.value}),a==null||a.addEventListener("keypress",y=>{if(M.longCustomTextWarning||M.challengeWarning){y.preventDefault();return}y.code==="Enter"&&y.ctrlKey&&o(`${Fe} .button.apply`).trigger("click"),Ni()&&Hk()!==""&&(Dr("",void 0),M.longCustomTextWarning=!1,g("Disabled long custom text progress tracking",0,{duration:5}))}),(d=t.querySelector(".button.apply"))==null||d.addEventListener("click",()=>{n7()}),(u=t.querySelector(".button.wordfilter"))==null||u.addEventListener("click",()=>{p6({modalChain:Xu})}),(c=t.querySelector(".button.showSavedTexts"))==null||c.addEventListener("click",()=>{QG({modalChain:Xu})}),(m=t.querySelector(".button.saveCustomText"))==null||m.addEventListener("click",()=>{JG({modalChain:Xu,modalChainData:{text:$y()}})}),(f=t.querySelector(".longCustomTextWarning"))==null||f.addEventListener("click",()=>{M.longCustomTextWarning=!1,Es()}),(h=t.querySelector(".challengeWarning"))==null||h.addEventListener("click",()=>{M.challengeWarning=!1,Es()})}const Xu=new Ct({dialogId:"customTextModal",setup:r7,customEscapeHandler:async()=>{g0()},customWrapperClickHandler:async()=>{g0()},showOptionsWhenInChain:{beforeAnimation:RI,afterAnimation:NI}});function jI(){const t=o("#mobileTestConfigModal");if(t.find("button").removeClass("active"),t.find(`.modeGroup button[data-mode='${l.mode}']`).addClass("active"),t.find(".timeGroup").addClass("hidden"),t.find(".wordsGroup").addClass("hidden"),t.find(".quoteGroup").addClass("hidden"),t.find(".customGroup").addClass("hidden"),t.find(`.${l.mode}Group`).removeClass("hidden"),l.punctuation?t.find(".punctuation").addClass("active"):t.find(".punctuation").removeClass("active"),l.numbers?t.find(".numbers").addClass("active"):t.find(".numbers").removeClass("active"),l.mode==="time")t.find(`.timeGroup button[data-time='${l.time}']`).addClass("active"),t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled");else if(l.mode==="words")t.find(`.wordsGroup button[data-words='${l.words}']`).addClass("active"),t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled");else if(l.mode==="quote"){for(const e of l.quoteLength)t.find(`.quoteGroup button[data-quoteLength='${e}']`).addClass("active");t.find(".punctuation").addClass("disabled"),t.find(".numbers").addClass("disabled")}else l.mode==="zen"?(t.find(".punctuation").addClass("disabled"),t.find(".numbers").addClass("disabled")):l.mode==="custom"&&(t.find(".punctuation").removeClass("disabled"),t.find(".numbers").removeClass("disabled"))}function o7(){Zu.show({beforeAnimation:async()=>{jI()}})}async function d7(t){var r,d,u;const e=t.querySelectorAll(".wordsGroup button");for(const c of e)c.addEventListener("click",m=>{const h=m.currentTarget.getAttribute("data-words");if(h==="custom")rE({modalChain:Zu});else if(h!==void 0){const y=parseInt(h);Zr(y),$t(),ut()}});const a=t.querySelectorAll(".modeGroup button");for(const c of a)c.addEventListener("click",m=>{const h=m.currentTarget.getAttribute("data-mode");h!==l.mode&&(ha(h),$t(),ut())});const s=t.querySelectorAll(".timeGroup button");for(const c of s)c.addEventListener("click",m=>{const h=m.currentTarget.getAttribute("data-time");if(h==="custom")HE({modalChain:Zu});else if(h!==void 0){const y=parseInt(h);Dn(y),$t(),ut()}});const n=t.querySelectorAll(".quoteGroup button");for(const c of n)c.addEventListener("click",m=>{const f=m.currentTarget,h=parseInt(f.getAttribute("data-quoteLength")??"0",10);if(h===-2)JE({modalChain:Zu});else{let y=h;h===-1&&(y=[0,1,2,3]),bi(y,!1,m.shiftKey),$t(),ut()}});(r=t.querySelector(".customChange"))==null||r.addEventListener("click",()=>{DI({modalChain:Zu})}),(d=t.querySelector(".punctuation"))==null||d.addEventListener("click",()=>{xn(!l.punctuation),$t(),ut()}),(u=t.querySelector(".numbers"))==null||u.addEventListener("click",()=>{Fs(!l.numbers),$t(),ut()});const i=t.querySelectorAll("button");for(const c of i)c.addEventListener("click",()=>{jI()})}const Zu=new Ct({dialogId:"mobileTestConfigModal",setup:d7}),yr={missed:"words",slow:!1},fd="#practiseWordsModal .modal";function mb(){o(`${fd} .group[data-id="missed"] button`).removeClass("active"),o(`${fd} .group[data-id="missed"] button[value="${yr.missed}"]`).addClass("active"),o(`${fd} .group[data-id="slow"] button`).removeClass("active"),o(`${fd} .group[data-id="slow"] button[value="${yr.slow}"]`).addClass("active"),yr.missed==="off"&&!yr.slow?o(`${fd} .start`).prop("disabled",!0):o(`${fd} .start`).prop("disabled",!1)}async function l7(t){var e;for(const a of t.querySelectorAll(".group[data-id='missed'] button"))a.addEventListener("click",s=>{yr.missed=s.target.value,mb()});for(const a of t.querySelectorAll(".group[data-id='slow'] button"))a.addEventListener("click",s=>{yr.slow=s.target.value==="true",mb()});(e=t.querySelector(".start"))==null||e.addEventListener("click",()=>{ZC()}),t.addEventListener("submit",a=>{a.preventDefault(),ZC()}),mb()}function u7(t){BI.show(t)}function c7(t=!1){BI.hide({clearModalChain:t})}function ZC(){Y4(yr.missed,yr.slow),c7(!0),ut({practiseMissed:!0})}const BI=new Ct({dialogId:"practiseWordsModal",setup:l7});o(".pageTest").on("click","#testModesNotice .textButton",async t=>{const e=o(t.currentTarget).attr("commands");e!==void 0&&(await Zl()).show({subgroupOverride:e})});o(".pageTest").on("click","#testConfig .wordCount .textButton",t=>{o(t.currentTarget).attr("wordCount")==="custom"&&rE()});o(".pageTest").on("click","#testConfig .time .textButton",t=>{o(t.currentTarget).attr("timeconfig")==="custom"&&HE()});o(".pageTest").on("click",".tags .editTagsButton",()=>{var t,e;if((((e=(t=T())==null?void 0:t.tags)==null?void 0:e.length)??0)>0){const a=o(".pageTest .tags .editTagsButton").attr("data-result-id"),s=o(".pageTest .tags .editTagsButton").attr("data-active-tag-ids"),n=s===""?[]:s.split(",");qE(a,n,"resultPage")}});o(".pageTest").on("click","#mobileTestConfigButton",()=>{o7()});o(".pageTest #rateQuoteButton").on("click",async()=>{if(pt===null){g("Failed to show quote rating popup: no quote",-1);return}qz(pt)});o(".pageTest #reportQuoteButton").on("click",async()=>{if(pt===null){g("Failed to show quote report popup: no quote",-1);return}QE(pt==null?void 0:pt.id)});o(".pageTest").on("click","#testConfig .quoteLength .textButton",t=>{parseInt(o(t.currentTarget).attr("quoteLength")??"0")===-2&&JE()});o(".pageTest").on("click","#testConfig .customText .textButton",()=>{DI()});o(".pageTest").on("click","#practiseWordsButton",()=>{if(l.mode==="zen"){g("Practice words is unsupported in zen mode",0);return}u7()});var tS;(tS=document.querySelector("#pageAbout #supportMeAboutButton"))==null||tS.addEventListener("click",()=>{nM()});var aS;(aS=document.querySelector("#pageAbout #contactPopupButton2"))==null||aS.addEventListener("click",()=>{rM()});const D_={includeBackground:!1};function p7(){y0.show({beforeAnimation:async t=>{t.querySelector("input[type='checkbox']").checked=!1,D_.includeBackground=!1}})}async function m7(){const t={c:Di.map(e=>o(`.pageSettings .customTheme .customThemeEdit #${e}[type='color']`).attr("value"))};return D_.includeBackground&&(t.i=l.customBackground,t.s=l.customBackgroundSize,t.f=l.customBackgroundFilter),window.location.origin+"?customTheme="+btoa(JSON.stringify(t))}async function f7(){const t=await m7();try{await navigator.clipboard.writeText(t),g("URL Copied to clipboard",1),y0.hide()}catch{g("Looks like we couldn't copy the link straight to your clipboard. Please copy it manually.",0,{duration:5}),v0.show({modalChain:y0,focusFirstInput:"focusAndSelect",beforeAnimation:async a=>{a.querySelector("input").value=t}})}}const y0=new Ct({dialogId:"shareCustomThemeModal",setup:async t=>{var e,a;(e=t.querySelector("button"))==null||e.addEventListener("click",f7),(a=t.querySelector("input[type='checkbox']"))==null||a.addEventListener("change",s=>{D_.includeBackground=s.target.checked})}}),v0=new Ct({dialogId:"shareCustomThemeUrlModal",customEscapeHandler:async()=>{await v0.hide({clearModalChain:!0})},customWrapperClickHandler:async()=>{await v0.hide({clearModalChain:!0})}}),h7=Lt.object({security:Lt.boolean(),analytics:Lt.boolean()}),qI=new Ts({key:"acceptedCookies",schema:h7,fallback:void 0});function fb(t){qI.set(t)}function g7(){qI.get()===void 0&&WI()}function WI(t){Sm.show({beforeAnimation:async()=>{t&&FI()},afterAnimation:async()=>{Ra("cookiesModal")||Sm.destroy()}})}function FI(){var t,e;(t=Sm.getModal().querySelector(".main"))==null||t.classList.add("hidden"),(e=Sm.getModal().querySelector(".settings"))==null||e.classList.remove("hidden")}async function hb(){Sm.hide({afterAnimation:async()=>{uv()}})}const Sm=new Ct({dialogId:"cookiesModal",customEscapeHandler:()=>{},customWrapperClickHandler:()=>{},setup:async t=>{var e,a,s,n,i;(e=t.querySelector(".acceptAll"))==null||e.addEventListener("click",()=>{fb({security:!0,analytics:!0}),Kb(),hb()}),(a=t.querySelector(".rejectAll"))==null||a.addEventListener("click",()=>{fb({security:!0,analytics:!1}),hb()}),(s=t.querySelector(".openSettings"))==null||s.addEventListener("click",()=>{FI()}),(n=t.querySelector(".cookie.ads .textButton"))==null||n.addEventListener("click",()=>{try{iH()}catch{console.error("Failed to open ad consent UI"),g("Failed to open Ad consent popup. Do you have an ad or cookie popup blocker enabled?",-1)}}),(i=t.querySelector(".acceptSelected"))==null||i.addEventListener("click",()=>{const r=t.querySelector(".cookie.analytics input").checked;fb({security:!0,analytics:r}),hb(),r&&Kb()})}});var xt;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function a(n){throw new Error}t.assertNever=a,t.arrayToEnum=n=>{let i={};for(let r of n)i[r]=r;return i},t.getValidEnumValues=n=>{let i=t.objectKeys(n).filter(d=>typeof n[n[d]]!="number"),r={};for(let d of i)r[d]=n[d];return t.objectValues(r)},t.objectValues=n=>t.objectKeys(n).map(function(i){return n[i]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let i=[];for(let r in n)Object.prototype.hasOwnProperty.call(n,r)&&i.push(r);return i},t.find=(n,i)=>{for(let r of n)if(i(r))return r},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function s(n,i=" | "){return n.map(r=>typeof r=="string"?`'${r}'`:r).join(i)}t.joinValues=s,t.jsonStringifyReplacer=(n,i)=>typeof i=="bigint"?i.toString():i})(xt||(xt={}));var b0;(function(t){t.mergeShapes=(e,a)=>({...e,...a})})(b0||(b0={}));var re=xt.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ur=t=>{switch(typeof t){case"undefined":return re.undefined;case"string":return re.string;case"number":return isNaN(t)?re.nan:re.number;case"boolean":return re.boolean;case"function":return re.function;case"bigint":return re.bigint;case"symbol":return re.symbol;case"object":return Array.isArray(t)?re.array:t===null?re.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?re.promise:typeof Map<"u"&&t instanceof Map?re.map:typeof Set<"u"&&t instanceof Set?re.set:typeof Date<"u"&&t instanceof Date?re.date:re.object;default:return re.unknown}},j=xt.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),y7=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),gn=class zI extends Error{constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};let a=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,a):this.__proto__=a,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){let a=e||function(i){return i.message},s={_errors:[]},n=i=>{for(let r of i.issues)if(r.code==="invalid_union")r.unionErrors.map(n);else if(r.code==="invalid_return_type")n(r.returnTypeError);else if(r.code==="invalid_arguments")n(r.argumentsError);else if(r.path.length===0)s._errors.push(a(r));else{let d=s,u=0;for(;u<r.path.length;){let c=r.path[u];u===r.path.length-1?(d[c]=d[c]||{_errors:[]},d[c]._errors.push(a(r))):d[c]=d[c]||{_errors:[]},d=d[c],u++}}};return n(this),s}static assert(e){if(!(e instanceof zI))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,xt.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=a=>a.message){let a={},s=[];for(let n of this.issues)n.path.length>0?(a[n.path[0]]=a[n.path[0]]||[],a[n.path[0]].push(e(n))):s.push(e(n));return{formErrors:s,fieldErrors:a}}get formErrors(){return this.flatten()}};gn.create=t=>new gn(t);var Al=(t,e)=>{let a;switch(t.code){case j.invalid_type:t.received===re.undefined?a="Required":a=`Expected ${t.expected}, received ${t.received}`;break;case j.invalid_literal:a=`Invalid literal value, expected ${JSON.stringify(t.expected,xt.jsonStringifyReplacer)}`;break;case j.unrecognized_keys:a=`Unrecognized key(s) in object: ${xt.joinValues(t.keys,", ")}`;break;case j.invalid_union:a="Invalid input";break;case j.invalid_union_discriminator:a=`Invalid discriminator value. Expected ${xt.joinValues(t.options)}`;break;case j.invalid_enum_value:a=`Invalid enum value. Expected ${xt.joinValues(t.options)}, received '${t.received}'`;break;case j.invalid_arguments:a="Invalid function arguments";break;case j.invalid_return_type:a="Invalid function return type";break;case j.invalid_date:a="Invalid date";break;case j.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(a=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(a=`${a} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?a=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?a=`Invalid input: must end with "${t.validation.endsWith}"`:xt.assertNever(t.validation):t.validation!=="regex"?a=`Invalid ${t.validation}`:a="Invalid";break;case j.too_small:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:a="Invalid input";break;case j.too_big:t.type==="array"?a=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?a=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?a=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?a=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?a=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:a="Invalid input";break;case j.custom:a="Invalid input";break;case j.invalid_intersection_types:a="Intersection results could not be merged";break;case j.not_multiple_of:a=`Number must be a multiple of ${t.multipleOf}`;break;case j.not_finite:a="Number must be finite";break;default:a=e.defaultError,xt.assertNever(t)}return{message:a}},HI=Al;function v7(t){HI=t}function Ay(){return HI}var My=t=>{let{data:e,path:a,errorMaps:s,issueData:n}=t,i=[...a,...n.path||[]],r={...n,path:i};if(n.message!==void 0)return{...n,path:i,message:n.message};let d="",u=s.filter(c=>!!c).slice().reverse();for(let c of u)d=c(r,{data:e,defaultError:d}).message;return{...n,path:i,message:d}},b7=[];function Y(t,e){let a=Ay(),s=My({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,a,a===Al?void 0:Al].filter(n=>!!n)});t.common.issues.push(s)}var us=class UI{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,a){let s=[];for(let n of a){if(n.status==="aborted")return Be;n.status==="dirty"&&e.dirty(),s.push(n.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,a){let s=[];for(let n of a){let i=await n.key,r=await n.value;s.push({key:i,value:r})}return UI.mergeObjectSync(e,s)}static mergeObjectSync(e,a){let s={};for(let n of a){let{key:i,value:r}=n;if(i.status==="aborted"||r.status==="aborted")return Be;i.status==="dirty"&&e.dirty(),r.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof r.value<"u"||n.alwaysSet)&&(s[i.value]=r.value)}return{status:e.value,value:s}}},Be=Object.freeze({status:"aborted"}),Ly=t=>({status:"dirty",value:t}),za=t=>({status:"valid",value:t}),w0=t=>t.status==="aborted",k0=t=>t.status==="dirty",Tm=t=>t.status==="valid",$m=t=>typeof Promise<"u"&&t instanceof Promise;function Ey(t,e,a,s){if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function KI(t,e,a,s,n){if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,a),a}var ge;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(ge||(ge={}));var Ru,Nu,oi=class{constructor(t,e,a,s){this._cachedPath=[],this.parent=t,this.data=e,this._path=a,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},RC=(t,e)=>{if(Tm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let a=new gn(t.common.issues);return this._error=a,this._error}}};function Je(t){if(!t)return{};let{errorMap:e,invalid_type_error:a,required_error:s,description:n}=t;if(e&&(a||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(i,r)=>{var d,u;let{message:c}=t;return i.code==="invalid_enum_value"?{message:c??r.defaultError}:typeof r.data>"u"?{message:(d=c??s)!==null&&d!==void 0?d:r.defaultError}:i.code!=="invalid_type"?{message:r.defaultError}:{message:(u=c??a)!==null&&u!==void 0?u:r.defaultError}},description:n}}var it=class{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return ur(t.data)}_getOrReturnCtx(t,e){return e||{common:t.parent.common,data:t.data,parsedType:ur(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new us,ctx:{common:t.parent.common,data:t.data,parsedType:ur(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let e=this._parse(t);if($m(e))throw new Error("Synchronous parse encountered promise.");return e}_parseAsync(t){let e=this._parse(t);return Promise.resolve(e)}parse(t,e){let a=this.safeParse(t,e);if(a.success)return a.data;throw a.error}safeParse(t,e){var a;let s={common:{issues:[],async:(a=e==null?void 0:e.async)!==null&&a!==void 0?a:!1,contextualErrorMap:e==null?void 0:e.errorMap},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ur(t)},n=this._parseSync({data:t,path:s.path,parent:s});return RC(s,n)}async parseAsync(t,e){let a=await this.safeParseAsync(t,e);if(a.success)return a.data;throw a.error}async safeParseAsync(t,e){let a={common:{issues:[],contextualErrorMap:e==null?void 0:e.errorMap,async:!0},path:(e==null?void 0:e.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ur(t)},s=this._parse({data:t,path:a.path,parent:a}),n=await($m(s)?s:Promise.resolve(s));return RC(a,n)}refine(t,e){let a=s=>typeof e=="string"||typeof e>"u"?{message:e}:typeof e=="function"?e(s):e;return this._refinement((s,n)=>{let i=t(s),r=()=>n.addIssue({code:j.custom,...a(s)});return typeof Promise<"u"&&i instanceof Promise?i.then(d=>d?!0:(r(),!1)):i?!0:(r(),!1)})}refinement(t,e){return this._refinement((a,s)=>t(a)?!0:(s.addIssue(typeof e=="function"?e(a,s):e),!1))}_refinement(t){return new Sn({schema:this,typeName:Le.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return Jn.create(this,this._def)}nullable(){return Hr.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Qo.create(this,this._def)}promise(){return El.create(this,this._def)}or(t){return Pm.create([this,t],this._def)}and(t){return Zm.create(this,t,this._def)}transform(t){return new Sn({...Je(this._def),schema:this,typeName:Le.ZodEffects,effect:{type:"transform",transform:t}})}default(t){let e=typeof t=="function"?t:()=>t;return new jm({...Je(this._def),innerType:this,defaultValue:e,typeName:Le.ZodDefault})}brand(){return new j_({typeName:Le.ZodBranded,type:this,...Je(this._def)})}catch(t){let e=typeof t=="function"?t:()=>t;return new Bm({...Je(this._def),innerType:this,catchValue:e,typeName:Le.ZodCatch})}describe(t){let e=this.constructor;return new e({...this._def,description:t})}pipe(t){return B_.create(this,t)}readonly(){return qm.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},w7=/^c[^\s-]{8,}$/i,k7=/^[0-9a-z]+$/,_7=/^[0-9A-HJKMNP-TV-Z]{26}$/,x7=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,C7=/^[a-z0-9_-]{21}$/i,S7=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,T7=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,$7="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",gb,A7=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,M7=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,L7=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,VI="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",E7=new RegExp(`^${VI}$`);function GI(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function I7(t){return new RegExp(`^${GI(t)}$`)}function QI(t){let e=`${VI}T${GI(t)}`,a=[];return a.push(t.local?"Z?":"Z"),t.offset&&a.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${a.join("|")})`,new RegExp(`^${e}$`)}function O7(t,e){return!!((e==="v4"||!e)&&A7.test(t)||(e==="v6"||!e)&&M7.test(t))}var Ml=class Du extends it{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==re.string){let n=this._getOrReturnCtx(e);return Y(n,{code:j.invalid_type,expected:re.string,received:n.parsedType}),Be}let a=new us,s;for(let n of this._def.checks)if(n.kind==="min")e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),Y(s,{code:j.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="max")e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),Y(s,{code:j.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),a.dirty());else if(n.kind==="length"){let i=e.data.length>n.value,r=e.data.length<n.value;(i||r)&&(s=this._getOrReturnCtx(e,s),i?Y(s,{code:j.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):r&&Y(s,{code:j.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),a.dirty())}else if(n.kind==="email")T7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"email",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="emoji")gb||(gb=new RegExp($7,"u")),gb.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"emoji",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="uuid")x7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"uuid",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="nanoid")C7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"nanoid",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid")w7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"cuid",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="cuid2")k7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"cuid2",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="ulid")_7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"ulid",code:j.invalid_string,message:n.message}),a.dirty());else if(n.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Y(s,{validation:"url",code:j.invalid_string,message:n.message}),a.dirty()}else n.kind==="regex"?(n.regex.lastIndex=0,n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"regex",code:j.invalid_string,message:n.message}),a.dirty())):n.kind==="trim"?e.data=e.data.trim():n.kind==="includes"?e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),a.dirty()):n.kind==="toLowerCase"?e.data=e.data.toLowerCase():n.kind==="toUpperCase"?e.data=e.data.toUpperCase():n.kind==="startsWith"?e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:{startsWith:n.value},message:n.message}),a.dirty()):n.kind==="endsWith"?e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:{endsWith:n.value},message:n.message}),a.dirty()):n.kind==="datetime"?QI(n).test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:"datetime",message:n.message}),a.dirty()):n.kind==="date"?E7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:"date",message:n.message}),a.dirty()):n.kind==="time"?I7(n).test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{code:j.invalid_string,validation:"time",message:n.message}),a.dirty()):n.kind==="duration"?S7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"duration",code:j.invalid_string,message:n.message}),a.dirty()):n.kind==="ip"?O7(e.data,n.version)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"ip",code:j.invalid_string,message:n.message}),a.dirty()):n.kind==="base64"?L7.test(e.data)||(s=this._getOrReturnCtx(e,s),Y(s,{validation:"base64",code:j.invalid_string,message:n.message}),a.dirty()):xt.assertNever(n);return{status:a.value,value:e.data}}_regex(e,a,s){return this.refinement(n=>e.test(n),{validation:a,code:j.invalid_string,...ge.errToObj(s)})}_addCheck(e){return new Du({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ge.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ge.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ge.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ge.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ge.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ge.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ge.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ge.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ge.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ge.errToObj(e)})}datetime(e){var a,s;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(a=e==null?void 0:e.offset)!==null&&a!==void 0?a:!1,local:(s=e==null?void 0:e.local)!==null&&s!==void 0?s:!1,...ge.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...ge.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...ge.errToObj(e)})}regex(e,a){return this._addCheck({kind:"regex",regex:e,...ge.errToObj(a)})}includes(e,a){return this._addCheck({kind:"includes",value:e,position:a==null?void 0:a.position,...ge.errToObj(a==null?void 0:a.message)})}startsWith(e,a){return this._addCheck({kind:"startsWith",value:e,...ge.errToObj(a)})}endsWith(e,a){return this._addCheck({kind:"endsWith",value:e,...ge.errToObj(a)})}min(e,a){return this._addCheck({kind:"min",value:e,...ge.errToObj(a)})}max(e,a){return this._addCheck({kind:"max",value:e,...ge.errToObj(a)})}length(e,a){return this._addCheck({kind:"length",value:e,...ge.errToObj(a)})}nonempty(e){return this.min(1,ge.errToObj(e))}trim(){return new Du({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Du({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Du({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get minLength(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxLength(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Ml.create=t=>{var e;return new Ml({checks:[],typeName:Le.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Je(t)})};function P7(t,e){let a=(t.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,n=a>s?a:s,i=parseInt(t.toFixed(n).replace(".","")),r=parseInt(e.toFixed(n).replace(".",""));return i%r/Math.pow(10,n)}var Am=class _0 extends it{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==re.number){let n=this._getOrReturnCtx(e);return Y(n,{code:j.invalid_type,expected:re.number,received:n.parsedType}),Be}let a,s=new us;for(let n of this._def.checks)n.kind==="int"?xt.isInteger(e.data)||(a=this._getOrReturnCtx(e,a),Y(a,{code:j.invalid_type,expected:"integer",received:"float",message:n.message}),s.dirty()):n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),s.dirty()):n.kind==="multipleOf"?P7(e.data,n.value)!==0&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):n.kind==="finite"?Number.isFinite(e.data)||(a=this._getOrReturnCtx(e,a),Y(a,{code:j.not_finite,message:n.message}),s.dirty()):xt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ge.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ge.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ge.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ge.toString(a))}setLimit(e,a,s,n){return new _0({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ge.toString(n)}]})}_addCheck(e){return new _0({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ge.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ge.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(a)})}finite(e){return this._addCheck({kind:"finite",message:ge.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ge.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ge.toString(e)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&xt.isInteger(e.value))}get isFinite(){let e=null,a=null;for(let s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(a===null||s.value>a)&&(a=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(a)&&Number.isFinite(e)}};Am.create=t=>new Am({checks:[],typeName:Le.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...Je(t)});var Mm=class x0 extends it{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==re.bigint){let n=this._getOrReturnCtx(e);return Y(n,{code:j.invalid_type,expected:re.bigint,received:n.parsedType}),Be}let a,s=new us;for(let n of this._def.checks)n.kind==="min"?(n.inclusive?e.data<n.value:e.data<=n.value)&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="max"?(n.inclusive?e.data>n.value:e.data>=n.value)&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),s.dirty()):n.kind==="multipleOf"?e.data%n.value!==BigInt(0)&&(a=this._getOrReturnCtx(e,a),Y(a,{code:j.not_multiple_of,multipleOf:n.value,message:n.message}),s.dirty()):xt.assertNever(n);return{status:s.value,value:e.data}}gte(e,a){return this.setLimit("min",e,!0,ge.toString(a))}gt(e,a){return this.setLimit("min",e,!1,ge.toString(a))}lte(e,a){return this.setLimit("max",e,!0,ge.toString(a))}lt(e,a){return this.setLimit("max",e,!1,ge.toString(a))}setLimit(e,a,s,n){return new x0({...this._def,checks:[...this._def.checks,{kind:e,value:a,inclusive:s,message:ge.toString(n)}]})}_addCheck(e){return new x0({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ge.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ge.toString(e)})}multipleOf(e,a){return this._addCheck({kind:"multipleOf",value:e,message:ge.toString(a)})}get minValue(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e}get maxValue(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e}};Mm.create=t=>{var e;return new Mm({checks:[],typeName:Le.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...Je(t)})};var Lm=class extends it{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==re.boolean){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.boolean,received:e.parsedType}),Be}return za(t.data)}};Lm.create=t=>new Lm({typeName:Le.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...Je(t)});var Em=class YI extends it{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==re.date){let n=this._getOrReturnCtx(e);return Y(n,{code:j.invalid_type,expected:re.date,received:n.parsedType}),Be}if(isNaN(e.data.getTime())){let n=this._getOrReturnCtx(e);return Y(n,{code:j.invalid_date}),Be}let a=new us,s;for(let n of this._def.checks)n.kind==="min"?e.data.getTime()<n.value&&(s=this._getOrReturnCtx(e,s),Y(s,{code:j.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),a.dirty()):n.kind==="max"?e.data.getTime()>n.value&&(s=this._getOrReturnCtx(e,s),Y(s,{code:j.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),a.dirty()):xt.assertNever(n);return{status:a.value,value:new Date(e.data.getTime())}}_addCheck(e){return new YI({...this._def,checks:[...this._def.checks,e]})}min(e,a){return this._addCheck({kind:"min",value:e.getTime(),message:ge.toString(a)})}max(e,a){return this._addCheck({kind:"max",value:e.getTime(),message:ge.toString(a)})}get minDate(){let e=null;for(let a of this._def.checks)a.kind==="min"&&(e===null||a.value>e)&&(e=a.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let a of this._def.checks)a.kind==="max"&&(e===null||a.value<e)&&(e=a.value);return e!=null?new Date(e):null}};Em.create=t=>new Em({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:Le.ZodDate,...Je(t)});var Iy=class extends it{_parse(t){if(this._getType(t)!==re.symbol){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.symbol,received:e.parsedType}),Be}return za(t.data)}};Iy.create=t=>new Iy({typeName:Le.ZodSymbol,...Je(t)});var Im=class extends it{_parse(t){if(this._getType(t)!==re.undefined){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.undefined,received:e.parsedType}),Be}return za(t.data)}};Im.create=t=>new Im({typeName:Le.ZodUndefined,...Je(t)});var Om=class extends it{_parse(t){if(this._getType(t)!==re.null){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.null,received:e.parsedType}),Be}return za(t.data)}};Om.create=t=>new Om({typeName:Le.ZodNull,...Je(t)});var Ll=class extends it{constructor(){super(...arguments),this._any=!0}_parse(t){return za(t.data)}};Ll.create=t=>new Ll({typeName:Le.ZodAny,...Je(t)});var Eo=class extends it{constructor(){super(...arguments),this._unknown=!0}_parse(t){return za(t.data)}};Eo.create=t=>new Eo({typeName:Le.ZodUnknown,...Je(t)});var qi=class extends it{_parse(t){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.never,received:e.parsedType}),Be}};qi.create=t=>new qi({typeName:Le.ZodNever,...Je(t)});var Oy=class extends it{_parse(t){if(this._getType(t)!==re.undefined){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.void,received:e.parsedType}),Be}return za(t.data)}};Oy.create=t=>new Oy({typeName:Le.ZodVoid,...Je(t)});var Qo=class jh extends it{_parse(e){let{ctx:a,status:s}=this._processInputParams(e),n=this._def;if(a.parsedType!==re.array)return Y(a,{code:j.invalid_type,expected:re.array,received:a.parsedType}),Be;if(n.exactLength!==null){let r=a.data.length>n.exactLength.value,d=a.data.length<n.exactLength.value;(r||d)&&(Y(a,{code:r?j.too_big:j.too_small,minimum:d?n.exactLength.value:void 0,maximum:r?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),s.dirty())}if(n.minLength!==null&&a.data.length<n.minLength.value&&(Y(a,{code:j.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),s.dirty()),n.maxLength!==null&&a.data.length>n.maxLength.value&&(Y(a,{code:j.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),s.dirty()),a.common.async)return Promise.all([...a.data].map((r,d)=>n.type._parseAsync(new oi(a,r,a.path,d)))).then(r=>us.mergeArray(s,r));let i=[...a.data].map((r,d)=>n.type._parseSync(new oi(a,r,a.path,d)));return us.mergeArray(s,i)}get element(){return this._def.type}min(e,a){return new jh({...this._def,minLength:{value:e,message:ge.toString(a)}})}max(e,a){return new jh({...this._def,maxLength:{value:e,message:ge.toString(a)}})}length(e,a){return new jh({...this._def,exactLength:{value:e,message:ge.toString(a)}})}nonempty(e){return this.min(1,e)}};Qo.create=(t,e)=>new Qo({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Le.ZodArray,...Je(e)});function Cd(t){if(t instanceof Hs){let e={};for(let a in t.shape){let s=t.shape[a];e[a]=Jn.create(Cd(s))}return new Hs({...t._def,shape:()=>e})}else return t instanceof Qo?new Qo({...t._def,type:Cd(t.element)}):t instanceof Jn?Jn.create(Cd(t.unwrap())):t instanceof Hr?Hr.create(Cd(t.unwrap())):t instanceof zr?zr.create(t.items.map(e=>Cd(e))):t}var Hs=class en extends it{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),a=xt.objectKeys(e);return this._cached={shape:e,keys:a}}_parse(e){if(this._getType(e)!==re.object){let u=this._getOrReturnCtx(e);return Y(u,{code:j.invalid_type,expected:re.object,received:u.parsedType}),Be}let{status:a,ctx:s}=this._processInputParams(e),{shape:n,keys:i}=this._getCached(),r=[];if(!(this._def.catchall instanceof qi&&this._def.unknownKeys==="strip"))for(let u in s.data)i.includes(u)||r.push(u);let d=[];for(let u of i){let c=n[u],m=s.data[u];d.push({key:{status:"valid",value:u},value:c._parse(new oi(s,m,s.path,u)),alwaysSet:u in s.data})}if(this._def.catchall instanceof qi){let u=this._def.unknownKeys;if(u==="passthrough")for(let c of r)d.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(u==="strict")r.length>0&&(Y(s,{code:j.unrecognized_keys,keys:r}),a.dirty());else if(u!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let u=this._def.catchall;for(let c of r){let m=s.data[c];d.push({key:{status:"valid",value:c},value:u._parse(new oi(s,m,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{let u=[];for(let c of d){let m=await c.key,f=await c.value;u.push({key:m,value:f,alwaysSet:c.alwaysSet})}return u}).then(u=>us.mergeObjectSync(a,u)):us.mergeObjectSync(a,d)}get shape(){return this._def.shape()}strict(e){return ge.errToObj,new en({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(a,s)=>{var n,i,r,d;let u=(r=(i=(n=this._def).errorMap)===null||i===void 0?void 0:i.call(n,a,s).message)!==null&&r!==void 0?r:s.defaultError;return a.code==="unrecognized_keys"?{message:(d=ge.errToObj(e).message)!==null&&d!==void 0?d:u}:{message:u}}}:{}})}strip(){return new en({...this._def,unknownKeys:"strip"})}passthrough(){return new en({...this._def,unknownKeys:"passthrough"})}extend(e){return new en({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new en({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Le.ZodObject})}setKey(e,a){return this.augment({[e]:a})}catchall(e){return new en({...this._def,catchall:e})}pick(e){let a={};return xt.objectKeys(e).forEach(s=>{e[s]&&this.shape[s]&&(a[s]=this.shape[s])}),new en({...this._def,shape:()=>a})}omit(e){let a={};return xt.objectKeys(this.shape).forEach(s=>{e[s]||(a[s]=this.shape[s])}),new en({...this._def,shape:()=>a})}deepPartial(){return Cd(this)}partial(e){let a={};return xt.objectKeys(this.shape).forEach(s=>{let n=this.shape[s];e&&!e[s]?a[s]=n:a[s]=n.optional()}),new en({...this._def,shape:()=>a})}required(e){let a={};return xt.objectKeys(this.shape).forEach(s=>{if(e&&!e[s])a[s]=this.shape[s];else{let n=this.shape[s];for(;n instanceof Jn;)n=n._def.innerType;a[s]=n}}),new en({...this._def,shape:()=>a})}keyof(){return sO(xt.objectKeys(this.shape))}};Hs.create=(t,e)=>new Hs({shape:()=>t,unknownKeys:"strip",catchall:qi.create(),typeName:Le.ZodObject,...Je(e)});Hs.strictCreate=(t,e)=>new Hs({shape:()=>t,unknownKeys:"strict",catchall:qi.create(),typeName:Le.ZodObject,...Je(e)});Hs.lazycreate=(t,e)=>new Hs({shape:t,unknownKeys:"strip",catchall:qi.create(),typeName:Le.ZodObject,...Je(e)});var Pm=class extends it{_parse(t){let{ctx:e}=this._processInputParams(t),a=this._def.options;function s(n){for(let r of n)if(r.result.status==="valid")return r.result;for(let r of n)if(r.result.status==="dirty")return e.common.issues.push(...r.ctx.common.issues),r.result;let i=n.map(r=>new gn(r.ctx.common.issues));return Y(e,{code:j.invalid_union,unionErrors:i}),Be}if(e.common.async)return Promise.all(a.map(async n=>{let i={...e,common:{...e.common,issues:[]},parent:null};return{result:await n._parseAsync({data:e.data,path:e.path,parent:i}),ctx:i}})).then(s);{let n,i=[];for(let d of a){let u={...e,common:{...e.common,issues:[]},parent:null},c=d._parseSync({data:e.data,path:e.path,parent:u});if(c.status==="valid")return c;c.status==="dirty"&&!n&&(n={result:c,ctx:u}),u.common.issues.length&&i.push(u.common.issues)}if(n)return e.common.issues.push(...n.ctx.common.issues),n.result;let r=i.map(d=>new gn(d));return Y(e,{code:j.invalid_union,unionErrors:r}),Be}}get options(){return this._def.options}};Pm.create=(t,e)=>new Pm({options:t,typeName:Le.ZodUnion,...Je(e)});var er=t=>t instanceof Rm?er(t.schema):t instanceof Sn?er(t.innerType()):t instanceof Nm?[t.value]:t instanceof $f?t.options:t instanceof Dm?xt.objectValues(t.enum):t instanceof jm?er(t._def.innerType):t instanceof Im?[void 0]:t instanceof Om?[null]:t instanceof Jn?[void 0,...er(t.unwrap())]:t instanceof Hr?[null,...er(t.unwrap())]:t instanceof j_||t instanceof qm?er(t.unwrap()):t instanceof Bm?er(t._def.innerType):[],JI=class XI extends it{_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==re.object)return Y(a,{code:j.invalid_type,expected:re.object,received:a.parsedType}),Be;let s=this.discriminator,n=a.data[s],i=this.optionsMap.get(n);return i?a.common.async?i._parseAsync({data:a.data,path:a.path,parent:a}):i._parseSync({data:a.data,path:a.path,parent:a}):(Y(a,{code:j.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Be)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,a,s){let n=new Map;for(let i of a){let r=er(i.shape[e]);if(!r.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let d of r){if(n.has(d))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(d)}`);n.set(d,i)}}return new XI({typeName:Le.ZodDiscriminatedUnion,discriminator:e,options:a,optionsMap:n,...Je(s)})}};function C0(t,e){let a=ur(t),s=ur(e);if(t===e)return{valid:!0,data:t};if(a===re.object&&s===re.object){let n=xt.objectKeys(e),i=xt.objectKeys(t).filter(d=>n.indexOf(d)!==-1),r={...t,...e};for(let d of i){let u=C0(t[d],e[d]);if(!u.valid)return{valid:!1};r[d]=u.data}return{valid:!0,data:r}}else if(a===re.array&&s===re.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let i=0;i<t.length;i++){let r=t[i],d=e[i],u=C0(r,d);if(!u.valid)return{valid:!1};n.push(u.data)}return{valid:!0,data:n}}else return a===re.date&&s===re.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var Zm=class extends it{_parse(t){let{status:e,ctx:a}=this._processInputParams(t),s=(n,i)=>{if(w0(n)||w0(i))return Be;let r=C0(n.value,i.value);return r.valid?((k0(n)||k0(i))&&e.dirty(),{status:e.value,value:r.data}):(Y(a,{code:j.invalid_intersection_types}),Be)};return a.common.async?Promise.all([this._def.left._parseAsync({data:a.data,path:a.path,parent:a}),this._def.right._parseAsync({data:a.data,path:a.path,parent:a})]).then(([n,i])=>s(n,i)):s(this._def.left._parseSync({data:a.data,path:a.path,parent:a}),this._def.right._parseSync({data:a.data,path:a.path,parent:a}))}};Zm.create=(t,e,a)=>new Zm({left:t,right:e,typeName:Le.ZodIntersection,...Je(a)});var zr=class eO extends it{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==re.array)return Y(s,{code:j.invalid_type,expected:re.array,received:s.parsedType}),Be;if(s.data.length<this._def.items.length)return Y(s,{code:j.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Be;!this._def.rest&&s.data.length>this._def.items.length&&(Y(s,{code:j.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),a.dirty());let n=[...s.data].map((i,r)=>{let d=this._def.items[r]||this._def.rest;return d?d._parse(new oi(s,i,s.path,r)):null}).filter(i=>!!i);return s.common.async?Promise.all(n).then(i=>us.mergeArray(a,i)):us.mergeArray(a,n)}get items(){return this._def.items}rest(e){return new eO({...this._def,rest:e})}};zr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new zr({items:t,typeName:Le.ZodTuple,rest:null,...Je(e)})};var tO=class S0 extends it{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==re.object)return Y(s,{code:j.invalid_type,expected:re.object,received:s.parsedType}),Be;let n=[],i=this._def.keyType,r=this._def.valueType;for(let d in s.data)n.push({key:i._parse(new oi(s,d,s.path,d)),value:r._parse(new oi(s,s.data[d],s.path,d)),alwaysSet:d in s.data});return s.common.async?us.mergeObjectAsync(a,n):us.mergeObjectSync(a,n)}get element(){return this._def.valueType}static create(e,a,s){return a instanceof it?new S0({keyType:e,valueType:a,typeName:Le.ZodRecord,...Je(s)}):new S0({keyType:Ml.create(),valueType:e,typeName:Le.ZodRecord,...Je(a)})}},Py=class extends it{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:e,ctx:a}=this._processInputParams(t);if(a.parsedType!==re.map)return Y(a,{code:j.invalid_type,expected:re.map,received:a.parsedType}),Be;let s=this._def.keyType,n=this._def.valueType,i=[...a.data.entries()].map(([r,d],u)=>({key:s._parse(new oi(a,r,a.path,[u,"key"])),value:n._parse(new oi(a,d,a.path,[u,"value"]))}));if(a.common.async){let r=new Map;return Promise.resolve().then(async()=>{for(let d of i){let u=await d.key,c=await d.value;if(u.status==="aborted"||c.status==="aborted")return Be;(u.status==="dirty"||c.status==="dirty")&&e.dirty(),r.set(u.value,c.value)}return{status:e.value,value:r}})}else{let r=new Map;for(let d of i){let u=d.key,c=d.value;if(u.status==="aborted"||c.status==="aborted")return Be;(u.status==="dirty"||c.status==="dirty")&&e.dirty(),r.set(u.value,c.value)}return{status:e.value,value:r}}}};Py.create=(t,e,a)=>new Py({valueType:e,keyType:t,typeName:Le.ZodMap,...Je(a)});var Zy=class T0 extends it{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.parsedType!==re.set)return Y(s,{code:j.invalid_type,expected:re.set,received:s.parsedType}),Be;let n=this._def;n.minSize!==null&&s.data.size<n.minSize.value&&(Y(s,{code:j.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),a.dirty()),n.maxSize!==null&&s.data.size>n.maxSize.value&&(Y(s,{code:j.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),a.dirty());let i=this._def.valueType;function r(u){let c=new Set;for(let m of u){if(m.status==="aborted")return Be;m.status==="dirty"&&a.dirty(),c.add(m.value)}return{status:a.value,value:c}}let d=[...s.data.values()].map((u,c)=>i._parse(new oi(s,u,s.path,c)));return s.common.async?Promise.all(d).then(u=>r(u)):r(d)}min(e,a){return new T0({...this._def,minSize:{value:e,message:ge.toString(a)}})}max(e,a){return new T0({...this._def,maxSize:{value:e,message:ge.toString(a)}})}size(e,a){return this.min(e,a).max(e,a)}nonempty(e){return this.min(1,e)}};Zy.create=(t,e)=>new Zy({valueType:t,minSize:null,maxSize:null,typeName:Le.ZodSet,...Je(e)});var aO=class Bh extends it{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:a}=this._processInputParams(e);if(a.parsedType!==re.function)return Y(a,{code:j.invalid_type,expected:re.function,received:a.parsedType}),Be;function s(d,u){return My({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Ay(),Al].filter(c=>!!c),issueData:{code:j.invalid_arguments,argumentsError:u}})}function n(d,u){return My({data:d,path:a.path,errorMaps:[a.common.contextualErrorMap,a.schemaErrorMap,Ay(),Al].filter(c=>!!c),issueData:{code:j.invalid_return_type,returnTypeError:u}})}let i={errorMap:a.common.contextualErrorMap},r=a.data;if(this._def.returns instanceof El){let d=this;return za(async function(...u){let c=new gn([]),m=await d._def.args.parseAsync(u,i).catch(h=>{throw c.addIssue(s(u,h)),c}),f=await Reflect.apply(r,this,m);return await d._def.returns._def.type.parseAsync(f,i).catch(h=>{throw c.addIssue(n(f,h)),c})})}else{let d=this;return za(function(...u){let c=d._def.args.safeParse(u,i);if(!c.success)throw new gn([s(u,c.error)]);let m=Reflect.apply(r,this,c.data),f=d._def.returns.safeParse(m,i);if(!f.success)throw new gn([n(m,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Bh({...this._def,args:zr.create(e).rest(Eo.create())})}returns(e){return new Bh({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,a,s){return new Bh({args:e||zr.create([]).rest(Eo.create()),returns:a||Eo.create(),typeName:Le.ZodFunction,...Je(s)})}},Rm=class extends it{get schema(){return this._def.getter()}_parse(t){let{ctx:e}=this._processInputParams(t);return this._def.getter()._parse({data:e.data,path:e.path,parent:e})}};Rm.create=(t,e)=>new Rm({getter:t,typeName:Le.ZodLazy,...Je(e)});var Nm=class extends it{_parse(t){if(t.data!==this._def.value){let e=this._getOrReturnCtx(t);return Y(e,{received:e.data,code:j.invalid_literal,expected:this._def.value}),Be}return{status:"valid",value:t.data}}get value(){return this._def.value}};Nm.create=(t,e)=>new Nm({value:t,typeName:Le.ZodLiteral,...Je(e)});function sO(t,e){return new $f({values:t,typeName:Le.ZodEnum,...Je(e)})}var $f=class $0 extends it{constructor(){super(...arguments),Ru.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let a=this._getOrReturnCtx(e),s=this._def.values;return Y(a,{expected:xt.joinValues(s),received:a.parsedType,code:j.invalid_type}),Be}if(Ey(this,Ru)||KI(this,Ru,new Set(this._def.values)),!Ey(this,Ru).has(e.data)){let a=this._getOrReturnCtx(e),s=this._def.values;return Y(a,{received:a.data,code:j.invalid_enum_value,options:s}),Be}return za(e.data)}get options(){return this._def.values}get enum(){let e={};for(let a of this._def.values)e[a]=a;return e}get Values(){let e={};for(let a of this._def.values)e[a]=a;return e}get Enum(){let e={};for(let a of this._def.values)e[a]=a;return e}extract(e,a=this._def){return $0.create(e,{...this._def,...a})}exclude(e,a=this._def){return $0.create(this.options.filter(s=>!e.includes(s)),{...this._def,...a})}};Ru=new WeakMap;$f.create=sO;var Dm=class extends it{constructor(){super(...arguments),Nu.set(this,void 0)}_parse(t){let e=xt.getValidEnumValues(this._def.values),a=this._getOrReturnCtx(t);if(a.parsedType!==re.string&&a.parsedType!==re.number){let s=xt.objectValues(e);return Y(a,{expected:xt.joinValues(s),received:a.parsedType,code:j.invalid_type}),Be}if(Ey(this,Nu)||KI(this,Nu,new Set(xt.getValidEnumValues(this._def.values))),!Ey(this,Nu).has(t.data)){let s=xt.objectValues(e);return Y(a,{received:a.data,code:j.invalid_enum_value,options:s}),Be}return za(t.data)}get enum(){return this._def.values}};Nu=new WeakMap;Dm.create=(t,e)=>new Dm({values:t,typeName:Le.ZodNativeEnum,...Je(e)});var El=class extends it{unwrap(){return this._def.type}_parse(t){let{ctx:e}=this._processInputParams(t);if(e.parsedType!==re.promise&&e.common.async===!1)return Y(e,{code:j.invalid_type,expected:re.promise,received:e.parsedType}),Be;let a=e.parsedType===re.promise?e.data:Promise.resolve(e.data);return za(a.then(s=>this._def.type.parseAsync(s,{path:e.path,errorMap:e.common.contextualErrorMap})))}};El.create=(t,e)=>new El({type:t,typeName:Le.ZodPromise,...Je(e)});var Sn=class extends it{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Le.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:e,ctx:a}=this._processInputParams(t),s=this._def.effect||null,n={addIssue:i=>{Y(a,i),i.fatal?e.abort():e.dirty()},get path(){return a.path}};if(n.addIssue=n.addIssue.bind(n),s.type==="preprocess"){let i=s.transform(a.data,n);if(a.common.async)return Promise.resolve(i).then(async r=>{if(e.value==="aborted")return Be;let d=await this._def.schema._parseAsync({data:r,path:a.path,parent:a});return d.status==="aborted"?Be:d.status==="dirty"||e.value==="dirty"?Ly(d.value):d});{if(e.value==="aborted")return Be;let r=this._def.schema._parseSync({data:i,path:a.path,parent:a});return r.status==="aborted"?Be:r.status==="dirty"||e.value==="dirty"?Ly(r.value):r}}if(s.type==="refinement"){let i=r=>{let d=s.refinement(r,n);if(a.common.async)return Promise.resolve(d);if(d instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return r};if(a.common.async===!1){let r=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});return r.status==="aborted"?Be:(r.status==="dirty"&&e.dirty(),i(r.value),{status:e.value,value:r.value})}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(r=>r.status==="aborted"?Be:(r.status==="dirty"&&e.dirty(),i(r.value).then(()=>({status:e.value,value:r.value}))))}if(s.type==="transform")if(a.common.async===!1){let i=this._def.schema._parseSync({data:a.data,path:a.path,parent:a});if(!Tm(i))return i;let r=s.transform(i.value,n);if(r instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:e.value,value:r}}else return this._def.schema._parseAsync({data:a.data,path:a.path,parent:a}).then(i=>Tm(i)?Promise.resolve(s.transform(i.value,n)).then(r=>({status:e.value,value:r})):i);xt.assertNever(s)}};Sn.create=(t,e,a)=>new Sn({schema:t,typeName:Le.ZodEffects,effect:e,...Je(a)});Sn.createWithPreprocess=(t,e,a)=>new Sn({schema:e,effect:{type:"preprocess",transform:t},typeName:Le.ZodEffects,...Je(a)});var Jn=class extends it{_parse(t){return this._getType(t)===re.undefined?za(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Jn.create=(t,e)=>new Jn({innerType:t,typeName:Le.ZodOptional,...Je(e)});var Hr=class extends it{_parse(t){return this._getType(t)===re.null?za(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};Hr.create=(t,e)=>new Hr({innerType:t,typeName:Le.ZodNullable,...Je(e)});var jm=class extends it{_parse(t){let{ctx:e}=this._processInputParams(t),a=e.data;return e.parsedType===re.undefined&&(a=this._def.defaultValue()),this._def.innerType._parse({data:a,path:e.path,parent:e})}removeDefault(){return this._def.innerType}};jm.create=(t,e)=>new jm({innerType:t,typeName:Le.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Je(e)});var Bm=class extends it{_parse(t){let{ctx:e}=this._processInputParams(t),a={...e,common:{...e.common,issues:[]}},s=this._def.innerType._parse({data:a.data,path:a.path,parent:{...a}});return $m(s)?s.then(n=>({status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new gn(a.common.issues)},input:a.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new gn(a.common.issues)},input:a.data})}}removeCatch(){return this._def.innerType}};Bm.create=(t,e)=>new Bm({innerType:t,typeName:Le.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Je(e)});var Ry=class extends it{_parse(t){if(this._getType(t)!==re.nan){let e=this._getOrReturnCtx(t);return Y(e,{code:j.invalid_type,expected:re.nan,received:e.parsedType}),Be}return{status:"valid",value:t.data}}};Ry.create=t=>new Ry({typeName:Le.ZodNaN,...Je(t)});var Z7=Symbol("zod_brand"),j_=class extends it{_parse(t){let{ctx:e}=this._processInputParams(t),a=e.data;return this._def.type._parse({data:a,path:e.path,parent:e})}unwrap(){return this._def.type}},B_=class nO extends it{_parse(e){let{status:a,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{let n=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Be:n.status==="dirty"?(a.dirty(),Ly(n.value)):this._def.out._parseAsync({data:n.value,path:s.path,parent:s})})();{let n=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return n.status==="aborted"?Be:n.status==="dirty"?(a.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:s.path,parent:s})}}static create(e,a){return new nO({in:e,out:a,typeName:Le.ZodPipeline})}},qm=class extends it{_parse(t){let e=this._def.innerType._parse(t),a=s=>(Tm(s)&&(s.value=Object.freeze(s.value)),s);return $m(e)?e.then(s=>a(s)):a(e)}unwrap(){return this._def.innerType}};qm.create=(t,e)=>new qm({innerType:t,typeName:Le.ZodReadonly,...Je(e)});function iO(t,e={},a){return t?Ll.create().superRefine((s,n)=>{var i,r;if(!t(s)){let d=typeof e=="function"?e(s):typeof e=="string"?{message:e}:e,u=(r=(i=d.fatal)!==null&&i!==void 0?i:a)!==null&&r!==void 0?r:!0,c=typeof d=="string"?{message:d}:d;n.addIssue({code:"custom",...c,fatal:u})}}):Ll.create()}var R7={object:Hs.lazycreate},Le;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Le||(Le={}));var N7=(t,e={message:`Input not instance of ${t.name}`})=>iO(a=>a instanceof t,e),rO=Ml.create,oO=Am.create,D7=Ry.create,j7=Mm.create,dO=Lm.create,B7=Em.create,q7=Iy.create,W7=Im.create,F7=Om.create,z7=Ll.create,H7=Eo.create,U7=qi.create,K7=Oy.create,V7=Qo.create,G7=Hs.create,Q7=Hs.strictCreate,Y7=Pm.create,J7=JI.create,X7=Zm.create,e8=zr.create,t8=tO.create,a8=Py.create,s8=Zy.create,n8=aO.create,i8=Rm.create,A0=Nm.create,r8=$f.create,o8=Dm.create,d8=El.create,NC=Sn.create,l8=Jn.create,u8=Hr.create,c8=Sn.createWithPreprocess,p8=B_.create,m8=()=>rO().optional(),f8=()=>oO().optional(),h8=()=>dO().optional(),g8={string:t=>Ml.create({...t,coerce:!0}),number:t=>Am.create({...t,coerce:!0}),boolean:t=>Lm.create({...t,coerce:!0}),bigint:t=>Mm.create({...t,coerce:!0}),date:t=>Em.create({...t,coerce:!0})},y8=Be,_=Object.freeze({__proto__:null,defaultErrorMap:Al,setErrorMap:v7,getErrorMap:Ay,makeIssue:My,EMPTY_PATH:b7,addIssueToContext:Y,ParseStatus:us,INVALID:Be,DIRTY:Ly,OK:za,isAborted:w0,isDirty:k0,isValid:Tm,isAsync:$m,get util(){return xt},get objectUtil(){return b0},ZodParsedType:re,getParsedType:ur,ZodType:it,datetimeRegex:QI,ZodString:Ml,ZodNumber:Am,ZodBigInt:Mm,ZodBoolean:Lm,ZodDate:Em,ZodSymbol:Iy,ZodUndefined:Im,ZodNull:Om,ZodAny:Ll,ZodUnknown:Eo,ZodNever:qi,ZodVoid:Oy,ZodArray:Qo,ZodObject:Hs,ZodUnion:Pm,ZodDiscriminatedUnion:JI,ZodIntersection:Zm,ZodTuple:zr,ZodRecord:tO,ZodMap:Py,ZodSet:Zy,ZodFunction:aO,ZodLazy:Rm,ZodLiteral:Nm,ZodEnum:$f,ZodNativeEnum:Dm,ZodPromise:El,ZodEffects:Sn,ZodTransformer:Sn,ZodOptional:Jn,ZodNullable:Hr,ZodDefault:jm,ZodCatch:Bm,ZodNaN:Ry,BRAND:Z7,ZodBranded:j_,ZodPipeline:B_,ZodReadonly:qm,custom:iO,Schema:it,ZodSchema:it,late:R7,get ZodFirstPartyTypeKind(){return Le},coerce:g8,any:z7,array:V7,bigint:j7,boolean:dO,date:B7,discriminatedUnion:J7,effect:NC,enum:r8,function:n8,instanceof:N7,intersection:X7,lazy:i8,literal:A0,map:a8,nan:D7,nativeEnum:o8,never:U7,null:F7,nullable:u8,number:oO,object:G7,oboolean:h8,onumber:f8,optional:l8,ostring:m8,pipeline:p8,preprocess:c8,promise:d8,record:t8,set:s8,strictObject:Q7,string:rO,symbol:q7,transformer:NC,tuple:e8,undefined:W7,union:Y7,unknown:H7,void:K7,NEVER:y8,ZodIssueCode:j,quotelessJson:y7,ZodError:gn}),qh=_.string().regex(/^\d+$/,'Needs to be a number or a number represented as a string e.g. "10".').or(_.number().transform(String)),Af=()=>_.string().regex(/^[a-zA-Z0-9_]+$/),v8=Af(),b8=Af().max(50),w8=_.string().max(50).regex(/^[a-zA-Z0-9_+]+$/,"Can only contain letters [a-zA-Z0-9_+]");_.string().nullable().optional().transform(t=>t??void 0);_.number().nonnegative().max(100);_.number().nonnegative().max(420);_.enum(["repeat","random","shuffle"]);_.enum(["word","time","section"]);var lO=_.enum(["normal","expert","master"]),iu=_.object({acc:_.number().nonnegative().max(100),consistency:_.number().nonnegative().max(100),difficulty:lO,lazyMode:_.boolean().optional(),language:_.string().max(100).regex(/[\w+]+/),punctuation:_.boolean().optional(),numbers:_.boolean().optional(),raw:_.number().nonnegative(),wpm:_.number().nonnegative(),timestamp:_.number().nonnegative()}),k8=_.object({time:_.record(qh.describe("Number of seconds as string"),_.array(iu)),words:_.record(qh.describe("Number of words as string"),_.array(iu)),quote:_.record(qh,_.array(iu)),custom:_.record(_.literal("custom"),_.array(iu)),zen:_.record(_.literal("zen"),_.array(iu))});_.union([_.literal("10"),_.literal("25"),_.literal("50"),_.literal("100")]);_.union([_.literal("15"),_.literal("30"),_.literal("60"),_.literal("120")]);_.union([_.literal("short"),_.literal("medium"),_.literal("long"),_.literal("thicc")]);var _8=k8.keyof();_.union([qh,A0("zen"),A0("custom")],{errorMap:()=>({message:'Needs to be either a number, "zen" or "custom".'})});var x8=_.enum(["off","slow","medium","fast"]),C8=_.enum(["off","esc","tab","enter"]),S8=_.union([_.literal(-3),_.literal(-2),_.literal(-1),_.literal(0),_.literal(1),_.literal(2),_.literal(3)]),T8=_.array(S8),DC=_.enum(["off","default","block","outline","underline","carrot","banana"]),$8=_.enum(["off","on","max"]),A8=_.enum(["off","below","replace"]),M8=_.enum(["off","bar","text","mini"]),yb=_.enum(["off","text","mini"]),L8=_.enum(["off","on","fav","light","dark","custom"]),E8=_.enum(["black","sub","text","main"]),I8=_.enum(["0.25","0.5","0.75","1"]),O8=_.enum(["off","word","letter"]),P8=_.enum(["off","static","react","next"]),Z8=_.enum(["staggered","alice","matrix","split","split_matrix","steno","steno_matrix"]),R8=_.enum(["lowercase","uppercase","blank","dynamic"]),N8=_.enum(["always","layout","never"]),D8=_.number().min(.5).max(3.5).step(.1),j8=_.enum(["manual","on"]),B8=_.enum(["off","1","2","3","4"]),q8=_.enum(["off","1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"]),W8=_.number().min(0).max(1),F8=_.enum(["off","average","pb","tagPb","last","custom","daily"]),z8=_.tuple([_.enum(["on","off"]),_.enum(["on","off"]),_.enum(["on","off"]),_.enum(["on","off"])]),H8=_.enum(["off","custom"]),U8=_.enum(["off","letter","word","next_word","next_two_words","next_three_words"]),K8=_.enum(["off","letter","word"]),V8=_.enum(["wpm","cpm","wps","cps","wph"]),G8=_.enum(["off","result","on","sellout"]),Q8=_.enum(["off","custom"]),Y8=_.enum(["off","typing"]),J8=_.enum(["off","on","keymap"]),X8=_.enum(["cover","contain","max"]),eQ=_.tuple([_.number(),_.number(),_.number(),_.number()]),tQ=_.string().regex(/^[0-9a-zA-Z_#]+$/),aQ=_.enum(["off","1","2","3","4"]),sQ=_.enum(["off","fixed","flex"]),nQ=_.enum(["off","speed","acc","both"]),En=_.string().regex(/^#([\da-f]{3}){1,2}$/i),iQ=lO,rQ=_.tuple([En,En,En,En,En,En,En,En,En,En]),oQ=_.array(Af().max(50)),dQ=_.string().max(100).regex(/[\w#]+/),lQ=_.number().nonnegative(),uQ=_.number().nonnegative(),cQ=_.number().nonnegative().max(100),pQ=_.number().nonnegative(),mQ=_.number().int().nonnegative(),fQ=_.number().int().nonnegative(),hQ=_.string().max(50).regex(/^[a-zA-Z0-9_\-+.]+$/),vb=Af().max(50),gQ=_.string().max(50).regex(/[\w\-_]+/),yQ=Af().max(50),vQ=_.number().positive(),bQ=_.number().min(20).max(1e3).or(_.literal(0)),wQ=_.string().regex(/(https|http):\/\/(www\.|).+\..+\/.+(\.png|\.gif|\.jpeg|\.jpg)/gi).or(_.literal("")),kQ=_.object({theme:vb,themeLight:vb,themeDark:vb,autoSwitchTheme:_.boolean(),customTheme:_.boolean(),customThemeColors:rQ,favThemes:oQ,showKeyTips:_.boolean(),smoothCaret:x8,quickRestart:C8,punctuation:_.boolean(),numbers:_.boolean(),words:fQ,time:mQ,mode:_8,quoteLength:T8,language:w8,fontSize:vQ,freedomMode:_.boolean(),difficulty:iQ,blindMode:_.boolean(),quickEnd:_.boolean(),caretStyle:DC,paceCaretStyle:DC,flipTestColors:_.boolean(),layout:yQ,funbox:dQ,confidenceMode:$8,indicateTypos:A8,timerStyle:M8,liveSpeedStyle:yb,liveAccStyle:yb,liveBurstStyle:yb,colorfulMode:_.boolean(),randomTheme:L8,timerColor:E8,timerOpacity:I8,stopOnError:O8,showAllLines:_.boolean(),keymapMode:P8,keymapStyle:Z8,keymapLegendStyle:R8,keymapLayout:gQ,keymapShowTopRow:N8,keymapSize:D8,fontFamily:hQ,smoothLineScroll:_.boolean(),alwaysShowDecimalPlaces:_.boolean(),alwaysShowWordsHistory:_.boolean(),singleListCommandLine:j8,capsLockWarning:_.boolean(),playSoundOnError:B8,playSoundOnClick:q8,soundVolume:W8,startGraphsAtZero:_.boolean(),showOutOfFocusWarning:_.boolean(),paceCaret:F8,paceCaretCustomSpeed:lQ,repeatedPace:_.boolean(),accountChart:z8,minWpm:H8,minWpmCustomSpeed:uQ,highlightMode:U8,tapeMode:K8,typingSpeedUnit:V8,ads:G8,hideExtraLetters:_.boolean(),strictSpace:_.boolean(),minAcc:Q8,minAccCustom:cQ,monkey:_.boolean(),repeatQuotes:Y8,oppositeShiftMode:J8,customBackground:wQ,customBackgroundSize:X8,customBackgroundFilter:eQ,customLayoutfluid:tQ,monkeyPowerLevel:aQ,minBurst:sQ,minBurstCustomSpeed:pQ,burstHeatmap:_.boolean(),britishEnglish:_.boolean(),lazyMode:_.boolean(),showAverage:nQ,maxLineWidth:bQ}).strict(),_Q=kQ.partial(),xQ=_.string().regex(/^[0-9a-zA-Z_-]+$/).max(16),CQ=_.enum(["full","partial"]),Il=_.enum(["test","behavior","input","sound","caret","appearance","theme","hideElements","ads","hidden"]),uO=_.array(Il).min(1).superRefine((t,e)=>{Il.options.forEach(a=>{t.filter(s=>s===a).length>1&&e.addIssue({code:_.ZodIssueCode.custom,message:"No duplicates allowed."})})}),SQ=_.object({_id:v8,name:xQ,settingGroups:uO.nullable().optional(),config:_Q.extend({tags:_.array(b8).optional()})});SQ.partial({config:!0,settingGroups:!0});const Tt={presetType:"full",checkboxes:new Map(Il.options.map(t=>[t,!0])),setPresetToCurrent:!1};function bb(t,e,a){if(!ta()){g("You are offline",0,{duration:2});return}pO.show({focusFirstInput:!0,beforeAnimation:async()=>{o("#editPresetModal .modal .text").addClass("hidden"),AQ(),t==="add"?(o("#editPresetModal .modal").attr("data-action","add"),o("#editPresetModal .modal .popupTitle").html("Add new preset"),o("#editPresetModal .modal .submit").html("add"),o("#editPresetModal .modal input").val(""),o("#editPresetModal .modal input").removeClass("hidden"),o("#editPresetModal .modal label.changePresetToCurrentCheckbox").addClass("hidden"),o("#editPresetModal .modal .inputs").removeClass("hidden"),o("#editPresetModal .modal .presetType").removeClass("hidden"),o("#editPresetModal .modal .presetNameTitle").removeClass("hidden"),Tt.presetType="full"):t==="edit"&&e!==void 0&&a!==void 0?(o("#editPresetModal .modal").attr("data-action","edit"),o("#editPresetModal .modal").attr("data-preset-id",e),o("#editPresetModal .modal .popupTitle").html("Edit preset"),o("#editPresetModal .modal .submit").html("save"),o("#editPresetModal .modal input").val(a),o("#editPresetModal .modal input").removeClass("hidden"),o("#editPresetModal .modal label.changePresetToCurrentCheckbox").removeClass("hidden"),o("#editPresetModal .modal .presetNameTitle").removeClass("hidden"),Tt.setPresetToCurrent=!1,await cO()):t==="remove"&&e!==void 0&&a!==void 0&&(o("#editPresetModal .modal").attr("data-action","remove"),o("#editPresetModal .modal").attr("data-preset-id",e),o("#editPresetModal .modal .popupTitle").html("Delete preset"),o("#editPresetModal .modal .submit").html("delete"),o("#editPresetModal .modal input").addClass("hidden"),o("#editPresetModal .modal label.changePresetToCurrentCheckbox").addClass("hidden"),o("#editPresetModal .modal .text").removeClass("hidden"),o("#editPresetModal .modal .deletePrompt").text(`Are you sure you want to delete the preset ${a}?`),o("#editPresetModal .modal .inputs").addClass("hidden"),o("#editPresetModal .modal .presetType").addClass("hidden"),o("#editPresetModal .modal .presetNameTitle").addClass("hidden")),q_()}})}async function TQ(t){for(const a of Tt.checkboxes.keys())Tt.checkboxes.set(a,!1);const e=await w6(t);if(e===void 0){g("Preset not found",-1);return}if(e.settingGroups===void 0||e.settingGroups===null){Tt.presetType="full";for(const a of Tt.checkboxes.keys())Tt.checkboxes.set(a,!0)}else Tt.presetType="partial",e.settingGroups.forEach(a=>Tt.checkboxes.set(a,!0));Tt.setPresetToCurrent=!1,q_()}function $Q(){Il.options.forEach(e=>{const a=o(`#editPresetModal .modal .checkboxList .checkboxTitlePair[data-id="${e}"] input`);a.on("change",s=>{Tt.checkboxes.set(e,a.prop("checked"))})});const t=o("#editPresetModal .modal .changePresetToCurrentCheckbox input");t.on("change",async()=>{Tt.setPresetToCurrent=t.prop("checked"),await cO()})}function AQ(){function t(a){return a.replace(/([a-z])([A-Z])/g,"$1 $2")}const e=o("#editPresetModal .modal .inputs .checkboxList").empty();Il.options.forEach(a=>{const s=t(a),n=`<label class="checkboxTitlePair" data-id="${a}">
              <input type="checkbox" />
              <div class="title">${s}</div>
              </label>`;e.append(n)});for(const a of Tt.checkboxes.keys())Tt.checkboxes.set(a,!0);$Q()}function q_(){Il.options.forEach(t=>{o(`#editPresetModal .modal .checkboxList .checkboxTitlePair[data-id="${t}"] input`).prop("checked",Tt.checkboxes.get(t))}),o("#editPresetModal .modal .presetType button").removeClass("active"),o(`#editPresetModal .modal .presetType button[value="${Tt.presetType}"]`).addClass("active"),o("#editPresetModal .modal .partialPresetGroups").removeClass("hidden"),Tt.presetType==="full"&&o("#editPresetModal .modal .partialPresetGroups").addClass("hidden")}async function cO(){if(o("#editPresetModal .modal label.changePresetToCurrentCheckbox input").prop("checked",Tt.setPresetToCurrent),Tt.setPresetToCurrent){const t=o("#editPresetModal .modal").attr("data-preset-id");await TQ(t),o("#editPresetModal .modal .inputs").removeClass("hidden"),o("#editPresetModal .modal .presetType").removeClass("hidden")}else o("#editPresetModal .modal .inputs").addClass("hidden"),o("#editPresetModal .modal .presetType").addClass("hidden")}function MQ(){pO.hide()}async function LQ(){var u;const t=o("#editPresetModal .modal").attr("data-action"),e=o("#editPresetModal .modal input").val(),a=e.replaceAll(" ","_"),s=o("#editPresetModal .modal").attr("data-preset-id"),n=o("#editPresetModal .modal label input").prop("checked"),i=((u=T())==null?void 0:u.presets)??[];if(t===void 0)return;if(["add","edit"].includes(t)&&Tt.presetType==="partial"&&Array.from(Tt.checkboxes.values()).every(c=>!c)){g("At least one setting group must be active while saving partial presets",0);return}if(["add","edit"].includes(t)&&a.replace(/^_+|_+$/g,"").length===0){g("Preset name cannot be empty",0);return}if(MQ(),ht(),t==="add"){const c=jC(),m=wb(),f=await F.presets.add({body:{name:a,config:c,...Tt.presetType==="partial"&&{settingGroups:m}}});f.status!==200||f.body.data===null?g("Failed to add preset: "+f.body.message.replace(a,e),-1):(g("Preset added",1,{duration:2}),i.push({name:a,config:c,...Tt.presetType==="partial"&&{settingGroups:m},display:e,_id:f.body.data.presetId}))}else if(t==="edit"){const c=i.filter(y=>y._id===s)[0];if(c===void 0){g("Preset not found",-1);return}const m=jC(),f=Tt.presetType==="partial"?wb():null,h=await F.presets.save({body:{_id:s,name:a,...n&&{config:m,settingGroups:f}}});h.status!==200?g("Failed to edit preset: "+h.body.message,-1):(g("Preset updated",1),c.name=a,c.display=a.replace(/_/g," "),n&&(c.config=m,Tt.presetType==="partial"?c.settingGroups=wb():c.settingGroups=null))}else if(t==="remove"){const c=await F.presets.delete({params:{presetId:s}});c.status!==200?g("Failed to remove preset: "+c.body.message,-1):(g("Preset removed",1),i.forEach((m,f)=>{m._id===s&&i.splice(f,1)}))}fr(),We()}function EQ(t){const e=["theme","themeLight","themeDark","autoSwitchTheme","customTheme","customThemeColors","favThemes","flipTestColors","colorfulMode","randomTheme","customBackground","customBackgroundSize","customBackgroundFilter"],a=["showKeyTips","capsLockWarning","showOutOfFocusWarning","showAverage"],s=["smoothCaret","caretStyle","paceCaretStyle","paceCaret","paceCaretCustomSpeed","repeatedPace"],n=["quickRestart","difficulty","blindMode","funbox","alwaysShowWordsHistory","singleListCommandLine","minWpm","minWpmCustomSpeed","minAcc","minAccCustom","repeatQuotes","customLayoutfluid","minBurst","minBurstCustomSpeed","britishEnglish","tags"],i=["punctuation","words","time","numbers","mode","quoteLength","language","burstHeatmap"],r=["fontSize","timerStyle","liveSpeedStyle","liveAccStyle","liveBurstStyle","timerColor","timerOpacity","showAllLines","keymapMode","keymapStyle","keymapLegendStyle","keymapLayout","keymapShowTopRow","keymapSize","fontFamily","smoothLineScroll","alwaysShowDecimalPlaces","startGraphsAtZero","highlightMode","tapeMode","typingSpeedUnit","maxLineWidth"],d=["freedomMode","quickEnd","layout","confidenceMode","indicateTypos","stopOnError","hideExtraLetters","strictSpace","oppositeShiftMode","lazyMode"],u=["playSoundOnError","playSoundOnClick","soundVolume"],c=["accountChart","monkey","monkeyPowerLevel"],m=["ads"];if(e.includes(t))return"theme";if(a.includes(t))return"hideElements";if(s.includes(t))return"caret";if(n.includes(t))return"behavior";if(i.includes(t))return"test";if(r.includes(t))return"appearance";if(d.includes(t))return"input";if(u.includes(t))return"sound";if(c.includes(t))return"hidden";if(m.includes(t))return"ads";throw new Error(`${t} setting not part of any setting group`)}function IQ(t){const e={};return Object.keys($a).filter(a=>Tt.checkboxes.get(EQ(a))===!0).forEach(a=>{const s=a,n=t[s]!==void 0?t[s]:$a[s];e[s]=n}),e}function wb(){return uO.parse(Array.from(Tt.checkboxes.entries()).filter(([,t])=>t).map(([t])=>t))}function jC(){var n;const t=Tt.presetType==="partial"?IQ($w()):$w(),a=(((n=T())==null?void 0:n.tags)??[]).filter(i=>i.active).map(i=>i._id),s=Tt.presetType==="full"||Tt.checkboxes.get("behavior")===!0;return{...t,...s&&{tags:a}}}async function OQ(t){t.addEventListener("submit",e=>{e.preventDefault(),LQ()}),CQ.options.forEach(e=>{const a=t.querySelector(`.presetType button[value="${e}"]`);a!==null&&a.addEventListener("click",()=>{Tt.presetType=e,q_()})})}const pO=new Ct({dialogId:"editPresetModal",setup:OQ});function oh(t,e,a,s){if(!ta()){g("You are offline",0,{duration:2});return}mO.show({focusFirstInput:!0,modalChain:s,beforeAnimation:async()=>{o("#editTagModal .modal .text").addClass("hidden"),t==="add"?(o("#editTagModal .modal").attr("data-action","add"),o("#editTagModal .modal .title").html("Add new tag"),o("#editTagModal .modal button").html("add"),o("#editTagModal .modal input").val(""),o("#editTagModal .modal input").removeClass("hidden")):t==="edit"&&e!==void 0&&a!==void 0?(o("#editTagModal .modal").attr("data-action","edit"),o("#editTagModal .modal").attr("data-tag-id",e),o("#editTagModal .modal .title").html("Edit tag"),o("#editTagModal .modal button").html("save"),o("#editTagModal .modal input").val(a),o("#editTagModal .modal input").removeClass("hidden")):t==="remove"&&e!==void 0&&a!==void 0?(o("#editTagModal .modal").attr("data-action","remove"),o("#editTagModal .modal").attr("data-tag-id",e),o("#editTagModal .modal .title").html("Delete tag"),o("#editTagModal .modal .text").removeClass("hidden"),o("#editTagModal .modal .text").html(`Are you sure you want to delete tag ${a}?`),o("#editTagModal .modal button").html("delete"),o("#editTagModal .modal input").addClass("hidden")):t==="clearPb"&&e!==void 0&&a!==void 0&&(o("#editTagModal .modal").attr("data-action","clearPb"),o("#editTagModal .modal").attr("data-tag-id",e),o("#editTagModal .modal .title").html("Clear personal bests"),o("#editTagModal .modal .text").removeClass("hidden"),o("#editTagModal .modal .text").html(`Are you sure you want to clear personal bests for tag ${a}?`),o("#editTagModal .modal button").html("clear"),o("#editTagModal .modal input").addClass("hidden"))}})}function PQ(t=!1){mO.hide({clearModalChain:t})}async function ZQ(){var n,i,r,d,u,c,m,f;const t=o("#editTagModal .modal").attr("data-action"),e=o("#editTagModal .modal input").val(),a=e.replaceAll(" ","_"),s=o("#editTagModal .modal").attr("data-tag-id");if(PQ(!0),ht(),t==="add"){const h=await F.users.createTag({body:{tagName:a}});if(h.status!==200)g("Failed to add tag: "+h.body.message.replace(a,e),-1);else{if(h.body.data===null){g("Tag was added but data returned was null",-1),We();return}g("Tag added",1),(i=(n=T())==null?void 0:n.tags)==null||i.push({display:e,name:h.body.data.name,_id:h.body.data._id,personalBests:{time:{},words:{},quote:{},zen:{},custom:{}}}),fr()}}else if(t==="edit"){const h=await F.users.editTag({body:{tagId:s,newName:a}});h.status!==200?g("Failed to edit tag: "+h.body.message,-1):(g("Tag updated",1),(d=(r=T())==null?void 0:r.tags)==null||d.forEach(y=>{y._id===s&&(y.name=a,y.display=e)}),fr())}else if(t==="remove"){const h=await F.users.deleteTag({params:{tagId:s}});h.status!==200?g("Failed to remove tag: "+h.body.message,-1):(g("Tag removed",1),(c=(u=T())==null?void 0:u.tags)==null||c.forEach((y,b)=>{var w,$;y._id===s&&(($=(w=T())==null?void 0:w.tags)==null||$.splice(b,1))}),fr())}else if(t==="clearPb"){const h=await F.users.deleteTagPersonalBest({params:{tagId:s}});h.status!==200?g("Failed to clear tag pb: "+h.body.message,-1):(g("Tag PB cleared",1),(f=(m=T())==null?void 0:m.tags)==null||f.forEach(y=>{y._id===s&&(y.personalBests={time:{},words:{},quote:{},zen:{},custom:{}})}),fr())}We()}const mO=new Ct({dialogId:"editTagModal",setup:async t=>{t.addEventListener("submit",e=>{e.preventDefault(),ZQ()})}}),Rs=document.querySelector("#pageSettings");var sS;(sS=Rs==null?void 0:Rs.querySelector("#shareCustomThemeButton"))==null||sS.addEventListener("click",()=>{p7()});var nS;(nS=Rs==null?void 0:Rs.querySelector(".section.updateCookiePreferences button"))==null||nS.addEventListener("click",()=>{WI(!0)});var iS;(iS=Rs==null?void 0:Rs.querySelector(".section.presets"))==null||iS.addEventListener("click",t=>{var a,s,n,i;const e=t.target;if(e.classList.contains("addPresetButton"))bb("add");else if(e.classList.contains("editButton")){const r=(a=e.parentElement)==null?void 0:a.getAttribute("data-id"),d=(s=e.parentElement)==null?void 0:s.getAttribute("data-display");if(r===void 0||d===void 0||r===""||d===""||r===null||d===null){g("Failed to edit preset: Could not find preset id or name",-1);return}bb("edit",r,d)}else if(e.classList.contains("removeButton")){const r=(n=e.parentElement)==null?void 0:n.getAttribute("data-id"),d=(i=e.parentElement)==null?void 0:i.getAttribute("data-display");if(r===void 0||d===void 0||r===""||d===""||r===null||d===null){g("Failed to remove preset: Could not find preset id or name",-1);return}bb("remove",r,d)}});var rS;(rS=Rs==null?void 0:Rs.querySelector(".section.tags"))==null||rS.addEventListener("click",t=>{var a,s,n,i,r,d;const e=t.target;if(e.classList.contains("addTagButton"))oh("add");else if(e.classList.contains("editButton")){const u=(a=e.parentElement)==null?void 0:a.getAttribute("data-id"),c=(s=e.parentElement)==null?void 0:s.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){g("Failed to edit tag: Could not find tag id or name",-1);return}oh("edit",u,c)}else if(e.classList.contains("clearPbButton")){const u=(n=e.parentElement)==null?void 0:n.getAttribute("data-id"),c=(i=e.parentElement)==null?void 0:i.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){g("Failed to clear tag PB: Could not find tag id or name",-1);return}oh("clearPb",u,c)}else if(e.classList.contains("removeButton")){const u=(r=e.parentElement)==null?void 0:r.getAttribute("data-id"),c=(d=e.parentElement)==null?void 0:d.getAttribute("data-display");if(u===void 0||c===void 0||u===""||c===""||u===null||c===null){g("Failed to remove tag: Could not find tag id or name",-1);return}oh("remove",u,c)}});function RQ(t){var r;const e=hO.getModal();e.querySelector("table tbody").innerHTML="",e.querySelector("table thead tr td").textContent=t,e.querySelector("table thead tr td span.unit").textContent=l.typingSpeedUnit;const a=T();if(!a)return;const s=(r=a.personalBests)==null?void 0:r[t];if(s===void 0)return;const n=[];Object.keys(s).forEach(function(d){let u=s[d]??[];u=u.sort(function(c,m){return m.wpm-c.wpm}),u.forEach(function(c){c.mode2=d,n.push(c)})});let i;n.forEach(d=>{var m;let u='-<br><span class="sub">-</span>';const c=new Date(d.timestamp);d.timestamp&&(u=Ot(c,"dd MMM yyyy")+"<br><div class='sub'>"+Ot(c,"HH:mm")+"</div>"),(m=e.querySelector("table tbody"))==null||m.insertAdjacentHTML("beforeend",`
      <tr>
        <td>${i===d.mode2?"":d.mode2}</td>
        <td>
          ${ve.typingSpeed(d.wpm)}
          <br />
          <span class="sub">${ve.accuracy(d.acc)}</span>
        </td>
        <td>
          ${ve.typingSpeed(d.raw)}
          <br />
          <span class="sub">${ve.percentage(d.consistency)}</span>
        </td>
        <td>${d.difficulty}</td>
        <td>${d.language?Ar(d.language):"-"}</td>
        <td>${d.punctuation?'<i class="fas fa-check"></i>':""}</td>
        <td>${d.numbers?'<i class="fas fa-check"></i>':""}</td>
        <td>${d.lazyMode?'<i class="fas fa-check"></i>':""}</td>
        <td>${u}</td>
      </tr>
    `),i=d.mode2})}function fO(t){hO.show({beforeAnimation:async()=>{RQ(t)}})}const hO=new Ct({dialogId:"pbTablesModal"});function NQ(){if(!ta()){g("You are offline",0,{duration:2});return}bO.show({beforeAnimation:async()=>{jQ(),BQ()}})}function DQ(){bO.hide({afterAnimation:async()=>{const t=T();t&&vy("account",t)}})}const W_=o("#editProfileModal .bio"),F_=o("#editProfileModal .keyboard"),gO=o("#editProfileModal .twitter"),yO=o("#editProfileModal .github"),vO=o("#editProfileModal .website"),dh=o("#editProfileModal .badgeSelectionContainer");let Ed=-1;function jQ(){var i;const t=T();if(!t)return;const e=((i=t.inventory)==null?void 0:i.badges)??[],{bio:a,keyboard:s,socialProfiles:n}=t.details??{};Ed=-1,W_.val(a??""),F_.val(s??""),gO.val((n==null?void 0:n.twitter)??""),yO.val((n==null?void 0:n.github)??""),vO.val((n==null?void 0:n.website)??""),dh.html(""),e==null||e.forEach(r=>{r.selected&&(Ed=r.id);const d=yy(r.id,!1,!0),u=`<button type="button" class="badgeSelectionItem ${r.selected?"selected":""}" selection-id=${r.id}>${d}</button>`;dh.append(u)}),dh.prepend(`<button type="button" class="badgeSelectionItem ${Ed===-1?"selected":""}" selection-id=-1>
      <div class="badge">
        <i class="fas fa-frown-open"></i>
        <div class="text">none</div>
      </div>
    </button>`),o(".badgeSelectionItem").on("click",({currentTarget:r})=>{const d=o(r).attr("selection-id");Ed=parseInt(d,10),dh.find(".badgeSelectionItem").removeClass("selected"),o(r).addClass("selected")})}function BQ(){new wm(W_,250),new wm(F_,75)}function qQ(){const t=W_.val()??"",e=F_.val()??"",a=gO.val()??"",s=yO.val()??"",n=vO.val()??"";return{bio:t,keyboard:e,socialProfiles:{twitter:a,github:s,website:n}}}async function WQ(){var i,r,d,u,c;const t=T();if(!t)return;const e=qQ(),a=39;if(((i=e.socialProfiles)==null?void 0:i.github)!==void 0&&((r=e.socialProfiles)==null?void 0:r.github.length)>a){g(`GitHub username exceeds maximum allowed length (${a} characters).`,-1);return}const s=20;if(((d=e.socialProfiles)==null?void 0:d.twitter)!==void 0&&((u=e.socialProfiles)==null?void 0:u.twitter.length)>s){g(`Twitter username exceeds maximum allowed length (${s} characters).`,-1);return}ht();const n=await F.users.updateProfile({body:{...e,selectedBadgeId:Ed}});if(We(),n.status!==200){g("Failed to update profile: "+n.body.message,-1);return}t.details=n.body.data??e,(c=t.inventory)==null||c.badges.forEach(m=>{m.id===Ed?m.selected=!0:delete m.selected}),g("Profile updated",1),DQ()}const bO=new Ct({dialogId:"editProfileModal",setup:async t=>{t.addEventListener("submit",async e=>{e.preventDefault(),await WQ()})}});function FQ(t){wO.show({...t,focusFirstInput:!0,beforeAnimation:async e=>{e.querySelector("input").value=""}})}function zQ(t=!1){wO.hide({clearModalChain:t})}function HQ(){const t=o("#newFilterPresetModal input").val();if(t===""){g("Name cannot be empty",0);return}aV(t),zQ(!0)}async function UQ(t){t.addEventListener("submit",e=>{e.preventDefault(),HQ()})}const wO=new Ct({dialogId:"newFilterPresetModal",setup:UQ}),Mf=document.querySelector("#pageAccount");o(Mf).on("click",".pbsTime .showAllButton",()=>{fO("time")});o(Mf).on("click",".pbsWords .showAllButton",()=>{fO("words")});o(Mf).on("click",".editProfileButton",()=>{if(!we()){g("You must be logged in to edit your profile",0);return}const t=T();if(!t){g("Failed to open edit profile modal: No user snapshot found",-1);return}if(t.banned===!0){g("Banned users cannot edit their profile",0);return}NQ()});o(Mf).on("click",".group.history .resultEditTagsButton",t=>{const e=o(t.target).attr("data-result-id"),a=o(t.target).attr("data-tags");qE(e??"",JSON.parse(a??"[]"),"accountPage")});o(Mf).find("button.createFilterPresetBtn").on("click",()=>{FQ()});let Ga;function KQ(t){kO.show({mode:"dialog",focusFirstInput:!0,beforeAnimation:async()=>{ql("googleSignUpModal"),xf(o("#googleSignUpModal .captcha")[0],"googleSignUpModal"),QQ(),z_(),Ga=t}})}async function Ny(){kO.hide({afterAnimation:async()=>{var t;Ga!==void 0&&(g("Sign up process cancelled",0,{duration:5}),Qa(),Ja(),(t=D0(Ga))!=null&&t.isNewUser&&(await F.users.delete(),await Ga.user.delete()),ad(),Ga=void 0)}})}async function VQ(){var a;if(!Ga){g("Missing user credential. Please close the popup and try again.",-1);return}const t=Sv("googleSignUpModal");if(!t){g("Please complete the captcha",0);return}YQ(),z_(),ht();const e=o("#googleSignUpModal input").val();try{if(e.length===0)throw new Error("Name cannot be empty");const s=await F.users.create({body:{name:e,captcha:t}});if(s.status!==200)throw new Error(`Failed to create user: ${s.body.message}`);s.status===200&&(await vS(Ga.user,{displayName:e}),await j2(Ga.user),g("Account created",1),Ja(),Qa(),await Tf(Ga.user),Ga=void 0,We(),Ny())}catch(s){console.log(s);const n=qe(s,"Failed to sign in with Google");g(n,-1),Qa(),Ja(),C_(),Ga&&((a=D0(Ga))!=null&&a.isNewUser)&&(await F.users.delete(),await Ga.user.delete()),ad(),Ga=void 0,Ny(),We();return}}function GQ(){o("#googleSignUpModal button").prop("disabled",!1)}function z_(){o("#googleSignUpModal button").prop("disabled",!0)}function QQ(){o("#googleSignUpModal input").prop("disabled",!1)}function YQ(){o("#googleSignUpModal input").prop("disabled",!0)}const Id=new Jr(o("#googleSignUpModal input"),{available:{icon:"fa-check",level:1},unavailable:{icon:"fa-times",level:-1},taken:{icon:"fa-user",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:0}}),JQ=cs(1e3,async()=>{const t=o("#googleSignUpModal input").val();if(!t)return;const e=await F.users.getNameAvailability({params:{name:t}});e.status===200?(Id.show("available",e.body.message),GQ()):e.status===422?Id.show("unavailable",e.body.message):e.status===409?Id.show("taken",e.body.message):(Id.show("unavailable"),g("Failed to check name availability: "+e.body.message,-1))});async function XQ(t){var e;t.addEventListener("submit",a=>{a.preventDefault(),VQ()}),(e=t.querySelector("input"))==null||e.addEventListener("input",()=>{if(z_(),o("#googleSignUpModal input").val()===""){Id.hide();return}else Id.show("checking"),JQ()})}lG((t,e)=>{t!==void 0&&e&&KQ(t)});const kO=new Ct({dialogId:"googleSignUpModal",setup:XQ,customEscapeHandler:async()=>{Ny()},customWrapperClickHandler:async()=>{Ny()}}),_O=console.log,eY=console.warn,tY=console.error,xO=new Ts({key:"debugLogs",schema:Lt.boolean(),fallback:!1});let ju=xO.get();function aY(){ju=!ju,CO(`Debug logs ${ju?"enabled":"disabled"}`),xO.set(ju)}function CO(...t){_O("%cINFO","background:#4CAF50;color: #111;padding:0 5px;border-radius:10px",...t)}function sY(...t){eY("%cWRN","background:#FFC107;color: #111;padding:0 5px;border-radius:10px",...t)}function nY(...t){tY("%cERR","background:#F44336;color: #111;padding:0 5px;border-radius:10px",...t)}function iY(...t){ju&&_O("%cDEBG","background:#2196F3;color: #111;padding:0 5px;border-radius:10px",...t)}console.log=CO;console.warn=sY;console.error=nY;console.debug=iY;let M0=!1;function rY(t){document.documentElement.style.setProperty("--font",'"'+t.replace(/_/g," ")+'", "Roboto Mono", "Vazirmatn"'),HM(),M0=!0}function Mee(){M0&&(rY(l.fontFamily),M0=!1)}function oY(){const t=window.navigator.userAgent.toLowerCase(),e=t.includes("mac")&&!t.includes("firefox")?"cmd":"ctrl",a=l.quickRestart==="esc"?"tab":"esc";o("footer .keyTips").html(`
    <key>${l.quickRestart}</key> - restart test<br>
    <key>${a}</key> or <key>${e}</key>+<key>shift</key>+<key>p</key> - command line`)}window.addEventListener("keydown",function(t){t.code==="Space"&&t.target===document.body&&t.preventDefault()});window.addEventListener("beforeunload",t=>{zy(l.mode,l.words,l.time,ed(),Ni()??!1)||ea&&(t.preventDefault(),t.returnValue="")});const dY=cs(250,()=>{if(Zi(),ft()==="test"&&!Yt)if(l.tapeMode!=="off")hf();else{const t=document.querySelectorAll("#words .word")[zt-1];if(t){const e=Math.floor(t.offsetTop);zk(e)}}setTimeout(()=>{o("#wordsInput").is(":focus")&&xM()},250)}),lY=N0(250,()=>{pf()});o(window).on("resize",()=>{lY(),dY()});Dt(t=>{t==="quickRestart"&&oY()});const SO=new Ts({key:"accountSettingsMessageDismissed",schema:Lt.boolean(),fallback:!1});SO.get()&&o(".pageSettings .accountSettingsNotice").remove();o(".pageSettings .accountSettingsNotice .dismissAndGo").on("click",()=>{SO.set(!0),Ca("/account-settings"),o(".pageSettings .accountSettingsNotice").remove()});let L0=!1;const uY=new RegExp("\\p{P}","u");async function cY(t){function e(u,c){let m=u.shiftKey;const f=L0&&c.length>2?2:0,h=!uY.test(c.slice(f,f+2));_o&&h&&(m=!u.shiftKey);const y=c[(m?1:0)+f]??"",b=c[m?1:0]??"",w=c[0];return y||b||w}let a;try{a=await Gm(l.layout)}catch(u){return g(qe(u,"Failed to emulate event"),-1),null}let s=[];if(a.type==="ansi"?s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="iso"?s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","Backslash","IntlBackslash","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]:a.type==="matrix"&&(s=["Backquote","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Minus","Equal","KeyQ","KeyW","KeyE","KeyR","KeyT","KeyY","KeyU","KeyI","KeyO","KeyP","BracketLeft","BracketRight","Backslash","KeyA","KeyS","KeyD","KeyF","KeyG","KeyH","KeyJ","KeyK","KeyL","Semicolon","Quote","KeyZ","KeyX","KeyC","KeyV","KeyB","KeyN","KeyM","Comma","Period","Slash","Space"]),!s.includes(t.code))return null;const n=a.keys,i=n.row1.concat(n.row2).concat(n.row3).concat(n.row4).concat(n.row5),r=s.indexOf(t.code);if(r===-1)return t.code.includes("Numpad")?t.key:null;const d=e(t,i[r]??"");return d!==void 0?d:null}function TO(t){const e=t.code==="AltLeft"&&navigator.userAgent.includes("Mac");t.code!=="AltRight"&&!e||(t.type==="keydown"&&(L0=!0),t.type==="keyup"&&(L0=!1))}o(document).on("keydown",TO);o(document).on("keyup",TO);const $O=["MediaTrackNext","MediaTrackPrevious","MediaPlayPause","AudioVolumeUp","AudioVolumeDown","AudioVolumeMute"],pY=["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Hyper","Meta","OS","NumLock","ScrollLock","Scroll","Shift","Super","Symbol","SymbolLock"];let Dy=!1,jy=!0,kb=!1,AO,_b=0,By=!1;const BC=document.getElementById("wordsInput"),MO=document.getElementById("koInputVisual");function Fn(t){t!==BC.value&&(BC.value=t)}function E0(){var e;const t=Oe(yf());if(isNaN(t)||a3(t),l.keymapMode==="next"&&l.mode!=="zen")if(!l.language.startsWith("korean"))cr(I.getCurrent().charAt(A.current.length).toString());else{const a=pa.disassemble(I.getCurrent(),!0),s=pa.disassemble(A.current,!0),n=s.length-1;if(s[n]){const i=s[n].length;try{const r=a[n][i]??a[s.length][i-a[n].length];cr(r)}catch{cr("")}}else{const i=(e=a==null?void 0:a[0])==null?void 0:e[0];i!==void 0&&cr(i)}}}function LO(){var a,s,n,i;if(!ea||A.history.length===0||zt===0)return;const t=document.querySelectorAll("#words > .word");if(A.history[I.currentIndex-1]==I.get(I.currentIndex-1)&&!l.freedomMode||(a=t[I.currentIndex-1])!=null&&a.classList.contains("hidden")||l.confidenceMode==="on"||l.confidenceMode==="max")return;const e=(n=(s=t[I.currentIndex])==null?void 0:s.children[0])==null?void 0:n.classList.contains("incorrect");if(l.stopOnError==="letter"&&e&&Bn(),A.current=A.popHistory(),da.popHistory(),ze(l.funbox).find(r=>{var d;return(d=r.properties)==null?void 0:d.includes("nospace")})&&(A.current=A.current.slice(0,-1),Fn(" "+A.current+" ")),I.decreaseCurrentIndex(),qk(zt-1),cv(!0),iy(I.getCurrent()),Bn(),l.mode==="zen"){vf();const r=((i=document.querySelector("#words"))==null?void 0:i.children)??[];for(let d=r.length-1;d>=0;d--){const u=r[d];if(u.classList.contains("newline"))u.remove();else break}}Zi(),xo("backWord")}async function qC(){var d,u,c;if(!ea||A.current===""||Co()&&l.language.startsWith("chinese"))return;l.mode==="zen"&&(o("#words .word.active").removeClass("active"),o("#words").append("<div class='word active'></div>"));const t=I.getCurrent();for(const m of ze(l.funbox))(d=m.functions)!=null&&d.handleSpace&&m.functions.handleSpace();Dy=!0;const e=aL();t3(Math.round(e)),gM(e);const a=ze(l.funbox).find(m=>{var f;return(f=m.properties)==null?void 0:f.includes("nospace")})!==void 0,s=t===A.current||l.mode==="zen";if(QL(s,!0),uM(s),s)l.stopOnError==="letter"&&Bn(),tC(!0,t),A.pushHistory(),I.increaseCurrentIndex(),iy(I.getCurrent()),Mw(),Lw(I.currentIndex),a||Ri(),xo("submitCorrectWord");else{a||(l.playSoundOnError==="off"||l.blindMode?Ri():ov()),mM(I.getCurrent()),lM();const m=A.current.length;if(m<=I.getCurrent().length&&(m>=da.current.length?da.current+="_":da.current=da.current.substring(0,m)+"_"+da.current.substring(m+1)),l.stopOnError!=="off"){if(l.difficulty==="expert"||l.difficulty==="master"){Qu("difficulty");return}l.stopOnError==="word"&&(Dy=!1,xo("incorrectLetter","_"),Bn(),Zi());return}tC(!1,t),l.blindMode?l.highlightMode!=="off"&&j4(zt):D4(zt),A.pushHistory(),I.increaseCurrentIndex(),iy(I.getCurrent()),Mw(),Lw(I.currentIndex),xo("submitErrorWord"),(l.difficulty==="expert"||l.difficulty==="master")&&Qu("difficulty")}const n=I.currentIndex===I.length;if(c_()&&n){hl();return}let i;l.mode==="zen"?i=A.current.length:i=I.getCurrent().length;const r=KO(l.minBurstCustomSpeed,i);if(l.minBurst==="fixed"&&e<l.minBurstCustomSpeed||l.minBurst==="flex"&&e<r){Qu("min burst");return}if(da.pushHistory(),l.keymapMode==="react"&&uL(" ",!0),(l.mode==="words"||l.mode==="custom"||l.mode==="quote"||l.mode==="zen")&&vf(),(l.mode==="time"||l.mode==="words"||l.mode==="custom"||l.mode==="quote")&&(n?(By=!0,ht(),await iC(),We(),By=!1):iC()),qk(zt+1),cv(),Zi(),!l.showAllLines||l.mode==="time"||l.mode==="custom"&&Bt()===0||l.mode==="custom"&&Jt()==="time"){const m=Math.floor(((u=document.querySelectorAll("#words .word")[zt-1])==null?void 0:u.offsetTop)??0);let f;try{f=Math.floor(((c=document.querySelectorAll("#words .word")[zt])==null?void 0:c.offsetTop)??0)}catch{f=0}f>m&&zk(m)}}function mY(t,e){var n;if(!jy)return!1;if(l.mode==="zen")return!0;if(A.getKoreanStatus()){const r=pa.disassemble(I.getCurrent())[e];return r===void 0?!1:r===t}const a=I.getCurrent()[e];if(a===void 0)return!1;if(a===t)return!0;const s=ze(l.funbox).find(i=>{var r;return(r=i.functions)==null?void 0:r.isCharCorrect});return(n=s==null?void 0:s.functions)!=null&&n.isCharCorrect?s.functions.isCharCorrect(t,a):!!(l.language.startsWith("russian")&&(t==="ё"||t==="е"||t==="e")&&(a==="ё"||a==="е"||a==="e")||(t==="’"||t==="‘"||t==="'"||t==="ʼ"||t==="׳")&&(a==="’"||a==="‘"||a==="'"||a==="ʼ"||a==="׳")||(t==='"'||t==="”"||t==="“"||t==="„")&&(a==='"'||a==="”"||a==="“"||a==="„")||(t==="–"||t==="—"||t==="-")&&(a==="-"||a==="–"||a==="—"))}function ws(t,e,a){var w,$;if(Fo||Yt)return;if(t==="…"&&I.getCurrent()[e]!=="…"){for(let E=0;E<3;E++)ws(".",e+E);return}if(t==="œ"&&I.getCurrent()[e]!=="œ"){ws("o",e),ws("e",e+1);return}if(t==="æ"&&I.getCurrent()[e]!=="æ"){ws("a",e),ws("e",e+1);return}console.debug("Handling char",t,e,a);const s=performance.now(),n=A.getKoreanStatus();for(const E of ze(l.funbox))(w=E.functions)!=null&&w.handleChar&&(t=E.functions.handleChar(t));const i=ze(l.funbox).find(E=>{var L;return(L=E.properties)==null?void 0:L.includes("nospace")})!==void 0;if(t!==`
`&&t!=="	"&&/\s/.test(t)){if(i)return;if(qC(),l.difficulty!=="normal"||l.strictSpace&&l.mode!=="zen"||l.stopOnError==="word"&&e>0){if(Dy){Dy=!1;return}}else return}if(l.mode!=="zen"&&I.getCurrent()[e]!==`
`&&t===`
`||!ea&&!b9(s))return;Qr(!0),kM();const r=mY(t,e);let d;if(r&&l.mode!=="zen"&&(t=n?pa.disassemble(I.getCurrent())[e]??"":I.getCurrent().charAt(e)),!r&&t===`
`){if(A.current==="")return;t=" "}if(A.current===""&&D5(s),n||l.language.startsWith("korean")?(d=(a??"").slice(1),MO.innerText=d.slice(-1)):l.language.startsWith("chinese")?d=(a??"").slice(1):d=A.current.substring(0,e)+t+A.current.substring(e+1),!r&&Co()&&!l.language.startsWith("korean")){A.current=d,Bn(),Zi();return}if(QL(r),uM(r),r||(lM(),mM(I.getCurrent())),x3(l.mode==="zen"?t:I.getCurrent()[e]??"",r),r||l.playSoundOnError==="off"||l.blindMode?Ri():ov(),l.keymapMode==="react"&&uL(t,r),l.difficulty!=="master")if(jy)_b=0;else{_b++,_b>=5&&g("Opposite shift mode is on.",0,{important:!0,customTitle:"Reminder"});return}if(da.current==="")da.current+=n?pa.disassemble(d).join(""):d;else{const E=n?pa.disassemble(da.current).length:da.current.length;e>=E?da.current+=n?pa.disassemble(t).concat():t:r||(da.current=da.current.substring(0,e)+t+da.current.substring(e+1))}if(Mw(),Lw(I.currentIndex),l.difficulty!=="master"&&l.stopOnError==="letter"&&!r){l.blindMode||Bn(A.current+t);return}xo(r?"correctLetter":"incorrectLetter",t);const u=($=document.querySelectorAll("#words .word"))==null?void 0:$[zt];if((n?pa.disassemble(A.current).length:A.current.length)===1&&I.currentIndex===0&&(u==null||u.offsetTop,void 0),l.mode==="zen"&&e<30||l.mode!=="zen"&&d.length<I.getCurrent().length+20?A.current=d:console.error("Hitting word limit"),!r&&l.difficulty==="master"){Qu("difficulty");return}if(l.mode!=="zen"){const E=I.getCurrent(),be=I.currentIndex===I.length-1,J=c_(),k=E===A.current,S=l.quickEnd&&!l.language.startsWith("korean")&&E.length===A.current.length&&l.stopOnError==="off",z=l.language.startsWith("chinese");if(be&&J&&(k||S)&&(!z||a!==void 0&&e+2==a.length)){hl();return}}const m=u==null?void 0:u.offsetTop;Bn();const f=u==null?void 0:u.offsetTop;m<f&&!Dw&&A.current.length>1&&(l.mode==="zen"?l.showAllLines||zk(m):(A.current=A.current.slice(0,-1),Bn())),(i&&A.current.length===I.getCurrent().length||t===`
`&&r)&&qC();const h=I.getCurrent(),y=/^\t+/.test(I.getCurrent()),b=h[A.current.length]==="	";setTimeout(()=>{if(r&&l.language.startsWith("code")&&y&&b){const E=new KeyboardEvent("keydown",{key:"Tab",code:"Tab"});document.dispatchEvent(E)}},0),t!==`
`&&Zi()}function fY(t,e){if(Fo){t.preventDefault();return}let a=!1;(l.mode==="zen"&&!t.shiftKey||Np&&!t.shiftKey)&&(a=!0);const s=Ra("commandLineWrapper")||e;if(l.quickRestart==="esc"){if(s||ft()==="login")return;if(t.preventDefault(),!Yt&&a){ws("	",A.current.length),Fn(" "+A.current);return}}else if(l.quickRestart==="tab"){if(s||ft()==="login")return;if(ft()!=="test"){Ca("/");return}if(t.shiftKey?$t():Dp(),!Yt&&a){t.preventDefault(),ws("	",A.current.length),Fn(" "+A.current);return}ut({event:t})}else{if(s||ft()!=="test"||Yt)return;if(a){t.preventDefault(),ws("	",A.current.length),Fn(" "+A.current);return}setTimeout(()=>{var n;((n=document.activeElement)==null?void 0:n.id)!=="wordsInput"&&Qr(!1)},0)}}o("#wordsInput").on("keydown",t=>{const e=ft()==="test",a=Ra("commandLineWrapper"),s=Ra("leaderboardsWrapper"),n=Wy();e&&!a&&!s&&!n&&!Yt&&t.key!=="Enter"&&!By||t.preventDefault()});let xb=-1;o(document).on("keydown",async t=>{var u,c,m;if(ft()==="loading"){console.debug("Ignoring keydown event on loading page.");return}if($O.includes(t.key)){console.debug(`Key ${t.key} is on the list of ignored keys. Stopping keydown event.`);return}const e=o("#wordsInput").is(":focus"),a=ft()==="test",s=Ra("commandLineWrapper"),n=Ra("leaderboardsWrapper"),i=Wy(),r=a&&!s&&!n&&!i&&!Yt&&(e||t.key!=="Enter")&&!By;if(r&&!e&&!["Enter"," ","Escape","Tab",...pY].includes(t.key)&&(uv(),l.showOutOfFocusWarning&&!t.ctrlKey&&!t.metaKey&&t.preventDefault()),t.key==="Tab"&&fY(t,i),t.key==="Escape"&&l.quickRestart==="esc"){if(Ra("commandLineWrapper")||i)return;if(ft()!=="test"){Ca("/");return}t.shiftKey?$t():Dp(),ut({event:t})}if(t.key==="Enter"&&l.quickRestart==="enter"){const f=document.activeElement;if((f==null?void 0:f.tagName)==="BUTTON"||(f==null?void 0:f.tagName)==="A"||(f==null?void 0:f.classList.contains("button"))||(f==null?void 0:f.classList.contains("textButton"))||(f==null?void 0:f.tagName)==="INPUT"&&(f==null?void 0:f.id)!=="wordsInput"||Ra("commandLineWrapper")||i)return;if(ft()!=="test"){Ca("/");return}if(Yt){ut({event:t});return}l.mode==="zen"||(!zg&&!l.funbox.includes("58008")||(zg||l.funbox.includes("58008"))&&t.shiftKey)&&(t.shiftKey?$t():Dp(),ut({event:t}))}if(!r)return;if(!((u=t.originalEvent)!=null&&u.isTrusted)||ds){t.preventDefault();return}if(dM(),t.key==="Backspace"&&(Ri(),/INPUT|SELECT|TEXTAREA/i.test(t.target.tagName)||t.preventDefault(),l.confidenceMode==="max")){t.preventDefault();return}if(gz(),t.key==="Backspace"&&A.current.length===0&&(LO(),A.current&&Fn(" "+A.current+" ")),t.key==="Enter")if(t.shiftKey){if(l.mode==="zen")hl();else if(!zy(l.mode,l.words,l.time,ed(),Ni()??!1)){const f=Date.now()-xb;xb===-1||f>200?(xb=Date.now(),f>=5e3&&g("Please double tap shift+enter to confirm bail out",0,{important:!0,duration:5})):(NT(!0),hl())}}else ws(`
`,A.current.length),Fn(" "+A.current);if(t.key==="Dead"&&!Co()){Ri();const f=(c=document.querySelectorAll("#words .word"))==null?void 0:c[zt],h=A.current.length,y=f==null?void 0:f.querySelectorAll("letter")[h];y&&y.classList.toggle("dead")}if(l.oppositeShiftMode!=="off")if(l.oppositeShiftMode==="keymap"&&l.keymapLayout!=="overrideSync"){const f=await Gm(l.keymapLayout).catch(()=>{});if(f===void 0){g("Failed to load keymap layout",-1);return}const h=TM(t.key,f);jy=h===void 0?!0:Ow(h)}else jy=Ow(t.code);const d=ze(l.funbox).find(f=>{var h;return(h=f.functions)==null?void 0:h.preventDefaultEvent});if((m=d==null?void 0:d.functions)!=null&&m.preventDefaultEvent&&await d.functions.preventDefaultEvent(t)&&(t.preventDefault(),ws(t.key,A.current.length),E0(),Fn(" "+A.current)),l.layout!=="default"&&!(t.ctrlKey||t.altKey&&window.navigator.platform.search("Linux")>-1)){const f=await cY(t);f!==null&&(t.preventDefault(),ws(f,A.current.length),E0(),Fn(" "+A.current))}AO=t.key==="Backspace"||t.key==="delete"});o("#wordsInput").on("keydown",t=>{var a;if((a=t.originalEvent)!=null&&a.repeat){console.log("spacing debug keydown STOPPED - repeat",t.key,t.code,t.which);return}t.code==="NumpadEnter"&&l.funbox.includes("58008")&&(t.code="Space"),t.code.includes("Arrow")&&l.funbox.includes("arrows")&&(t.code="NoCode");const e=performance.now();setTimeout(()=>{const s=t.code===""||t.which===231?"NoCode":t.code;B5(e,s)},0)});o("#wordsInput").on("keyup",t=>{var a;if((a=t.originalEvent)!=null&&a.repeat){console.log("spacing debug keydown STOPPED - repeat",t.key,t.code,t.which);return}t.code==="NumpadEnter"&&l.funbox.includes("58008")&&(t.code="Space"),t.code.includes("Arrow")&&l.funbox.includes("arrows")&&(t.code="NoCode");const e=performance.now();setTimeout(()=>{const s=t.code===""||t.which===231?"NoCode":t.code;cM(e,s)},0)});o("#wordsInput").on("keyup",t=>{var e;if(!((e=t.originalEvent)!=null&&e.isTrusted)||ds){t.preventDefault();return}$O.includes(t.key)||Yt||yz()});o("#wordsInput").on("beforeinput",t=>{var e;(e=t.originalEvent)!=null&&e.isTrusted&&t.target.value===""&&(t.target.value=" ")});o("#wordsInput").on("input",t=>{var u;if(!((u=t.originalEvent)!=null&&u.isTrusted)||ds){t.target.value=" ";return}if(Wy()){t.preventDefault();return}dM(),(l.layout==="default"||l.layout==="korean")&&t.target.value.normalize().match(/[\uac00-\ud7af]|[\u1100-\u11ff]|[\u3130-\u318f]|[\ua960-\ua97f]|[\ud7b0-\ud7ff]/g)&&A.setKoreanStatus(!0);const a=A.getKoreanStatus(),s=l.language.startsWith("chinese"),n=t.target.value.normalize(),i=a?pa.disassemble(n).join("").slice(1):n.slice(1),r=a?pa.disassemble(A.current).join(""):A.current;if(a&&!AO&&(kb||n.slice(1).length<A.current.length&&pa.disassemble(A.current.slice(-1)).length>1)){kb=!kb;return}if(l.layout!=="default"&&i.length>=r.length){Fn(" "+r);return}if(n.length===0&&r.length===0)LO();else if(i.length<r.length){if(s)if(r.length-i.length<=2&&r.startsWith(r))A.current=i;else{let c=0;for(;i[c]===r[c];)c++;let m=0;l.stopOnError!=="word"&&/.+ .+/.test(i)&&(m=i.indexOf(" ")+1);for(let f=c;f<i.length;f++)ws(i[f],f-m,n)}else if(a){const c=t.target.value.normalize().slice(1);A.current=c,MO.innerText=c.slice(-1)}else A.current=i;Bn(),Zi(),Co()||((t==null?void 0:t.originalEvent).inputType==="deleteWordBackward"?xo("setLetterIndex",0):xo("setLetterIndex",r.length-1))}if(i!==r){let c=0;for(;i[c]===r[c];)c++;let m=0;l.stopOnError!=="word"&&/.+ .+/.test(i)&&(m=i.indexOf(" ")+1);for(let f=c;f<i.length;f++)ws(i[f],f-m,n)}Fn(" "+A.current),E0();const d=Co();setTimeout(()=>{const c=Co();d!==c&&Bn(),t.target.selectionStart!==t.target.value.length&&(!tr.test(t.target.value)||(t.target.selectionStart??0)<t.target.value.search(tr))&&(t.target.selectionStart=t.target.selectionEnd=t.target.value.length)},0)});o("#wordsInput").on("focus",t=>{t.target.selectionStart=t.target.selectionEnd=t.target.value.length});o("#wordsInput").on("copy paste",t=>{t.preventDefault()});o("#wordsInput").on("select selectstart",t=>{t.preventDefault()});o("#wordsInput").on("keydown",t=>{t.key.startsWith("Arrow")&&t.preventDefault()});o("#wordsInput").on("compositionstart",()=>{l.layout==="default"&&(NM(!0),m4(A.current.length))});o("#wordsInput").on("compositionend",()=>{l.layout==="default"&&NM(!1)});const hY=new Ts({key:"merchBannerClosed",schema:Lt.boolean(),fallback:!1});function gY(){hY.get()}o(()=>{G_("/css/slimselect.min.css",!0),G_("/css/balloon.min.css",!0),g7(),o("body").css("transition","background .25s, transform .05s"),gY(),setTimeout(()=>{ze(l.funbox).forEach(t=>{var e,a;return(a=(e=t.functions)==null?void 0:e.applyGlobalCSS)==null?void 0:a.call(e)})},500),o("#app").css("opacity","0").removeClass("hidden").stop(!0,!0).animate({opacity:1},qt(250)),ta()&&bV().then(()=>{var t;(t=xv())!=null&&t.users.signUp||(sq(),o(".register").addClass("hidden"),o(".login").addClass("hidden"),o(".disabledNotification").removeClass("hidden"))}),FH(),new B2("https://keymash.io/")});let lh=!1;o(document).on("click",".scrollToTopButton",()=>{window.scrollTo({top:0,behavior:dS()?"instant":"smooth"})});o(window).on("scroll",()=>{const t=ft();if(t!=="test"&&(t==="about"||t==="settings"||t==="account")){const e=window.scrollY;!lh&&e>100?(o(".scrollToTopButton").removeClass("invisible"),lh=!0):lh&&e<100&&(o(".scrollToTopButton").addClass("invisible"),lh=!1)}});o("#nocss .requestedStylesheets").html("Requested stylesheets:<br>"+[...document.querySelectorAll("link[rel=stylesheet")].map(t=>t.href).filter(t=>/\/css\/style/gi.test(t)).join("<br>"));o("#nocss .requestedJs").html("Requested Javascript files:<br>"+[...document.querySelectorAll("script")].map(t=>t.src).filter(t=>/(\/js\/mon|\/js\/vendor)/gi.test(t)).join("<br>")+"<br><br>Client version:<br>"+Fm.clientVersion);window.navigator.userAgent.toLowerCase().includes("mac")?o("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-top: 1rem;
        margin-bottom: 1rem;
      "
    >
      Cmd
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `):o("#nocss .keys").html(`
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
        margin-bottom: 1rem;
      "
    >
      Ctrl
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      Shift
    </span>
    +
    <span
      style="
        padding: 1rem;
        display: inline-block;
        border-radius: 1rem;
        background: #2c2e31;
      "
    >
      R
    </span>
  `);const Wm="videoAdPopupWrapper";async function yY(){if(Cs(Wm,"popups"),await l_(),wv){g("Looks like you're using an adblocker. Video ads will not work until you disable it.",0,{duration:6});return}if(await u_(),tm){g("Looks like you're using a cookie popup blocker. Video ads will not work without giving your consent through the popup.",0,{duration:7});return}Ra(Wm)||o("#videoAdPopupWrapper").stop(!0,!0).css("opacity",0).removeClass("hidden").animate({opacity:1},125,()=>{window.dataLayer.push({event:"EG_Video"})})}function WC(){Ra(Wm)&&o("#videoAdPopupWrapper").stop(!0,!0).css("opacity",1).animate({opacity:0},125,()=>{o("#videoAdPopupWrapper").addClass("hidden"),Na(Wm)})}function vY(t){const e=t.event;e==="started"||(e==="finished"?WC():e==="empty"&&(g("Failed to load video ad. Please try again later",-1,{duration:3}),WC()))}o(".pageTest #watchVideoAdButton").on("click",()=>{yY()});ms(Wm);let vr;async function EO(t=l.language){if(!vr)return;const a=(await Qm(t)).bcp47??"en-US";vr.lang=a}async function IO(){vr=new SpeechSynthesisUtterance,await EO()}function bY(){vr=void 0}async function wY(t){window.speechSynthesis.cancel(),vr===void 0&&await IO(),vr!==void 0&&(vr.text=t,window.speechSynthesis.speak(vr))}Dt((t,e)=>{t==="funbox"&&(e==="none"?bY():e==="tts"&&IO()),t==="language"&&l.funbox.split("#").includes("tts")&&EO()});g3(t=>{wY(t)});let Wh=0,OO,I0,H_=!0;const ro=document.querySelector("#fpsCounter");function PO(t){if(H_)return;const e=t-I0;if(Wh++,e>500){const a=Oe(Wh*1e3/e).toFixed(2);Wh=0,I0=t,kY(a)}window.requestAnimationFrame(PO)}function Lee(){H_=!1,Wh=0,I0=performance.now(),OO=window.requestAnimationFrame(PO),ro.classList.remove("hidden")}function Eee(){cancelAnimationFrame(OO),H_=!0,ro.classList.add("hidden")}async function kY(t){ro.innerHTML=`FPS ${t}`;const e=parseFloat(t);ro.classList.remove("error"),ro.classList.remove("main"),e<30?ro.classList.add("error"):e>55&&ro.classList.add("main")}const ru=new Jr(o(".page.pageProfileSearch .search input"),{notFound:{icon:"fa-user-slash",level:-1},error:{icon:"fa-times",level:-1},checking:{icon:"fa-circle-notch",spinIcon:!0,level:1}});function _Y(){o(".page.pageProfileSearch .search button").addClass("disabled"),o(".page.pageProfileSearch .search input").attr("disabled","disabled")}function xY(){o(".page.pageProfileSearch .search button").removeClass("disabled"),o(".page.pageProfileSearch .search input").removeAttr("disabled")}function CY(){return o(".page.pageProfileSearch .search input").attr("disabled")!==void 0}function FC(){o(".page.pageProfileSearch .search input").trigger("focus")}async function SY(){ru.hide();const t=o(".page.pageProfileSearch .search input").val();if(t==="")return;ru.show("checking"),_Y(),await jt(500);const e=await F.users.getProfile({params:{uidOrName:t}});if(xY(),e.status===404){FC(),ru.show("notFound","User not found");return}else if(e.status!==200){FC(),ru.show("error",`Error: ${e.body.message}`);return}ru.hide(),Ca(`/profile/${t}`,{data:e.body.data})}o(".page.pageProfileSearch form").on("submit",t=>{t.preventDefault(),!CY()&&SY()});ms("pageProfileSearch");const ZO=new Ts({key:"lastSeenVersion",schema:Lt.string(),fallback:""});let O0=null,qy=null;function TY(t){ZO.set(t)}function $Y(){return ZO.get()}async function AY(){const t=await $B(),e=$Y();O0=t,qy=e===""?!1:e!==t,(qy||e==="")&&(TY(t),MY())}function MY(){caches.keys().then(function(t){for(const e of t)caches.delete(e)})}async function LY(){return(O0===null||qy===null)&&await AY(),{version:O0,isNew:qy}}function EY(t){o("footer .currentVersion .text").text(t)}function IY(t){t?o("#newVersionIndicator").removeClass("hidden"):o("#newVersionIndicator").addClass("hidden")}async function OY(){const{version:t,isNew:e}=await LY();EY(t),IY(e)}function PY(t){for(const[e,a]of Object.entries(t))window[e]=a}$5();OY();Qr(!0,!0);PY({snapshot:T,config:l,toggleFilterDebug:SV,glarsesMode:cH,stats:F4,replay:u4,enableTimerDebug:wz,getTimerStats:Mz,toggleUnsmoothedRaw:wH,egVideoListener:vY,toggleDebugLogs:aY});export{yA as $,jr as A,rA as B,see as C,ov as D,dA as E,Ri as F,CA as G,qA as H,uA as I,cA as J,BA as K,Zp as L,Pp as M,SA as N,pA as O,bA as P,wA as Q,oA as R,aee as S,r4 as T,qx as U,hA as V,Ta as W,l as X,_k as Y,gA as Z,xk as _,ha as a,Rz as a$,Ck as a0,wi as a1,YA as a2,Pn as a3,MA as a4,mA as a5,kk as a6,AA as a7,fA as a8,IA as a9,O4 as aA,A as aB,I as aC,Y4 as aD,u7 as aE,$k as aF,Ak as aG,xa as aH,Tw as aI,oh as aJ,Aa as aK,SL as aL,Cf as aM,T as aN,aI as aO,oz as aP,Rp as aQ,wy as aR,b6 as aS,fr as aT,bb as aU,wo as aV,Xm as aW,W3 as aX,ok as aY,fL as aZ,VA as a_,RA as aa,NA as ab,Gr as ac,Sk as ad,JA as ae,mn as af,eM as ag,XA as ah,tM as ai,rf as aj,_A as ak,T5 as al,Ni as am,Jt as an,K5 as ao,Bt as ap,NT as aq,hl as ar,_s as as,pt as at,ZJ as au,Ca as av,Xy as aw,of as ax,Yt as ay,VM as az,$t as b,rY as b0,FA as b1,Mee as b2,Ar as b3,ul as b4,bo as b5,Ct as b6,ed as b7,Vm as b8,sk as b9,Ol as ba,xB as bb,ak as bc,CB as bd,DI as be,JE as bf,Tk as bg,df as bh,lz as bi,S5 as bj,yY as bk,mW as bl,cl as bm,Rc as bn,Pl as bo,F4 as bp,Lee as bq,Eee as br,Qr as bs,eC as bt,Mi as bu,Ym as bv,zB as bw,ft as bx,uv as by,Dn as c,Zr as d,HA as e,bi as f,wk as g,Fs as h,jA as i,WA as j,xA as k,OA as l,PA as m,ZA as n,LA as o,DA as p,zA as q,ut as r,xn as s,TA as t,lA as u,vA as v,UA as w,EA as x,kA as y,$A as z};